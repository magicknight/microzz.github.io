<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>æ¶µæœˆå¤©-microzz.com</title>
  <subtitle>ITæŠ€æœ¯åˆ†äº«</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://microzz.com/"/>
  <updated>2017-03-15T14:54:38.426Z</updated>
  <id>http://microzz.com/</id>
  
  <author>
    <name>Microzz</name>
    <email>903036377@qq.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Vue.jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨</title>
    <link href="http://microzz.com/2017/03/15/vue-music/"/>
    <id>http://microzz.com/2017/03/15/vue-music/</id>
    <published>2017-03-15T13:44:02.000Z</published>
    <updated>2017-03-15T14:54:38.426Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vue-jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨"><a href="#Vue-jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨" class="headerlink" title="Vue.jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨"></a>Vue.jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨</h1><h2 id="åœ¨çº¿é¢„è§ˆ"><a href="#åœ¨çº¿é¢„è§ˆ" class="headerlink" title="åœ¨çº¿é¢„è§ˆ"></a>åœ¨çº¿é¢„è§ˆ</h2><p>åœ¨çº¿é¢„è§ˆåœ°å€1: ğŸ”—<a href="http://microzz.cn/vue-music/" target="_blank" rel="external">http://microzz.cn/vue-music/</a><br>åœ¨çº¿é¢„è§ˆåœ°å€2: ğŸ”—<a href="https://microzz.github.io/vue-music-player/" target="_blank" rel="external">https://microzz.github.io/vue-music-player/</a></p>
<h2 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h2><p>GitHubåœ°å€: ğŸ”—<a href="https://github.com/microzz/vue-music-player" target="_blank" rel="external">https://github.com/microzz/vue-music-player</a><br>æ¬¢è¿å¤§å®¶followå’Œstarå“¦ğŸ˜„</p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>å­¦ä¹ Vue.jsåï¼Œå†³å®šåšä¸ªå°é¡¹ç›®é”»ç‚¼ä¸€ä¸‹ï¼Œäºæ˜¯é€‰æ‹©äº†å…¸å‹çš„éŸ³ä¹æ’­æ”¾å™¨ä¸Šæ‰‹ã€‚å…¶ä¸­é‡åˆ°äº†å¾ˆå¤šå‘ï¼Œä¹Ÿå­¦åˆ°äº†å¾ˆå¤šã€‚ä»£ç å¯èƒ½è¿˜æœ‰ç‘•ç–µï¼Œæ¬¢è¿å¤§å®¶åˆ°æˆ‘çš„<a href="https://github.com/microzz/vue-music-player" target="_blank" rel="external">GitHub</a>åé¦ˆï¼Œç›¸äº’äº¤æµå­¦ä¹ ã€‚åŒæ—¶ä¹Ÿæ¬¢è¿å¤§å®¶followå’ŒstarğŸ˜„<br>é¢„è§ˆå›¾ï¼š<br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://omratag7g.bkt.clouddn.com/red.png" alt="çº¢è‰²çš®è‚¤-microzz.com" title="">
                </div>
                <div class="image-caption">çº¢è‰²çš®è‚¤-microzz.com</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://omratag7g.bkt.clouddn.com/green.png" alt="ç»¿è‰²çš®è‚¤-microzz.com" title="">
                </div>
                <div class="image-caption">ç»¿è‰²çš®è‚¤-microzz.com</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://omratag7g.bkt.clouddn.com/blue.png" alt="è“è‰²çš®è‚¤-microzz.com" title="">
                </div>
                <div class="image-caption">è“è‰²çš®è‚¤-microzz.com</div>
            </figure><br><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://omratag7g.bkt.clouddn.com/black.png" alt="é»‘è‰²çš®è‚¤-microzz.com" title="">
                </div>
                <div class="image-caption">é»‘è‰²çš®è‚¤-microzz.com</div>
            </figure></p>
<h3 id="æŠ€æœ¯æ ˆ"><a href="#æŠ€æœ¯æ ˆ" class="headerlink" title="æŠ€æœ¯æ ˆ"></a>æŠ€æœ¯æ ˆ</h3><h4 id="Vue-js"><a href="#Vue-js" class="headerlink" title="Vue.js"></a><strong>Vue.js</strong></h4><p>Vueçš„åŒå‘æ•°æ®ç»‘å®šçœŸçš„å¾ˆçˆ½ï¼Œè®©å¼€å‘è€…æ›´å¤šçš„å…³æ³¨ä¸šåŠ¡é€»è¾‘ï¼Œè€Œä¸æ˜¯è€—æ€§èƒ½çš„DOMæ“ä½œã€‚å€Ÿé‰´äº†React.jså’ŒAngular.jsç­‰è‘—åæ¡†æ¶ï¼ŒVueå†™èµ·æ¥ä¹Ÿçš„ç¡®å¾ˆæ–¹ä¾¿ï¼Œå¾ˆå¤šåœ°æ–¹ä¹Ÿæƒ³çš„å¾ˆå‘¨åˆ°ã€‚å› ä¸ºå®é™…åœºæ™¯ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨åˆ°è·¯ç”±ã€vuexç­‰ä¸œè¥¿ã€‚<br>å…¶ä¸­ä¹Ÿé‡åˆ°äº†å‡ ä¸ªå€¼å¾—æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<ol>
<li>ç”¨å¥½<code>watch</code>ä¼šäº‹åŠåŠŸå€</li>
<li>æœ‰äº›æ“ä½œè¦åœ¨å®ä¾‹åŠ è½½å®Œï¼Œæ‰€ä»¥é’©å­å‡½æ•°<code>mounted</code>éœ€è¦æ³¨æ„</li>
<li>å¾ˆå¤šå°æŠ€å·§è¦è¯•è¿‡æ‰çŸ¥é“èµ°äº†å¼¯è·¯ğŸ˜‚</li>
</ol>
<hr>
<h4 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a><strong>ES6</strong></h4><p>æœ¬ç¤ºä¾‹é‡‡ç”¨çš„æ˜¯ES6çš„è¯­æ³•ï¼Œå› ä¸ºwebpackç¼–è¯‘ï¼Œæ‰€ä»¥ä¹Ÿä¸å¿…å¤ªè¿‡å½“å¿ƒå…¼å®¹æ€§é—®é¢˜ã€‚ES6ä¹Ÿå³ECMAScript 2015ï¼Œå‘å¸ƒä¹Ÿæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œå¾ˆå¤šåœ°æ–¹å¾ˆæ–¹ä¾¿ï¼Œè¿™æ˜¯å¤§åŠ¿æ‰€è¶‹ï¼Œä»¥åä¼šæ…¢æ…¢åœ°å‘ES6è¿ç§»ã€‚æŒæ¡æ˜¯å¾ˆå¿…è¦çš„ï¼</p>
<hr>
<h4 id="HTML5"><a href="#HTML5" class="headerlink" title="HTML5"></a>HTML5</h4><p><strong>localStorage</strong><br>æœ¬demoç”¨localStorageæœ¬åœ°å­˜å‚¨ä¿å­˜ç”¨æˆ·è®¾ç½®ï¼ˆå¦‚ï¼šçš®è‚¤ï¼‰å’Œç”¨æˆ·æ­Œå•åˆ—è¡¨</p>
<hr>
<h4 id="CSS3"><a href="#CSS3" class="headerlink" title="CSS3"></a>CSS3</h4><p>å¾ˆå¤šåŠ¨ç”»éƒ½æ˜¯ä¾é CSS3å®Œæˆçš„ï¼Œæ–¹ä¾¿æ€§èƒ½ä¹Ÿä¸é”™ï¼Œç¼ºç‚¹æ˜¯å…¼å®¹æ€§é—®é¢˜ã€‚</p>
<hr>
<h2 id="æ›´æ–°è®°å½•"><a href="#æ›´æ–°è®°å½•" class="headerlink" title="æ›´æ–°è®°å½•"></a>æ›´æ–°è®°å½•</h2><h3 id="2017-03-13"><a href="#2017-03-13" class="headerlink" title="2017.03.13"></a>2017.03.13</h3><p>A music player by Vue.jsã€‚ä¸€ä¸ªç”±Vue.jså†™çš„éŸ³ä¹æ’­æ”¾å™¨ï¼Œä»Šå¤©å®Œæˆäº†æ’­æ”¾å™¨çš„å¤§ä½“åŠŸèƒ½ï¼Œæ•°æ®æ˜¯é€šè¿‡JSONæ¨¡æ‹Ÿ</p>
<h4 id="åç»­å®Œå–„"><a href="#åç»­å®Œå–„" class="headerlink" title="åç»­å®Œå–„"></a>åç»­å®Œå–„</h4><ol>
<li>æ­å»ºåå°è°ƒç”¨ç½‘ä¸ŠéŸ³ä¹API</li>
<li>å®Œå–„åŠŸèƒ½</li>
</ol>
<hr>
<h3 id="2017-03-14"><a href="#2017-03-14" class="headerlink" title="2017.03.14"></a>2017.03.14</h3><p>åˆ—è¡¨éƒ¨åˆ†åŠŸèƒ½å®Œå–„ï¼Œéƒ¨åˆ†ä»£ç ä¼˜åŒ–ï¼Œéƒ¨åˆ†å¼‚æ­¥ä»£ç PromiseåŒ–</p>
<h4 id="åç»­å®Œå–„-1"><a href="#åç»­å®Œå–„-1" class="headerlink" title="åç»­å®Œå–„"></a>åç»­å®Œå–„</h4><ol>
<li>å†—ä½™ä»£ç æ•´åˆä¼˜åŒ–</li>
<li>éƒ¨åˆ†ä»£ç å°è£…</li>
</ol>
<hr>
<h3 id="2017-03-15"><a href="#2017-03-15" class="headerlink" title="2017.03.15"></a>2017.03.15</h3><p>1.0.0æ­£å¼ç‰ˆå‘å¸ƒ</p>
<h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p>ä¸ªäººç½‘ç«™ï¼šğŸ”—<a href="https://microzz.com/">https://microzz.com/</a><br>GitHubï¼šğŸ”—<a href="https://github.com/microzz" target="_blank" rel="external">https://github.com/microzz</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Vue-jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨&quot;&gt;&lt;a href=&quot;#Vue-jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨&quot; class=&quot;headerlink&quot; title=&quot;Vue.jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨&quot;&gt;&lt;/a&gt;Vue.jså†™ä¸€ä¸ªéŸ³ä¹æ’­æ”¾å™¨&lt;/h1&gt;&lt;h2 id=&quot;åœ¨çº¿é¢„è§ˆ&quot;&gt;&lt;a href=&quot;#åœ¨
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="HTML5" scheme="http://microzz.com/tags/HTML5/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Vue.js" scheme="http://microzz.com/tags/Vue-js/"/>
    
  </entry>
  
  <entry>
    <title>ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶</title>
    <link href="http://microzz.com/2017/03/12/select-plugin/"/>
    <id>http://microzz.com/2017/03/12/select-plugin/</id>
    <published>2017-03-12T09:03:01.000Z</published>
    <updated>2017-03-13T01:37:03.201Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶"><a href="#ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶" class="headerlink" title="ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶"></a>ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>ä¸€ä¸ªä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶ï¼Œé»˜è®¤ç”Ÿæˆä¸­å›½åœ°åŒºğŸ‡¨ğŸ‡³çš„ä¸‰çº§è”åŠ¨æ•°æ®ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ•°æ®ã€‚<br>npmåœ°å€ï¼š<a href="https://www.npmjs.com/package/select-plugin" target="_blank" rel="external">https://www.npmjs.com/package/select-plugin</a></p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>è¾“å…¥ <code>npm install select-plugin</code> .  </p>
<p>æœ€å¥½å…ˆåˆå§‹åŒ–ä¸€ä¸‹package.jsonæ–‡ä»¶ï¼Œè¾“å…¥ <code>npm init -y</code>ï¼Œç„¶åå†æ‰§è¡Œå®‰è£…<code>npm install select-plugin</code></p>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="é»˜è®¤æ•°æ®"><a href="#é»˜è®¤æ•°æ®" class="headerlink" title="é»˜è®¤æ•°æ®"></a><strong>é»˜è®¤æ•°æ®</strong></h3><p> å¼•å…¥jsæ–‡ä»¶ã€‚<br> åœ¨htmlæ–‡ä»¶ä¸­æ’å…¥<code>&lt;script src=&quot;./node_modules/select-plugin/dist/select-plugin-all.js&quot;&gt;&lt;/script&gt;</code>ï¼Œ<br> ç„¶å<br> <code>&lt;script&gt;new Select()&lt;/script&gt;</code><br> é»˜è®¤å°±å¯ä»¥ç”Ÿæˆä¸­å›½åœ°åŒºçš„ä¸‰çº§è”åŠ¨æ•°æ®å•¦ğŸ˜„</p>
<h3 id="è‡ªå®šä¹‰æ•°æ®"><a href="#è‡ªå®šä¹‰æ•°æ®" class="headerlink" title="è‡ªå®šä¹‰æ•°æ®"></a><strong>è‡ªå®šä¹‰æ•°æ®</strong></h3><p>å¦‚æœä½ <strong>åªä½¿ç”¨</strong>è‡ªå®šä¹‰çš„æ•°æ®ï¼Œå»ºè®®åªå¼•å…¥ä¸åŒ…å«åœ°åŒºæ•°æ®çš„jsæ–‡ä»¶ï¼Œ<br>å³<code>&lt;script src=&quot;./node_modules/select-plugin/dist/select-plugin.js&quot;&gt;&lt;/script&gt;</code>ï¼Œ<br>è¿™æ ·æ–‡ä»¶å¤§å°å¯ä»¥å‡å°‘å¾ˆå¤šï¼Œæ¯•ç«Ÿå¤§ä¸­å›½åœ°åŒºæ•°æ®å¤ªåºå¤§äº†ğŸ˜‡ä½†æ˜¯åŠ¡å¿…ä¼ é€’ä¼ é€’ç›¸å…³å‚æ•°ï¼<br><br><code>new Select(&#39;.container&#39;, data, id, text);</code> <br><br><strong>å‚æ•°ä¾æ¬¡æ˜¯æ’å…¥çˆ¶å®¹å™¨ä½ç½®ï¼ˆé»˜è®¤æ˜¯bodyï¼Œå‚æ•°æ˜¯CSS3é€‰æ‹©å™¨çš„å½¢å¼ï¼Œå¦‚â€™#idâ€™ , â€˜ .classNameâ€™ï¼‰ï¼Œæ•°æ®ï¼Œåœ¨DOMå…ƒç´ çš„idï¼Œæ˜¾ç¤ºçš„æ–‡æœ¬</strong></p>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>ä¸‰çº§è”åŠ¨ç”Ÿæˆå™¨æ’ä»¶<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/select-plugin/dist/select-plugin-all.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">  <span class="comment">// ä¸ä¼ ä»»ä½•å‚æ•°,é»˜è®¤ç”Ÿæˆä¸­å›½åœ°åŒºä¸‰çº§è”åŠ¨</span></div><div class="line">    <span class="keyword">new</span> Select();</div><div class="line"></div><div class="line">  <span class="comment">// è‡ªå®šä¹‰æ•°æ®</span></div><div class="line">    <span class="keyword">var</span> data = &#123;</div><div class="line">                <span class="attr">One</span>: [<span class="string">'a1'</span>, <span class="string">'a2'</span>, <span class="string">'a3'</span>],</div><div class="line">                <span class="attr">Two</span>: [</div><div class="line">                  [<span class="string">'a11'</span>, <span class="string">'a12'</span>, <span class="string">'a13'</span>],</div><div class="line">                  [<span class="string">'a21'</span>, <span class="string">'a22'</span>],</div><div class="line">                  [<span class="string">'a31'</span>, <span class="string">'a32'</span>]</div><div class="line">                ],</div><div class="line">                <span class="attr">Three</span>:  [</div><div class="line">                  [[<span class="string">'a111'</span>, <span class="string">'a112'</span>], [<span class="string">'a121'</span>, <span class="string">'a122'</span>], [<span class="string">'a131'</span>, <span class="string">'a132'</span>]],</div><div class="line">                  [[<span class="string">'a211'</span>, <span class="string">'a212'</span>], [<span class="string">'a221'</span>, <span class="string">'a222'</span>]],</div><div class="line">                  [[<span class="string">'a311'</span>], [<span class="string">'a312'</span>]]</div><div class="line">                ]</div><div class="line">              &#125;;</div><div class="line">    <span class="keyword">var</span> id = [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>];</div><div class="line">    <span class="keyword">var</span> text = [<span class="string">'é€‰é¡¹1'</span>, <span class="string">'é€‰é¡¹2'</span>, <span class="string">'é€‰é¡¹3'</span>];</div><div class="line">    <span class="comment">// å‚æ•°ä¾æ¬¡æ˜¯æ’å…¥çˆ¶å®¹å™¨ä½ç½®ï¼Œæ•°æ®ï¼ŒDOMçš„idï¼Œæ˜¾ç¤ºçš„æ–‡æœ¬</span></div><div class="line">    <span class="keyword">new</span> Select(<span class="string">'.container'</span>, data, id, text);</div><div class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="æ•ˆæœé¢„è§ˆ"><a href="#æ•ˆæœé¢„è§ˆ" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h3><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://github.com/microzz/select-plugin/blob/1.0.0/preview.png?raw=true" alt="select-plugin" title="">
                </div>
                <div class="image-caption">select-plugin</div>
            </figure>
<h3 id="åœ¨çº¿é¢„è§ˆ"><a href="#åœ¨çº¿é¢„è§ˆ" class="headerlink" title="åœ¨çº¿é¢„è§ˆ"></a>åœ¨çº¿é¢„è§ˆ</h3><p><a href="https://microzz.github.io/select-plugin/" target="_blank" rel="external">åœ¨çº¿é¢„è§ˆåœ°å€1</a><br><a href="http://microzz.cn/select-plugin/" target="_blank" rel="external">åœ¨çº¿é¢„è§ˆåœ°å€2</a></p>
<h2 id="About"><a href="#About" class="headerlink" title="About"></a>About</h2><p>GitHubï¼š <a href="https://github.com/microzz" target="_blank" rel="external">https://github.com/microzz</a>  <br><br>ä¸ªäººç½‘ç«™ï¼š<a href="https://microzz.com/">https://microzz.com/</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶&quot;&gt;&lt;a href=&quot;#ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶&quot; class=&quot;headerlink&quot; title=&quot;ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶&quot;&gt;&lt;/a&gt;ä¸‰çº§è”åŠ¨çš„ç”Ÿæˆå™¨æ’ä»¶&lt;/h1&gt;&lt;h2 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot; class=&quot;headerli
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="npm" scheme="http://microzz.com/tags/npm/"/>
    
  </entry>
  
  <entry>
    <title>Vue.jsåˆä½“éªŒ-TodoList</title>
    <link href="http://microzz.com/2017/03/09/vue-begin/"/>
    <id>http://microzz.com/2017/03/09/vue-begin/</id>
    <published>2017-03-09T14:51:14.000Z</published>
    <updated>2017-03-10T00:22:07.409Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Vue-jsåˆä½“éªŒ"><a href="#Vue-jsåˆä½“éªŒ" class="headerlink" title="Vue.jsåˆä½“éªŒ"></a>Vue.jsåˆä½“éªŒ</h1><blockquote>
<p>&nbsp;&nbsp;&nbsp;ä¹‹å‰å­¦äº†React.jsï¼Œä»Šå¤©ç®€å•ä¸Šæ‰‹äº†Vue.jsï¼Œæ„Ÿå—åˆ°äº†Vue.jsçš„ä¸€äº›ç‹¬ç‰¹é­…åŠ›ã€‚åŒå‘çš„æ•°æ®ç»‘å®šè®©äººå¼€å‘èµ·æ¥å¾ˆâ€œçˆ½â€ï¼Œäºæ˜¯åŠ¨æ‰‹ç®€å•å†™äº†ä¸€ä¸ªTodo Listå°demoï¼ŒVueä¸Šæ‰‹çš„ç¡®æ¯”è¾ƒç®€å•ï¼Œæ–¹ä¾¿ä¸å°‘ã€‚æœŸå¾…åç»­çš„å­¦ä¹ ğŸ˜„</p>
</blockquote>
<h2 id="TodoListå°demo"><a href="#TodoListå°demo" class="headerlink" title="TodoListå°demo"></a>TodoListå°demo</h2><h3 id="åœ¨çº¿é¢„è§ˆ"><a href="#åœ¨çº¿é¢„è§ˆ" class="headerlink" title="åœ¨çº¿é¢„è§ˆ"></a>åœ¨çº¿é¢„è§ˆ</h3><p>åœ¨çº¿é¢„è§ˆåœ°å€1: ğŸ”—<a href="http://microzz.cn/todo-vue/" target="_blank" rel="external">http://microzz.cn/todo-vue/</a><br>åœ¨çº¿é¢„è§ˆåœ°å€2: ğŸ”—<a href="https://microzz.github.io/todo-list-vuejs/" target="_blank" rel="external">https://microzz.github.io/todo-list-vuejs/</a></p>
<h3 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h3><p>æºä»£ç åœ°å€ï¼šğŸ”—<a href="https://github.com/microzz/todo-list-vuejs" target="_blank" rel="external">https://github.com/microzz/todo-list-vuejs</a></p>
<h2 id="Vue-js"><a href="#Vue-js" class="headerlink" title="Vue.js"></a>Vue.js</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>Vue.jsæ˜¯ä¸€å¥—æ„å»ºç”¨æˆ·ç•Œé¢çš„æ¸è¿›å¼æ¡†æ¶ã€‚ä¸å…¶ä»–é‡é‡çº§æ¡†æ¶ä¸åŒçš„æ˜¯ï¼ŒVue é‡‡ç”¨è‡ªåº•å‘ä¸Šå¢é‡å¼€å‘çš„è®¾è®¡ã€‚Vue çš„æ ¸å¿ƒåº“åªå…³æ³¨è§†å›¾å±‚ï¼Œå¹¶ä¸”éå¸¸å®¹æ˜“å­¦ä¹ ï¼Œéå¸¸å®¹æ˜“ä¸å…¶å®ƒåº“æˆ–å·²æœ‰é¡¹ç›®æ•´åˆã€‚å¦ä¸€æ–¹é¢ï¼ŒVue å®Œå…¨æœ‰èƒ½åŠ›é©±åŠ¨é‡‡ç”¨å•æ–‡ä»¶ç»„ä»¶å’Œ Vue ç”Ÿæ€ç³»ç»Ÿæ”¯æŒçš„åº“å¼€å‘çš„å¤æ‚å•é¡µåº”ç”¨ã€‚<br>Vue.js çš„ç›®æ ‡æ˜¯é€šè¿‡å°½å¯èƒ½ç®€å•çš„ API å®ç°å“åº”çš„æ•°æ®ç»‘å®šå’Œç»„åˆçš„è§†å›¾ç»„ä»¶ã€‚</p>
<h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ol>
<li><strong>æ˜“ç”¨</strong><br>å·²ç»ä¼šäº†HTML,CSS,JavaScriptï¼Ÿå³åˆ»é˜…è¯»æŒ‡å—å¼€å§‹æ„å»ºåº”ç”¨ï¼</li>
<li><strong>çµæ´»</strong><br>ç®€å•å°å·§çš„æ ¸å¿ƒï¼Œæ¸è¿›å¼æŠ€æœ¯æ ˆï¼Œè¶³ä»¥åº”ä»˜ä»»ä½•è§„æ¨¡çš„åº”ç”¨ã€‚</li>
<li><strong>æ€§èƒ½</strong><br>17kb min+gzip è¿è¡Œå¤§å°<br>è¶…å¿«è™šæ‹Ÿ DOM<br>æœ€çœå¿ƒçš„ä¼˜åŒ–</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Vue-jsåˆä½“éªŒ&quot;&gt;&lt;a href=&quot;#Vue-jsåˆä½“éªŒ&quot; class=&quot;headerlink&quot; title=&quot;Vue.jsåˆä½“éªŒ&quot;&gt;&lt;/a&gt;Vue.jsåˆä½“éªŒ&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;ä¹‹å‰å­¦äº†React.j
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Vue.js" scheme="http://microzz.com/tags/Vue-js/"/>
    
  </entry>
  
  <entry>
    <title>JavaScriptå®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•</title>
    <link href="http://microzz.com/2017/03/06/extend/"/>
    <id>http://microzz.com/2017/03/06/extend/</id>
    <published>2017-03-06T13:44:25.000Z</published>
    <updated>2017-03-08T15:18:28.334Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JavaScriptä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•"><a href="#JavaScriptä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•" class="headerlink" title="JavaScriptä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•"></a>JavaScriptä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•</h1><h2 id="ES5ä¸­çš„å®ç°"><a href="#ES5ä¸­çš„å®ç°" class="headerlink" title="ES5ä¸­çš„å®ç°"></a>ES5ä¸­çš„å®ç°</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>JavaScript(ES5)ä¸­æ²¡æœ‰åƒJavaé‚£æ ·ç±»çš„æ¦‚å¿µï¼Œå†™æ³•è·Ÿä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ï¼ˆæ¯”å¦‚C++å’ŒJavaï¼‰å·®å¼‚å¾ˆå¤§ï¼Œå¾ˆå®¹æ˜“è®©æ–°å­¦ä¹ è¿™é—¨è¯­è¨€çš„ç¨‹åºå‘˜æ„Ÿåˆ°å›°æƒ‘ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡åŸå‹é“¾prototypeæ¥æ¨¡æ‹Ÿç±»ï¼Œå»å®ç°ç»§æ‰¿çš„ç›¸å…³åŠŸèƒ½ã€‚ä¸‹é¢æ¥çœ‹çœ‹ES5ä¸­å®ç°ç»§æ‰¿å¸¸è§çš„ä¸‰ç§æ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * JavaScript(ES5)ä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="comment">// å®šä¹‰åŸºç±»Person</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name;</div><div class="line">  <span class="keyword">this</span>.age = age;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å…±äº«æ•°æ®</span></div><div class="line">Person.prototype.LEGS_NUM = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="comment">// å…±äº«æ–¹æ³•</span></div><div class="line">Person.prototype.info = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'My name is '</span> + <span class="keyword">this</span>.name + <span class="string">' .I\'m '</span> + <span class="keyword">this</span>.age + <span class="string">' years old now'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Person.prototype.walk = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">' is walking...'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// Studentå­ç±»</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, className</span>) </span>&#123;</div><div class="line">  <span class="comment">// è°ƒç”¨çˆ¶ç±»</span></div><div class="line">  Person.call(<span class="keyword">this</span>, name, age);</div><div class="line">  <span class="keyword">this</span>.className = className;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 1âƒ£ï¸ æ–¹æ³•ä¸€ï¼šPerson.prototypeç›´æ¥èµ‹å€¼ç»™Student.prototype</span></div><div class="line"><span class="comment">// Student.prototype = Person.prototype;</span></div><div class="line"></div><div class="line"><span class="comment">// 2âƒ£ï¸ æ–¹æ³•äºŒï¼šStudent.prototypeä¸ºPersonçš„å®ä¾‹</span></div><div class="line"><span class="comment">// Student.prototype = new Person();</span></div><div class="line"></div><div class="line"><span class="comment">// 3âƒ£ï¸ æ–¹æ³•ä¸‰ï¼šåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¯¹è±¡çš„åŸå‹æŒ‡å‘Person.prototypeï¼Œèµ‹å€¼ç»™Student.prototype</span></div><div class="line">Student.prototype = <span class="built_in">Object</span>.create(Person.prototype);</div><div class="line"></div><div class="line">Student.prototype.constructor = Student;</div><div class="line"></div><div class="line"><span class="comment">// è¦†ç›–çˆ¶ç±»çš„infoæ–¹æ³•</span></div><div class="line">Student.prototype.info = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'My name is '</span> + <span class="keyword">this</span>.name + <span class="string">',I\'m '</span> + <span class="keyword">this</span>.age + <span class="string">' years old now, and from class '</span> + <span class="keyword">this</span>.className + <span class="string">'.'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// Studentç±»çš„å…±äº«æ–¹æ³•</span></div><div class="line">Student.prototype.learn = <span class="function"><span class="keyword">function</span> (<span class="params">subject</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">' is learning '</span> + subject + <span class="string">'.'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æµ‹è¯•,åˆ›å»ºä¸€ä¸ªStudentçš„å®ä¾‹</span></div><div class="line"><span class="keyword">var</span> microzz = <span class="keyword">new</span> Student(<span class="string">'Microzz'</span>, <span class="number">22</span>, <span class="number">5</span>);</div><div class="line">microzz.info(); <span class="comment">// My name is Microzz,I'm 22 years old now, and from class 5.</span></div><div class="line"><span class="built_in">console</span>.log(microzz.LEGS_NUM); <span class="comment">// 2</span></div><div class="line">microzz.walk(); <span class="comment">// Microzz is walking...</span></div><div class="line">microzz.learn(<span class="string">'JavaScript'</span>); <span class="comment">// Microzz is learning JavaScript.</span></div><div class="line"><span class="built_in">console</span>.log(microzz.__proto__.__proto__ === Person.prototype); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(microzz.__proto__ === Student.prototype); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(microzz.__proto__.constructor === Student); <span class="comment">// true</span></div></pre></td></tr></table></figure>
<h3 id="ä¸‰ç§æ–¹æ³•æ¯”è¾ƒ"><a href="#ä¸‰ç§æ–¹æ³•æ¯”è¾ƒ" class="headerlink" title="ä¸‰ç§æ–¹æ³•æ¯”è¾ƒ"></a>ä¸‰ç§æ–¹æ³•æ¯”è¾ƒ</h3><p>ä¸Šé¢ä»£ç ä¸­æœ‰ä¸‰ç§æ–¹æ³•å®ç°ç»§æ‰¿ï¼Œç°åœ¨æˆ‘ä»¬å¯ä»¥æ¥åˆ†æä¸€ä¸‹è¿™å‡ ç§æ–¹æ³•ã€‚<br>1âƒ£ï¸è¿™ç§æ–¹æ³•ä¸­ï¼ŒPerson.prototypeç›´æ¥èµ‹å€¼ç»™Student.prototypeï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªå¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œå¦‚æœå­ç±»prototypeæ·»åŠ æ–°çš„ä¸œè¥¿çš„è¯ä¹Ÿä¼šæ”¹å†™çˆ¶ç±»ã€‚æ‰€ä»¥è¿™ç§æ–¹æ³•ä¸æ¨èã€‚<br>2âƒ£ï¸ç¬¬äºŒç§æ–¹æ³•Student.prototypeä¸ºPersonçš„å®ä¾‹ï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥å®ç°çš„ã€‚ä½†æ˜¯Personæ„é€ å‡½æ•°æœ‰å‚æ•°åº”è¯¥ä¼ ä»€ä¹ˆå‘¢ï¼Ÿä¼ ä»»ä½•ä¸€ä¸ªéƒ½æ˜¯å¾ˆå¥‡æ€ªçš„ã€‚æ‰€ä»¥ä¹Ÿä¸æ¨èã€‚<br>3âƒ£ï¸ç¬¬ä¸‰ç§æ–¹æ³•æ˜¯æ¯”è¾ƒç†æƒ³çš„ï¼Œåˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¯¹è±¡çš„åŸå‹æŒ‡å‘Person.prototypeï¼Œèµ‹å€¼ç»™Student.prototypeã€‚ä½†æ˜¯Object.createä¹Ÿæœ‰ä¸€ç‚¹å°ç‘•ç–µï¼Œå› ä¸ºå®ƒæ˜¯ES5ä¹‹åæ‰æ”¯æŒçš„ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¨¡æ‹Ÿå®ç°Object.createæ–¹æ³•ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (!<span class="built_in">Object</span>.create) &#123;</div><div class="line">  <span class="built_in">Object</span>.prototype.create = <span class="function"><span class="keyword">function</span> (<span class="params">proto</span>) </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">    F.prototype = proto;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> F;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·åœ¨ES5ä¸­å°±å®Œç¾å®ç°äº†ç»§æ‰¿ğŸ˜„</p>
<h2 id="ES6ä¸­çš„å®ç°"><a href="#ES6ä¸­çš„å®ç°" class="headerlink" title="ES6ä¸­çš„å®ç°"></a>ES6ä¸­çš„å®ç°</h2><h3 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>ES6æä¾›äº†æ›´æ¥è¿‘ä¼ ç»Ÿè¯­è¨€â€ç±»â€çš„å†™æ³•ï¼Œå¼•å…¥äº†Classï¼ˆç±»ï¼‰è¿™ä¸ªæ¦‚å¿µï¼Œä½œä¸ºå¯¹è±¡çš„æ¨¡æ¿ã€‚é€šè¿‡classå…³é”®å­—ï¼Œå¯ä»¥å®šä¹‰ç±»ã€‚åŸºæœ¬ä¸Šï¼ŒES6çš„classå¯ä»¥çœ‹ä½œåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå®ƒçš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½ï¼ŒES5éƒ½å¯ä»¥åšåˆ°ï¼Œæ–°çš„classå†™æ³•åªæ˜¯è®©å¯¹è±¡åŸå‹çš„å†™æ³•æ›´åŠ æ¸…æ™°ã€æ›´åƒé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­æ³•è€Œå·²ã€‚ä¸‹é¢æˆ‘ä»¬ç”¨ES6çš„è¯­æ³•å®ç°ç±»çš„ç»§æ‰¿ã€‚</p>
<h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åŸºç±» Person</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  <span class="comment">// çˆ¶ç±»çš„æ„é€ æ–¹æ³•</span></div><div class="line">  <span class="keyword">constructor</span>(name, age) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">    <span class="keyword">this</span>.age = age;</div><div class="line">    <span class="comment">// å…±äº«å˜é‡</span></div><div class="line">    <span class="keyword">this</span>.LEGS_NUM = <span class="number">2</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="comment">// çˆ¶ç±»çš„infoæ–¹æ³•</span></div><div class="line">  info() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`My name is <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>, I\'m <span class="subst">$&#123;<span class="keyword">this</span>.age&#125;</span> years old now.`</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// çˆ¶ç±»çš„walkæ–¹æ³•</span></div><div class="line">  walk() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name + <span class="string">' is walking...'</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å­ç±» Student</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(name, age, className) &#123;</div><div class="line">    <span class="comment">// è°ƒç”¨åŸºç±»çš„æ„é€ æ–¹æ³•</span></div><div class="line">    <span class="keyword">super</span>(name, age);</div><div class="line">    <span class="keyword">this</span>.className = className;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// è¦†ç›–çˆ¶ç±»çš„infoæ–¹æ³•</span></div><div class="line">  info() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`My name is <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>, I\'m <span class="subst">$&#123;<span class="keyword">this</span>.age&#125;</span> years old, and from class <span class="subst">$&#123;<span class="keyword">this</span>.className&#125;</span>.`</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å®ä¾‹åŒ–ä¸€ä¸ªStudentçš„å®ä¾‹</span></div><div class="line"><span class="keyword">let</span> stu = <span class="keyword">new</span> Student(<span class="string">'Zhaohui'</span>, <span class="number">22</span>, <span class="number">5</span>);</div><div class="line">stu.info(); <span class="comment">// My name is Zhaohui, I'm 22 years old, and from class 5.</span></div><div class="line">stu.walk(); <span class="comment">// Zhaohui is walking...</span></div><div class="line"><span class="built_in">console</span>.log(stu.LEGS_NUM); <span class="comment">// 2</span></div><div class="line"><span class="built_in">console</span>.log(stu <span class="keyword">instanceof</span> Student); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(stu <span class="keyword">instanceof</span> Person); <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·æˆ‘ä»¬å°±é€šè¿‡ES6ä¸­çš„classå®ç°äº†â€œç±»â€çš„ç»§æ‰¿äº†ğŸ˜„</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JavaScriptä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•&quot;&gt;&lt;a href=&quot;#JavaScriptä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•&quot; class=&quot;headerlink&quot; title=&quot;JavaScriptä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•&quot;&gt;&lt;/a&gt;JavaScriptä¸­å®ç°ç»§æ‰¿çš„å‡ ç§æ–¹æ³•&lt;/h1&gt;&lt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="åŸå‹é“¾" scheme="http://microzz.com/tags/%E5%8E%9F%E5%9E%8B%E9%93%BE/"/>
    
  </entry>
  
  <entry>
    <title>JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°</title>
    <link href="http://microzz.com/2017/03/05/func/"/>
    <id>http://microzz.com/2017/03/05/func/</id>
    <published>2017-03-05T11:49:42.000Z</published>
    <updated>2017-03-05T12:18:09.031Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°"><a href="#JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°" class="headerlink" title="JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°"></a>JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°</h1><h2 id="é«˜é˜¶å‡½æ•°"><a href="#é«˜é˜¶å‡½æ•°" class="headerlink" title="é«˜é˜¶å‡½æ•°"></a>é«˜é˜¶å‡½æ•°</h2><h3 id="ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°"><a href="#ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°" class="headerlink" title="ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°"></a>ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°</h3><p>é«˜é˜¶å‡½æ•°æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„åŸºç¡€ï¼Œé‚£ä¹ˆä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°å‘¢?</p>
<p>é«˜é˜¶äºŒå­—å¬èµ·æ¥æœ‰ç‚¹é«˜å¤§ä¸Šçš„æ„Ÿè§‰ï¼Œå…¶å®ä¸ç„¶ï¼Œé«˜é˜¶å‡½æ•°ä¸æ™®é€šå‡½æ•°ä¸åŒçš„åœ°æ–¹æ˜¯é«˜é˜¶å‡½æ•°å¯ä»¥æŠŠå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œæˆ–è€…æ˜¯å°†å‡½æ•°ä½œä¸ºè¿”å›å€¼ï¼Œè¯·çœ‹å¦‚ä¸‹ç¤ºä¾‹ã€‚</p>
<h3 id="ç¤ºä¾‹ï¼š"><a href="#ç¤ºä¾‹ï¼š" class="headerlink" title="ç¤ºä¾‹ï¼š"></a>ç¤ºä¾‹ï¼š</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params">v</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> v;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¤ºä¾‹ä¸­æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„é«˜é˜¶å‡½æ•°ï¼Œå¦‚ä½ æ‰€è§ï¼Œé«˜é˜¶å‡½æ•°testçš„è¿”å›å€¼æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚</p>
<h3 id="ç°å®ä¸­çš„åº”ç”¨"><a href="#ç°å®ä¸­çš„åº”ç”¨" class="headerlink" title="ç°å®ä¸­çš„åº”ç”¨"></a>ç°å®ä¸­çš„åº”ç”¨</h3><p>è™½ç„¶æœ‰å¯èƒ½æ˜¯ç¬¬ä¸€æ¬¡çœŸæ­£çš„å»äº†è§£ä»€ä¹ˆæ˜¯é«˜é˜¶å‡½æ•°ï¼Œä½†æ˜¯å…¶å®æˆ‘ä»¬åœ¨æ—¥å¸¸å¼€å‘ä¸­ç»å¸¸ä¼šç”¨åˆ°å®ƒï¼Œåªæ˜¯æˆ‘ä»¬æ²¡æœ‰å»ç•™æ„æˆ–è€…è¯´ä¸çŸ¥é“å®ƒçš„ç§°è°“è€Œå·²ã€‚</p>
<p>ç¤ºä¾‹ï¼šæ•°ç»„çš„æ’åº(sort)å‡½æ•°</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">23</span>,<span class="number">54</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">78</span>];</div><div class="line">arr.sort(<span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> a-b;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="åå‡½æ•°"><a href="#åå‡½æ•°" class="headerlink" title="åå‡½æ•°"></a>åå‡½æ•°</h2><h3 id="ä»€ä¹ˆæ˜¯åå‡½æ•°"><a href="#ä»€ä¹ˆæ˜¯åå‡½æ•°" class="headerlink" title="ä»€ä¹ˆæ˜¯åå‡½æ•°"></a>ä»€ä¹ˆæ˜¯åå‡½æ•°</h3><p>å‡è®¾æœ‰ä¸€ä¸ªå‚æ•°æˆ–å˜é‡å·²ç»é¢„ç½®çš„å‡½æ•°Aï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨Aæ¥äº§ç”Ÿä¸€ä¸ªæ–°çš„å‡½æ•°Bï¼Œå‡½æ•°Bå°±æ˜¯æˆ‘ä»¬è¯´çš„åå‡½æ•°ã€‚ä¸‹é¢å¯ä»¥çœ‹ä¸€ä¸ªç¤ºä¾‹ã€‚</p>
<h3 id="ç¤ºä¾‹"><a href="#ç¤ºä¾‹" class="headerlink" title="ç¤ºä¾‹"></a>ç¤ºä¾‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ¤æ–­ç±»å‹çš„å°demo</span></div><div class="line"><span class="keyword">var</span> isType = <span class="function"><span class="keyword">function</span>(<span class="params">type</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> toString.call(obj)==<span class="string">'[object '</span>+type+<span class="string">']'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// å®šåˆ¶æ–°çš„å‡½æ•°</span></div><div class="line"><span class="keyword">var</span> isString = isType(<span class="string">'String'</span>);</div><div class="line"><span class="keyword">var</span> isArray = isType(<span class="string">'Array'</span>);</div><div class="line"><span class="keyword">var</span> isFunction = isType(<span class="string">'Function'</span>);</div><div class="line"></div><div class="line"><span class="comment">// æµ‹è¯•åå‡½æ•°</span></div><div class="line"><span class="built_in">console</span>.log(isString(<span class="string">'abc'</span>)); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(isArray([<span class="number">1</span>, <span class="number">2</span>])); <span class="comment">// true</span></div><div class="line"><span class="built_in">console</span>.log(isFunction(<span class="string">'abc'</span>)); <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>isTypeå‡½æ•°ä¸­é¢„ç½®äº†åˆ¤æ–­ç±»å‹çš„æ–¹æ³•ï¼ŒåªæŒ‡å®šéƒ¨åˆ†å‚æ•°æ¥äº§ç”Ÿçš„æ–°çš„å®šåˆ¶çš„å‡½æ•°isStringã€isArrayå’ŒisFunctionå°±æ˜¯åå‡½æ•°ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°&quot;&gt;&lt;a href=&quot;#JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°&quot;&gt;&lt;/a&gt;JSä¸­çš„é«˜é˜¶å‡½æ•°å’Œåå‡½æ•°&lt;/h1&gt;&lt;h2 id=&quot;é«˜é˜¶å‡½æ•°&quot;&gt;&lt;a href=&quot;#é«˜é˜¶å‡½æ•°&quot; cla
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="å‡½æ•°" scheme="http://microzz.com/tags/%E5%87%BD%E6%95%B0/"/>
    
  </entry>
  
  <entry>
    <title>åŸºäºHTML5çš„Webé˜…è¯»å™¨</title>
    <link href="http://microzz.com/2017/03/04/WebReader/"/>
    <id>http://microzz.com/2017/03/04/WebReader/</id>
    <published>2017-03-04T12:11:26.000Z</published>
    <updated>2017-03-04T12:30:35.748Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸºäºHTML5çš„Webé˜…è¯»å™¨"><a href="#åŸºäºHTML5çš„Webé˜…è¯»å™¨" class="headerlink" title="åŸºäºHTML5çš„Webé˜…è¯»å™¨"></a>åŸºäºHTML5çš„Webé˜…è¯»å™¨</h1><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>è¿™æ˜¯åŸºäºHTML5å¼€å‘çš„ç®€å•çš„è½»é‡çº§ WebAppåœ¨çº¿é˜…è¯»å™¨ï¼Œå¯ä»¥è¿›è¡Œç®€å•çš„ä¸ªæ€§åŒ–è®¾ç½®ï¼Œé€‚é…äº†æ‰‹æœºå’Œç”µè„‘ã€‚è¿è¡Œéœ€è¦ä¸€ä¸ªWebæœåŠ¡å™¨çš„æ”¯æŒã€‚æ¬¢è¿å¤§å®¶åœ¨æˆ‘çš„<a href="https://github.com/microzz/WebReader" target="_blank" rel="external">GitHub</a>ä¸ŠStarï¼Œä¹Ÿå¯ä»¥æå‡ºå®è´µæ„è§å“¦ğŸ˜„</p>
<h2 id="åœ¨çº¿é¢„è§ˆ"><a href="#åœ¨çº¿é¢„è§ˆ" class="headerlink" title="åœ¨çº¿é¢„è§ˆ"></a>åœ¨çº¿é¢„è§ˆ</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://microzz.cn/web-reader/web-reader.png" alt="åŸºäºHTML5çš„Webé˜…è¯»å™¨" title="">
                </div>
                <div class="image-caption">åŸºäºHTML5çš„Webé˜…è¯»å™¨</div>
            </figure>
<p>åœ¨çº¿é¢„è§ˆåœ°å€1ï¼šğŸ”—<a href="http://microzz.cn/web-reader/" target="_blank" rel="external">http://microzz.cn/web-reader/</a><br>åœ¨çº¿é¢„è§ˆåœ°å€2:ğŸ”—<a href="https://microzz.github.io/WebReader/" target="_blank" rel="external">https://microzz.github.io/WebReader/</a></p>
<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>æºç åœ°å€ï¼š<a href="https://github.com/microzz/WebReader" target="_blank" rel="external">https://github.com/microzz/WebReader</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;åŸºäºHTML5çš„Webé˜…è¯»å™¨&quot;&gt;&lt;a href=&quot;#åŸºäºHTML5çš„Webé˜…è¯»å™¨&quot; class=&quot;headerlink&quot; title=&quot;åŸºäºHTML5çš„Webé˜…è¯»å™¨&quot;&gt;&lt;/a&gt;åŸºäºHTML5çš„Webé˜…è¯»å™¨&lt;/h1&gt;&lt;h2 id=&quot;ä»‹ç»&quot;&gt;&lt;a href=&quot;#ä»‹ç»&quot;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="HTML5" scheme="http://microzz.com/tags/HTML5/"/>
    
      <category term="WebApp" scheme="http://microzz.com/tags/WebApp/"/>
    
  </entry>
  
  <entry>
    <title>å“åº”å¼ç½‘é¡µè®¾è®¡</title>
    <link href="http://microzz.com/2017/03/02/responsive/"/>
    <id>http://microzz.com/2017/03/02/responsive/</id>
    <published>2017-03-02T14:55:31.000Z</published>
    <updated>2017-03-03T13:47:40.778Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å“åº”å¼ç½‘é¡µè®¾è®¡"><a href="#å“åº”å¼ç½‘é¡µè®¾è®¡" class="headerlink" title="å“åº”å¼ç½‘é¡µè®¾è®¡"></a>å“åº”å¼ç½‘é¡µè®¾è®¡</h1><h2 id="ä»€ä¹ˆæ˜¯å“åº”å¼ç½‘ç«™"><a href="#ä»€ä¹ˆæ˜¯å“åº”å¼ç½‘ç«™" class="headerlink" title="ä»€ä¹ˆæ˜¯å“åº”å¼ç½‘ç«™"></a>ä»€ä¹ˆæ˜¯å“åº”å¼ç½‘ç«™</h2><p>å“åº”å¼å¸ƒå±€æ˜¯Ethan Marcotteåœ¨2010å¹´5æœˆä»½æå‡ºçš„ä¸€ä¸ªæ¦‚å¿µï¼Œç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯ä¸€ä¸ªç½‘ç«™èƒ½å¤Ÿå…¼å®¹å¤šä¸ªç»ˆç«¯â€”â€”è€Œä¸æ˜¯ä¸ºæ¯ä¸ªç»ˆç«¯åšä¸€ä¸ªç‰¹å®šçš„ç‰ˆæœ¬ã€‚è¿™ä¸ªæ¦‚å¿µæ˜¯ä¸ºè§£å†³ç§»åŠ¨äº’è”ç½‘æµè§ˆè€Œè¯ç”Ÿçš„ã€‚</p>
<h2 id="ä¼˜ç‚¹å’Œç¼ºç‚¹"><a href="#ä¼˜ç‚¹å’Œç¼ºç‚¹" class="headerlink" title="ä¼˜ç‚¹å’Œç¼ºç‚¹"></a>ä¼˜ç‚¹å’Œç¼ºç‚¹</h2><h3 id="ä¼˜ç‚¹"><a href="#ä¼˜ç‚¹" class="headerlink" title="ä¼˜ç‚¹"></a>ä¼˜ç‚¹</h3><p>ä¼˜ç‚¹ï¼š<br>é¢å¯¹ä¸åŒåˆ†è¾¨ç‡è®¾å¤‡çµæ´»æ€§å¼º<br>èƒ½å¤Ÿå¿«æ·è§£å†³å¤šè®¾å¤‡æ˜¾ç¤ºé€‚åº”é—®é¢˜</p>
<h3 id="ç¼ºç‚¹"><a href="#ç¼ºç‚¹" class="headerlink" title="ç¼ºç‚¹"></a>ç¼ºç‚¹</h3><p>å…¼å®¹å„ç§è®¾å¤‡å·¥ä½œé‡å¤§ï¼Œæ•ˆç‡ä½ä¸‹<br>ä»£ç ç´¯èµ˜ï¼Œä¼šå‡ºç°éšè—æ— ç”¨çš„å…ƒç´ ï¼ŒåŠ è½½æ—¶é—´åŠ é•¿<br>å…¶å®è¿™æ˜¯ä¸€ç§æŠ˜ä¸­æ€§è´¨çš„è®¾è®¡è§£å†³æ–¹æ¡ˆï¼Œå¤šæ–¹é¢å› ç´ å½±å“è€Œè¾¾ä¸åˆ°æœ€ä½³æ•ˆæœ<br>ä¸€å®šç¨‹åº¦ä¸Šæ”¹å˜äº†ç½‘ç«™åŸæœ‰çš„å¸ƒå±€ç»“æ„ï¼Œä¼šå‡ºç°ç”¨æˆ·æ··æ·†çš„æƒ…å†µ</p>
<h2 id="å“åº”å¼ç½‘é¡µè®¾è®¡å®æˆ˜"><a href="#å“åº”å¼ç½‘é¡µè®¾è®¡å®æˆ˜" class="headerlink" title="å“åº”å¼ç½‘é¡µè®¾è®¡å®æˆ˜"></a>å“åº”å¼ç½‘é¡µè®¾è®¡å®æˆ˜</h2><p>ç”¨HTML5ä»¥åŠCSS3çš„åª’ä½“æŸ¥è¯¢å®Œæˆäº†ä¸€ä¸ªå“åº”å¼å¸ƒå±€çš„demoï¼Œå¤§å®¶å¯ä»¥ç”¨ä¸åŒçš„å°ºå¯¸çš„è®¾å¤‡ï¼ŒæŸ¥çœ‹ä¸åŒåˆ†è¾¨ç‡ä¸‹çš„è¡¨ç°ã€‚ä¹Ÿå¯ä»¥åœ¨æ§åˆ¶å°æ¨¡æ‹Ÿå„ç§è®¾å¤‡ï¼Œæ¬¢è¿å¤§å®¶æå‡ºæ„è§ã€‚ğŸ˜„</p>
<h2 id="åœ¨çº¿é¢„è§ˆ"><a href="#åœ¨çº¿é¢„è§ˆ" class="headerlink" title="åœ¨çº¿é¢„è§ˆ"></a>åœ¨çº¿é¢„è§ˆ</h2><p>åœ¨çº¿é¢„è§ˆåœ°å€1: ğŸ”—<a href="http://microzz.cn/responsive/" target="_blank" rel="external">http://microzz.cn/responsive/</a><br>åœ¨çº¿é¢„è§ˆåœ°å€2: ğŸ”—<a href="https://microzz.github.io/ResponsiveWeb/" target="_blank" rel="external">https://microzz.github.io/ResponsiveWeb/</a></p>
<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>æºç åœ°å€ï¼šğŸ”—<a href="https://github.com/microzz/ResponsiveWeb" target="_blank" rel="external">https://github.com/microzz/ResponsiveWeb</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å“åº”å¼ç½‘é¡µè®¾è®¡&quot;&gt;&lt;a href=&quot;#å“åº”å¼ç½‘é¡µè®¾è®¡&quot; class=&quot;headerlink&quot; title=&quot;å“åº”å¼ç½‘é¡µè®¾è®¡&quot;&gt;&lt;/a&gt;å“åº”å¼ç½‘é¡µè®¾è®¡&lt;/h1&gt;&lt;h2 id=&quot;ä»€ä¹ˆæ˜¯å“åº”å¼ç½‘ç«™&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯å“åº”å¼ç½‘ç«™&quot; class=&quot;headerli
    
    </summary>
    
    
      <category term="HTML5" scheme="http://microzz.com/tags/HTML5/"/>
    
      <category term="CSS3" scheme="http://microzz.com/tags/CSS3/"/>
    
      <category term="Responsive" scheme="http://microzz.com/tags/Responsive/"/>
    
      <category term="å“åº”å¼è®¾è®¡" scheme="http://microzz.com/tags/%E5%93%8D%E5%BA%94%E5%BC%8F%E8%AE%BE%E8%AE%A1/"/>
    
  </entry>
  
  <entry>
    <title>JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ</title>
    <link href="http://microzz.com/2017/03/01/flow-info/"/>
    <id>http://microzz.com/2017/03/01/flow-info/</id>
    <published>2017-03-01T07:42:04.000Z</published>
    <updated>2017-03-01T07:53:52.412Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ"><a href="#JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ" class="headerlink" title="JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ"></a>JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ</h1><h2 id="é¢„è§ˆ"><a href="#é¢„è§ˆ" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://microzz.cn/flow-info/preview.gif" alt="JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ" title="">
                </div>
                <div class="image-caption">JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ</div>
            </figure>
<h3 id="åœ¨çº¿é¢„è§ˆ1"><a href="#åœ¨çº¿é¢„è§ˆ1" class="headerlink" title="åœ¨çº¿é¢„è§ˆ1"></a>åœ¨çº¿é¢„è§ˆ1</h3><p>åœ¨çº¿é¢„è§ˆåœ°å€1: ğŸ”—<a href="http://microzz.cn/flow-info/" target="_blank" rel="external">http://microzz.cn/flow-info/</a></p>
<h3 id="åœ¨çº¿é¢„è§ˆ2"><a href="#åœ¨çº¿é¢„è§ˆ2" class="headerlink" title="åœ¨çº¿é¢„è§ˆ2"></a>åœ¨çº¿é¢„è§ˆ2</h3><p>åœ¨çº¿é¢„è§ˆåœ°å€2: ğŸ”—<a href="https://microzz.github.io/flow-info-by-js/" target="_blank" rel="external">https://microzz.github.io/flow-info-by-js/</a></p>
<h3 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h3><p>æºä»£ç åœ°å€ï¼šğŸ”—<a href="https://github.com/microzz/flow-info-by-js" target="_blank" rel="external">https://github.com/microzz/flow-info-by-js</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ&quot;&gt;&lt;a href=&quot;#JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ&quot; class=&quot;headerlink&quot; title=&quot;JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ&quot;&gt;&lt;/a&gt;JSå®ç°æ–‡å­—ä¿¡æ¯æ— ç¼æ»šåŠ¨æ•ˆæœ&lt;/h1&gt;&lt;h2 id=&quot;é¢„è§ˆ&quot;&gt;&lt;a href=&quot;#é¢„è§ˆ&quot;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜</title>
    <link href="http://microzz.com/2017/02/26/interview2/"/>
    <id>http://microzz.com/2017/02/26/interview2/</id>
    <published>2017-02-26T12:02:20.000Z</published>
    <updated>2017-02-26T12:09:18.585Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜"><a href="#å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜" class="headerlink" title="å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜"></a>å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜</h1><p>æœ¬æ–‡åŒ…å«äº†ä¸€äº›ç”¨äºè€ƒæŸ¥å€™é€‰è€…çš„å‰ç«¯é¢è¯•é—®é¢˜ã€‚ä¸å»ºè®®å¯¹å•ä¸ªå€™é€‰è€…é—®åŠæ¯ä¸ªé—®é¢˜ (é‚£éœ€è¦å¥½å‡ ä¸ªå°æ—¶)ã€‚åªè¦ä»åˆ—è¡¨é‡ŒæŒ‘é€‰ä¸€äº›ï¼Œå°±èƒ½å¸®åŠ©ä½ è€ƒæŸ¥å€™é€‰è€…æ˜¯å¦å…·å¤‡æ‰€éœ€è¦çš„æŠ€èƒ½ã€‚</p>
<p><strong>å¤‡æ³¨ï¼š</strong> è¿™äº›é—®é¢˜ä¸­å¾ˆå¤šéƒ½æ˜¯å¼€æ”¾æ€§çš„ï¼Œå¯ä»¥å¼•å‘æœ‰è¶£çš„è®¨è®ºã€‚è¿™æ¯”ç›´æ¥çš„ç­”æ¡ˆæ›´èƒ½ä½“ç°æ­¤äººçš„èƒ½åŠ›ã€‚</p>
<h4 id="å¸¸è§é—®é¢˜ï¼š"><a href="#å¸¸è§é—®é¢˜ï¼š" class="headerlink" title="å¸¸è§é—®é¢˜ï¼š"></a><a name="general-questions">å¸¸è§é—®é¢˜ï¼š</a></h4><ul>
<li>ä½ åœ¨æ˜¨å¤©/æœ¬å‘¨å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ</li>
<li>ç¼–å†™ä»£ç çš„å“ªäº›æ–¹é¢èƒ½å¤Ÿä½¿ä½ å…´å¥‹æˆ–æ„Ÿå…´è¶£ï¼Ÿ</li>
<li>ä½ æœ€è¿‘é‡åˆ°è¿‡ä»€ä¹ˆæŠ€æœ¯æŒ‘æˆ˜ï¼Ÿä½ æ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ</li>
<li>åœ¨åˆ¶ä½œä¸€ä¸ªç½‘é¡µåº”ç”¨æˆ–ç½‘ç«™çš„è¿‡ç¨‹ä¸­ï¼Œä½ æ˜¯å¦‚ä½•è€ƒè™‘å…¶ UIã€å®‰å…¨æ€§ã€é«˜æ€§èƒ½ã€SEOã€å¯ç»´æŠ¤æ€§ä»¥åŠæŠ€æœ¯å› ç´ çš„ï¼Ÿ</li>
<li>è¯·è°ˆè°ˆä½ å–œæ¬¢çš„å¼€å‘ç¯å¢ƒã€‚</li>
<li>ä½ æœ€ç†Ÿæ‚‰å“ªä¸€å¥—ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Ÿ</li>
<li>ä½ èƒ½æè¿°å½“ä½ åˆ¶ä½œä¸€ä¸ªç½‘é¡µçš„å·¥ä½œæµç¨‹å—ï¼Ÿ</li>
<li>å‡è‹¥ä½ æœ‰ 5 ä¸ªä¸åŒçš„æ ·å¼æ–‡ä»¶ (stylesheets), æ•´åˆè¿›ç½‘ç«™çš„æœ€å¥½æ–¹å¼æ˜¯?</li>
<li>ä½ èƒ½æè¿°æ¸è¿›å¢å¼º (progressive enhancement) å’Œä¼˜é›…é™çº§ (graceful degradation) ä¹‹é—´çš„ä¸åŒå—?</li>
<li>ä½ å¦‚ä½•å¯¹ç½‘ç«™çš„æ–‡ä»¶å’Œèµ„æºè¿›è¡Œä¼˜åŒ–ï¼Ÿ</li>
<li>æµè§ˆå™¨åŒä¸€æ—¶é—´å¯ä»¥ä»ä¸€ä¸ªåŸŸåä¸‹è½½å¤šå°‘èµ„æºï¼Ÿ<ul>
<li>æœ‰ä»€ä¹ˆä¾‹å¤–å—ï¼Ÿ</li>
</ul>
</li>
<li>è¯·è¯´å‡ºä¸‰ç§å‡å°‘é¡µé¢åŠ è½½æ—¶é—´çš„æ–¹æ³•ã€‚(åŠ è½½æ—¶é—´æŒ‡æ„ŸçŸ¥çš„æ—¶é—´æˆ–è€…å®é™…åŠ è½½æ—¶é—´)</li>
<li>å¦‚æœä½ å‚ä¸åˆ°ä¸€ä¸ªé¡¹ç›®ä¸­ï¼Œå‘ç°ä»–ä»¬ä½¿ç”¨ Tab æ¥ç¼©è¿›ä»£ç ï¼Œä½†æ˜¯ä½ å–œæ¬¢ç©ºæ ¼ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ</li>
<li>è¯·å†™ä¸€ä¸ªç®€å•çš„å¹»ç¯æ•ˆæœé¡µé¢ã€‚</li>
<li>å¦‚æœä»Šå¹´ä½ æ‰“ç®—ç†Ÿç»ƒæŒæ¡ä¸€é¡¹æ–°æŠ€æœ¯ï¼Œé‚£ä¼šæ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>è¯·è°ˆè°ˆä½ å¯¹ç½‘é¡µæ ‡å‡†å’Œæ ‡å‡†åˆ¶å®šæœºæ„é‡è¦æ€§çš„ç†è§£ã€‚</li>
<li>ä»€ä¹ˆæ˜¯ FOUC (æ— æ ·å¼å†…å®¹é—ªçƒ)ï¼Ÿä½ å¦‚ä½•æ¥é¿å… FOUCï¼Ÿ</li>
<li>è¯·è§£é‡Šä»€ä¹ˆæ˜¯ ARIA å’Œå±å¹•é˜…è¯»å™¨ (screenreaders)ï¼Œä»¥åŠå¦‚ä½•ä½¿ç½‘ç«™å®ç°æ— éšœç¢è®¿é—® (accessible)ã€‚</li>
<li>è¯·è§£é‡Š CSS åŠ¨ç”»å’Œ JavaScript åŠ¨ç”»çš„ä¼˜ç¼ºç‚¹ã€‚</li>
<li>ä»€ä¹ˆæ˜¯è·¨åŸŸèµ„æºå…±äº« (CORS)ï¼Ÿå®ƒç”¨äºè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ</li>
</ul>
<h4 id="HTML-ç›¸å…³é—®é¢˜ï¼š"><a href="#HTML-ç›¸å…³é—®é¢˜ï¼š" class="headerlink" title="HTML ç›¸å…³é—®é¢˜ï¼š"></a><a name="html-questions">HTML ç›¸å…³é—®é¢˜ï¼š</a></h4><ul>
<li><code>doctype</code>(æ–‡æ¡£ç±»å‹) çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>æµè§ˆå™¨æ ‡å‡†æ¨¡å¼ (standards mode) ã€å‡ ä¹æ ‡å‡†æ¨¡å¼ï¼ˆalmost standards modeï¼‰å’Œæ€ªå¼‚æ¨¡å¼ (quirks mode) ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>HTML å’Œ XHTML æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li>
<li>å¦‚æœé¡µé¢ä½¿ç”¨ â€˜application/xhtml+xmlâ€™ ä¼šæœ‰ä»€ä¹ˆé—®é¢˜å—ï¼Ÿ</li>
<li>å¦‚æœç½‘é¡µå†…å®¹éœ€è¦æ”¯æŒå¤šè¯­è¨€ï¼Œä½ ä¼šæ€ä¹ˆåšï¼Ÿ</li>
<li>åœ¨è®¾è®¡å’Œå¼€å‘å¤šè¯­è¨€ç½‘ç«™æ—¶ï¼Œæœ‰å“ªäº›é—®é¢˜ä½ å¿…é¡»è¦è€ƒè™‘ï¼Ÿ</li>
<li>ä½¿ç”¨ <code>data-</code> å±æ€§çš„å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>å¦‚æœæŠŠ HTML5 çœ‹ä½œåšä¸€ä¸ªå¼€æ”¾å¹³å°ï¼Œé‚£å®ƒçš„æ„å»ºæ¨¡å—æœ‰å“ªäº›ï¼Ÿ</li>
<li>è¯·æè¿° <code>cookies</code>ã€<code>sessionStorage</code> å’Œ <code>localStorage</code> çš„åŒºåˆ«ã€‚</li>
<li>è¯·è§£é‡Š <code>&lt;script&gt;</code>ã€<code>&lt;script async&gt;</code> å’Œ <code>&lt;script defer&gt;</code> çš„åŒºåˆ«ã€‚</li>
<li>ä¸ºä»€ä¹ˆé€šå¸¸æ¨èå°† CSS <code>&lt;link&gt;</code> æ”¾ç½®åœ¨ <code>&lt;head&gt;&lt;/head&gt;</code> ä¹‹é—´ï¼Œè€Œå°† JS <code>&lt;script&gt;</code> æ”¾ç½®åœ¨ <code>&lt;/body&gt;</code> ä¹‹å‰ï¼Ÿä½ çŸ¥é“æœ‰å“ªäº›ä¾‹å¤–å—ï¼Ÿ</li>
<li>ä»€ä¹ˆæ˜¯æ¸è¿›å¼æ¸²æŸ“ (progressive rendering)ï¼Ÿ</li>
<li>ä½ ç”¨è¿‡å“ªäº›ä¸åŒçš„ HTML æ¨¡æ¿è¯­è¨€ï¼Ÿ</li>
</ul>
<h4 id="CSS-ç›¸å…³é—®é¢˜ï¼š"><a href="#CSS-ç›¸å…³é—®é¢˜ï¼š" class="headerlink" title="CSS ç›¸å…³é—®é¢˜ï¼š"></a><a name="css-questions">CSS ç›¸å…³é—®é¢˜ï¼š</a></h4><ul>
<li>CSS ä¸­ç±» (classes) å’Œ ID çš„åŒºåˆ«ã€‚</li>
<li>è¯·é—® â€œresettingâ€ å’Œ â€œnormalizingâ€ CSS ä¹‹é—´çš„åŒºåˆ«ï¼Ÿä½ ä¼šå¦‚ä½•é€‰æ‹©ï¼Œä¸ºä»€ä¹ˆï¼Ÿ</li>
<li>è¯·è§£é‡Šæµ®åŠ¨ (Floats) åŠå…¶å·¥ä½œåŸç†ã€‚</li>
<li>æè¿°<code>z-index</code>å’Œå åŠ ä¸Šä¸‹æ–‡æ˜¯å¦‚ä½•å½¢æˆçš„ã€‚</li>
<li>è¯·æè¿° BFC(Block Formatting Context) åŠå…¶å¦‚ä½•å·¥ä½œã€‚</li>
<li>åˆ—ä¸¾ä¸åŒçš„æ¸…é™¤æµ®åŠ¨çš„æŠ€å·§ï¼Œå¹¶æŒ‡å‡ºå®ƒä»¬å„è‡ªé€‚ç”¨çš„ä½¿ç”¨åœºæ™¯ã€‚</li>
<li>è¯·è§£é‡Š CSS spritesï¼Œä»¥åŠä½ è¦å¦‚ä½•åœ¨é¡µé¢æˆ–ç½‘ç«™ä¸­å®ç°å®ƒã€‚</li>
<li>ä½ æœ€å–œæ¬¢çš„å›¾ç‰‡æ›¿æ¢æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œä½ å¦‚ä½•é€‰æ‹©ä½¿ç”¨ã€‚</li>
<li>ä½ ä¼šå¦‚ä½•è§£å†³ç‰¹å®šæµè§ˆå™¨çš„æ ·å¼é—®é¢˜ï¼Ÿ</li>
<li>å¦‚ä½•ä¸ºæœ‰åŠŸèƒ½é™åˆ¶çš„æµè§ˆå™¨æä¾›ç½‘é¡µï¼Ÿ<ul>
<li>ä½ ä¼šä½¿ç”¨å“ªäº›æŠ€æœ¯å’Œå¤„ç†æ–¹æ³•ï¼Ÿ</li>
</ul>
</li>
<li>æœ‰å“ªäº›çš„éšè—å†…å®¹çš„æ–¹æ³• (å¦‚æœåŒæ—¶è¿˜è¦ä¿è¯å±å¹•é˜…è¯»å™¨å¯ç”¨å‘¢)ï¼Ÿ</li>
<li>ä½ ç”¨è¿‡æ …æ ¼ç³»ç»Ÿ (grid system) å—ï¼Ÿå¦‚æœä½¿ç”¨è¿‡ï¼Œä½ æœ€å–œæ¬¢å“ªç§ï¼Ÿ</li>
<li>ä½ ç”¨è¿‡åª’ä½“æŸ¥è¯¢ï¼Œæˆ–é’ˆå¯¹ç§»åŠ¨ç«¯çš„å¸ƒå±€/CSS å—ï¼Ÿ</li>
<li>ä½ ç†Ÿæ‚‰ SVG æ ·å¼çš„ä¹¦å†™å—ï¼Ÿ</li>
<li>å¦‚ä½•ä¼˜åŒ–ç½‘é¡µçš„æ‰“å°æ ·å¼ï¼Ÿ</li>
<li>åœ¨ä¹¦å†™é«˜æ•ˆ CSS æ—¶ä¼šæœ‰å“ªäº›é—®é¢˜éœ€è¦è€ƒè™‘ï¼Ÿ</li>
<li>ä½¿ç”¨ CSS é¢„å¤„ç†å™¨çš„ä¼˜ç¼ºç‚¹æœ‰å“ªäº›ï¼Ÿ<ul>
<li>è¯·æè¿°ä½ æ›¾ç»ä½¿ç”¨è¿‡çš„ CSS é¢„å¤„ç†å™¨çš„ä¼˜ç¼ºç‚¹ã€‚</li>
</ul>
</li>
<li>å¦‚æœè®¾è®¡ä¸­ä½¿ç”¨äº†éæ ‡å‡†çš„å­—ä½“ï¼Œä½ è¯¥å¦‚ä½•å»å®ç°ï¼Ÿ</li>
<li>è¯·è§£é‡Šæµè§ˆå™¨æ˜¯å¦‚ä½•åˆ¤æ–­å…ƒç´ æ˜¯å¦åŒ¹é…æŸä¸ª CSS é€‰æ‹©å™¨ï¼Ÿ</li>
<li>è¯·æè¿°ä¼ªå…ƒç´  (pseudo-elements) åŠå…¶ç”¨é€”ã€‚</li>
<li>è¯·è§£é‡Šä½ å¯¹ç›’æ¨¡å‹çš„ç†è§£ï¼Œä»¥åŠå¦‚ä½•åœ¨ CSS ä¸­å‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨ä¸åŒçš„ç›’æ¨¡å‹æ¥æ¸²æŸ“ä½ çš„å¸ƒå±€ã€‚</li>
<li><p>è¯·è§£é‡Š <figure class="highlight plain"><figcaption><span>&#123; box-sizing: border-box; &#125;``` çš„ä½œç”¨, å¹¶ä¸”è¯´æ˜ä½¿ç”¨å®ƒæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿ</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">* è¯·ç½—åˆ—å‡ºä½ æ‰€çŸ¥é“çš„ display å±æ€§çš„å…¨éƒ¨å€¼</div><div class="line">* è¯·è§£é‡Š inline å’Œ inline-block çš„åŒºåˆ«ï¼Ÿ</div><div class="line">* è¯·è§£é‡Š relativeã€fixedã€absolute å’Œ static å…ƒç´ çš„åŒºåˆ«</div><div class="line">* CSS ä¸­å­—æ¯ &apos;C&apos; çš„æ„æ€æ˜¯å å±‚ (Cascading)ã€‚è¯·é—®åœ¨ç¡®å®šæ ·å¼çš„è¿‡ç¨‹ä¸­ä¼˜å…ˆçº§æ˜¯å¦‚ä½•å†³å®šçš„ (è¯·ä¸¾ä¾‹)ï¼Ÿå¦‚ä½•æœ‰æ•ˆä½¿ç”¨æ­¤ç³»ç»Ÿï¼Ÿ</div><div class="line">* ä½ åœ¨å¼€å‘æˆ–ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¿‡å“ªäº› CSS æ¡†æ¶ï¼Ÿä½ è§‰å¾—åº”è¯¥å¦‚ä½•æ”¹å–„ä»–ä»¬ï¼Ÿ</div><div class="line">* è¯·é—®ä½ æœ‰å°è¯•è¿‡ CSS Flexbox æˆ–è€… Grid æ ‡å‡†è§„æ ¼å—ï¼Ÿ</div><div class="line">* ä¸ºä»€ä¹ˆå“åº”å¼è®¾è®¡ (responsive design) å’Œè‡ªé€‚åº”è®¾è®¡ (adaptive design) ä¸åŒï¼Ÿ</div><div class="line">* ä½ æœ‰å…¼å®¹ retina å±å¹•çš„ç»å†å—ï¼Ÿå¦‚æœæœ‰ï¼Œåœ¨ä»€ä¹ˆåœ°æ–¹ä½¿ç”¨äº†ä½•ç§æŠ€æœ¯ï¼Ÿ</div><div class="line">* è¯·é—®ä¸ºä½•è¦ä½¿ç”¨ `translate()` è€Œé *absolute positioning*ï¼Œæˆ–åä¹‹çš„ç†ç”±ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</div><div class="line"></div><div class="line">#### &lt;a name=&apos;js-questions&apos;&gt;JS ç›¸å…³é—®é¢˜ï¼š&lt;/a&gt;</div><div class="line"></div><div class="line">* è¯·è§£é‡Šäº‹ä»¶ä»£ç† (event delegation)ã€‚</div><div class="line">* è¯·è§£é‡Š JavaScript ä¸­ `this` æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</div><div class="line">* è¯·è§£é‡ŠåŸå‹ç»§æ‰¿ (prototypal inheritance) çš„åŸç†ã€‚</div><div class="line">* ä½ æ€ä¹ˆçœ‹ AMD vs. CommonJSï¼Ÿ</div><div class="line">* è¯·è§£é‡Šä¸ºä»€ä¹ˆæ¥ä¸‹æ¥è¿™æ®µä»£ç ä¸æ˜¯ IIFE (ç«‹å³è°ƒç”¨çš„å‡½æ•°è¡¨è¾¾å¼)ï¼š`function foo()&#123; &#125;();`.</div><div class="line">  * è¦åšå“ªäº›æ”¹åŠ¨ä½¿å®ƒå˜æˆ IIFE?</div><div class="line">* æè¿°ä»¥ä¸‹å˜é‡çš„åŒºåˆ«ï¼š`null`ï¼Œ`undefined` æˆ– `undeclared`ï¼Ÿ</div><div class="line">  * è¯¥å¦‚ä½•æ£€æµ‹å®ƒä»¬ï¼Ÿ</div><div class="line">* ä»€ä¹ˆæ˜¯é—­åŒ… (closure)ï¼Œå¦‚ä½•ä½¿ç”¨å®ƒï¼Œä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒï¼Ÿ</div><div class="line">* è¯·ä¸¾å‡ºä¸€ä¸ªåŒ¿åå‡½æ•°çš„å…¸å‹ç”¨ä¾‹ï¼Ÿ</div><div class="line">* ä½ æ˜¯å¦‚ä½•ç»„ç»‡è‡ªå·±çš„ä»£ç ï¼Ÿæ˜¯ä½¿ç”¨æ¨¡å—æ¨¡å¼ï¼Œè¿˜æ˜¯ä½¿ç”¨ç»å…¸ç»§æ‰¿çš„æ–¹æ³•ï¼Ÿ</div><div class="line">* è¯·æŒ‡å‡º JavaScript å®¿ä¸»å¯¹è±¡ (host objects) å’ŒåŸç”Ÿå¯¹è±¡ (native objects) çš„åŒºåˆ«ï¼Ÿ</div><div class="line">* è¯·æŒ‡å‡ºä»¥ä¸‹ä»£ç çš„åŒºåˆ«ï¼š`function Person()&#123;&#125;`ã€`var person = Person()`ã€`var person = new Person()`ï¼Ÿ</div><div class="line">* `.call` å’Œ `.apply` çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</div><div class="line">* è¯·è§£é‡Š `Function.prototype.bind`ï¼Ÿ</div><div class="line">* åœ¨ä»€ä¹ˆæ—¶å€™ä½ ä¼šä½¿ç”¨ `document.write()`ï¼Ÿ</div><div class="line">* è¯·æŒ‡å‡ºæµè§ˆå™¨ç‰¹æ€§æ£€æµ‹ï¼Œç‰¹æ€§æ¨æ–­å’Œæµè§ˆå™¨ UA å­—ç¬¦ä¸²å—…æ¢çš„åŒºåˆ«ï¼Ÿ</div><div class="line">* è¯·å°½å¯èƒ½è¯¦å°½çš„è§£é‡Š Ajax çš„å·¥ä½œåŸç†ã€‚</div><div class="line">* ä½¿ç”¨ Ajax éƒ½æœ‰å“ªäº›ä¼˜åŠ£ï¼Ÿ</div><div class="line">* è¯·è§£é‡Š JSONP çš„å·¥ä½œåŸç†ï¼Œä»¥åŠå®ƒä¸ºä»€ä¹ˆä¸æ˜¯çœŸæ­£çš„ Ajaxã€‚</div><div class="line">* ä½ ä½¿ç”¨è¿‡ JavaScript æ¨¡æ¿ç³»ç»Ÿå—ï¼Ÿ</div><div class="line">  * å¦‚æœ‰ä½¿ç”¨è¿‡ï¼Œè¯·è°ˆè°ˆä½ éƒ½ä½¿ç”¨è¿‡å“ªäº›åº“ï¼Ÿ</div><div class="line">* è¯·è§£é‡Šå˜é‡å£°æ˜æå‡ (hoisting)ã€‚</div><div class="line">* è¯·æè¿°äº‹ä»¶å†’æ³¡æœºåˆ¶ (event bubbling)ã€‚</div><div class="line">* &quot;attribute&quot; å’Œ &quot;property&quot; çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</div><div class="line">* ä¸ºä»€ä¹ˆæ‰©å±• JavaScript å†…ç½®å¯¹è±¡ä¸æ˜¯å¥½çš„åšæ³•ï¼Ÿ</div><div class="line">* è¯·æŒ‡å‡º document load å’Œ document DOMContentLoaded ä¸¤ä¸ªäº‹ä»¶çš„åŒºåˆ«ã€‚</div><div class="line">* `==` å’Œ `===` æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</div><div class="line">* è¯·è§£é‡Š JavaScript çš„åŒæºç­–ç•¥ (same-origin policy)ã€‚</div><div class="line">* å¦‚ä½•å®ç°ä¸‹åˆ—ä»£ç ï¼š</div><div class="line">```javascript</div><div class="line">[1,2,3,4,5].duplicator(); // [1,2,3,4,5,1,2,3,4,5]</div></pre></td></tr></table></figure></p>
</li>
<li><p>ä»€ä¹ˆæ˜¯ä¸‰å…ƒè¡¨è¾¾å¼ (Ternary expression)ï¼Ÿâ€œä¸‰å…ƒ (Ternary)â€ è¡¨ç¤ºä»€ä¹ˆæ„æ€ï¼Ÿ</p>
</li>
<li>ä»€ä¹ˆæ˜¯ <code>&quot;use strict&quot;;</code> ? ä½¿ç”¨å®ƒçš„å¥½å¤„å’Œåå¤„åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>è¯·å®ç°ä¸€ä¸ªéå†è‡³ <code>100</code> çš„ for loop å¾ªç¯ï¼Œåœ¨èƒ½è¢« <code>3</code> æ•´é™¤æ—¶è¾“å‡º <strong>â€œfizzâ€</strong>ï¼Œåœ¨èƒ½è¢« <code>5</code> æ•´é™¤æ—¶è¾“å‡º <strong>â€œbuzzâ€</strong>ï¼Œåœ¨èƒ½åŒæ—¶è¢« <code>3</code> å’Œ <code>5</code> æ•´é™¤æ—¶è¾“å‡º <strong>â€œfizzbuzzâ€</strong>ã€‚</li>
<li>ä¸ºä½•é€šå¸¸ä¼šè®¤ä¸ºä¿ç•™ç½‘ç«™ç°æœ‰çš„å…¨å±€ä½œç”¨åŸŸ (global scope) ä¸å»æ”¹å˜å®ƒï¼Œæ˜¯è¾ƒå¥½çš„é€‰æ‹©ï¼Ÿ</li>
<li>ä¸ºä½•ä½ ä¼šä½¿ç”¨ <code>load</code> ä¹‹ç±»çš„äº‹ä»¶ (event)ï¼Ÿæ­¤äº‹ä»¶æœ‰ç¼ºç‚¹å—ï¼Ÿä½ æ˜¯å¦çŸ¥é“å…¶ä»–æ›¿ä»£å“ï¼Œä»¥åŠä¸ºä½•ä½¿ç”¨å®ƒä»¬ï¼Ÿ</li>
<li>è¯·è§£é‡Šä»€ä¹ˆæ˜¯å•é¡µåº”ç”¨ (single page app), ä»¥åŠå¦‚ä½•ä½¿å…¶å¯¹æœç´¢å¼•æ“å‹å¥½ (SEO-friendly)ã€‚</li>
<li>What is the extent of your experience with Promises and/or their polyfills?</li>
<li>ä½¿ç”¨ Promises è€Œéå›è°ƒ (callbacks) ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>ä½¿ç”¨ä¸€ç§å¯ä»¥ç¼–è¯‘æˆ JavaScript çš„è¯­è¨€æ¥å†™ JavaScript ä»£ç æœ‰å“ªäº›ä¼˜ç¼ºç‚¹ï¼Ÿ</li>
<li>ä½ ä½¿ç”¨å“ªäº›å·¥å…·å’ŒæŠ€æœ¯æ¥è°ƒè¯• JavaScript ä»£ç ï¼Ÿ</li>
<li>ä½ ä¼šä½¿ç”¨æ€æ ·çš„è¯­è¨€ç»“æ„æ¥éå†å¯¹è±¡å±æ€§ (object properties) å’Œæ•°ç»„å†…å®¹ï¼Ÿ</li>
<li>è¯·è§£é‡Šå¯å˜ (mutable) å’Œä¸å˜ (immutable) å¯¹è±¡çš„åŒºåˆ«ã€‚<ul>
<li>è¯·ä¸¾å‡º JavaScript ä¸­ä¸€ä¸ªä¸å˜æ€§å¯¹è±¡ (immutable object) çš„ä¾‹å­ï¼Ÿ</li>
<li>ä¸å˜æ€§ (immutability) æœ‰å“ªäº›ä¼˜ç¼ºç‚¹ï¼Ÿ</li>
<li>å¦‚ä½•ç”¨ä½ è‡ªå·±çš„ä»£ç æ¥å®ç°ä¸å˜æ€§ (immutability)ï¼Ÿ</li>
</ul>
</li>
<li>è¯·è§£é‡ŠåŒæ­¥ (synchronous) å’Œå¼‚æ­¥ (asynchronous) å‡½æ•°çš„åŒºåˆ«ã€‚</li>
<li>ä»€ä¹ˆæ˜¯äº‹ä»¶å¾ªç¯ (event loop)ï¼Ÿ<ul>
<li>è¯·é—®è°ƒç”¨æ ˆ (call stack) å’Œä»»åŠ¡é˜Ÿåˆ— (task queue) çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
</li>
<li>è§£é‡Š <code>function foo() {}</code> ä¸ <code>var foo = function() {}</code> ç”¨æ³•çš„åŒºåˆ«</li>
</ul>
<h4 id="æµ‹è¯•ç›¸å…³é—®é¢˜ï¼š"><a href="#æµ‹è¯•ç›¸å…³é—®é¢˜ï¼š" class="headerlink" title="æµ‹è¯•ç›¸å…³é—®é¢˜ï¼š"></a><a name="testing-questions">æµ‹è¯•ç›¸å…³é—®é¢˜ï¼š</a></h4><ul>
<li>å¯¹ä»£ç è¿›è¡Œæµ‹è¯•çš„æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</li>
<li>ä½ ä¼šç”¨ä»€ä¹ˆå·¥å…·æµ‹è¯•ä½ çš„ä»£ç åŠŸèƒ½ï¼Ÿ</li>
<li>å•å…ƒæµ‹è¯•ä¸åŠŸèƒ½/é›†æˆæµ‹è¯•çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>ä»£ç é£æ ¼ linting å·¥å…·çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</li>
</ul>
<h4 id="æ•ˆèƒ½ç›¸å…³é—®é¢˜ï¼š"><a href="#æ•ˆèƒ½ç›¸å…³é—®é¢˜ï¼š" class="headerlink" title="æ•ˆèƒ½ç›¸å…³é—®é¢˜ï¼š"></a><a name="performance-questions">æ•ˆèƒ½ç›¸å…³é—®é¢˜ï¼š</a></h4><ul>
<li>ä½ ä¼šç”¨ä»€ä¹ˆå·¥å…·æ¥æŸ¥æ‰¾ä»£ç ä¸­çš„æ€§èƒ½é—®é¢˜ï¼Ÿ</li>
<li>ä½ ä¼šç”¨ä»€ä¹ˆæ–¹å¼æ¥å¢å¼ºç½‘ç«™çš„é¡µé¢æ»šåŠ¨æ•ˆèƒ½ï¼Ÿ</li>
<li>è¯·è§£é‡Š layoutã€painting å’Œ compositing çš„åŒºåˆ«ã€‚</li>
</ul>
<h4 id="ç½‘ç»œç›¸å…³é—®é¢˜ï¼š"><a href="#ç½‘ç»œç›¸å…³é—®é¢˜ï¼š" class="headerlink" title="ç½‘ç»œç›¸å…³é—®é¢˜ï¼š"></a><a name="network-questions">ç½‘ç»œç›¸å…³é—®é¢˜ï¼š</a></h4><ul>
<li>ä¸ºä»€ä¹ˆä¼ ç»Ÿä¸Šåˆ©ç”¨å¤šä¸ªåŸŸåæ¥æä¾›ç½‘ç«™èµ„æºä¼šæ›´æœ‰æ•ˆï¼Ÿ</li>
<li>è¯·å°½å¯èƒ½å®Œæ•´å¾—æè¿°ä»è¾“å…¥ URL åˆ°æ•´ä¸ªç½‘é¡µåŠ è½½å®Œæ¯•åŠæ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„æ•´ä¸ªæµç¨‹ã€‚</li>
<li>Long-Pollingã€Websockets å’Œ Server-Sent Event ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li>
<li>è¯·æè¿°ä»¥ä¸‹ request å’Œ response headersï¼š<ul>
<li>Diff. between Expires, Date, Age and If-Modified-â€¦</li>
<li>Do Not Track</li>
<li>Cache-Control</li>
<li>Transfer-Encoding</li>
<li>ETag</li>
<li>X-Frame-Options</li>
</ul>
</li>
<li>ä»€ä¹ˆæ˜¯ HTTP methodï¼Ÿè¯·ç½—åˆ—å‡ºä½ æ‰€çŸ¥é“çš„æ‰€æœ‰ HTTP methodï¼Œå¹¶ç»™å‡ºè§£é‡Šã€‚</li>
</ul>
<h4 id="ä»£ç ç›¸å…³çš„é—®é¢˜ï¼š"><a href="#ä»£ç ç›¸å…³çš„é—®é¢˜ï¼š" class="headerlink" title="ä»£ç ç›¸å…³çš„é—®é¢˜ï¼š"></a><a name="coding-questions">ä»£ç ç›¸å…³çš„é—®é¢˜ï¼š</a></h4><p><em>é—®é¢˜ï¼š<code>foo</code>çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> foo = <span class="number">10</span> + <span class="string">'20'</span>;</div></pre></td></tr></table></figure></p>
<p><em>é—®é¢˜ï¼šå¦‚ä½•å®ç°ä»¥ä¸‹å‡½æ•°ï¼Ÿ</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">add(<span class="number">2</span>, <span class="number">5</span>); <span class="comment">// 7</span></div><div class="line">add(<span class="number">2</span>)(<span class="number">5</span>); <span class="comment">// 7</span></div></pre></td></tr></table></figure></p>
<p><em>é—®é¢˜ï¼šä¸‹é¢çš„è¯­å¥çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"i'm a lasagna hog"</span>.split(<span class="string">""</span>).reverse().join(<span class="string">""</span>);</div></pre></td></tr></table></figure></p>
<p><em>é—®é¢˜ï¼š<code>window.foo</code>çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">( <span class="built_in">window</span>.foo || ( <span class="built_in">window</span>.foo = <span class="string">"bar"</span> ) );</div></pre></td></tr></table></figure></p>
<p><em>é—®é¢˜ï¼šä¸‹é¢ä¸¤ä¸ª alert çš„ç»“æœæ˜¯ä»€ä¹ˆï¼Ÿ</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> foo = <span class="string">"Hello"</span>;</div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> bar = <span class="string">" World"</span>;</div><div class="line">  alert(foo + bar);</div><div class="line">&#125;)();</div><div class="line">alert(foo + bar);</div></pre></td></tr></table></figure></p>
<p><em>é—®é¢˜ï¼š<code>foo.length</code>çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> foo = [];</div><div class="line">foo.push(<span class="number">1</span>);</div><div class="line">foo.push(<span class="number">2</span>);</div></pre></td></tr></table></figure></p>
<p><em>é—®é¢˜ï¼š<code>foo.x</code>çš„å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> foo = &#123;<span class="attr">n</span>: <span class="number">1</span>&#125;;</div><div class="line"><span class="keyword">var</span> bar = foo;</div><div class="line">foo.x = foo = &#123;<span class="attr">n</span>: <span class="number">2</span>&#125;;</div></pre></td></tr></table></figure></p>
<p><em>é—®é¢˜ï¼šä¸‹é¢ä»£ç çš„è¾“å‡ºæ˜¯ä»€ä¹ˆï¼Ÿ</em><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'one'</span>);</div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'two'</span>);</div><div class="line">&#125;, <span class="number">0</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'three'</span>);</div></pre></td></tr></table></figure></p>
<h4 id="è¶£å‘³é—®é¢˜ï¼š"><a href="#è¶£å‘³é—®é¢˜ï¼š" class="headerlink" title="è¶£å‘³é—®é¢˜ï¼š"></a><a name="fun-questions">è¶£å‘³é—®é¢˜ï¼š</a></h4><ul>
<li>ä½ æœ€è¿‘å†™è¿‡ä»€ä¹ˆçš„å¾ˆé…·çš„é¡¹ç›®å—ï¼Ÿ</li>
<li>åœ¨ä½ ä½¿ç”¨çš„å¼€å‘å·¥å…·ä¸­ï¼Œæœ€å–œæ¬¢å“ªäº›æ–¹é¢ï¼Ÿ</li>
<li>è°ä½¿ä½ è¸è¶³äº†å‰ç«¯å¼€å‘é¢†åŸŸï¼Ÿ</li>
<li>ä½ æœ‰ä»€ä¹ˆä¸šä½™é¡¹ç›®å—ï¼Ÿæ˜¯å“ªç§ç±»å‹çš„ï¼Ÿ</li>
<li>ä½ æœ€çˆ±çš„ IE ç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>ä½ å¯¹å’–å•¡æœ‰æ²¡æœ‰ä»€ä¹ˆå–œå¥½ï¼Ÿ</li>
</ul>
<h4 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h4><p>æœ¬æ–‡æ”¶é›†è‡ªç½‘ç»œï¼Œä¸ç”¨ä½œå•†ä¸šç”¨é€”ï¼Œæ„Ÿè°¢è´¡çŒ®è€…ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜&quot;&gt;&lt;a href=&quot;#å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜&quot; class=&quot;headerlink&quot; title=&quot;å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜&quot;&gt;&lt;/a&gt;å‰ç«¯å·¥ä½œé¢è¯•é—®é¢˜&lt;/h1&gt;&lt;p&gt;æœ¬æ–‡åŒ…å«äº†ä¸€äº›ç”¨äºè€ƒæŸ¥å€™é€‰è€…çš„å‰ç«¯é¢è¯•é—®é¢˜ã€‚ä¸å»ºè®®å¯¹å•ä¸ªå€™é€‰è€…é—®åŠæ¯ä¸ªé—®é¢˜ (é‚£éœ€è¦å¥½å‡ ä¸ªå°
    
    </summary>
    
    
      <category term="é¢è¯•" scheme="http://microzz.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="å‰ç«¯" scheme="http://microzz.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="Web" scheme="http://microzz.com/tags/Web/"/>
    
      <category term="æ±‚èŒ" scheme="http://microzz.com/tags/%E6%B1%82%E8%81%8C/"/>
    
  </entry>
  
  <entry>
    <title>JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…</title>
    <link href="http://microzz.com/2017/02/23/lazy-func/"/>
    <id>http://microzz.com/2017/02/23/lazy-func/</id>
    <published>2017-02-23T06:55:16.000Z</published>
    <updated>2017-02-23T07:35:44.170Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…"><a href="#JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…" class="headerlink" title="JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…"></a>JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…</h1><h2 id="JavaScriptæƒ°æ€§å‡½æ•°"><a href="#JavaScriptæƒ°æ€§å‡½æ•°" class="headerlink" title="JavaScriptæƒ°æ€§å‡½æ•°"></a>JavaScriptæƒ°æ€§å‡½æ•°</h2><blockquote>
<p>&nbsp;&nbsp;&nbsp;æƒ°æ€§å‡½æ•°ï¼Œå³åªåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œåå†è°ƒç”¨å¾—åˆ°çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ã€‚è¿™å¯¹äºå‰ç«¯æ€§èƒ½ä¼˜åŒ–æœ‰ä¸€å®šçš„å¸®åŠ©ï¼Œæœ‰åŠ©äºå¼€å‘å¥å£®çš„é¡¹ç›®ã€‚</p>
</blockquote>
<h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><blockquote>
<p>&nbsp;&nbsp;&nbsp;AJAXå³â€œAsynchronous Javascript And XMLâ€ï¼ˆå¼‚æ­¥JavaScriptå’ŒXMLï¼‰ï¼Œæ˜¯æŒ‡ä¸€ç§åˆ›å»ºäº¤äº’å¼ç½‘é¡µåº”ç”¨çš„ç½‘é¡µå¼€å‘æŠ€æœ¯ã€‚<br>AJAX = å¼‚æ­¥ JavaScriptå’ŒXMLã€‚<br>é€šè¿‡åœ¨åå°ä¸æœåŠ¡å™¨è¿›è¡Œå°‘é‡æ•°æ®äº¤æ¢ï¼ŒAJAX å¯ä»¥ä½¿ç½‘é¡µå®ç°å¼‚æ­¥æ›´æ–°ã€‚è¿™æ„å‘³ç€å¯ä»¥åœ¨ä¸é‡æ–°åŠ è½½æ•´ä¸ªç½‘é¡µçš„æƒ…å†µä¸‹ï¼Œå¯¹ç½‘é¡µçš„æŸéƒ¨åˆ†è¿›è¡Œæ›´æ–°ã€‚</p>
</blockquote>
<h2 id="æƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…"><a href="#æƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…" class="headerlink" title="æƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…"></a>æƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * æƒ°æ€§å‡½æ•°</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createXHR</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> xhr = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">if</span> ( <span class="keyword">typeof</span> XMLHttpRequest !== <span class="string">'undefined'</span>) &#123;</div><div class="line">    xhr = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">    createXHR = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">    &#125;;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">"Msxml2.XMLHTTP"</span>);</div><div class="line">      createXHR = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ActiveXObject(<span class="string">"Msxml2.XMLHTTP"</span>);</div><div class="line">      &#125;;</div><div class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        xhr = <span class="keyword">new</span> ActiveXObject(<span class="string">'Microsoft.XMLHTTP'</span>);</div><div class="line">        createXHR = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> ActiveXObject(<span class="string">'Microsoft.XMLHTTP'</span>);</div><div class="line">        &#125;;</div><div class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">        createXHR = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">          <span class="keyword">return</span> <span class="literal">null</span>;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> xhr;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…&quot;&gt;&lt;a href=&quot;#JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…&quot; class=&quot;headerlink&quot; title=&quot;JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…&quot;&gt;&lt;/a&gt;JSæƒ°æ€§å‡½æ•°å®ç°Ajaxå°è£…&lt;/h1&gt;&lt;h2 id=&quot;JavaScriptæƒ°æ€§å‡½æ•°&quot;&gt;&lt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="Function" scheme="http://microzz.com/tags/Function/"/>
    
      <category term="Ajax" scheme="http://microzz.com/tags/Ajax/"/>
    
      <category term="æ€§èƒ½ä¼˜åŒ–" scheme="http://microzz.com/tags/%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>åŸç”ŸJSå®ç°è½®æ’­å›¾</title>
    <link href="http://microzz.com/2017/02/22/carousel/"/>
    <id>http://microzz.com/2017/02/22/carousel/</id>
    <published>2017-02-22T02:05:02.000Z</published>
    <updated>2017-02-22T02:31:44.566Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸç”ŸJSå®ç°è½®æ’­å›¾"><a href="#åŸç”ŸJSå®ç°è½®æ’­å›¾" class="headerlink" title="åŸç”ŸJSå®ç°è½®æ’­å›¾"></a>åŸç”ŸJSå®ç°è½®æ’­å›¾</h1><h2 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://raw.githubusercontent.com/microzz/carousel/master/preview.gif" alt="åŸç”ŸJSå®ç°å®šæ—¶è‡ªåŠ¨åˆ‡æ¢è½®æ’­å›¾" title="">
                </div>
                <div class="image-caption">åŸç”ŸJSå®ç°å®šæ—¶è‡ªåŠ¨åˆ‡æ¢è½®æ’­å›¾</div>
            </figure>
<h2 id="åœ¨çº¿é¢„è§ˆ"><a href="#åœ¨çº¿é¢„è§ˆ" class="headerlink" title="åœ¨çº¿é¢„è§ˆ"></a>åœ¨çº¿é¢„è§ˆ</h2><h3 id="åœ¨çº¿é¢„è§ˆåœ°å€1"><a href="#åœ¨çº¿é¢„è§ˆåœ°å€1" class="headerlink" title="åœ¨çº¿é¢„è§ˆåœ°å€1"></a>åœ¨çº¿é¢„è§ˆåœ°å€1</h3><p> ğŸ”—<a href="http://microzz.cn/Carousel/" target="_blank" rel="external">http://microzz.cn/Carousel/</a></p>
<h3 id="åœ¨çº¿é¢„è§ˆåœ°å€2"><a href="#åœ¨çº¿é¢„è§ˆåœ°å€2" class="headerlink" title="åœ¨çº¿é¢„è§ˆåœ°å€2"></a>åœ¨çº¿é¢„è§ˆåœ°å€2</h3><p> ğŸ”—<a href="https://microzz.github.io/carousel/" target="_blank" rel="external">https://microzz.github.io/carousel/</a></p>
<h2 id="æºä»£ç "><a href="#æºä»£ç " class="headerlink" title="æºä»£ç "></a>æºä»£ç </h2><p>æºä»£ç åœ°å€ï¼šğŸ”—<a href="https://github.com/microzz/carousel" target="_blank" rel="external">https://github.com/microzz/carousel</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;åŸç”ŸJSå®ç°è½®æ’­å›¾&quot;&gt;&lt;a href=&quot;#åŸç”ŸJSå®ç°è½®æ’­å›¾&quot; class=&quot;headerlink&quot; title=&quot;åŸç”ŸJSå®ç°è½®æ’­å›¾&quot;&gt;&lt;/a&gt;åŸç”ŸJSå®ç°è½®æ’­å›¾&lt;/h1&gt;&lt;h2 id=&quot;æ•ˆæœå›¾&quot;&gt;&lt;a href=&quot;#æ•ˆæœå›¾&quot; class=&quot;headerlink
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="Carousel" scheme="http://microzz.com/tags/Carousel/"/>
    
  </entry>
  
  <entry>
    <title>React.JSå­¦ä¹ æ€ç»´å¯¼å›¾</title>
    <link href="http://microzz.com/2017/02/21/react-mind-map/"/>
    <id>http://microzz.com/2017/02/21/react-mind-map/</id>
    <published>2017-02-21T13:41:34.000Z</published>
    <updated>2017-02-24T13:53:53.803Z</updated>
    
    <content type="html"><![CDATA[<h1 id="React-JSå­¦ä¹ æ€ç»´å¯¼å›¾"><a href="#React-JSå­¦ä¹ æ€ç»´å¯¼å›¾" class="headerlink" title="React.JSå­¦ä¹ æ€ç»´å¯¼å›¾"></a>React.JSå­¦ä¹ æ€ç»´å¯¼å›¾</h1><h2 id="ReactJSç®€ä»‹"><a href="#ReactJSç®€ä»‹" class="headerlink" title="ReactJSç®€ä»‹"></a>ReactJSç®€ä»‹</h2><p>React æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JAVASCRIPT åº“ã€‚<br>Reactä¸»è¦ç”¨äºæ„å»ºUIï¼Œå¾ˆå¤šäººè®¤ä¸º React æ˜¯ MVC ä¸­çš„ Vï¼ˆè§†å›¾ï¼‰ã€‚<br>React èµ·æºäº Facebook çš„å†…éƒ¨é¡¹ç›®ï¼Œç”¨æ¥æ¶è®¾ Instagram çš„ç½‘ç«™ï¼Œå¹¶äº 2013 å¹´ 5 æœˆå¼€æºã€‚<br>React æ‹¥æœ‰è¾ƒé«˜çš„æ€§èƒ½ï¼Œä»£ç é€»è¾‘éå¸¸ç®€å•ï¼Œè¶Šæ¥è¶Šå¤šçš„äººå·²å¼€å§‹å…³æ³¨å’Œä½¿ç”¨å®ƒã€‚</p>
<h2 id="æ€ç»´å¯¼å›¾"><a href="#æ€ç»´å¯¼å›¾" class="headerlink" title="æ€ç»´å¯¼å›¾"></a>æ€ç»´å¯¼å›¾</h2><h3 id="åœ¨çº¿é¢„è§ˆåœ°å€"><a href="#åœ¨çº¿é¢„è§ˆåœ°å€" class="headerlink" title="åœ¨çº¿é¢„è§ˆåœ°å€"></a>åœ¨çº¿é¢„è§ˆåœ°å€</h3><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://microzz.cn/images/mind-map-for-react.png" alt="mind-map-for-react" title="">
                </div>
                <div class="image-caption">mind-map-for-react</div>
            </figure>
<h3 id="æºæ–‡ä»¶"><a href="#æºæ–‡ä»¶" class="headerlink" title="æºæ–‡ä»¶"></a>æºæ–‡ä»¶</h3><p><a href="https://github.com/microzz/mind-map-for-react" target="_blank" rel="external">React.JSå­¦ä¹ æ€ç»´å¯¼å›¾</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;React-JSå­¦ä¹ æ€ç»´å¯¼å›¾&quot;&gt;&lt;a href=&quot;#React-JSå­¦ä¹ æ€ç»´å¯¼å›¾&quot; class=&quot;headerlink&quot; title=&quot;React.JSå­¦ä¹ æ€ç»´å¯¼å›¾&quot;&gt;&lt;/a&gt;React.JSå­¦ä¹ æ€ç»´å¯¼å›¾&lt;/h1&gt;&lt;h2 id=&quot;ReactJSç®€ä»‹&quot;&gt;&lt;a hre
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="ReactJS" scheme="http://microzz.com/tags/ReactJS/"/>
    
  </entry>
  
  <entry>
    <title>jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</title>
    <link href="http://microzz.com/2017/02/20/waterfalljq/"/>
    <id>http://microzz.com/2017/02/20/waterfalljq/</id>
    <published>2017-02-20T13:42:02.000Z</published>
    <updated>2017-02-20T14:05:07.388Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€"><a href="#jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€" class="headerlink" title="jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€"></a>jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</h1><h2 id="ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ"><a href="#ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ"></a>ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ</h2><p>ç€‘å¸ƒæµï¼Œåˆç§°ç€‘å¸ƒæµå¼å¸ƒå±€ã€‚æ˜¯æ¯”è¾ƒæµè¡Œçš„ä¸€ç§ç½‘ç«™é¡µé¢å¸ƒå±€ï¼Œè§†è§‰è¡¨ç°ä¸ºå‚å·®ä¸é½çš„å¤šæ å¸ƒå±€ï¼Œéšç€é¡µé¢æ»šåŠ¨æ¡å‘ä¸‹æ»šåŠ¨ï¼Œè¿™ç§å¸ƒå±€è¿˜ä¼šä¸æ–­åŠ è½½æ•°æ®å—å¹¶é™„åŠ è‡³å½“å‰å°¾éƒ¨ã€‚æœ€æ—©é‡‡ç”¨æ­¤å¸ƒå±€çš„ç½‘ç«™æ˜¯Pinterestï¼Œé€æ¸åœ¨å›½å†…æµè¡Œå¼€æ¥ã€‚å›½å†…å¤§å¤šæ•°æ¸…æ–°ç«™åŸºæœ¬ä¸ºè¿™ç±»é£æ ¼ã€‚</p>
<h2 id="ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹"><a href="#ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹"></a>ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹</h2><ol>
<li>ç³ç…æ»¡ç›®ï¼šæ•´ç‰ˆä»¥å›¾ç‰‡ä¸ºä¸»ï¼Œå¤§å°ä¸ä¸€çš„å›¾ç‰‡æŒ‰ç…§ä¸€å®šçš„è§„å¾‹æ’åˆ—ã€‚</li>
<li>å”¯ç¾ï¼šå›¾ç‰‡çš„é£æ ¼ä»¥å”¯ç¾çš„å›¾ç‰‡ä¸ºä¸»ã€‚</li>
<li>æ“ä½œç®€å•ï¼šåœ¨æµè§ˆç½‘ç«™çš„æ—¶å€™åªéœ€è¦è½»è½»æ»‘åŠ¨ä¸€ä¸‹é¼ æ ‡æ»šè½®ï¼Œä¸€åˆ‡çš„ç¾å¦™çš„å›¾ç‰‡ç²¾å½©ä¾¿å¯å‘ˆç°åœ¨ä½ é¢å‰ã€‚</li>
</ol>
<h2 id="æ•ˆæœé¢„è§ˆ"><a href="#æ•ˆæœé¢„è§ˆ" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h2><p> åœ¨çº¿é¢„è§ˆåœ°å€1ï¼š ğŸ”—<a href="http://microzz.cn/waterfall-jq/" target="_blank" rel="external">http://microzz.cn/waterfall-jq/</a><br> åœ¨çº¿é¢„è§ˆåœ°å€2ï¼š ğŸ”—<a href="https://microzz.github.io/waterfall-jq/" target="_blank" rel="external">https://microzz.github.io/waterfall-jq/</a></p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>æºä»£ç åœ°å€ï¼šğŸ”—<a href="https://github.com/microzz/waterfall-jq" target="_blank" rel="external">https://github.com/microzz/waterfall-jq</a></p>
<h2 id="ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹"><a href="#ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹"></a>ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹</h2><h3 id="å¸ƒå±€ä¼˜ç‚¹"><a href="#å¸ƒå±€ä¼˜ç‚¹" class="headerlink" title="å¸ƒå±€ä¼˜ç‚¹"></a>å¸ƒå±€ä¼˜ç‚¹</h3><ol>
<li>æœ‰æ•ˆçš„é™ä½äº†ç•Œé¢å¤æ‚åº¦ï¼ŒèŠ‚çœäº†ç©ºé—´ï¼šæˆ‘ä»¬ä¸å†éœ€è¦è‡ƒè‚¿å¤æ‚çš„é¡µç å¯¼èˆªé“¾æ¥æˆ–æŒ‰é’®äº†ã€‚</li>
<li>å¯¹è§¦å±è®¾å¤‡æ¥è¯´ï¼Œäº¤äº’æ–¹å¼æ›´ç¬¦åˆç›´è§‰ï¼šåœ¨ç§»åŠ¨åº”ç”¨çš„äº¤äº’ç¯å¢ƒå½“ä¸­ï¼Œé€šè¿‡å‘ä¸Šæ»‘åŠ¨è¿›è¡Œæ»šå±çš„æ“ä½œå·²ç»æˆä¸ºæœ€åŸºæœ¬çš„ç”¨æˆ·ä¹ æƒ¯ï¼Œè€Œä¸”æ‰€éœ€è¦çš„æ“ä½œç²¾å‡†ç¨‹åº¦è¿œè¿œä½äºç‚¹å‡»é“¾æ¥æˆ–æŒ‰é’®ã€‚</li>
<li>æ›´é«˜çš„å‚ä¸åº¦ï¼šä»¥ä¸Šä¸¤ç‚¹æ‰€å¸¦æ¥çš„äº¤äº’ä¾¿æ·æ€§å¯ä»¥ä½¿ç”¨æˆ·å°†æ³¨æ„åŠ›æ›´å¤šçš„é›†ä¸­åœ¨å†…å®¹è€Œä¸æ˜¯æ“ä½œä¸Šï¼Œä»è€Œè®©ä»–ä»¬æ›´ä¹äºæ²‰æµ¸åœ¨æ¢ç´¢ä¸æµè§ˆå½“ä¸­ã€‚<h3 id="å¸ƒå±€ç¼ºç‚¹"><a href="#å¸ƒå±€ç¼ºç‚¹" class="headerlink" title="å¸ƒå±€ç¼ºç‚¹"></a>å¸ƒå±€ç¼ºç‚¹</h3></li>
<li>æœ‰é™çš„ç”¨ä¾‹ï¼š<br>æ— é™æ»šåŠ¨çš„æ–¹å¼åªé€‚ç”¨äºæŸäº›ç‰¹å®šç±»å‹äº§å“å½“ä¸­ä¸€éƒ¨åˆ†ç‰¹å®šç±»å‹çš„å†…å®¹ã€‚<br>ä¾‹å¦‚ï¼Œåœ¨ç”µå•†ç½‘ç«™å½“ä¸­ï¼Œç”¨æˆ·æ—¶å¸¸éœ€è¦åœ¨å•†å“åˆ—è¡¨ä¸è¯¦æƒ…é¡µé¢ä¹‹é—´åˆ‡æ¢ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¼ ç»Ÿçš„ã€å¸¦æœ‰é¡µç å¯¼èˆªçš„æ–¹å¼å¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´ç¨³å¦¥å’Œå‡†ç¡®çš„å›åˆ°æŸä¸ªç‰¹å®šçš„åˆ—è¡¨é¡µé¢å½“ä¸­ã€‚</li>
<li>é¢å¤–çš„å¤æ‚åº¦ï¼š<br>é‚£äº›ç”¨æ¥æ‰“é€ æ— é™æ»šåŠ¨çš„JSåº“è™½ç„¶éƒ½è‡ªç§°å¾ˆå®¹æ˜“ä½¿ç”¨ï¼Œä½†ä½ æ€»ä¼šéœ€è¦åœ¨è‡ªå·±çš„äº§å“ä¸­è¿›è¡Œä¸åŒç¨‹åº¦çš„å®šåˆ¶åŒ–å¤„ç†ï¼Œä»¥æ»¡è¶³ä½ ä»¬è‡ªå·±çš„éœ€æ±‚;å¦å¤–è¿™äº›JSåº“åœ¨æµè§ˆå™¨å’Œè®¾å¤‡å…¼å®¹æ€§ç­‰æ–¹é¢çš„è¡¨ç°ä¹Ÿå‚å·®ä¸é½ï¼Œä½ å¿…é¡»åšå¥½å……åˆ†çš„æµ‹è¯•ä¸è°ƒæ•´å·¥ä½œã€‚</li>
<li>å†è§äº†ï¼Œé¡µè„šï¼š<br>å¦‚æœä½¿ç”¨äº†æ¯”è¾ƒå…¸å‹çš„æ— é™æ»šåŠ¨åŠ è½½æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ä½ å¯ä»¥å’Œé¡µè„šè¯´æ‹œæ‹œäº†ã€‚<br>æœ€å¥½è€ƒè™‘ä¸€ä¸‹é¡µè„šå¯¹äºä½ çš„ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯ç”¨æˆ·çš„é‡è¦æ€§;å¦‚æœå…¶ä¸­ç¡®å®æœ‰æ¯”è¾ƒé‡è¦çš„å†…å®¹æˆ–é“¾æ¥ï¼Œé‚£ä¹ˆæœ€å¥½æ¢ä¸€ç§æ›´ä¼ ç»Ÿå’Œç¨³å¦¥çš„æ–¹å¼ã€‚<br>åƒä¸‡ä¸è¦è€å¼„ä½ çš„ç”¨æˆ·ï¼Œå½“ä»–ä»¬ä¸€æ¬¡æ¬¡çš„æµè§ˆåˆ°é¡µé¢åº•éƒ¨ï¼Œçœ‹åˆ°é¡µè„šï¼Œå´å› ä¸ºè‡ªåŠ¨åŠ è½½çš„å†…å®¹çªç„¶å‡ºç°è€Œæ— è®ºå¦‚ä½•éƒ½æ— æ³•ç‚¹å‡»é¡µè„šä¸­çš„é“¾æ¥æ—¶ï¼Œä»–ä»¬ä¼šå˜çš„è¶Šå‘æ„¤æ€’ã€‚</li>
<li>SEOï¼š<br>é›†ä¸­åœ¨ä¸€é¡µå½“ä¸­åŠ¨æ€åŠ è½½æ•°æ®ï¼Œä¸ä¸€é¡µä¸€é¡µçš„è¾“å‡ºç›¸æ¯”ï¼Œç©¶ç«Ÿé‚£ç§æ–¹å¼æ›´åˆ©äºSEOï¼Œè¿™æ˜¯ä½ å¿…é¡»è€ƒè™‘çš„é—®é¢˜ã€‚å¯¹äºæŸäº›ä»¥ç±»å‹ç½‘ç«™æ¥è¯´ï¼Œåœ¨è¿™æ–¹é¢è¿›è¡Œå†’é™©æ˜¯å¾ˆä¸åˆ’ç®—çš„ã€‚</li>
<li>å…³äºé¡µé¢æ•°é‡çš„å°è±¡ï¼š<br>å…¶å®ç«™åœ¨ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸€ç‚¹å¹¶éè´Ÿé¢;ä¸è¿‡ï¼Œå¦‚æœå¯¹äºä½ çš„ç½‘ç«™æ¥è¯´ï¼Œé€šè¿‡æ›´å¤šçš„å†…å®¹é¡µé¢å±•ç¤ºæ›´å¤šçš„ç›¸å…³ä¿¡æ¯(åŒ…æ‹¬å¹¿å‘Š)æ˜¯å¾ˆé‡è¦çš„ç­–ç•¥ï¼Œé‚£ä¹ˆå•é¡µæ— é™æ»šåŠ¨çš„æ–¹å¼å¯¹ä½ å¹¶ä¸é€‚ç”¨ã€‚</li>
</ol>
<h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p> <a href="https://microzz.com/2017/02/17/waterfalljs/">åŸç”ŸJavaScriptå®ç°ç€‘å¸ƒæµå¸ƒå±€</a><br> <a href="https://microzz.com/2017/02/19/waterfallcss3/">CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot;&gt;&lt;a href=&quot;#jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot; class=&quot;headerlink&quot; title=&quot;jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot;&gt;&lt;/a&gt;jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&lt;/h1&gt;&lt;h2 id=&quot;ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ&quot;&gt;&lt;a h
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="waterfall" scheme="http://microzz.com/tags/waterfall/"/>
    
      <category term="ç€‘å¸ƒæµ" scheme="http://microzz.com/tags/%E7%80%91%E5%B8%83%E6%B5%81/"/>
    
      <category term="jQuery" scheme="http://microzz.com/tags/jQuery/"/>
    
  </entry>
  
  <entry>
    <title>CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</title>
    <link href="http://microzz.com/2017/02/19/waterfallcss3/"/>
    <id>http://microzz.com/2017/02/19/waterfallcss3/</id>
    <published>2017-02-19T11:30:02.000Z</published>
    <updated>2017-02-20T14:10:38.466Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€"><a href="#CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€" class="headerlink" title="CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€"></a>CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</h1><h2 id="ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ"><a href="#ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ"></a>ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ</h2><p>ç€‘å¸ƒæµï¼Œåˆç§°ç€‘å¸ƒæµå¼å¸ƒå±€ã€‚æ˜¯æ¯”è¾ƒæµè¡Œçš„ä¸€ç§ç½‘ç«™é¡µé¢å¸ƒå±€ï¼Œè§†è§‰è¡¨ç°ä¸ºå‚å·®ä¸é½çš„å¤šæ å¸ƒå±€ï¼Œéšç€é¡µé¢æ»šåŠ¨æ¡å‘ä¸‹æ»šåŠ¨ï¼Œè¿™ç§å¸ƒå±€è¿˜ä¼šä¸æ–­åŠ è½½æ•°æ®å—å¹¶é™„åŠ è‡³å½“å‰å°¾éƒ¨ã€‚æœ€æ—©é‡‡ç”¨æ­¤å¸ƒå±€çš„ç½‘ç«™æ˜¯Pinterestï¼Œé€æ¸åœ¨å›½å†…æµè¡Œå¼€æ¥ã€‚å›½å†…å¤§å¤šæ•°æ¸…æ–°ç«™åŸºæœ¬ä¸ºè¿™ç±»é£æ ¼ã€‚</p>
<h2 id="ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹"><a href="#ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹"></a>ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹</h2><ol>
<li>ç³ç…æ»¡ç›®ï¼šæ•´ç‰ˆä»¥å›¾ç‰‡ä¸ºä¸»ï¼Œå¤§å°ä¸ä¸€çš„å›¾ç‰‡æŒ‰ç…§ä¸€å®šçš„è§„å¾‹æ’åˆ—ã€‚</li>
<li>å”¯ç¾ï¼šå›¾ç‰‡çš„é£æ ¼ä»¥å”¯ç¾çš„å›¾ç‰‡ä¸ºä¸»ã€‚</li>
<li>æ“ä½œç®€å•ï¼šåœ¨æµè§ˆç½‘ç«™çš„æ—¶å€™åªéœ€è¦è½»è½»æ»‘åŠ¨ä¸€ä¸‹é¼ æ ‡æ»šè½®ï¼Œä¸€åˆ‡çš„ç¾å¦™çš„å›¾ç‰‡ç²¾å½©ä¾¿å¯å‘ˆç°åœ¨ä½ é¢å‰ã€‚</li>
</ol>
<h2 id="æ•ˆæœé¢„è§ˆ"><a href="#æ•ˆæœé¢„è§ˆ" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h2><p> åœ¨çº¿é¢„è§ˆåœ°å€1ï¼š ğŸ”—<a href="http://microzz.cn/waterfall-css3/" target="_blank" rel="external">http://microzz.cn/waterfall-css3/</a><br> åœ¨çº¿é¢„è§ˆåœ°å€2ï¼š ğŸ”—<a href="https://microzz.github.io/waterfall-css3/" target="_blank" rel="external">https://microzz.github.io/waterfall-css3/</a></p>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>æºä»£ç åœ°å€ï¼šğŸ”—<a href="https://github.com/microzz/waterfall-css3" target="_blank" rel="external">https://github.com/microzz/waterfall-css3</a></p>
<h2 id="ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹"><a href="#ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹"></a>ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹</h2><h3 id="å¸ƒå±€ä¼˜ç‚¹"><a href="#å¸ƒå±€ä¼˜ç‚¹" class="headerlink" title="å¸ƒå±€ä¼˜ç‚¹"></a>å¸ƒå±€ä¼˜ç‚¹</h3><ol>
<li>æœ‰æ•ˆçš„é™ä½äº†ç•Œé¢å¤æ‚åº¦ï¼ŒèŠ‚çœäº†ç©ºé—´ï¼šæˆ‘ä»¬ä¸å†éœ€è¦è‡ƒè‚¿å¤æ‚çš„é¡µç å¯¼èˆªé“¾æ¥æˆ–æŒ‰é’®äº†ã€‚</li>
<li>å¯¹è§¦å±è®¾å¤‡æ¥è¯´ï¼Œäº¤äº’æ–¹å¼æ›´ç¬¦åˆç›´è§‰ï¼šåœ¨ç§»åŠ¨åº”ç”¨çš„äº¤äº’ç¯å¢ƒå½“ä¸­ï¼Œé€šè¿‡å‘ä¸Šæ»‘åŠ¨è¿›è¡Œæ»šå±çš„æ“ä½œå·²ç»æˆä¸ºæœ€åŸºæœ¬çš„ç”¨æˆ·ä¹ æƒ¯ï¼Œè€Œä¸”æ‰€éœ€è¦çš„æ“ä½œç²¾å‡†ç¨‹åº¦è¿œè¿œä½äºç‚¹å‡»é“¾æ¥æˆ–æŒ‰é’®ã€‚</li>
<li>æ›´é«˜çš„å‚ä¸åº¦ï¼šä»¥ä¸Šä¸¤ç‚¹æ‰€å¸¦æ¥çš„äº¤äº’ä¾¿æ·æ€§å¯ä»¥ä½¿ç”¨æˆ·å°†æ³¨æ„åŠ›æ›´å¤šçš„é›†ä¸­åœ¨å†…å®¹è€Œä¸æ˜¯æ“ä½œä¸Šï¼Œä»è€Œè®©ä»–ä»¬æ›´ä¹äºæ²‰æµ¸åœ¨æ¢ç´¢ä¸æµè§ˆå½“ä¸­ã€‚<h3 id="å¸ƒå±€ç¼ºç‚¹"><a href="#å¸ƒå±€ç¼ºç‚¹" class="headerlink" title="å¸ƒå±€ç¼ºç‚¹"></a>å¸ƒå±€ç¼ºç‚¹</h3></li>
<li>æœ‰é™çš„ç”¨ä¾‹ï¼š<br>æ— é™æ»šåŠ¨çš„æ–¹å¼åªé€‚ç”¨äºæŸäº›ç‰¹å®šç±»å‹äº§å“å½“ä¸­ä¸€éƒ¨åˆ†ç‰¹å®šç±»å‹çš„å†…å®¹ã€‚<br>ä¾‹å¦‚ï¼Œåœ¨ç”µå•†ç½‘ç«™å½“ä¸­ï¼Œç”¨æˆ·æ—¶å¸¸éœ€è¦åœ¨å•†å“åˆ—è¡¨ä¸è¯¦æƒ…é¡µé¢ä¹‹é—´åˆ‡æ¢ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¼ ç»Ÿçš„ã€å¸¦æœ‰é¡µç å¯¼èˆªçš„æ–¹å¼å¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´ç¨³å¦¥å’Œå‡†ç¡®çš„å›åˆ°æŸä¸ªç‰¹å®šçš„åˆ—è¡¨é¡µé¢å½“ä¸­ã€‚</li>
<li>é¢å¤–çš„å¤æ‚åº¦ï¼š<br>é‚£äº›ç”¨æ¥æ‰“é€ æ— é™æ»šåŠ¨çš„JSåº“è™½ç„¶éƒ½è‡ªç§°å¾ˆå®¹æ˜“ä½¿ç”¨ï¼Œä½†ä½ æ€»ä¼šéœ€è¦åœ¨è‡ªå·±çš„äº§å“ä¸­è¿›è¡Œä¸åŒç¨‹åº¦çš„å®šåˆ¶åŒ–å¤„ç†ï¼Œä»¥æ»¡è¶³ä½ ä»¬è‡ªå·±çš„éœ€æ±‚;å¦å¤–è¿™äº›JSåº“åœ¨æµè§ˆå™¨å’Œè®¾å¤‡å…¼å®¹æ€§ç­‰æ–¹é¢çš„è¡¨ç°ä¹Ÿå‚å·®ä¸é½ï¼Œä½ å¿…é¡»åšå¥½å……åˆ†çš„æµ‹è¯•ä¸è°ƒæ•´å·¥ä½œã€‚</li>
<li>å†è§äº†ï¼Œé¡µè„šï¼š<br>å¦‚æœä½¿ç”¨äº†æ¯”è¾ƒå…¸å‹çš„æ— é™æ»šåŠ¨åŠ è½½æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ä½ å¯ä»¥å’Œé¡µè„šè¯´æ‹œæ‹œäº†ã€‚<br>æœ€å¥½è€ƒè™‘ä¸€ä¸‹é¡µè„šå¯¹äºä½ çš„ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯ç”¨æˆ·çš„é‡è¦æ€§;å¦‚æœå…¶ä¸­ç¡®å®æœ‰æ¯”è¾ƒé‡è¦çš„å†…å®¹æˆ–é“¾æ¥ï¼Œé‚£ä¹ˆæœ€å¥½æ¢ä¸€ç§æ›´ä¼ ç»Ÿå’Œç¨³å¦¥çš„æ–¹å¼ã€‚<br>åƒä¸‡ä¸è¦è€å¼„ä½ çš„ç”¨æˆ·ï¼Œå½“ä»–ä»¬ä¸€æ¬¡æ¬¡çš„æµè§ˆåˆ°é¡µé¢åº•éƒ¨ï¼Œçœ‹åˆ°é¡µè„šï¼Œå´å› ä¸ºè‡ªåŠ¨åŠ è½½çš„å†…å®¹çªç„¶å‡ºç°è€Œæ— è®ºå¦‚ä½•éƒ½æ— æ³•ç‚¹å‡»é¡µè„šä¸­çš„é“¾æ¥æ—¶ï¼Œä»–ä»¬ä¼šå˜çš„è¶Šå‘æ„¤æ€’ã€‚</li>
<li>SEOï¼š<br>é›†ä¸­åœ¨ä¸€é¡µå½“ä¸­åŠ¨æ€åŠ è½½æ•°æ®ï¼Œä¸ä¸€é¡µä¸€é¡µçš„è¾“å‡ºç›¸æ¯”ï¼Œç©¶ç«Ÿé‚£ç§æ–¹å¼æ›´åˆ©äºSEOï¼Œè¿™æ˜¯ä½ å¿…é¡»è€ƒè™‘çš„é—®é¢˜ã€‚å¯¹äºæŸäº›ä»¥ç±»å‹ç½‘ç«™æ¥è¯´ï¼Œåœ¨è¿™æ–¹é¢è¿›è¡Œå†’é™©æ˜¯å¾ˆä¸åˆ’ç®—çš„ã€‚</li>
<li>å…³äºé¡µé¢æ•°é‡çš„å°è±¡ï¼š<br>å…¶å®ç«™åœ¨ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸€ç‚¹å¹¶éè´Ÿé¢;ä¸è¿‡ï¼Œå¦‚æœå¯¹äºä½ çš„ç½‘ç«™æ¥è¯´ï¼Œé€šè¿‡æ›´å¤šçš„å†…å®¹é¡µé¢å±•ç¤ºæ›´å¤šçš„ç›¸å…³ä¿¡æ¯(åŒ…æ‹¬å¹¿å‘Š)æ˜¯å¾ˆé‡è¦çš„ç­–ç•¥ï¼Œé‚£ä¹ˆå•é¡µæ— é™æ»šåŠ¨çš„æ–¹å¼å¯¹ä½ å¹¶ä¸é€‚ç”¨ã€‚</li>
</ol>
<h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p> <a href="https://microzz.com/2017/02/17/waterfalljs/">åŸç”ŸJavaScriptå®ç°ç€‘å¸ƒæµå¸ƒå±€</a><br><a href="https://microzz.com/2017/02/20/waterfalljq/">jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot;&gt;&lt;a href=&quot;#CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot; class=&quot;headerlink&quot; title=&quot;CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot;&gt;&lt;/a&gt;CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&lt;/h1&gt;&lt;h2 id=&quot;ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ&quot;&gt;&lt;a href=&quot;#ç€‘å¸ƒ
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="CSS3" scheme="http://microzz.com/tags/CSS3/"/>
    
      <category term="waterfall" scheme="http://microzz.com/tags/waterfall/"/>
    
      <category term="ç€‘å¸ƒæµ" scheme="http://microzz.com/tags/%E7%80%91%E5%B8%83%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>åŸç”ŸJavaScriptå®ç°ç€‘å¸ƒæµå¸ƒå±€</title>
    <link href="http://microzz.com/2017/02/17/waterfalljs/"/>
    <id>http://microzz.com/2017/02/17/waterfalljs/</id>
    <published>2017-02-17T09:35:03.000Z</published>
    <updated>2017-02-20T14:11:36.711Z</updated>
    
    <content type="html"><![CDATA[<h1 id="åŸç”ŸJavaScriptå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€"><a href="#åŸç”ŸJavaScriptå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€" class="headerlink" title="åŸç”ŸJavaScriptå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€"></a>åŸç”ŸJavaScriptå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</h1><h2 id="ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ"><a href="#ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ"></a>ç€‘å¸ƒæµå¸ƒå±€æ¦‚å¿µ</h2><p>ç€‘å¸ƒæµï¼Œåˆç§°ç€‘å¸ƒæµå¼å¸ƒå±€ã€‚æ˜¯æ¯”è¾ƒæµè¡Œçš„ä¸€ç§ç½‘ç«™é¡µé¢å¸ƒå±€ï¼Œè§†è§‰è¡¨ç°ä¸ºå‚å·®ä¸é½çš„å¤šæ å¸ƒå±€ï¼Œéšç€é¡µé¢æ»šåŠ¨æ¡å‘ä¸‹æ»šåŠ¨ï¼Œè¿™ç§å¸ƒå±€è¿˜ä¼šä¸æ–­åŠ è½½æ•°æ®å—å¹¶é™„åŠ è‡³å½“å‰å°¾éƒ¨ã€‚æœ€æ—©é‡‡ç”¨æ­¤å¸ƒå±€çš„ç½‘ç«™æ˜¯Pinterestï¼Œé€æ¸åœ¨å›½å†…æµè¡Œå¼€æ¥ã€‚å›½å†…å¤§å¤šæ•°æ¸…æ–°ç«™åŸºæœ¬ä¸ºè¿™ç±»é£æ ¼ã€‚</p>
<h2 id="ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹"><a href="#ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹"></a>ç€‘å¸ƒæµå¸ƒå±€ç‰¹ç‚¹</h2><ol>
<li>ç³ç…æ»¡ç›®ï¼šæ•´ç‰ˆä»¥å›¾ç‰‡ä¸ºä¸»ï¼Œå¤§å°ä¸ä¸€çš„å›¾ç‰‡æŒ‰ç…§ä¸€å®šçš„è§„å¾‹æ’åˆ—ã€‚</li>
<li>å”¯ç¾ï¼šå›¾ç‰‡çš„é£æ ¼ä»¥å”¯ç¾çš„å›¾ç‰‡ä¸ºä¸»ã€‚</li>
<li>æ“ä½œç®€å•ï¼šåœ¨æµè§ˆç½‘ç«™çš„æ—¶å€™åªéœ€è¦è½»è½»æ»‘åŠ¨ä¸€ä¸‹é¼ æ ‡æ»šè½®ï¼Œä¸€åˆ‡çš„ç¾å¦™çš„å›¾ç‰‡ç²¾å½©ä¾¿å¯å‘ˆç°åœ¨ä½ é¢å‰ã€‚</li>
</ol>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><p>æºä»£ç åœ°å€ï¼šğŸ”—<a href="https://github.com/microzz/waterfall-js" target="_blank" rel="external">https://github.com/microzz/waterfall-js</a></p>
<h2 id="æ•ˆæœé¢„è§ˆ"><a href="#æ•ˆæœé¢„è§ˆ" class="headerlink" title="æ•ˆæœé¢„è§ˆ"></a>æ•ˆæœé¢„è§ˆ</h2><p> åœ¨çº¿é¢„è§ˆåœ°å€1ï¼š ğŸ”—<a href="http://microzz.cn/waterfall/" target="_blank" rel="external">http://microzz.cn/waterfall/</a><br> åœ¨çº¿é¢„è§ˆåœ°å€2ï¼š ğŸ”—<a href="https://microzz.github.io/waterfall-js/" target="_blank" rel="external">https://microzz.github.io/waterfall-js/</a></p>
<h2 id="ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹"><a href="#ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹" class="headerlink" title="ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹"></a>ç€‘å¸ƒæµå¸ƒå±€ä¼˜ç¼ºç‚¹</h2><h3 id="å¸ƒå±€ä¼˜ç‚¹"><a href="#å¸ƒå±€ä¼˜ç‚¹" class="headerlink" title="å¸ƒå±€ä¼˜ç‚¹"></a>å¸ƒå±€ä¼˜ç‚¹</h3><ol>
<li>æœ‰æ•ˆçš„é™ä½äº†ç•Œé¢å¤æ‚åº¦ï¼ŒèŠ‚çœäº†ç©ºé—´ï¼šæˆ‘ä»¬ä¸å†éœ€è¦è‡ƒè‚¿å¤æ‚çš„é¡µç å¯¼èˆªé“¾æ¥æˆ–æŒ‰é’®äº†ã€‚</li>
<li>å¯¹è§¦å±è®¾å¤‡æ¥è¯´ï¼Œäº¤äº’æ–¹å¼æ›´ç¬¦åˆç›´è§‰ï¼šåœ¨ç§»åŠ¨åº”ç”¨çš„äº¤äº’ç¯å¢ƒå½“ä¸­ï¼Œé€šè¿‡å‘ä¸Šæ»‘åŠ¨è¿›è¡Œæ»šå±çš„æ“ä½œå·²ç»æˆä¸ºæœ€åŸºæœ¬çš„ç”¨æˆ·ä¹ æƒ¯ï¼Œè€Œä¸”æ‰€éœ€è¦çš„æ“ä½œç²¾å‡†ç¨‹åº¦è¿œè¿œä½äºç‚¹å‡»é“¾æ¥æˆ–æŒ‰é’®ã€‚</li>
<li>æ›´é«˜çš„å‚ä¸åº¦ï¼šä»¥ä¸Šä¸¤ç‚¹æ‰€å¸¦æ¥çš„äº¤äº’ä¾¿æ·æ€§å¯ä»¥ä½¿ç”¨æˆ·å°†æ³¨æ„åŠ›æ›´å¤šçš„é›†ä¸­åœ¨å†…å®¹è€Œä¸æ˜¯æ“ä½œä¸Šï¼Œä»è€Œè®©ä»–ä»¬æ›´ä¹äºæ²‰æµ¸åœ¨æ¢ç´¢ä¸æµè§ˆå½“ä¸­ã€‚<h3 id="å¸ƒå±€ç¼ºç‚¹"><a href="#å¸ƒå±€ç¼ºç‚¹" class="headerlink" title="å¸ƒå±€ç¼ºç‚¹"></a>å¸ƒå±€ç¼ºç‚¹</h3></li>
<li>æœ‰é™çš„ç”¨ä¾‹ï¼š<br>æ— é™æ»šåŠ¨çš„æ–¹å¼åªé€‚ç”¨äºæŸäº›ç‰¹å®šç±»å‹äº§å“å½“ä¸­ä¸€éƒ¨åˆ†ç‰¹å®šç±»å‹çš„å†…å®¹ã€‚<br>ä¾‹å¦‚ï¼Œåœ¨ç”µå•†ç½‘ç«™å½“ä¸­ï¼Œç”¨æˆ·æ—¶å¸¸éœ€è¦åœ¨å•†å“åˆ—è¡¨ä¸è¯¦æƒ…é¡µé¢ä¹‹é—´åˆ‡æ¢ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œä¼ ç»Ÿçš„ã€å¸¦æœ‰é¡µç å¯¼èˆªçš„æ–¹å¼å¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´ç¨³å¦¥å’Œå‡†ç¡®çš„å›åˆ°æŸä¸ªç‰¹å®šçš„åˆ—è¡¨é¡µé¢å½“ä¸­ã€‚</li>
<li>é¢å¤–çš„å¤æ‚åº¦ï¼š<br>é‚£äº›ç”¨æ¥æ‰“é€ æ— é™æ»šåŠ¨çš„JSåº“è™½ç„¶éƒ½è‡ªç§°å¾ˆå®¹æ˜“ä½¿ç”¨ï¼Œä½†ä½ æ€»ä¼šéœ€è¦åœ¨è‡ªå·±çš„äº§å“ä¸­è¿›è¡Œä¸åŒç¨‹åº¦çš„å®šåˆ¶åŒ–å¤„ç†ï¼Œä»¥æ»¡è¶³ä½ ä»¬è‡ªå·±çš„éœ€æ±‚;å¦å¤–è¿™äº›JSåº“åœ¨æµè§ˆå™¨å’Œè®¾å¤‡å…¼å®¹æ€§ç­‰æ–¹é¢çš„è¡¨ç°ä¹Ÿå‚å·®ä¸é½ï¼Œä½ å¿…é¡»åšå¥½å……åˆ†çš„æµ‹è¯•ä¸è°ƒæ•´å·¥ä½œã€‚</li>
<li>å†è§äº†ï¼Œé¡µè„šï¼š<br>å¦‚æœä½¿ç”¨äº†æ¯”è¾ƒå…¸å‹çš„æ— é™æ»šåŠ¨åŠ è½½æ¨¡å¼ï¼Œè¿™å°±æ„å‘³ç€ä½ å¯ä»¥å’Œé¡µè„šè¯´æ‹œæ‹œäº†ã€‚<br>æœ€å¥½è€ƒè™‘ä¸€ä¸‹é¡µè„šå¯¹äºä½ çš„ç½‘ç«™ï¼Œç‰¹åˆ«æ˜¯ç”¨æˆ·çš„é‡è¦æ€§;å¦‚æœå…¶ä¸­ç¡®å®æœ‰æ¯”è¾ƒé‡è¦çš„å†…å®¹æˆ–é“¾æ¥ï¼Œé‚£ä¹ˆæœ€å¥½æ¢ä¸€ç§æ›´ä¼ ç»Ÿå’Œç¨³å¦¥çš„æ–¹å¼ã€‚<br>åƒä¸‡ä¸è¦è€å¼„ä½ çš„ç”¨æˆ·ï¼Œå½“ä»–ä»¬ä¸€æ¬¡æ¬¡çš„æµè§ˆåˆ°é¡µé¢åº•éƒ¨ï¼Œçœ‹åˆ°é¡µè„šï¼Œå´å› ä¸ºè‡ªåŠ¨åŠ è½½çš„å†…å®¹çªç„¶å‡ºç°è€Œæ— è®ºå¦‚ä½•éƒ½æ— æ³•ç‚¹å‡»é¡µè„šä¸­çš„é“¾æ¥æ—¶ï¼Œä»–ä»¬ä¼šå˜çš„è¶Šå‘æ„¤æ€’ã€‚</li>
<li>SEOï¼š<br>é›†ä¸­åœ¨ä¸€é¡µå½“ä¸­åŠ¨æ€åŠ è½½æ•°æ®ï¼Œä¸ä¸€é¡µä¸€é¡µçš„è¾“å‡ºç›¸æ¯”ï¼Œç©¶ç«Ÿé‚£ç§æ–¹å¼æ›´åˆ©äºSEOï¼Œè¿™æ˜¯ä½ å¿…é¡»è€ƒè™‘çš„é—®é¢˜ã€‚å¯¹äºæŸäº›ä»¥ç±»å‹ç½‘ç«™æ¥è¯´ï¼Œåœ¨è¿™æ–¹é¢è¿›è¡Œå†’é™©æ˜¯å¾ˆä¸åˆ’ç®—çš„ã€‚</li>
<li>å…³äºé¡µé¢æ•°é‡çš„å°è±¡ï¼š<br>å…¶å®ç«™åœ¨ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸€ç‚¹å¹¶éè´Ÿé¢;ä¸è¿‡ï¼Œå¦‚æœå¯¹äºä½ çš„ç½‘ç«™æ¥è¯´ï¼Œé€šè¿‡æ›´å¤šçš„å†…å®¹é¡µé¢å±•ç¤ºæ›´å¤šçš„ç›¸å…³ä¿¡æ¯(åŒ…æ‹¬å¹¿å‘Š)æ˜¯å¾ˆé‡è¦çš„ç­–ç•¥ï¼Œé‚£ä¹ˆå•é¡µæ— é™æ»šåŠ¨çš„æ–¹å¼å¯¹ä½ å¹¶ä¸é€‚ç”¨ã€‚</li>
</ol>
<h2 id="ç›¸å…³é“¾æ¥"><a href="#ç›¸å…³é“¾æ¥" class="headerlink" title="ç›¸å…³é“¾æ¥"></a>ç›¸å…³é“¾æ¥</h2><p> <a href="https://microzz.com/2017/02/19/waterfallcss3/">CSS3å®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</a><br><a href="https://microzz.com/2017/02/20/waterfalljq/">jQueryå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;åŸç”ŸJavaScriptå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot;&gt;&lt;a href=&quot;#åŸç”ŸJavaScriptå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot; class=&quot;headerlink&quot; title=&quot;åŸç”ŸJavaScriptå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&quot;&gt;&lt;/a&gt;åŸç”ŸJavaScriptå®ç°ä¸€ä¸ªç€‘å¸ƒæµå¸ƒå±€&lt;/
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="waterfall" scheme="http://microzz.com/tags/waterfall/"/>
    
      <category term="ç€‘å¸ƒæµ" scheme="http://microzz.com/tags/%E7%80%91%E5%B8%83%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>Node.jså®ç°ä¸€ä¸ªå°çˆ¬è™«</title>
    <link href="http://microzz.com/2017/02/14/crawler/"/>
    <id>http://microzz.com/2017/02/14/crawler/</id>
    <published>2017-02-14T08:33:13.000Z</published>
    <updated>2017-02-24T13:52:06.629Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Node-jså®ç°ä¸€ä¸ªå°çˆ¬è™«"><a href="#Node-jså®ç°ä¸€ä¸ªå°çˆ¬è™«" class="headerlink" title="Node.jså®ç°ä¸€ä¸ªå°çˆ¬è™«"></a>Node.jså®ç°ä¸€ä¸ªå°çˆ¬è™«</h1><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>æˆ‘ä»¬å°†ç”¨æœ€ç®€å•çš„ä»£ç å®ç°ä¸€ä¸ªç®€å•çš„å°çˆ¬è™«ã€‚æœ¬ç¤ºä¾‹é‡‡ç”¨ES6å†™æ³•ã€‚é¦–å…ˆæˆ‘ä»¬è¦å®‰è£…ç¬¬ä¸‰æ–¹cheerioæ¨¡å—ï¼Œåœ¨é¡¹ç›®ç›®å½•ä½¿ç”¨<code>npm install cheerio --save</code> å‘½ä»¤å³å¯ã€‚åœ¨æ–‡ä»¶ä¸­æˆ‘ä»¬éœ€è¦å¼•å…¥å¦‚ä¸‹æ¨¡å—ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:center">æ¨¡å—å</th>
<th style="text-align:center">ä½œç”¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">cheerio</td>
<td style="text-align:center">ç±»ä¼¼jQueryï¼Œæ–¹ä¾¿å¯¹DOMå†…å®¹æ“ä½œ</td>
</tr>
<tr>
<td style="text-align:center">https</td>
<td style="text-align:center">é’ˆå¯¹httpsåè®®ï¼Œhttpæ¨¡å—ç”¨æ³•ç±»ä¼¼</td>
</tr>
</tbody>
</table>
<h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¼•å…¥æ¨¡å—</span></div><div class="line"><span class="keyword">const</span> https = <span class="built_in">require</span>(<span class="string">'https'</span>);</div><div class="line"><span class="keyword">const</span> cheerio = <span class="built_in">require</span>(<span class="string">'cheerio'</span>);</div><div class="line"></div><div class="line"><span class="comment">// çˆ¬å–ç›®æ ‡ç½‘ç«™URL</span></div><div class="line"><span class="keyword">let</span> url = <span class="string">'https://microzz.com'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ä½¿ç”¨getæ–¹æ³•è®¿é—®</span></div><div class="line">https.get(url, res =&gt; &#123;</div><div class="line">  <span class="keyword">let</span> html = <span class="string">''</span>;</div><div class="line">  </div><div class="line">  <span class="comment">// ç›‘å¬dataäº‹ä»¶è·å–htmlæºç </span></div><div class="line">  res.on(<span class="string">'data'</span>, data =&gt; &#123;</div><div class="line">    html += data;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line"> <span class="comment">// ç›‘å¬endäº‹ä»¶ï¼ŒåŒæ—¶æŠŠè·å–åˆ°çš„æ•°æ®ä¼ ç»™filterDataæ–¹æ³•è¿›è¡Œè¿‡æ»¤</span></div><div class="line">  res.on(<span class="string">'end'</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">let</span> titles = filterData(html);</div><div class="line">    <span class="built_in">console</span>.log(titles);</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">&#125;).on(<span class="string">'error'</span>, e =&gt; &#123;</div><div class="line">  <span class="built_in">console</span>.log(e.message);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// ä½¿ç”¨cheerioæ¨¡å—å¯¹å†…å®¹è¿›è¡Œç­›é€‰è¿‡æ»¤</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">filterData</span>(<span class="params">html</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> $ = cheerio.load(html);</div><div class="line">  <span class="keyword">let</span> oTitles = $(<span class="string">'.post-title-link'</span>);</div><div class="line">  <span class="keyword">let</span> titles = <span class="string">''</span>;</div><div class="line"></div><div class="line">  oTitles.each( <span class="function">(<span class="params">index, item</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">let</span> title = $(item).text();</div><div class="line">    <span class="keyword">let</span> end = index == (oTitles.length - <span class="number">1</span>) ? <span class="string">''</span> : <span class="string">'\n'</span>;</div><div class="line">    titles += <span class="string">'ã€'</span> + (index+<span class="number">1</span>) + <span class="string">'ã€‘'</span> + title + end;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> titles;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è‡³æ­¤ä¸€ä¸ªç®€å•çš„çˆ¬å– <a href="https://microzz.com">https://microzz.com</a> æ–‡ç« å†…å®¹æ ‡é¢˜çš„å°çˆ¬è™«å°±å®Œæˆå•¦ğŸ˜„</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Node-jså®ç°ä¸€ä¸ªå°çˆ¬è™«&quot;&gt;&lt;a href=&quot;#Node-jså®ç°ä¸€ä¸ªå°çˆ¬è™«&quot; class=&quot;headerlink&quot; title=&quot;Node.jså®ç°ä¸€ä¸ªå°çˆ¬è™«&quot;&gt;&lt;/a&gt;Node.jså®ç°ä¸€ä¸ªå°çˆ¬è™«&lt;/h1&gt;&lt;h2 id=&quot;åˆ†æ&quot;&gt;&lt;a href=&quot;#åˆ†æ&quot;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Nodejs" scheme="http://microzz.com/tags/Nodejs/"/>
    
      <category term="çˆ¬è™«" scheme="http://microzz.com/tags/%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>npm scripts ä½¿ç”¨æŒ‡å—</title>
    <link href="http://microzz.com/2017/02/13/npm-scripts/"/>
    <id>http://microzz.com/2017/02/13/npm-scripts/</id>
    <published>2017-02-13T11:51:28.000Z</published>
    <updated>2017-02-13T12:23:32.975Z</updated>
    
    <content type="html"><![CDATA[<h1 id="npm-scripts-ä½¿ç”¨æŒ‡å—"><a href="#npm-scripts-ä½¿ç”¨æŒ‡å—" class="headerlink" title="npm scripts ä½¿ç”¨æŒ‡å—"></a>npm scripts ä½¿ç”¨æŒ‡å—</h1><blockquote>
<p>&nbsp;&nbsp;&nbsp;Node å¼€å‘ç¦»ä¸å¼€ npmï¼Œè€Œè„šæœ¬åŠŸèƒ½æ˜¯ npm æœ€å¼ºå¤§ã€æœ€å¸¸ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ã€‚<br>æœ¬æ–‡ä»‹ç»å¦‚ä½•ä½¿ç”¨ npm è„šæœ¬ï¼ˆnpm scriptsï¼‰ã€‚</p>
</blockquote>
<h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯-npm-è„šæœ¬ï¼Ÿ"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯-npm-è„šæœ¬ï¼Ÿ" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯ npm è„šæœ¬ï¼Ÿ"></a>ä¸€ã€ä»€ä¹ˆæ˜¯ npm è„šæœ¬ï¼Ÿ</h2><p><code>npm</code> å…è®¸åœ¨package.jsonæ–‡ä»¶é‡Œé¢ï¼Œä½¿ç”¨scriptså­—æ®µå®šä¹‰è„šæœ¬å‘½ä»¤ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  // ...</div><div class="line">  "scripts": &#123;</div><div class="line">    "build": "node build.js"</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯package.jsonæ–‡ä»¶çš„ä¸€ä¸ªç‰‡æ®µï¼Œé‡Œé¢çš„scriptså­—æ®µæ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å®ƒçš„æ¯ä¸€ä¸ªå±æ€§ï¼Œå¯¹åº”ä¸€æ®µè„šæœ¬ã€‚æ¯”å¦‚ï¼Œ<code>build</code>å‘½ä»¤å¯¹åº”çš„è„šæœ¬æ˜¯<code>node build.js</code>ã€‚<br>å‘½ä»¤è¡Œä¸‹ä½¿ç”¨<code>npm run</code>å‘½ä»¤ï¼Œå°±å¯ä»¥æ‰§è¡Œè¿™æ®µè„šæœ¬ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ npm run build</div><div class="line"># ç­‰åŒäºæ‰§è¡Œ</div><div class="line">$ node build.js</div></pre></td></tr></table></figure>
<p>è¿™äº›å®šä¹‰åœ¨package.jsoné‡Œé¢çš„è„šæœ¬ï¼Œå°±ç§°ä¸º npm è„šæœ¬ã€‚å®ƒçš„ä¼˜ç‚¹å¾ˆå¤šã€‚<br>é¡¹ç›®çš„ç›¸å…³è„šæœ¬ï¼Œå¯ä»¥é›†ä¸­åœ¨ä¸€ä¸ªåœ°æ–¹ã€‚<br>ä¸åŒé¡¹ç›®çš„è„šæœ¬å‘½ä»¤ï¼Œåªè¦åŠŸèƒ½ç›¸åŒï¼Œå°±å¯ä»¥æœ‰åŒæ ·çš„å¯¹å¤–æ¥å£ã€‚ç”¨æˆ·ä¸éœ€è¦çŸ¥é“æ€ä¹ˆæµ‹è¯•ä½ çš„é¡¹ç›®ï¼Œåªè¦è¿è¡Œ<code>npm run test</code>å³å¯ã€‚<br>å¯ä»¥åˆ©ç”¨ npm æä¾›çš„å¾ˆå¤šè¾…åŠ©åŠŸèƒ½ã€‚<br>æŸ¥çœ‹å½“å‰é¡¹ç›®çš„æ‰€æœ‰ npm è„šæœ¬å‘½ä»¤ï¼Œå¯ä»¥ä½¿ç”¨ä¸å¸¦ä»»ä½•å‚æ•°çš„<code>npm run</code>å‘½ä»¤ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm run</div></pre></td></tr></table></figure>
<h2 id="äºŒã€åŸç†"><a href="#äºŒã€åŸç†" class="headerlink" title="äºŒã€åŸç†"></a>äºŒã€åŸç†</h2><p>npm è„šæœ¬çš„åŸç†éå¸¸ç®€å•ã€‚æ¯å½“æ‰§è¡Œ<code>npm run</code>ï¼Œå°±ä¼šè‡ªåŠ¨æ–°å»ºä¸€ä¸ª Shellï¼Œåœ¨è¿™ä¸ª Shell é‡Œé¢æ‰§è¡ŒæŒ‡å®šçš„è„šæœ¬å‘½ä»¤ã€‚å› æ­¤ï¼Œåªè¦æ˜¯ Shellï¼ˆä¸€èˆ¬æ˜¯ Bashï¼‰å¯ä»¥è¿è¡Œçš„å‘½ä»¤ï¼Œå°±å¯ä»¥å†™åœ¨ npm è„šæœ¬é‡Œé¢ã€‚<br>æ¯”è¾ƒç‰¹åˆ«çš„æ˜¯ï¼Œnpm runæ–°å»ºçš„è¿™ä¸ª Shellï¼Œä¼šå°†å½“å‰ç›®å½•çš„node_modules/.binå­ç›®å½•åŠ å…¥PATHå˜é‡ï¼Œæ‰§è¡Œç»“æŸåï¼Œå†å°†PATHå˜é‡æ¢å¤åŸæ ·ã€‚<br>è¿™æ„å‘³ç€ï¼Œå½“å‰ç›®å½•çš„node_modules/.binå­ç›®å½•é‡Œé¢çš„æ‰€æœ‰è„šæœ¬ï¼Œéƒ½å¯ä»¥ç›´æ¥ç”¨è„šæœ¬åè°ƒç”¨ï¼Œè€Œä¸å¿…åŠ ä¸Šè·¯å¾„ã€‚æ¯”å¦‚ï¼Œå½“å‰é¡¹ç›®çš„ä¾èµ–é‡Œé¢æœ‰ Mochaï¼Œåªè¦ç›´æ¥å†™<code>mocha test</code>å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">"test": "mocha test"</div></pre></td></tr></table></figure>
<p>è€Œä¸ç”¨å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">"test": "./node_modules/.bin/mocha test"</div></pre></td></tr></table></figure>
<p>ç”±äº npm è„šæœ¬çš„å”¯ä¸€è¦æ±‚å°±æ˜¯å¯ä»¥åœ¨ Shell æ‰§è¡Œï¼Œå› æ­¤å®ƒä¸ä¸€å®šæ˜¯ Node è„šæœ¬ï¼Œä»»ä½•å¯æ‰§è¡Œæ–‡ä»¶éƒ½å¯ä»¥å†™åœ¨é‡Œé¢ã€‚<br>npm è„šæœ¬çš„é€€å‡ºç ï¼Œä¹Ÿéµå®ˆ Shell è„šæœ¬è§„åˆ™ã€‚å¦‚æœé€€å‡ºç ä¸æ˜¯0ï¼Œnpm å°±è®¤ä¸ºè¿™ä¸ªè„šæœ¬æ‰§è¡Œå¤±è´¥ã€‚</p>
<h2 id="ä¸‰ã€é€šé…ç¬¦"><a href="#ä¸‰ã€é€šé…ç¬¦" class="headerlink" title="ä¸‰ã€é€šé…ç¬¦"></a>ä¸‰ã€é€šé…ç¬¦</h2><p>ç”±äº npm è„šæœ¬å°±æ˜¯ Shell è„šæœ¬ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ Shell é€šé…ç¬¦ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">"lint": "jshint *.js"</div><div class="line">"lint": "jshint **/*.js"</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<em>è¡¨ç¤ºä»»æ„æ–‡ä»¶åï¼Œ*</em>è¡¨ç¤ºä»»æ„ä¸€å±‚å­ç›®å½•ã€‚<br>å¦‚æœè¦å°†é€šé…ç¬¦ä¼ å…¥åŸå§‹å‘½ä»¤ï¼Œé˜²æ­¢è¢« Shell è½¬ä¹‰ï¼Œè¦å°†æ˜Ÿå·è½¬ä¹‰ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">"test": "tap test/\*.js"</div></pre></td></tr></table></figure>
<h2 id="å››ã€ä¼ å‚"><a href="#å››ã€ä¼ å‚" class="headerlink" title="å››ã€ä¼ å‚"></a>å››ã€ä¼ å‚</h2><p>å‘ npm è„šæœ¬ä¼ å…¥å‚æ•°ï¼Œè¦ä½¿ç”¨â€“æ ‡æ˜ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">"lint": "jshint **.js"</div></pre></td></tr></table></figure>
<p>å‘ä¸Šé¢çš„<code>npm run lint</code>å‘½ä»¤ä¼ å…¥å‚æ•°ï¼Œå¿…é¡»å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm run lint --  --reporter checkstyle &gt; checkstyle.xml</div></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥åœ¨package.jsoné‡Œé¢å†å°è£…ä¸€ä¸ªå‘½ä»¤ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">"lint": "jshint **.js",</div><div class="line">"lint:checkstyle": "npm run lint -- --reporter checkstyle &gt; checkstyle.xml"</div></pre></td></tr></table></figure>
<h2 id="äº”ã€æ‰§è¡Œé¡ºåº"><a href="#äº”ã€æ‰§è¡Œé¡ºåº" class="headerlink" title="äº”ã€æ‰§è¡Œé¡ºåº"></a>äº”ã€æ‰§è¡Œé¡ºåº</h2><p>å¦‚æœ npm è„šæœ¬é‡Œé¢éœ€è¦æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œé‚£ä¹ˆéœ€è¦æ˜ç¡®å®ƒä»¬çš„æ‰§è¡Œé¡ºåºã€‚<br>å¦‚æœæ˜¯å¹¶è¡Œæ‰§è¡Œï¼ˆå³åŒæ—¶çš„å¹³è¡Œæ‰§è¡Œï¼‰ï¼Œå¯ä»¥ä½¿ç”¨&amp;ç¬¦å·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm run script1.js &amp; npm run script2.js</div></pre></td></tr></table></figure>
<p>å¦‚æœæ˜¯ç»§å‘æ‰§è¡Œï¼ˆå³åªæœ‰å‰ä¸€ä¸ªä»»åŠ¡æˆåŠŸï¼Œæ‰æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨&amp;&amp;ç¬¦å·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm run script1.js &amp;&amp; npm run script2.js</div></pre></td></tr></table></figure>
<p>è¿™ä¸¤ä¸ªç¬¦å·æ˜¯ Bash çš„åŠŸèƒ½ã€‚æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ node çš„ä»»åŠ¡ç®¡ç†æ¨¡å—ï¼šscript-runnerã€npm-run-allã€redrunã€‚</p>
<h2 id="å…­ã€é»˜è®¤å€¼"><a href="#å…­ã€é»˜è®¤å€¼" class="headerlink" title="å…­ã€é»˜è®¤å€¼"></a>å…­ã€é»˜è®¤å€¼</h2><p>ä¸€èˆ¬æ¥è¯´ï¼Œnpm è„šæœ¬ç”±ç”¨æˆ·æä¾›ã€‚ä½†æ˜¯ï¼Œnpm å¯¹ä¸¤ä¸ªè„šæœ¬æä¾›äº†é»˜è®¤å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸¤ä¸ªè„šæœ¬ä¸ç”¨å®šä¹‰ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">"start": "node server.js"ï¼Œ</div><div class="line">"install": "node-gyp rebuild"</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>npm run start</code>çš„é»˜è®¤å€¼æ˜¯<code>node server.js</code>ï¼Œå‰ææ˜¯é¡¹ç›®æ ¹ç›®å½•ä¸‹æœ‰server.jsè¿™ä¸ªè„šæœ¬ï¼›<code>npm run install</code>çš„é»˜è®¤å€¼æ˜¯<code>node-gyp rebuild</code>ï¼Œå‰ææ˜¯é¡¹ç›®æ ¹ç›®å½•ä¸‹æœ‰binding.gypæ–‡ä»¶ã€‚</p>
<h2 id="ä¸ƒã€é’©å­"><a href="#ä¸ƒã€é’©å­" class="headerlink" title="ä¸ƒã€é’©å­"></a>ä¸ƒã€é’©å­</h2><p>npm è„šæœ¬æœ‰preå’Œpostä¸¤ä¸ªé’©å­ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ<code>build</code>è„šæœ¬å‘½ä»¤çš„é’©å­å°±æ˜¯prebuildå’Œpostbuildã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"prebuild": "echo I run before the build script",</div><div class="line">"build": "cross-env NODE_ENV=production webpack",</div><div class="line">"postbuild": "echo I run after the build script"</div></pre></td></tr></table></figure>
<p>ç”¨æˆ·æ‰§è¡Œ<code>npm run build</code>çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ‰§è¡Œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm run prebuild &amp;&amp; npm run build &amp;&amp; npm run postbuild</div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œå¯ä»¥åœ¨è¿™ä¸¤ä¸ªé’©å­é‡Œé¢ï¼Œå®Œæˆä¸€äº›å‡†å¤‡å·¥ä½œå’Œæ¸…ç†å·¥ä½œã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"clean": "rimraf ./dist &amp;&amp; mkdir dist",</div><div class="line">"prebuild": "npm run clean",</div><div class="line">"build": "cross-env NODE_ENV=production webpack"</div></pre></td></tr></table></figure>
<p>npm é»˜è®¤æä¾›ä¸‹é¢è¿™äº›é’©å­ã€‚</p>
<blockquote>
<p>prepublishï¼Œpostpublish<br>preinstallï¼Œpostinstall<br>preuninstallï¼Œpostuninstall<br>preversionï¼Œpostversion<br>pretestï¼Œposttest<br>prestopï¼Œpoststop<br>prestartï¼Œpoststart<br>prerestartï¼Œpostrestart</p>
</blockquote>
<p>è‡ªå®šä¹‰çš„è„šæœ¬å‘½ä»¤ä¹Ÿå¯ä»¥åŠ ä¸Špreå’Œposté’©å­ã€‚æ¯”å¦‚ï¼Œ<code>myscript</code>è¿™ä¸ªè„šæœ¬å‘½ä»¤ï¼Œä¹Ÿæœ‰premyscriptå’Œpostmyscripté’©å­ã€‚ä¸è¿‡ï¼ŒåŒé‡çš„preå’Œpostæ— æ•ˆï¼Œæ¯”å¦‚prepretestå’Œpostposttestæ˜¯æ— æ•ˆçš„ã€‚<br>npm æä¾›ä¸€ä¸ªnpm_lifecycle_eventå˜é‡ï¼Œè¿”å›å½“å‰æ­£åœ¨è¿è¡Œçš„è„šæœ¬åç§°ï¼Œæ¯”å¦‚pretestã€testã€posttestç­‰ç­‰ã€‚æ‰€ä»¥ï¼Œå¯ä»¥åˆ©ç”¨è¿™ä¸ªå˜é‡ï¼Œåœ¨åŒä¸€ä¸ªè„šæœ¬æ–‡ä»¶é‡Œé¢ï¼Œä¸ºä¸åŒçš„npm scriptså‘½ä»¤ç¼–å†™ä»£ç ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> TARGET = process.env.npm_lifecycle_event;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (TARGET === <span class="string">'test'</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`Running the test task!`</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (TARGET === <span class="string">'pretest'</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`Running the pretest task!`</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (TARGET === <span class="string">'posttest'</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`Running the posttest task!`</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œprepublishè¿™ä¸ªé’©å­ä¸ä»…ä¼šåœ¨npm publishå‘½ä»¤ä¹‹å‰è¿è¡Œï¼Œè¿˜ä¼šåœ¨<code>npm install</code>ï¼ˆä¸å¸¦ä»»ä½•å‚æ•°ï¼‰å‘½ä»¤ä¹‹å‰è¿è¡Œã€‚è¿™ç§è¡Œä¸ºå¾ˆå®¹æ˜“è®©ç”¨æˆ·æ„Ÿåˆ°å›°æƒ‘ï¼Œæ‰€ä»¥ npm 4 å¼•å…¥äº†ä¸€ä¸ªæ–°çš„é’©å­prepareï¼Œè¡Œä¸ºç­‰åŒäºprepublishï¼Œè€Œä» npm 5 å¼€å§‹ï¼Œprepublishå°†åªåœ¨npm publishå‘½ä»¤ä¹‹å‰è¿è¡Œã€‚</p>
<h2 id="å…«ã€ç®€å†™å½¢å¼"><a href="#å…«ã€ç®€å†™å½¢å¼" class="headerlink" title="å…«ã€ç®€å†™å½¢å¼"></a>å…«ã€ç®€å†™å½¢å¼</h2><p>å››ä¸ªå¸¸ç”¨çš„ npm è„šæœ¬æœ‰ç®€å†™å½¢å¼ã€‚<br><code>npm start</code>æ˜¯<code>npm run start</code><br><code>npm stop</code>æ˜¯<code>npm run stop</code>çš„ç®€å†™<br><code>npm test</code>æ˜¯<code>npm run test</code>çš„ç®€å†™<br><code>npm restart</code>æ˜¯<code>npm run stop &amp;&amp; npm run restart &amp;&amp; npm run start</code>çš„ç®€å†™<br><code>npm start</code>ã€<code>npm stop</code>å’Œ<code>npm test</code>éƒ½æ¯”è¾ƒå¥½ç†è§£ï¼Œè€Œ<code>npm restart</code>æ˜¯ä¸€ä¸ªå¤åˆå‘½ä»¤ï¼Œå®é™…ä¸Šä¼šæ‰§è¡Œä¸‰ä¸ªè„šæœ¬å‘½ä»¤ï¼š<code>stop</code>ã€<code>restart</code>ã€<code>start</code>ã€‚å…·ä½“çš„æ‰§è¡Œé¡ºåºå¦‚ä¸‹ã€‚<br><code>prerestart</code><br><code>prestop</code><br><code>stop</code><br><code>poststop</code><br><code>restart</code><br><code>prestart</code><br><code>start</code><br><code>poststart</code><br><code>postrestart</code></p>
<h2 id="ä¹ã€å˜é‡"><a href="#ä¹ã€å˜é‡" class="headerlink" title="ä¹ã€å˜é‡"></a>ä¹ã€å˜é‡</h2><p><code>npm</code> è„šæœ¬æœ‰ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå°±æ˜¯å¯ä»¥ä½¿ç”¨ npm çš„å†…éƒ¨å˜é‡ã€‚<br>é¦–å…ˆï¼Œé€šè¿‡npm<em>package</em>å‰ç¼€ï¼Œnpm è„šæœ¬å¯ä»¥æ‹¿åˆ°package.jsoné‡Œé¢çš„å­—æ®µã€‚æ¯”å¦‚ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªpackage.jsonã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">"name"</span>: <span class="string">"foo"</span>, </div><div class="line">  <span class="attr">"version"</span>: <span class="string">"1.2.5"</span>,</div><div class="line">  <span class="attr">"scripts"</span>: &#123;</div><div class="line">    <span class="attr">"view"</span>: <span class="string">"node view.js"</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆï¼Œå˜é‡npm_package_nameè¿”å›fooï¼Œå˜é‡npm_package_versionè¿”å›1.2.5ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// view.js</span></div><div class="line"><span class="built_in">console</span>.log(process.env.npm_package_name); <span class="comment">// foo</span></div><div class="line"><span class="built_in">console</span>.log(process.env.npm_package_version); <span class="comment">// 1.2.5</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ç¯å¢ƒå˜é‡<code>process.env</code>å¯¹è±¡ï¼Œæ‹¿åˆ°package.jsonçš„å­—æ®µå€¼ã€‚å¦‚æœæ˜¯ Bash è„šæœ¬ï¼Œå¯ä»¥ç”¨\$npm_package_nameå’Œ$npm_package_versionå–åˆ°è¿™ä¸¤ä¸ªå€¼ã€‚<br>npm<em>package</em>å‰ç¼€ä¹Ÿæ”¯æŒåµŒå¥—çš„package.jsonå­—æ®µã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">"repository": &#123;</div><div class="line">  "type": "git",</div><div class="line">  "url": "xxx"</div><div class="line">&#125;,</div><div class="line">scripts: &#123;</div><div class="line">  "view": "echo $npm_package_repository_type"</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œrepositoryå­—æ®µçš„typeå±æ€§ï¼Œå¯ä»¥é€šè¿‡npm_package_repository_typeå–åˆ°ã€‚<br>ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">"scripts": &#123;</div><div class="line">  "install": "foo.js"</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œnpm_package_scripts_installå˜é‡çš„å€¼ç­‰äºfoo.jsã€‚<br>ç„¶åï¼Œnpm è„šæœ¬è¿˜å¯ä»¥é€šè¿‡npm<em>config</em>å‰ç¼€ï¼Œæ‹¿åˆ° npm çš„é…ç½®å˜é‡ï¼Œå³<code>npm config get xxx</code>å‘½ä»¤è¿”å›çš„å€¼ã€‚æ¯”å¦‚ï¼Œå½“å‰æ¨¡å—çš„å‘è¡Œæ ‡ç­¾ï¼Œå¯ä»¥é€šè¿‡npm_config_tagå–åˆ°ã€‚</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">"view": "echo $npm_config_tag",</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œpackage.jsoné‡Œé¢çš„configå¯¹è±¡ï¼Œå¯ä»¥è¢«ç¯å¢ƒå˜é‡è¦†ç›–ã€‚</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123; </div><div class="line">  <span class="attr">"name"</span> : <span class="string">"foo"</span>,</div><div class="line">  <span class="attr">"config"</span> : &#123; <span class="attr">"port"</span> : <span class="string">"8080"</span> &#125;,</div><div class="line">  <span class="attr">"scripts"</span> : &#123; <span class="attr">"start"</span> : <span class="string">"node server.js"</span> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œnpm_package_config_portå˜é‡è¿”å›çš„æ˜¯8080ã€‚è¿™ä¸ªå€¼å¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•è¦†ç›–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm config set foo:port 80</div></pre></td></tr></table></figure>
<p>æœ€åï¼Œenvå‘½ä»¤å¯ä»¥åˆ—å‡ºæ‰€æœ‰ç¯å¢ƒå˜é‡ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"env"</span>: <span class="string">"env"</span></div></pre></td></tr></table></figure>
<h2 id="åã€å¸¸ç”¨è„šæœ¬ç¤ºä¾‹"><a href="#åã€å¸¸ç”¨è„šæœ¬ç¤ºä¾‹" class="headerlink" title="åã€å¸¸ç”¨è„šæœ¬ç¤ºä¾‹"></a>åã€å¸¸ç”¨è„šæœ¬ç¤ºä¾‹</h2><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">// åˆ é™¤ç›®å½•</div><div class="line">"clean": "rimraf dist/*",</div><div class="line"></div><div class="line">// æœ¬åœ°æ­å»ºä¸€ä¸ª HTTP æœåŠ¡</div><div class="line">"serve": "http-server -p 9090 dist/",</div><div class="line"></div><div class="line">// æ‰“å¼€æµè§ˆå™¨</div><div class="line">"open:dev": "opener http://localhost:9090",</div><div class="line"></div><div class="line">// å®æ—¶åˆ·æ–°</div><div class="line"> "livereload": "live-reload --port 9091 dist/",</div><div class="line"></div><div class="line">// æ„å»º HTML æ–‡ä»¶</div><div class="line">"build:html": "jade index.jade &gt; dist/index.html",</div><div class="line"></div><div class="line">// åªè¦ CSS æ–‡ä»¶æœ‰å˜åŠ¨ï¼Œå°±é‡æ–°æ‰§è¡Œæ„å»º</div><div class="line">"watch:css": "watch 'npm run build:css' assets/styles/",</div><div class="line"></div><div class="line">// åªè¦ HTML æ–‡ä»¶æœ‰å˜åŠ¨ï¼Œå°±é‡æ–°æ‰§è¡Œæ„å»º</div><div class="line">"watch:html": "watch 'npm run build:html' assets/html",</div><div class="line"></div><div class="line">// éƒ¨ç½²åˆ° Amazon S3</div><div class="line">"deploy:prod": "s3-cli sync ./dist/ s3://example-com/prod-site/",</div><div class="line"></div><div class="line">// æ„å»º favicon</div><div class="line">"build:favicon": "node scripts/favicon.js",</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;npm-scripts-ä½¿ç”¨æŒ‡å—&quot;&gt;&lt;a href=&quot;#npm-scripts-ä½¿ç”¨æŒ‡å—&quot; class=&quot;headerlink&quot; title=&quot;npm scripts ä½¿ç”¨æŒ‡å—&quot;&gt;&lt;/a&gt;npm scripts ä½¿ç”¨æŒ‡å—&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&amp;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="Nodejs" scheme="http://microzz.com/tags/Nodejs/"/>
    
      <category term="npm" scheme="http://microzz.com/tags/npm/"/>
    
      <category term="js" scheme="http://microzz.com/tags/js/"/>
    
  </entry>
  
  <entry>
    <title>Mac ç»ˆç«¯å‘½ä»¤å¤§å…¨ (Shell)</title>
    <link href="http://microzz.com/2017/02/12/mac-shell/"/>
    <id>http://microzz.com/2017/02/12/mac-shell/</id>
    <published>2017-02-12T10:24:35.000Z</published>
    <updated>2017-02-12T11:07:56.766Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Mac-ç»ˆç«¯å‘½ä»¤å¤§å…¨"><a href="#Mac-ç»ˆç«¯å‘½ä»¤å¤§å…¨" class="headerlink" title="Mac ç»ˆç«¯å‘½ä»¤å¤§å…¨"></a>Mac ç»ˆç«¯å‘½ä»¤å¤§å…¨</h1><h2 id="ç›®å½•æ“ä½œ"><a href="#ç›®å½•æ“ä½œ" class="headerlink" title="ç›®å½•æ“ä½œ"></a>ç›®å½•æ“ä½œ</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>mkdir</td>
<td>åˆ›å»ºä¸€ä¸ªç›®å½•</td>
<td>mkdir dirname</td>
</tr>
<tr>
<td>rmdir</td>
<td>åˆ é™¤ä¸€ä¸ªç›®å½•</td>
<td>rmdir dirname</td>
</tr>
<tr>
<td>mvdir</td>
<td>ç§»åŠ¨æˆ–é‡å‘½åä¸€ä¸ªç›®å½•</td>
<td>mvdir dir1 dir2</td>
</tr>
<tr>
<td>cd</td>
<td>æ”¹å˜å½“å‰ç›®å½•</td>
<td>cd dirname</td>
</tr>
<tr>
<td>pwd</td>
<td>æ˜¾ç¤ºå½“å‰ç›®å½•çš„è·¯å¾„å</td>
<td>pwd</td>
</tr>
<tr>
<td>ls</td>
<td>æ˜¾ç¤ºå½“å‰ç›®å½•çš„å†…å®¹</td>
<td>ls -la</td>
</tr>
<tr>
<td>dircmp</td>
<td>æ¯”è¾ƒä¸¤ä¸ªç›®å½•çš„å†…å®¹</td>
<td>dircmp dir1 dir2</td>
</tr>
</tbody>
</table>
<h2 id="æ–‡ä»¶æ“ä½œ"><a href="#æ–‡ä»¶æ“ä½œ" class="headerlink" title="æ–‡ä»¶æ“ä½œ"></a>æ–‡ä»¶æ“ä½œ</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>cat</td>
<td>æ˜¾ç¤ºæˆ–è¿æ¥æ–‡ä»¶</td>
<td>cat filename</td>
</tr>
<tr>
<td>pg</td>
<td>åˆ†é¡µæ ¼å¼åŒ–æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</td>
<td>pg filename</td>
</tr>
<tr>
<td>more</td>
<td>åˆ†å±æ˜¾ç¤ºæ–‡ä»¶å†…å®¹</td>
<td>more filename</td>
</tr>
<tr>
<td>od</td>
<td>æ˜¾ç¤ºéæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹</td>
<td>od -c filename</td>
</tr>
<tr>
<td>cp</td>
<td>å¤åˆ¶æ–‡ä»¶æˆ–ç›®å½•</td>
<td>cp file1 file2</td>
</tr>
<tr>
<td>rm</td>
<td>åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•</td>
<td>rm filename</td>
</tr>
<tr>
<td>mv</td>
<td>æ”¹å˜æ–‡ä»¶åæˆ–æ‰€åœ¨ç›®å½•</td>
<td>mv file1 file2</td>
</tr>
<tr>
<td>ln</td>
<td>è”æ¥æ–‡ä»¶</td>
<td>ln -s file1 file2</td>
</tr>
<tr>
<td>find</td>
<td>ä½¿ç”¨åŒ¹é…è¡¨è¾¾å¼æŸ¥æ‰¾æ–‡ä»¶</td>
<td>find . -name â€œ*.câ€ -print</td>
</tr>
<tr>
<td>file</td>
<td>æ˜¾ç¤ºæ–‡ä»¶ç±»å‹</td>
<td>file filename</td>
</tr>
<tr>
<td>open</td>
<td>ä½¿ç”¨é»˜è®¤çš„ç¨‹åºæ‰“å¼€æ–‡ä»¶</td>
<td>open filename</td>
</tr>
</tbody>
</table>
<h2 id="é€‰æ‹©æ“ä½œ"><a href="#é€‰æ‹©æ“ä½œ" class="headerlink" title="é€‰æ‹©æ“ä½œ"></a>é€‰æ‹©æ“ä½œ</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>head</td>
<td>æ˜¾ç¤ºæ–‡ä»¶çš„æœ€åˆå‡ è¡Œ</td>
<td>head -20 filename</td>
</tr>
<tr>
<td>tail</td>
<td>æ˜¾ç¤ºæ–‡ä»¶çš„æœ€åå‡ è¡Œ</td>
<td>tail -15 filename</td>
</tr>
<tr>
<td>cut</td>
<td>æ˜¾ç¤ºæ–‡ä»¶æ¯è¡Œä¸­çš„æŸäº›åŸŸ</td>
<td>cut -f1,7 -d: /etc/passwd</td>
</tr>
<tr>
<td>colrm</td>
<td>ä»æ ‡å‡†è¾“å…¥ä¸­åˆ é™¤è‹¥å¹²åˆ—</td>
<td>colrm 8 20 file2</td>
</tr>
<tr>
<td>paste</td>
<td>æ¨ªå‘è¿æ¥æ–‡ä»¶</td>
<td>paste file1 file2</td>
</tr>
<tr>
<td>diff</td>
<td>æ¯”è¾ƒå¹¶æ˜¾ç¤ºä¸¤ä¸ªæ–‡ä»¶çš„å·®å¼‚</td>
<td>diff file1 file2</td>
</tr>
<tr>
<td>sed</td>
<td>éäº¤äº’æ–¹å¼æµç¼–è¾‘å™¨</td>
<td>sed â€œs/red/green/gâ€ filename</td>
</tr>
<tr>
<td>grep</td>
<td>åœ¨æ–‡ä»¶ä¸­æŒ‰æ¨¡å¼æŸ¥æ‰¾</td>
<td>grep â€œ^[a-zA-Z]â€ filename</td>
</tr>
<tr>
<td>awk</td>
<td>åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾å¹¶å¤„ç†æ¨¡å¼</td>
<td>awk â€˜{print $1 $1}â€™ filename</td>
</tr>
<tr>
<td>sort</td>
<td>æ’åºæˆ–å½’å¹¶æ–‡ä»¶</td>
<td>sort -d -f -u file1</td>
</tr>
<tr>
<td>uniq</td>
<td>å»æ‰æ–‡ä»¶ä¸­çš„é‡å¤è¡Œ</td>
<td>uniq file1 file2</td>
</tr>
<tr>
<td>comm</td>
<td>æ˜¾ç¤ºä¸¤æœ‰åºæ–‡ä»¶çš„å…¬å…±å’Œéå…¬å…±è¡Œ</td>
<td>comm file1 file2</td>
</tr>
<tr>
<td>wc</td>
<td>ç»Ÿè®¡æ–‡ä»¶çš„å­—ç¬¦æ•°ã€è¯æ•°å’Œè¡Œæ•°</td>
<td>wc filename</td>
</tr>
<tr>
<td>nl</td>
<td>ç»™æ–‡ä»¶åŠ ä¸Šè¡Œå·</td>
<td>nl file1 &gt;file2</td>
</tr>
</tbody>
</table>
<h2 id="å®‰å…¨æ“ä½œ"><a href="#å®‰å…¨æ“ä½œ" class="headerlink" title="å®‰å…¨æ“ä½œ"></a>å®‰å…¨æ“ä½œ</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>passwd</td>
<td>ä¿®æ”¹ç”¨æˆ·å¯†ç </td>
<td>passwd</td>
</tr>
<tr>
<td>chmod</td>
<td>æ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™</td>
<td>chmod ug+x filename</td>
</tr>
<tr>
<td>umask</td>
<td>å®šä¹‰åˆ›å»ºæ–‡ä»¶çš„æƒé™æ©ç </td>
<td>umask 027</td>
</tr>
<tr>
<td>chown</td>
<td>æ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„å±ä¸»</td>
<td>chown newowner filename</td>
</tr>
<tr>
<td>chgrp</td>
<td>æ”¹å˜æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç»„</td>
<td>chgrp staff filename</td>
</tr>
<tr>
<td>xlock</td>
<td>ç»™ç»ˆç«¯ä¸Šé”</td>
<td>xlock -remote</td>
</tr>
</tbody>
</table>
<h2 id="ç¼–ç¨‹æ“ä½œ"><a href="#ç¼–ç¨‹æ“ä½œ" class="headerlink" title="ç¼–ç¨‹æ“ä½œ"></a>ç¼–ç¨‹æ“ä½œ</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>make</td>
<td>ç»´æŠ¤å¯æ‰§è¡Œç¨‹åºçš„æœ€æ–°ç‰ˆæœ¬</td>
<td>make</td>
</tr>
<tr>
<td>touch</td>
<td>æ›´æ–°æ–‡ä»¶çš„è®¿é—®å’Œä¿®æ”¹æ—¶é—´</td>
<td>touch -m 05202400 filename</td>
</tr>
<tr>
<td>dbx</td>
<td>å‘½ä»¤è¡Œç•Œé¢è°ƒè¯•å·¥å…·</td>
<td>dbx a.out</td>
</tr>
<tr>
<td>xde</td>
<td>å›¾å½¢ç”¨æˆ·ç•Œé¢è°ƒè¯•å·¥å…·</td>
<td>xde a.out</td>
</tr>
</tbody>
</table>
<h2 id="è¿›ç¨‹æ“ä½œ"><a href="#è¿›ç¨‹æ“ä½œ" class="headerlink" title="è¿›ç¨‹æ“ä½œ"></a>è¿›ç¨‹æ“ä½œ</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>ps</td>
<td>æ˜¾ç¤ºè¿›ç¨‹å½“å‰çŠ¶æ€</td>
<td>ps u</td>
</tr>
<tr>
<td>kill</td>
<td>ç»ˆæ­¢è¿›ç¨‹</td>
<td>kill -9 30142</td>
</tr>
<tr>
<td>nice</td>
<td>æ”¹å˜å¾…æ‰§è¡Œå‘½ä»¤çš„ä¼˜å…ˆçº§</td>
<td>nice cc -c *.c</td>
</tr>
<tr>
<td>renice</td>
<td>æ”¹å˜å·²è¿è¡Œè¿›ç¨‹çš„ä¼˜å…ˆçº§</td>
<td>renice +20 32768</td>
</tr>
</tbody>
</table>
<h2 id="æ—¶é—´æ“ä½œ"><a href="#æ—¶é—´æ“ä½œ" class="headerlink" title="æ—¶é—´æ“ä½œ"></a>æ—¶é—´æ“ä½œ</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å    åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>date</td>
<td>æ˜¾ç¤ºç³»ç»Ÿçš„å½“å‰æ—¥æœŸå’Œæ—¶é—´</td>
<td>date</td>
</tr>
<tr>
<td>cal</td>
<td>æ˜¾ç¤ºæ—¥å†</td>
<td>cal 8 1996</td>
</tr>
<tr>
<td>time</td>
<td>ç»Ÿè®¡ç¨‹åºçš„æ‰§è¡Œæ—¶é—´</td>
<td>time a.out</td>
</tr>
</tbody>
</table>
<h2 id="ç½‘ç»œä¸é€šä¿¡æ“ä½œ"><a href="#ç½‘ç»œä¸é€šä¿¡æ“ä½œ" class="headerlink" title="ç½‘ç»œä¸é€šä¿¡æ“ä½œ"></a>ç½‘ç»œä¸é€šä¿¡æ“ä½œ</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>telnet</td>
<td>è¿œç¨‹ç™»å½•</td>
<td>telnet hpc.sp.net.edu.cn</td>
</tr>
<tr>
<td>rlogin</td>
<td>è¿œç¨‹ç™»å½•</td>
<td>rlogin hostname -l username</td>
</tr>
<tr>
<td>rsh</td>
<td>åœ¨è¿œç¨‹ä¸»æœºæ‰§è¡ŒæŒ‡å®šå‘½ä»¤</td>
<td>rsh f01n03 date</td>
</tr>
<tr>
<td>ftp</td>
<td>åœ¨æœ¬åœ°ä¸»æœºä¸è¿œç¨‹ä¸»æœºä¹‹é—´ä¼ è¾“æ–‡ä»¶</td>
<td>ftp ftp.sp.net.edu.cn</td>
</tr>
<tr>
<td>rcp</td>
<td>åœ¨æœ¬åœ°ä¸»æœºä¸è¿œç¨‹ä¸»æœºä¹‹é—´å¤åˆ¶æ–‡ä»¶</td>
<td>rcp file1 host1:file2</td>
</tr>
<tr>
<td>ping</td>
<td>ç»™ä¸€ä¸ªç½‘ç»œä¸»æœºå‘é€å›åº”è¯·æ±‚</td>
<td>ping hpc.sp.net.edu.cn</td>
</tr>
<tr>
<td>mail</td>
<td>é˜…è¯»å’Œå‘é€ç”µå­é‚®ä»¶</td>
<td>mail</td>
</tr>
<tr>
<td>write</td>
<td>ç»™å¦ä¸€ç”¨æˆ·å‘é€æŠ¥æ–‡</td>
<td>write username pts/1</td>
</tr>
<tr>
<td>mesg</td>
<td>å…è®¸æˆ–æ‹’ç»æ¥æ”¶æŠ¥æ–‡</td>
<td>mesg n</td>
</tr>
</tbody>
</table>
<h2 id="Korn-Shell-å‘½ä»¤"><a href="#Korn-Shell-å‘½ä»¤" class="headerlink" title="Korn Shell å‘½ä»¤"></a>Korn Shell å‘½ä»¤</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>history</td>
<td>åˆ—å‡ºæœ€è¿‘æ‰§è¡Œè¿‡çš„å‡ æ¡å‘½ä»¤åŠç¼–å·</td>
<td>history</td>
</tr>
<tr>
<td>r</td>
<td>é‡å¤æ‰§è¡Œæœ€è¿‘æ‰§è¡Œè¿‡çš„æŸæ¡å‘½ä»¤</td>
<td>r -2</td>
</tr>
<tr>
<td>alias</td>
<td>ç»™æŸä¸ªå‘½ä»¤å®šä¹‰åˆ«å</td>
<td>alias del=rm -i</td>
</tr>
<tr>
<td>unalias</td>
<td>å–æ¶ˆå¯¹æŸä¸ªåˆ«åçš„å®šä¹‰</td>
<td>unalias del</td>
</tr>
</tbody>
</table>
<h2 id="å…¶å®ƒå‘½ä»¤"><a href="#å…¶å®ƒå‘½ä»¤" class="headerlink" title="å…¶å®ƒå‘½ä»¤"></a>å…¶å®ƒå‘½ä»¤</h2><table>
<thead>
<tr>
<th>å‘½ä»¤å</th>
<th>åŠŸèƒ½æè¿°</th>
<th>ä½¿ç”¨ä¸¾ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>uname</td>
<td>æ˜¾ç¤ºæ“ä½œç³»ç»Ÿçš„æœ‰å…³ä¿¡æ¯</td>
<td>uname -a</td>
</tr>
<tr>
<td>clear</td>
<td>æ¸…é™¤å±å¹•æˆ–çª—å£å†…å®¹</td>
<td>clear</td>
</tr>
<tr>
<td>env</td>
<td>æ˜¾ç¤ºå½“å‰æ‰€æœ‰è®¾ç½®è¿‡çš„ç¯å¢ƒå˜é‡</td>
<td>env</td>
</tr>
<tr>
<td>who</td>
<td>åˆ—å‡ºå½“å‰ç™»å½•çš„æ‰€æœ‰ç”¨æˆ·</td>
<td>who</td>
</tr>
<tr>
<td>whoami</td>
<td>æ˜¾ç¤ºå½“å‰æ­£è¿›è¡Œæ“ä½œçš„ç”¨æˆ·å</td>
<td>whoami</td>
</tr>
<tr>
<td>tty</td>
<td>æ˜¾ç¤ºç»ˆç«¯æˆ–ä¼ªç»ˆç«¯çš„åç§°</td>
<td>tty</td>
</tr>
<tr>
<td>stty</td>
<td>æ˜¾ç¤ºæˆ–é‡ç½®æ§åˆ¶é”®å®šä¹‰</td>
<td>stty -a</td>
</tr>
<tr>
<td>du</td>
<td>æŸ¥è¯¢ç£ç›˜ä½¿ç”¨æƒ…å†µ</td>
<td>du -k subdir</td>
</tr>
<tr>
<td>df</td>
<td>æ˜¾ç¤ºæ–‡ä»¶ç³»ç»Ÿçš„æ€»ç©ºé—´å’Œå¯ç”¨ç©ºé—´</td>
<td>df /tmp</td>
</tr>
<tr>
<td>w</td>
<td>æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ´»åŠ¨çš„æ€»ä¿¡æ¯</td>
<td>w</td>
</tr>
</tbody>
</table>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Mac-ç»ˆç«¯å‘½ä»¤å¤§å…¨&quot;&gt;&lt;a href=&quot;#Mac-ç»ˆç«¯å‘½ä»¤å¤§å…¨&quot; class=&quot;headerlink&quot; title=&quot;Mac ç»ˆç«¯å‘½ä»¤å¤§å…¨&quot;&gt;&lt;/a&gt;Mac ç»ˆç«¯å‘½ä»¤å¤§å…¨&lt;/h1&gt;&lt;h2 id=&quot;ç›®å½•æ“ä½œ&quot;&gt;&lt;a href=&quot;#ç›®å½•æ“ä½œ&quot; class=&quot;head
    
    </summary>
    
    
      <category term="å¼€å‘è€…" scheme="http://microzz.com/tags/%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
      <category term="Shell" scheme="http://microzz.com/tags/Shell/"/>
    
      <category term="Mac" scheme="http://microzz.com/tags/Mac/"/>
    
      <category term="Linux" scheme="http://microzz.com/tags/Linux/"/>
    
      <category term="Unix" scheme="http://microzz.com/tags/Unix/"/>
    
  </entry>
  
  <entry>
    <title>å‰ç«¯å¼€å‘é¢è¯•é¢˜é›†é”¦</title>
    <link href="http://microzz.com/2017/02/10/interview/"/>
    <id>http://microzz.com/2017/02/10/interview/</id>
    <published>2017-02-10T10:01:15.000Z</published>
    <updated>2017-02-10T10:40:25.830Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰ç«¯å¼€å‘é¢è¯•é¢˜"><a href="#å‰ç«¯å¼€å‘é¢è¯•é¢˜" class="headerlink" title="å‰ç«¯å¼€å‘é¢è¯•é¢˜"></a>å‰ç«¯å¼€å‘é¢è¯•é¢˜</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a><a name="preface">å‰è¨€</a></h2><p>å‰ç«¯è¿˜æ˜¯ä¸€ä¸ªå¹´è½»çš„è¡Œä¸šï¼Œæ–°çš„è¡Œä¸šæ ‡å‡†ï¼Œ æ¡†æ¶ï¼Œ åº“éƒ½ä¸æ–­åœ¨æ›´æ–°å’Œæ–°å¢ï¼Œæ­£å¦‚èµ«é—¨åœ¨2015æ·±JSå¤§ä¼šä¸Šçš„ã€Šå‰ç«¯æœåŠ¡åŒ–ä¹‹è·¯ã€‹ä¸»é¢˜æ¼”è®²ä¸­è¯´çš„ä¸€å¥è¯ï¼šâ€œæ¯18è‡³24ä¸ªæœˆï¼Œå‰ç«¯éƒ½ä¼šéš¾ä¸€å€â€ï¼Œè¿™äº›å˜åŒ–ä½¿å‰ç«¯çš„èƒ½åŠ›æ›´åŠ ä¸°å¯Œã€åˆ›é€ çš„åº”ç”¨ä¹Ÿä¼šæ›´åŠ å®Œç¾ã€‚æ‰€ä»¥å…³æ³¨å„ç§å‰ç«¯æŠ€æœ¯ï¼Œè·Ÿä¸Šå¿«é€Ÿå˜åŒ–çš„èŠ‚å¥ï¼Œä¹Ÿæ˜¯èº«ä¸ºä¸€ä¸ªå‰ç«¯ç¨‹åºå‘˜å¿…å¤‡çš„æŠ€èƒ½ä¹‹ä¸€ã€‚</p>
<ol>
<li><p>é¢è¯•é¢˜ç›®ï¼š æ ¹æ®ä½ çš„ç­‰çº§å’ŒèŒä½çš„å˜åŒ–ï¼Œå…¥é—¨çº§åˆ°ä¸“å®¶çº§ï¼Œå¹¿åº¦å’Œæ·±åº¦éƒ½ä¼šæœ‰æ‰€å¢åŠ ã€‚</p>
</li>
<li><p>é¢˜ç›®ç±»å‹ï¼š ç†è®ºçŸ¥è¯†ã€ç®—æ³•ã€é¡¹ç›®ç»†èŠ‚ã€æŠ€æœ¯è§†é‡ã€å¼€æ”¾æ€§é¢˜ã€å·¥ä½œæ¡ˆä¾‹ã€‚</p>
</li>
<li><p>ç»†èŠ‚è¿½é—®ï¼š å¯ä»¥ç¡®ä¿é—®åˆ°ä½ å¼€å§‹ä¸æ‡‚æˆ–é¢è¯•å®˜å¼€å§‹ä¸æ‡‚ä¸ºæ­¢ï¼Œè¿™æ ·å¯ä»¥å¤§å¤§å»¶å±•é¢˜ç›®çš„åŒºåˆ†åº¦å’Œæ·±åº¦ï¼ŒçŸ¥é“ä½ çš„å®é™…èƒ½åŠ›ã€‚å› ä¸ºè¿™ç§çŸ¥è¯†å…³è”æ˜¯é•¿æ—¶æœŸçš„å­¦ä¹ ï¼Œä¸´æ—¶æŠ±ä½›è„šç»å¯¹æ˜¯è®°ä¸ä½çš„ã€‚</p>
</li>
<li><p>å›ç­”é—®é¢˜å†æ£’ï¼Œé¢è¯•å®˜ï¼ˆå¯èƒ½æ˜¯ä½ é¢è¯•èŒä½çš„ç›´æ¥é¢†å¯¼ï¼‰ï¼Œä¼šè€ƒè™‘æˆ‘è¦ä¸è¦è¿™ä¸ªäººåšæˆ‘çš„åŒäº‹ï¼Ÿæ‰€ä»¥æ€åº¦å¾ˆé‡è¦ã€é™¤äº†èƒ½åšäº‹ï¼Œè¿˜è¦ä¼šåšäººã€‚ï¼ˆæ„Ÿè§‰æ›´åƒæ˜¯ç›¸äº²( â€¢Ì£Ì£Ì£Ì£Ì£Ì¥Ìà¯°â€¢Ì£Ì£Ì£Ì£Ì£Ì¥Ì€ )ï¼‰</p>
</li>
<li><p>èµ„æ·±çš„å‰ç«¯å¼€å‘èƒ½æŠŠabsoluteå’Œrelativeå¼„æ··ï¼Œè¿™æ ·çš„äººä¸è¦ä¹Ÿç½¢ï¼Œå› ä¸ºå›¢é˜Ÿéœ€è¦çš„æ˜¯ï¼šä½ è¿™ä¸ªäººå…·æœ‰å¯ä»¥ä¾é çš„æ‰èƒ½ï¼ˆé è°±ï¼‰ã€‚</p>
</li>
</ol>
<p><strong>å‰ç«¯å¼€å‘çŸ¥è¯†ç‚¹ï¼š</strong></p>
<pre><code>HTML&amp;CSSï¼š
    å¯¹Webæ ‡å‡†çš„ç†è§£ã€æµè§ˆå™¨å†…æ ¸å·®å¼‚ã€å…¼å®¹æ€§ã€hackã€CSSåŸºæœ¬åŠŸï¼šå¸ƒå±€ã€ç›’å­æ¨¡å‹ã€é€‰æ‹©å™¨ä¼˜å…ˆçº§ã€
    HTML5ã€CSS3ã€Flexbox

JavaScriptï¼š
    æ•°æ®ç±»å‹ã€è¿ç®—ã€å¯¹è±¡ã€Functionã€ç»§æ‰¿ã€é—­åŒ…ã€ä½œç”¨åŸŸã€åŸå‹é“¾ã€äº‹ä»¶ã€RegExpã€JSONã€Ajaxã€
    DOMã€BOMã€å†…å­˜æ³„æ¼ã€è·¨åŸŸã€å¼‚æ­¥è£…è½½ã€æ¨¡æ¿å¼•æ“ã€å‰ç«¯MVCã€è·¯ç”±ã€æ¨¡å—åŒ–ã€Canvasã€ECMAScript 6ã€Nodejs

å…¶ä»–ï¼š
    ç§»åŠ¨ç«¯ã€å“åº”å¼ã€è‡ªåŠ¨åŒ–æ„å»ºã€HTTPã€ç¦»çº¿å­˜å‚¨ã€WEBå®‰å…¨ã€ä¼˜åŒ–ã€é‡æ„ã€å›¢é˜Ÿåä½œã€å¯ç»´æŠ¤ã€æ˜“ç”¨æ€§ã€SEOã€UEDã€æ¶æ„ã€èŒä¸šç”Ÿæ¶¯ã€å¿«é€Ÿå­¦ä¹ èƒ½åŠ›
</code></pre><p>ä½œä¸ºä¸€åå‰ç«¯å·¥ç¨‹å¸ˆï¼Œ<strong>æ— è®ºå·¥ä½œå¹´å¤´é•¿çŸ­éƒ½åº”è¯¥æŒæ¡çš„çŸ¥è¯†ç‚¹</strong>ï¼š</p>
<pre><code>1ã€DOMç»“æ„ â€”â€” ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´å¯èƒ½å­˜åœ¨å“ªäº›å…³ç³»ä»¥åŠå¦‚ä½•åœ¨èŠ‚ç‚¹ä¹‹é—´ä»»æ„ç§»åŠ¨ã€‚

2ã€DOMæ“ä½œ â€”â€” å¦‚ä½•æ·»åŠ ã€ç§»é™¤ã€ç§»åŠ¨ã€å¤åˆ¶ã€åˆ›å»ºå’ŒæŸ¥æ‰¾èŠ‚ç‚¹ç­‰ã€‚

3ã€äº‹ä»¶ â€”â€” å¦‚ä½•ä½¿ç”¨äº‹ä»¶ï¼Œä»¥åŠIEå’Œæ ‡å‡†DOMäº‹ä»¶æ¨¡å‹ä¹‹é—´å­˜åœ¨çš„å·®åˆ«ã€‚

4ã€XMLHttpRequest â€”â€” è¿™æ˜¯ä»€ä¹ˆã€æ€æ ·å®Œæ•´åœ°æ‰§è¡Œä¸€æ¬¡GETè¯·æ±‚ã€æ€æ ·æ£€æµ‹é”™è¯¯ã€‚

5ã€ä¸¥æ ¼æ¨¡å¼ä¸æ··æ‚æ¨¡å¼ â€”â€” å¦‚ä½•è§¦å‘è¿™ä¸¤ç§æ¨¡å¼ï¼ŒåŒºåˆ†å®ƒä»¬æœ‰ä½•æ„ä¹‰ã€‚

6ã€ç›’æ¨¡å‹ â€”â€” å¤–è¾¹è·ã€å†…è¾¹è·å’Œè¾¹æ¡†ä¹‹é—´çš„å…³ç³»ï¼ŒåŠIE8ä»¥ä¸‹ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­çš„ç›’æ¨¡å‹

7ã€å—çº§å…ƒç´ ä¸è¡Œå†…å…ƒç´  â€”â€” æ€ä¹ˆç”¨CSSæ§åˆ¶å®ƒä»¬ã€ä»¥åŠå¦‚ä½•åˆç†çš„ä½¿ç”¨å®ƒä»¬

8ã€æµ®åŠ¨å…ƒç´  â€”â€” æ€ä¹ˆä½¿ç”¨å®ƒä»¬ã€å®ƒä»¬æœ‰ä»€ä¹ˆé—®é¢˜ä»¥åŠæ€ä¹ˆè§£å†³è¿™äº›é—®é¢˜ã€‚

9ã€HTMLä¸XHTML â€”â€” äºŒè€…æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œä½ è§‰å¾—åº”è¯¥ä½¿ç”¨å“ªä¸€ä¸ªå¹¶è¯´å‡ºç†ç”±ã€‚

10ã€JSON â€”â€” ä½œç”¨ã€ç”¨é€”ã€è®¾è®¡ç»“æ„ã€‚
</code></pre><p><strong>å¤‡æ³¨ï¼š</strong></p>
<pre><code>æ ¹æ®è‡ªå·±éœ€è¦é€‰æ‹©æ€§é˜…è¯»ï¼Œé¢è¯•é¢˜æ˜¯å¯¹ç†è®ºçŸ¥è¯†çš„æ€»ç»“ï¼Œè®©è‡ªå·±å­¦ä¼šåº”è¯¥å¦‚ä½•è¡¨è¾¾ã€‚

èµ„æ–™ç­”æ¡ˆä¸å¤Ÿæ­£ç¡®å’Œå…¨é¢ï¼Œæ¬¢è¿æ¬¢è¿Starå’Œæäº¤issuesã€‚

æ ¼å¼ä¸æ–­ä¿®æ”¹æ›´æ–°ä¸­ã€‚

æ›´æ–°è®°å½•ï¼š
2016å¹´3æœˆ25æ—¥ï¼šæ–°å¢ECMAScript6 ç›¸å…³é—®é¢˜
</code></pre><h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a><a name="html">HTML</a></h2><ul>
<li><p>Doctypeä½œç”¨ï¼Ÿæ ‡å‡†æ¨¡å¼ä¸å…¼å®¹æ¨¡å¼å„æœ‰ä»€ä¹ˆåŒºåˆ«?</p>
<pre><code>ï¼ˆ1ï¼‰ã€&lt;!DOCTYPE&gt;å£°æ˜ä½äºä½äºHTMLæ–‡æ¡£ä¸­çš„ç¬¬ä¸€è¡Œï¼Œå¤„äº &lt;html&gt; æ ‡ç­¾ä¹‹å‰ã€‚å‘ŠçŸ¥æµè§ˆå™¨çš„è§£æå™¨ç”¨ä»€ä¹ˆæ–‡æ¡£æ ‡å‡†è§£æè¿™ä¸ªæ–‡æ¡£ã€‚DOCTYPEä¸å­˜åœ¨æˆ–æ ¼å¼ä¸æ­£ç¡®ä¼šå¯¼è‡´æ–‡æ¡£ä»¥å…¼å®¹æ¨¡å¼å‘ˆç°ã€‚

ï¼ˆ2ï¼‰ã€æ ‡å‡†æ¨¡å¼çš„æ’ç‰ˆ å’ŒJSè¿ä½œæ¨¡å¼éƒ½æ˜¯ä»¥è¯¥æµè§ˆå™¨æ”¯æŒçš„æœ€é«˜æ ‡å‡†è¿è¡Œã€‚åœ¨å…¼å®¹æ¨¡å¼ä¸­ï¼Œé¡µé¢ä»¥å®½æ¾çš„å‘åå…¼å®¹çš„æ–¹å¼æ˜¾ç¤º,æ¨¡æ‹Ÿè€å¼æµè§ˆå™¨çš„è¡Œä¸ºä»¥é˜²æ­¢ç«™ç‚¹æ— æ³•å·¥ä½œã€‚
</code></pre></li>
<li><p>HTML5 ä¸ºä»€ä¹ˆåªéœ€è¦å†™ &lt;!DOCTYPE HTML&gt;ï¼Ÿ</p>
<pre><code>HTML5 ä¸åŸºäº SGMLï¼Œå› æ­¤ä¸éœ€è¦å¯¹DTDè¿›è¡Œå¼•ç”¨ï¼Œä½†æ˜¯éœ€è¦doctypeæ¥è§„èŒƒæµè§ˆå™¨çš„è¡Œä¸ºï¼ˆè®©æµè§ˆå™¨æŒ‰ç…§å®ƒä»¬åº”è¯¥çš„æ–¹å¼æ¥è¿è¡Œï¼‰ï¼›

è€ŒHTML4.01åŸºäºSGML,æ‰€ä»¥éœ€è¦å¯¹DTDè¿›è¡Œå¼•ç”¨ï¼Œæ‰èƒ½å‘ŠçŸ¥æµè§ˆå™¨æ–‡æ¡£æ‰€ä½¿ç”¨çš„æ–‡æ¡£ç±»å‹ã€‚
</code></pre></li>
<li><p>è¡Œå†…å…ƒç´ æœ‰å“ªäº›ï¼Ÿå—çº§å…ƒç´ æœ‰å“ªäº›ï¼Ÿ ç©º(void)å…ƒç´ æœ‰é‚£äº›ï¼Ÿ</p>
<pre><code>é¦–å…ˆï¼šCSSè§„èŒƒè§„å®šï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰displayå±æ€§ï¼Œç¡®å®šè¯¥å…ƒç´ çš„ç±»å‹ï¼Œæ¯ä¸ªå…ƒç´ éƒ½æœ‰é»˜è®¤çš„displayå€¼ï¼Œå¦‚divçš„displayé»˜è®¤å€¼ä¸ºâ€œblockâ€ï¼Œåˆ™ä¸ºâ€œå—çº§â€å…ƒç´ ï¼›spané»˜è®¤displayå±æ€§å€¼ä¸ºâ€œinlineâ€ï¼Œæ˜¯â€œè¡Œå†…â€å…ƒç´ ã€‚

ï¼ˆ1ï¼‰è¡Œå†…å…ƒç´ æœ‰ï¼ša b span img input select strongï¼ˆå¼ºè°ƒçš„è¯­æ°”ï¼‰
ï¼ˆ2ï¼‰å—çº§å…ƒç´ æœ‰ï¼šdiv ul ol li dl dt dd h1 h2 h3 h4â€¦p

ï¼ˆ3ï¼‰å¸¸è§çš„ç©ºå…ƒç´ ï¼š
    &lt;br&gt; &lt;hr&gt; &lt;img&gt; &lt;input&gt; &lt;link&gt; &lt;meta&gt;
    é²œä¸ºäººçŸ¥çš„æ˜¯ï¼š
    &lt;area&gt; &lt;base&gt; &lt;col&gt; &lt;command&gt; &lt;embed&gt; &lt;keygen&gt; &lt;param&gt; &lt;source&gt; &lt;track&gt; &lt;wbr&gt;

ä¸åŒæµè§ˆå™¨ï¼ˆç‰ˆæœ¬ï¼‰ã€HTML4ï¼ˆ5ï¼‰ã€CSS2ç­‰å®é™…ç•¥æœ‰å·®å¼‚
å‚è€ƒ: http://stackoverflow.com/questions/6867254/browsers-default-css-for-html-elements
</code></pre></li>
</ul>
<ul>
<li>é¡µé¢å¯¼å…¥æ ·å¼æ—¶ï¼Œä½¿ç”¨linkå’Œ@importæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li>
</ul>
<pre><code>ï¼ˆ1ï¼‰linkå±äºXHTMLæ ‡ç­¾ï¼Œé™¤äº†åŠ è½½CSSå¤–ï¼Œè¿˜èƒ½ç”¨äºå®šä¹‰RSS, å®šä¹‰relè¿æ¥å±æ€§ç­‰ä½œç”¨ï¼›è€Œ@importæ˜¯CSSæä¾›çš„ï¼Œåªèƒ½ç”¨äºåŠ è½½CSS;

ï¼ˆ2ï¼‰é¡µé¢è¢«åŠ è½½çš„æ—¶ï¼Œlinkä¼šåŒæ—¶è¢«åŠ è½½ï¼Œè€Œ@importå¼•ç”¨çš„CSSä¼šç­‰åˆ°é¡µé¢è¢«åŠ è½½å®Œå†åŠ è½½;

ï¼ˆ3ï¼‰importæ˜¯CSS2.1 æå‡ºçš„ï¼Œåªåœ¨IE5ä»¥ä¸Šæ‰èƒ½è¢«è¯†åˆ«ï¼Œè€Œlinkæ˜¯XHTMLæ ‡ç­¾ï¼Œæ— å…¼å®¹é—®é¢˜;
</code></pre><ul>
<li><p>ä»‹ç»ä¸€ä¸‹ä½ å¯¹æµè§ˆå™¨å†…æ ¸çš„ç†è§£ï¼Ÿ</p>
<pre><code>ä¸»è¦åˆ†æˆä¸¤éƒ¨åˆ†ï¼šæ¸²æŸ“å¼•æ“(layout engineeræˆ–Rendering Engine)å’ŒJSå¼•æ“ã€‚
æ¸²æŸ“å¼•æ“ï¼šè´Ÿè´£å–å¾—ç½‘é¡µçš„å†…å®¹ï¼ˆHTMLã€XMLã€å›¾åƒç­‰ç­‰ï¼‰ã€æ•´ç†è®¯æ¯ï¼ˆä¾‹å¦‚åŠ å…¥CSSç­‰ï¼‰ï¼Œä»¥åŠè®¡ç®—ç½‘é¡µçš„æ˜¾ç¤ºæ–¹å¼ï¼Œç„¶åä¼šè¾“å‡ºè‡³æ˜¾ç¤ºå™¨æˆ–æ‰“å°æœºã€‚æµè§ˆå™¨çš„å†…æ ¸çš„ä¸åŒå¯¹äºç½‘é¡µçš„è¯­æ³•è§£é‡Šä¼šæœ‰ä¸åŒï¼Œæ‰€ä»¥æ¸²æŸ“çš„æ•ˆæœä¹Ÿä¸ç›¸åŒã€‚æ‰€æœ‰ç½‘é¡µæµè§ˆå™¨ã€ç”µå­é‚®ä»¶å®¢æˆ·ç«¯ä»¥åŠå…¶å®ƒéœ€è¦ç¼–è¾‘ã€æ˜¾ç¤ºç½‘ç»œå†…å®¹çš„åº”ç”¨ç¨‹åºéƒ½éœ€è¦å†…æ ¸ã€‚

JSå¼•æ“åˆ™ï¼šè§£æå’Œæ‰§è¡Œjavascriptæ¥å®ç°ç½‘é¡µçš„åŠ¨æ€æ•ˆæœã€‚

æœ€å¼€å§‹æ¸²æŸ“å¼•æ“å’ŒJSå¼•æ“å¹¶æ²¡æœ‰åŒºåˆ†çš„å¾ˆæ˜ç¡®ï¼Œåæ¥JSå¼•æ“è¶Šæ¥è¶Šç‹¬ç«‹ï¼Œå†…æ ¸å°±å€¾å‘äºåªæŒ‡æ¸²æŸ“å¼•æ“ã€‚
</code></pre></li>
<li><p>å¸¸è§çš„æµè§ˆå™¨å†…æ ¸æœ‰å“ªäº›ï¼Ÿ</p>
<pre><code>  Tridentå†…æ ¸ï¼šIE,MaxThon,TT,The World,360,æœç‹—æµè§ˆå™¨ç­‰ã€‚[åˆç§°MSHTML]
  Geckoå†…æ ¸ï¼šNetscape6åŠä»¥ä¸Šç‰ˆæœ¬ï¼ŒFF,MozillaSuite/SeaMonkeyç­‰
  Prestoå†…æ ¸ï¼šOpera7åŠä»¥ä¸Šã€‚      [Operaå†…æ ¸åŸä¸ºï¼šPrestoï¼Œç°ä¸ºï¼šBlink;]
  Webkitå†…æ ¸ï¼šSafari,Chromeç­‰ã€‚   [ Chromeçš„ï¼šBlinkï¼ˆWebKitçš„åˆ†æ”¯ï¼‰]

è¯¦ç»†æ–‡ç« ï¼š[æµè§ˆå™¨å†…æ ¸çš„è§£æå’Œå¯¹æ¯”](http://www.cnblogs.com/fullhouse/archive/2011/12/19/2293455.html)
</code></pre></li>
</ul>
<ul>
<li>html5æœ‰å“ªäº›æ–°ç‰¹æ€§ã€ç§»é™¤äº†é‚£äº›å…ƒç´ ï¼Ÿå¦‚ä½•å¤„ç†HTML5æ–°æ ‡ç­¾çš„æµè§ˆå™¨å…¼å®¹é—®é¢˜ï¼Ÿå¦‚ä½•åŒºåˆ† HTML å’Œ<br>HTML5ï¼Ÿ</li>
</ul>
<pre><code>* HTML5 ç°åœ¨å·²ç»ä¸æ˜¯ SGML çš„å­é›†ï¼Œä¸»è¦æ˜¯å…³äºå›¾åƒï¼Œä½ç½®ï¼Œå­˜å‚¨ï¼Œå¤šä»»åŠ¡ç­‰åŠŸèƒ½çš„å¢åŠ ã€‚
      ç»˜ç”» canvas;
      ç”¨äºåª’ä»‹å›æ”¾çš„ video å’Œ audio å…ƒç´ ;
      æœ¬åœ°ç¦»çº¿å­˜å‚¨ localStorage é•¿æœŸå­˜å‚¨æ•°æ®ï¼Œæµè§ˆå™¨å…³é—­åæ•°æ®ä¸ä¸¢å¤±;
      sessionStorage çš„æ•°æ®åœ¨æµè§ˆå™¨å…³é—­åè‡ªåŠ¨åˆ é™¤;
      è¯­æ„åŒ–æ›´å¥½çš„å†…å®¹å…ƒç´ ï¼Œæ¯”å¦‚ articleã€footerã€headerã€navã€section;
      è¡¨å•æ§ä»¶ï¼Œcalendarã€dateã€timeã€emailã€urlã€search;
      æ–°çš„æŠ€æœ¯webworker, websocket, Geolocation;

  ç§»é™¤çš„å…ƒç´ ï¼š
      çº¯è¡¨ç°çš„å…ƒç´ ï¼šbasefontï¼Œbigï¼Œcenterï¼Œfont, sï¼Œstrikeï¼Œttï¼Œu;
      å¯¹å¯ç”¨æ€§äº§ç”Ÿè´Ÿé¢å½±å“çš„å…ƒç´ ï¼šframeï¼Œframesetï¼Œnoframesï¼›

* æ”¯æŒHTML5æ–°æ ‡ç­¾ï¼š
     IE8/IE7/IE6æ”¯æŒé€šè¿‡document.createElementæ–¹æ³•äº§ç”Ÿçš„æ ‡ç­¾ï¼Œ
       å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§è®©è¿™äº›æµè§ˆå™¨æ”¯æŒHTML5æ–°æ ‡ç­¾ï¼Œ
       æµè§ˆå™¨æ”¯æŒæ–°æ ‡ç­¾åï¼Œè¿˜éœ€è¦æ·»åŠ æ ‡ç­¾é»˜è®¤çš„æ ·å¼ã€‚

     å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨æˆç†Ÿçš„æ¡†æ¶ã€æ¯”å¦‚html5shim;
     &lt;!--[if lt IE 9]&gt;
        &lt;script&gt; src=&quot;http://html5shim.googlecode.com/svn/trunk/html5.js&quot;&lt;/script&gt;
     &lt;![endif]--&gt;

* å¦‚ä½•åŒºåˆ†HTML5ï¼š DOCTYPEå£°æ˜\æ–°å¢çš„ç»“æ„å…ƒç´ \åŠŸèƒ½å…ƒç´ 
</code></pre><ul>
<li><p>ç®€è¿°ä¸€ä¸‹ä½ å¯¹HTMLè¯­ä¹‰åŒ–çš„ç†è§£ï¼Ÿ</p>
<pre><code>ç”¨æ­£ç¡®çš„æ ‡ç­¾åšæ­£ç¡®çš„äº‹æƒ…ã€‚
htmlè¯­ä¹‰åŒ–è®©é¡µé¢çš„å†…å®¹ç»“æ„åŒ–ï¼Œç»“æ„æ›´æ¸…æ™°ï¼Œä¾¿äºå¯¹æµè§ˆå™¨ã€æœç´¢å¼•æ“è§£æ;
å³ä½¿åœ¨æ²¡æœ‰æ ·å¼CSSæƒ…å†µä¸‹ä¹Ÿä»¥ä¸€ç§æ–‡æ¡£æ ¼å¼æ˜¾ç¤ºï¼Œå¹¶ä¸”æ˜¯å®¹æ˜“é˜…è¯»çš„;
æœç´¢å¼•æ“çš„çˆ¬è™«ä¹Ÿä¾èµ–äºHTMLæ ‡è®°æ¥ç¡®å®šä¸Šä¸‹æ–‡å’Œå„ä¸ªå…³é”®å­—çš„æƒé‡ï¼Œåˆ©äºSEO;
ä½¿é˜…è¯»æºä»£ç çš„äººå¯¹ç½‘ç«™æ›´å®¹æ˜“å°†ç½‘ç«™åˆ†å—ï¼Œä¾¿äºé˜…è¯»ç»´æŠ¤ç†è§£ã€‚
</code></pre></li>
</ul>
<ul>
<li><p>HTML5çš„ç¦»çº¿å‚¨å­˜æ€ä¹ˆä½¿ç”¨ï¼Œå·¥ä½œåŸç†èƒ½ä¸èƒ½è§£é‡Šä¸€ä¸‹ï¼Ÿ</p>
<pre><code>åœ¨ç”¨æˆ·æ²¡æœ‰ä¸å› ç‰¹ç½‘è¿æ¥æ—¶ï¼Œå¯ä»¥æ­£å¸¸è®¿é—®ç«™ç‚¹æˆ–åº”ç”¨ï¼Œåœ¨ç”¨æˆ·ä¸å› ç‰¹ç½‘è¿æ¥æ—¶ï¼Œæ›´æ–°ç”¨æˆ·æœºå™¨ä¸Šçš„ç¼“å­˜æ–‡ä»¶ã€‚
åŸç†ï¼šHTML5çš„ç¦»çº¿å­˜å‚¨æ˜¯åŸºäºä¸€ä¸ªæ–°å»ºçš„.appcacheæ–‡ä»¶çš„ç¼“å­˜æœºåˆ¶(ä¸æ˜¯å­˜å‚¨æŠ€æœ¯)ï¼Œé€šè¿‡è¿™ä¸ªæ–‡ä»¶ä¸Šçš„è§£ææ¸…å•ç¦»çº¿å­˜å‚¨èµ„æºï¼Œè¿™äº›èµ„æºå°±ä¼šåƒcookieä¸€æ ·è¢«å­˜å‚¨äº†ä¸‹æ¥ã€‚ä¹‹åå½“ç½‘ç»œåœ¨å¤„äºç¦»çº¿çŠ¶æ€ä¸‹æ—¶ï¼Œæµè§ˆå™¨ä¼šé€šè¿‡è¢«ç¦»çº¿å­˜å‚¨çš„æ•°æ®è¿›è¡Œé¡µé¢å±•ç¤ºã€‚
</code></pre></li>
</ul>
<pre><code>    å¦‚ä½•ä½¿ç”¨ï¼š
    1ã€é¡µé¢å¤´éƒ¨åƒä¸‹é¢ä¸€æ ·åŠ å…¥ä¸€ä¸ªmanifestçš„å±æ€§ï¼›
    2ã€åœ¨cache.manifestæ–‡ä»¶çš„ç¼–å†™ç¦»çº¿å­˜å‚¨çš„èµ„æºï¼›
        CACHE MANIFEST
        #v0.11
        CACHE:
        js/app.js
        css/style.css
        NETWORK:
        resourse/logo.png
        FALLBACK:
        / /offline.html
    3ã€åœ¨ç¦»çº¿çŠ¶æ€æ—¶ï¼Œæ“ä½œwindow.applicationCacheè¿›è¡Œéœ€æ±‚å®ç°ã€‚

è¯¦ç»†çš„ä½¿ç”¨è¯·å‚è€ƒï¼š

[HTML5 ç¦»çº¿ç¼“å­˜-manifestç®€ä»‹](http://yanhaijing.com/html/2014/12/28/html5-manifest/)

[æœ‰è¶£çš„HTML5ï¼šç¦»çº¿å­˜å‚¨](http://segmentfault.com/a/1190000000732617)
</code></pre><ul>
<li><p>æµè§ˆå™¨æ˜¯æ€ä¹ˆå¯¹HTML5çš„ç¦»çº¿å‚¨å­˜èµ„æºè¿›è¡Œç®¡ç†å’ŒåŠ è½½çš„å‘¢ï¼Ÿ</p>
<pre><code>åœ¨çº¿çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å‘ç°htmlå¤´éƒ¨æœ‰manifestå±æ€§ï¼Œå®ƒä¼šè¯·æ±‚manifestæ–‡ä»¶ï¼Œå¦‚æœæ˜¯ç¬¬ä¸€æ¬¡è®¿é—®appï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šæ ¹æ®manifestæ–‡ä»¶çš„å†…å®¹ä¸‹è½½ç›¸åº”çš„èµ„æºå¹¶ä¸”è¿›è¡Œç¦»çº¿å­˜å‚¨ã€‚å¦‚æœå·²ç»è®¿é—®è¿‡appå¹¶ä¸”èµ„æºå·²ç»ç¦»çº¿å­˜å‚¨äº†ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°±ä¼šä½¿ç”¨ç¦»çº¿çš„èµ„æºåŠ è½½é¡µé¢ï¼Œç„¶åæµè§ˆå™¨ä¼šå¯¹æ¯”æ–°çš„manifestæ–‡ä»¶ä¸æ—§çš„manifestæ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶æ²¡æœ‰å‘ç”Ÿæ”¹å˜ï¼Œå°±ä¸åšä»»ä½•æ“ä½œï¼Œå¦‚æœæ–‡ä»¶æ”¹å˜äº†ï¼Œé‚£ä¹ˆå°±ä¼šé‡æ–°ä¸‹è½½æ–‡ä»¶ä¸­çš„èµ„æºå¹¶è¿›è¡Œç¦»çº¿å­˜å‚¨ã€‚
ç¦»çº¿çš„æƒ…å†µä¸‹ï¼Œæµè§ˆå™¨å°±ç›´æ¥ä½¿ç”¨ç¦»çº¿å­˜å‚¨çš„èµ„æºã€‚
</code></pre><p>  è¯¦ç»†è¯·å‚è€ƒï¼š<a href="http://segmentfault.com/a/1190000000732617" target="_blank" rel="external">æœ‰è¶£çš„HTML5ï¼šç¦»çº¿å­˜å‚¨</a></p>
</li>
<li><p>è¯·æè¿°ä¸€ä¸‹ cookiesï¼ŒsessionStorage å’Œ localStorage çš„åŒºåˆ«ï¼Ÿ</p>
<pre><code>cookieæ˜¯ç½‘ç«™ä¸ºäº†æ ‡ç¤ºç”¨æˆ·èº«ä»½è€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ï¼ˆClient Sideï¼‰ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ã€‚
cookieæ•°æ®å§‹ç»ˆåœ¨åŒæºçš„httpè¯·æ±‚ä¸­æºå¸¦ï¼ˆå³ä½¿ä¸éœ€è¦ï¼‰ï¼Œè®°ä¼šåœ¨æµè§ˆå™¨å’ŒæœåŠ¡å™¨é—´æ¥å›ä¼ é€’ã€‚
sessionStorageå’ŒlocalStorageä¸ä¼šè‡ªåŠ¨æŠŠæ•°æ®å‘ç»™æœåŠ¡å™¨ï¼Œä»…åœ¨æœ¬åœ°ä¿å­˜ã€‚

å­˜å‚¨å¤§å°ï¼š
    cookieæ•°æ®å¤§å°ä¸èƒ½è¶…è¿‡4kã€‚
    sessionStorageå’ŒlocalStorage è™½ç„¶ä¹Ÿæœ‰å­˜å‚¨å¤§å°çš„é™åˆ¶ï¼Œä½†æ¯”cookieå¤§å¾—å¤šï¼Œå¯ä»¥è¾¾åˆ°5Mæˆ–æ›´å¤§ã€‚

æœ‰æœŸæ—¶é—´ï¼š
    localStorage    å­˜å‚¨æŒä¹…æ•°æ®ï¼Œæµè§ˆå™¨å…³é—­åæ•°æ®ä¸ä¸¢å¤±é™¤éä¸»åŠ¨åˆ é™¤æ•°æ®ï¼›
    sessionStorage  æ•°æ®åœ¨å½“å‰æµè§ˆå™¨çª—å£å…³é—­åè‡ªåŠ¨åˆ é™¤ã€‚
    cookie          è®¾ç½®çš„cookieè¿‡æœŸæ—¶é—´ä¹‹å‰ä¸€ç›´æœ‰æ•ˆï¼Œå³ä½¿çª—å£æˆ–æµè§ˆå™¨å…³é—­
</code></pre></li>
<li><p>iframeæœ‰é‚£äº›ç¼ºç‚¹ï¼Ÿ</p>
<pre><code>*iframeä¼šé˜»å¡ä¸»é¡µé¢çš„Onloadäº‹ä»¶ï¼›
*æœç´¢å¼•æ“çš„æ£€ç´¢ç¨‹åºæ— æ³•è§£è¯»è¿™ç§é¡µé¢ï¼Œä¸åˆ©äºSEO;

*iframeå’Œä¸»é¡µé¢å…±äº«è¿æ¥æ± ï¼Œè€Œæµè§ˆå™¨å¯¹ç›¸åŒåŸŸçš„è¿æ¥æœ‰é™åˆ¶ï¼Œæ‰€ä»¥ä¼šå½±å“é¡µé¢çš„å¹¶è¡ŒåŠ è½½ã€‚

ä½¿ç”¨iframeä¹‹å‰éœ€è¦è€ƒè™‘è¿™ä¸¤ä¸ªç¼ºç‚¹ã€‚å¦‚æœéœ€è¦ä½¿ç”¨iframeï¼Œæœ€å¥½æ˜¯é€šè¿‡javascript
åŠ¨æ€ç»™iframeæ·»åŠ srcå±æ€§å€¼ï¼Œè¿™æ ·å¯ä»¥ç»•å¼€ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜ã€‚
</code></pre></li>
<li><p>Labelçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯æ€ä¹ˆç”¨çš„ï¼Ÿ</p>
<pre><code>labelæ ‡ç­¾æ¥å®šä¹‰è¡¨å•æ§åˆ¶é—´çš„å…³ç³»,å½“ç”¨æˆ·é€‰æ‹©è¯¥æ ‡ç­¾æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨å°†ç„¦ç‚¹è½¬åˆ°å’Œæ ‡ç­¾ç›¸å…³çš„è¡¨å•æ§ä»¶ä¸Šã€‚

&lt;label for=&quot;Name&quot;&gt;Number:&lt;/label&gt;
&lt;input type=â€œtextâ€œname=&quot;Name&quot; id=&quot;Name&quot;/&gt;

&lt;label&gt;Date:&lt;input type=&quot;text&quot; name=&quot;B&quot;/&gt;&lt;/label&gt;
</code></pre></li>
<li><p>HTML5çš„formå¦‚ä½•å…³é—­è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ï¼Ÿ</p>
<pre><code>ç»™ä¸æƒ³è¦æç¤ºçš„ form æˆ–æŸä¸ª input è®¾ç½®ä¸º autocomplete=offã€‚
</code></pre></li>
</ul>
<ul>
<li><p>å¦‚ä½•å®ç°æµè§ˆå™¨å†…å¤šä¸ªæ ‡ç­¾é¡µä¹‹é—´çš„é€šä¿¡? (é˜¿é‡Œ)</p>
<pre><code>WebSocketã€SharedWorkerï¼›
ä¹Ÿå¯ä»¥è°ƒç”¨localstorgeã€cookiesç­‰æœ¬åœ°å­˜å‚¨æ–¹å¼ï¼›

localstorgeå¦ä¸€ä¸ªæµè§ˆä¸Šä¸‹æ–‡é‡Œè¢«æ·»åŠ ã€ä¿®æ”¹æˆ–åˆ é™¤æ—¶ï¼Œå®ƒéƒ½ä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œ
æˆ‘ä»¬é€šè¿‡ç›‘å¬äº‹ä»¶ï¼Œæ§åˆ¶å®ƒçš„å€¼æ¥è¿›è¡Œé¡µé¢ä¿¡æ¯é€šä¿¡ï¼›
æ³¨æ„quirksï¼šSafari åœ¨æ— ç—•æ¨¡å¼ä¸‹è®¾ç½®localstorgeå€¼æ—¶ä¼šæŠ›å‡º QuotaExceededError çš„å¼‚å¸¸ï¼›
</code></pre></li>
<li><p>webSocketå¦‚ä½•å…¼å®¹ä½æµè§ˆå™¨ï¼Ÿ(é˜¿é‡Œ)</p>
<pre><code>Adobe Flash Socket ã€
ActiveX HTMLFile (IE) ã€
åŸºäº multipart ç¼–ç å‘é€ XHR ã€
åŸºäºé•¿è½®è¯¢çš„ XHR
</code></pre></li>
<li><p>é¡µé¢å¯è§æ€§ï¼ˆPage Visibility APIï¼‰ å¯ä»¥æœ‰å“ªäº›ç”¨é€”ï¼Ÿ</p>
<pre><code>é€šè¿‡ visibilityState çš„å€¼æ£€æµ‹é¡µé¢å½“å‰æ˜¯å¦å¯è§ï¼Œä»¥åŠæ‰“å¼€ç½‘é¡µçš„æ—¶é—´ç­‰;
åœ¨é¡µé¢è¢«åˆ‡æ¢åˆ°å…¶ä»–åå°è¿›ç¨‹çš„æ—¶å€™ï¼Œè‡ªåŠ¨æš‚åœéŸ³ä¹æˆ–è§†é¢‘çš„æ’­æ”¾ï¼›
</code></pre></li>
</ul>
<ul>
<li><p>å¦‚ä½•åœ¨é¡µé¢ä¸Šå®ç°ä¸€ä¸ªåœ†å½¢çš„å¯ç‚¹å‡»åŒºåŸŸï¼Ÿ</p>
<pre><code>1ã€map+areaæˆ–è€…svg
2ã€border-radius
3ã€çº¯jså®ç° éœ€è¦æ±‚ä¸€ä¸ªç‚¹åœ¨ä¸åœ¨åœ†ä¸Šç®€å•ç®—æ³•ã€è·å–é¼ æ ‡åæ ‡ç­‰ç­‰
</code></pre></li>
<li><p>å®ç°ä¸ä½¿ç”¨ border ç”»å‡º1pxé«˜çš„çº¿ï¼Œåœ¨ä¸åŒæµè§ˆå™¨çš„æ ‡å‡†æ¨¡å¼ä¸æ€ªå¼‚æ¨¡å¼ä¸‹éƒ½èƒ½ä¿æŒä¸€è‡´çš„æ•ˆæœã€‚</p>
<pre><code>&lt;div style=&quot;height:1px;overflow:hidden;background:red&quot;&gt;&lt;/div&gt;
</code></pre></li>
</ul>
<ul>
<li><p>ç½‘é¡µéªŒè¯ç æ˜¯å¹²å˜›çš„ï¼Œæ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆå®‰å…¨é—®é¢˜ã€‚</p>
<pre><code>åŒºåˆ†ç”¨æˆ·æ˜¯è®¡ç®—æœºè¿˜æ˜¯äººçš„å…¬å…±å…¨è‡ªåŠ¨ç¨‹åºã€‚å¯ä»¥é˜²æ­¢æ¶æ„ç ´è§£å¯†ç ã€åˆ·ç¥¨ã€è®ºå›çŒæ°´ï¼›
æœ‰æ•ˆé˜²æ­¢é»‘å®¢å¯¹æŸä¸€ä¸ªç‰¹å®šæ³¨å†Œç”¨æˆ·ç”¨ç‰¹å®šç¨‹åºæš´åŠ›ç ´è§£æ–¹å¼è¿›è¡Œä¸æ–­çš„ç™»é™†å°è¯•ã€‚
</code></pre></li>
<li><p>titleä¸h1çš„åŒºåˆ«ã€bä¸strongçš„åŒºåˆ«ã€iä¸emçš„åŒºåˆ«ï¼Ÿ</p>
<pre><code>titleå±æ€§æ²¡æœ‰æ˜ç¡®æ„ä¹‰åªè¡¨ç¤ºæ˜¯ä¸ªæ ‡é¢˜ï¼ŒH1åˆ™è¡¨ç¤ºå±‚æ¬¡æ˜ç¡®çš„æ ‡é¢˜ï¼Œå¯¹é¡µé¢ä¿¡æ¯çš„æŠ“å–ä¹Ÿæœ‰å¾ˆå¤§çš„å½±å“ï¼›

strongæ˜¯æ ‡æ˜é‡ç‚¹å†…å®¹ï¼Œæœ‰è¯­æ°”åŠ å¼ºçš„å«ä¹‰ï¼Œä½¿ç”¨é˜…è¯»è®¾å¤‡é˜…è¯»ç½‘ç»œæ—¶ï¼š&lt;strong&gt;ä¼šé‡è¯»ï¼Œè€Œ&lt;B&gt;æ˜¯å±•ç¤ºå¼ºè°ƒå†…å®¹ã€‚

iå†…å®¹å±•ç¤ºä¸ºæ–œä½“ï¼Œemè¡¨ç¤ºå¼ºè°ƒçš„æ–‡æœ¬ï¼›

Physical Style Elements -- è‡ªç„¶æ ·å¼æ ‡ç­¾
b, i, u, s, pre
Semantic Style Elements -- è¯­ä¹‰æ ·å¼æ ‡ç­¾
strong, em, ins, del, code
åº”è¯¥å‡†ç¡®ä½¿ç”¨è¯­ä¹‰æ ·å¼æ ‡ç­¾, ä½†ä¸èƒ½æ»¥ç”¨, å¦‚æœä¸èƒ½ç¡®å®šæ—¶é¦–é€‰ä½¿ç”¨è‡ªç„¶æ ·å¼æ ‡ç­¾ã€‚
</code></pre></li>
</ul>
<h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a><a name="css">CSS</a></h2><ul>
<li><p>ä»‹ç»ä¸€ä¸‹æ ‡å‡†çš„CSSçš„ç›’å­æ¨¡å‹ï¼Ÿä½ç‰ˆæœ¬IEçš„ç›’å­æ¨¡å‹æœ‰ä»€ä¹ˆä¸åŒçš„ï¼Ÿ</p>
<pre><code>ï¼ˆ1ï¼‰æœ‰ä¸¤ç§ï¼Œ IE ç›’å­æ¨¡å‹ã€W3C ç›’å­æ¨¡å‹ï¼›
ï¼ˆ2ï¼‰ç›’æ¨¡å‹ï¼š å†…å®¹(content)ã€å¡«å……(padding)ã€è¾¹ç•Œ(margin)ã€ è¾¹æ¡†(border)ï¼›
ï¼ˆ3ï¼‰åŒº  åˆ«ï¼š IEçš„contentéƒ¨åˆ†æŠŠ border å’Œ paddingè®¡ç®—äº†è¿›å»;
</code></pre></li>
</ul>
<ul>
<li><p>CSSé€‰æ‹©ç¬¦æœ‰å“ªäº›ï¼Ÿå“ªäº›å±æ€§å¯ä»¥ç»§æ‰¿ï¼Ÿ</p>
<pre><code>*   1.idé€‰æ‹©å™¨ï¼ˆ # myidï¼‰
    2.ç±»é€‰æ‹©å™¨ï¼ˆ.myclassnameï¼‰
    3.æ ‡ç­¾é€‰æ‹©å™¨ï¼ˆdiv, h1, pï¼‰
    4.ç›¸é‚»é€‰æ‹©å™¨ï¼ˆh1 + pï¼‰
    5.å­é€‰æ‹©å™¨ï¼ˆul &gt; liï¼‰
    6.åä»£é€‰æ‹©å™¨ï¼ˆli aï¼‰
    7.é€šé…ç¬¦é€‰æ‹©å™¨ï¼ˆ * ï¼‰
    8.å±æ€§é€‰æ‹©å™¨ï¼ˆa[rel = &quot;external&quot;]ï¼‰
    9.ä¼ªç±»é€‰æ‹©å™¨ï¼ˆa:hover, li:nth-childï¼‰

*   å¯ç»§æ‰¿çš„æ ·å¼ï¼š font-size font-family color, UL LI DL DD DT;

*   ä¸å¯ç»§æ‰¿çš„æ ·å¼ï¼šborder padding margin width height ;
</code></pre></li>
</ul>
<ul>
<li><p>CSSä¼˜å…ˆçº§ç®—æ³•å¦‚ä½•è®¡ç®—ï¼Ÿ</p>
<pre><code>*   ä¼˜å…ˆçº§å°±è¿‘åŸåˆ™ï¼ŒåŒæƒé‡æƒ…å†µä¸‹æ ·å¼å®šä¹‰æœ€è¿‘è€…ä¸ºå‡†;
*   è½½å…¥æ ·å¼ä»¥æœ€åè½½å…¥çš„å®šä½ä¸ºå‡†;

ä¼˜å…ˆçº§ä¸º:
    åŒæƒé‡: å†…è”æ ·å¼è¡¨ï¼ˆæ ‡ç­¾å†…éƒ¨ï¼‰&gt; åµŒå…¥æ ·å¼è¡¨ï¼ˆå½“å‰æ–‡ä»¶ä¸­ï¼‰&gt; å¤–éƒ¨æ ·å¼è¡¨ï¼ˆå¤–éƒ¨æ–‡ä»¶ä¸­ï¼‰ã€‚
    !important &gt;  id &gt; class &gt; tag
    important æ¯” å†…è”ä¼˜å…ˆçº§é«˜
</code></pre></li>
<li><p>CSS3æ–°å¢ä¼ªç±»æœ‰é‚£äº›ï¼Ÿ</p>
<pre><code>ä¸¾ä¾‹ï¼š
p:first-of-type    é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„é¦–ä¸ª &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚
p:last-of-type    é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„æœ€å &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚
p:only-of-type    é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ å”¯ä¸€çš„ &lt;p&gt; å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚
p:only-child        é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„å”¯ä¸€å­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚
p:nth-child(2)    é€‰æ‹©å±äºå…¶çˆ¶å…ƒç´ çš„ç¬¬äºŒä¸ªå­å…ƒç´ çš„æ¯ä¸ª &lt;p&gt; å…ƒç´ ã€‚

:after            åœ¨å…ƒç´ ä¹‹å‰æ·»åŠ å†…å®¹,ä¹Ÿå¯ä»¥ç”¨æ¥åšæ¸…é™¤æµ®åŠ¨ã€‚
:before            åœ¨å…ƒç´ ä¹‹åæ·»åŠ å†…å®¹
 :enabled          
:disabled         æ§åˆ¶è¡¨å•æ§ä»¶çš„ç¦ç”¨çŠ¶æ€ã€‚
:checked        å•é€‰æ¡†æˆ–å¤é€‰æ¡†è¢«é€‰ä¸­ã€‚
</code></pre></li>
<li><p>å¦‚ä½•å±…ä¸­divï¼Ÿ</p>
</li>
</ul>
<pre><code>*  æ°´å¹³å±…ä¸­ï¼šç»™divè®¾ç½®ä¸€ä¸ªå®½åº¦ï¼Œç„¶åæ·»åŠ margin:0 autoå±æ€§

        div{
            width:200px;
            margin:0 auto;
         }

*  è®©ç»å¯¹å®šä½çš„divå±…ä¸­

        div {
            position: absolute;
            width: 300px;
            height: 300px;
            margin: auto;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background-color: pink;    /* æ–¹ä¾¿çœ‹æ•ˆæœ */
        }

*  æ°´å¹³å‚ç›´å±…ä¸­ä¸€

        ç¡®å®šå®¹å™¨çš„å®½é«˜ å®½500 é«˜ 300 çš„å±‚
        è®¾ç½®å±‚çš„å¤–è¾¹è·

        div {
            position: relative;        /* ç›¸å¯¹å®šä½æˆ–ç»å¯¹å®šä½å‡å¯ */
            width:500px;
            height:300px;
            top: 50%;
            left: 50%;
            margin: -150px 0 0 -250px;         /* å¤–è¾¹è·ä¸ºè‡ªèº«å®½é«˜çš„ä¸€åŠ */
            background-color: pink;         /* æ–¹ä¾¿çœ‹æ•ˆæœ */

         }

*  æ°´å¹³å‚ç›´å±…ä¸­äºŒ

        æœªçŸ¥å®¹å™¨çš„å®½é«˜ï¼Œåˆ©ç”¨ `transform` å±æ€§

        div {
            position: absolute;        /* ç›¸å¯¹å®šä½æˆ–ç»å¯¹å®šä½å‡å¯ */
            width:500px;
            height:300px;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: pink;         /* æ–¹ä¾¿çœ‹æ•ˆæœ */

        }

*  æ°´å¹³å‚ç›´å±…ä¸­ä¸‰

        åˆ©ç”¨ flex å¸ƒå±€
        å®é™…ä½¿ç”¨æ—¶åº”è€ƒè™‘å…¼å®¹æ€§

        .container {
            display: flex;
            align-items: center;         /* å‚ç›´å±…ä¸­ */
            justify-content: center;    /* æ°´å¹³å±…ä¸­ */

        }
        .container div {
            width: 100px;
            height: 100px;
            background-color: pink;        /* æ–¹ä¾¿çœ‹æ•ˆæœ */
        }  
</code></pre><ul>
<li><p>displayæœ‰å“ªäº›å€¼ï¼Ÿè¯´æ˜ä»–ä»¬çš„ä½œç”¨ã€‚</p>
<pre><code>block           å—ç±»å‹ã€‚é»˜è®¤å®½åº¦ä¸ºçˆ¶å…ƒç´ å®½åº¦ï¼Œå¯è®¾ç½®å®½é«˜ï¼Œæ¢è¡Œæ˜¾ç¤ºã€‚
none            ç¼ºçœå€¼ã€‚è±¡è¡Œå†…å…ƒç´ ç±»å‹ä¸€æ ·æ˜¾ç¤ºã€‚
inline          è¡Œå†…å…ƒç´ ç±»å‹ã€‚é»˜è®¤å®½åº¦ä¸ºå†…å®¹å®½åº¦ï¼Œä¸å¯è®¾ç½®å®½é«˜ï¼ŒåŒè¡Œæ˜¾ç¤ºã€‚
inline-block  é»˜è®¤å®½åº¦ä¸ºå†…å®¹å®½åº¦ï¼Œå¯ä»¥è®¾ç½®å®½é«˜ï¼ŒåŒè¡Œæ˜¾ç¤ºã€‚
list-item       è±¡å—ç±»å‹å…ƒç´ ä¸€æ ·æ˜¾ç¤ºï¼Œå¹¶æ·»åŠ æ ·å¼åˆ—è¡¨æ ‡è®°ã€‚
table           æ­¤å…ƒç´ ä¼šä½œä¸ºå—çº§è¡¨æ ¼æ¥æ˜¾ç¤ºã€‚
inherit         è§„å®šåº”è¯¥ä»çˆ¶å…ƒç´ ç»§æ‰¿ display å±æ€§çš„å€¼ã€‚
</code></pre></li>
</ul>
<ul>
<li><p>positionçš„å€¼relativeå’Œabsoluteå®šä½åŸç‚¹æ˜¯ï¼Ÿ</p>
<pre><code>absolute
  ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºå€¼ä¸ä¸º staticçš„ç¬¬ä¸€ä¸ªçˆ¶å…ƒç´ è¿›è¡Œå®šä½ã€‚
fixed ï¼ˆè€IEä¸æ”¯æŒï¼‰
  ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºæµè§ˆå™¨çª—å£è¿›è¡Œå®šä½ã€‚
relative
  ç”Ÿæˆç›¸å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºå…¶æ­£å¸¸ä½ç½®è¿›è¡Œå®šä½ã€‚
static
  é»˜è®¤å€¼ã€‚æ²¡æœ‰å®šä½ï¼Œå…ƒç´ å‡ºç°åœ¨æ­£å¸¸çš„æµä¸­ï¼ˆå¿½ç•¥ top, bottom, left, right z-index å£°æ˜ï¼‰ã€‚
inherit
  è§„å®šä»çˆ¶å…ƒç´ ç»§æ‰¿ position å±æ€§çš„å€¼ã€‚
</code></pre></li>
<li><p>CSS3æœ‰å“ªäº›æ–°ç‰¹æ€§ï¼Ÿ</p>
<pre><code>æ–°å¢å„ç§CSSé€‰æ‹©å™¨    ï¼ˆ: not(.input)ï¼šæ‰€æœ‰ class ä¸æ˜¯â€œinputâ€çš„èŠ‚ç‚¹ï¼‰
  åœ†è§’            ï¼ˆborder-radius:8pxï¼‰
å¤šåˆ—å¸ƒå±€        ï¼ˆmulti-column layoutï¼‰
é˜´å½±å’Œåå°„    ï¼ˆShadow\Reflectï¼‰
æ–‡å­—ç‰¹æ•ˆ        ï¼ˆtext-shadowã€ï¼‰
æ–‡å­—æ¸²æŸ“        ï¼ˆText-decorationï¼‰
çº¿æ€§æ¸å˜        ï¼ˆgradientï¼‰
æ—‹è½¬             ï¼ˆtransformï¼‰
ç¼©æ”¾,å®šä½,å€¾æ–œ,åŠ¨ç”»,å¤šèƒŒæ™¯
ä¾‹å¦‚:transform:\scale(0.85,0.90)\ translate(0px,-30px)\ skew(-9deg,0deg)\Animation:
</code></pre></li>
<li><p>è¯·è§£é‡Šä¸€ä¸‹CSS3çš„Flexboxï¼ˆå¼¹æ€§ç›’å¸ƒå±€æ¨¡å‹ï¼‰,ä»¥åŠé€‚ç”¨åœºæ™¯ï¼Ÿ</p>
<pre><code>ä¸€ä¸ªç”¨äºé¡µé¢å¸ƒå±€çš„å…¨æ–°CSS3åŠŸèƒ½ï¼ŒFlexboxå¯ä»¥æŠŠåˆ—è¡¨æ”¾åœ¨åŒä¸€ä¸ªæ–¹å‘ï¼ˆä»ä¸Šåˆ°ä¸‹æ’åˆ—ï¼Œä»å·¦åˆ°å³ï¼‰ï¼Œå¹¶è®©åˆ—è¡¨èƒ½å»¶ä¼¸åˆ°å ç”¨å¯ç”¨çš„ç©ºé—´ã€‚
è¾ƒä¸ºå¤æ‚çš„å¸ƒå±€è¿˜å¯ä»¥é€šè¿‡åµŒå¥—ä¸€ä¸ªä¼¸ç¼©å®¹å™¨ï¼ˆflex containerï¼‰æ¥å®ç°ã€‚
é‡‡ç”¨Flexå¸ƒå±€çš„å…ƒç´ ï¼Œç§°ä¸ºFlexå®¹å™¨ï¼ˆflex containerï¼‰ï¼Œç®€ç§°&quot;å®¹å™¨&quot;ã€‚
å®ƒçš„æ‰€æœ‰å­å…ƒç´ è‡ªåŠ¨æˆä¸ºå®¹å™¨æˆå‘˜ï¼Œç§°ä¸ºFlexé¡¹ç›®ï¼ˆflex itemï¼‰ï¼Œç®€ç§°&quot;é¡¹ç›®&quot;ã€‚
å¸¸è§„å¸ƒå±€æ˜¯åŸºäºå—å’Œå†…è”æµæ–¹å‘ï¼Œè€ŒFlexå¸ƒå±€æ˜¯åŸºäºflex-flowæµå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç”¨æ¥åšå±€ä¸­ï¼Œèƒ½å¯¹ä¸åŒå±å¹•å¤§å°è‡ªé€‚åº”ã€‚
åœ¨å¸ƒå±€ä¸Šæœ‰äº†æ¯”ä»¥å‰æ›´åŠ çµæ´»çš„ç©ºé—´ã€‚

å…·ä½“ï¼šhttp://www.w3cplus.com/css3/flexbox-basics.html
</code></pre></li>
<li><p>ç”¨çº¯CSSåˆ›å»ºä¸€ä¸ªä¸‰è§’å½¢çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<pre><code>æŠŠä¸Šã€å·¦ã€å³ä¸‰æ¡è¾¹éšè—æ‰ï¼ˆé¢œè‰²è®¾ä¸º transparentï¼‰
#demo {
  width: 0;
  height: 0;
  border-width: 20px;
  border-style: solid;
  border-color: transparent transparent red transparent;
}
</code></pre></li>
<li><p>ä¸€ä¸ªæ»¡å± å“ å­—å¸ƒå±€ å¦‚ä½•è®¾è®¡?</p>
<pre><code>ç®€å•çš„æ–¹å¼ï¼š
    ä¸Šé¢çš„divå®½100%ï¼Œ
    ä¸‹é¢çš„ä¸¤ä¸ªdivåˆ†åˆ«å®½50%ï¼Œ
    ç„¶åç”¨floatæˆ–è€…inlineä½¿å…¶ä¸æ¢è¡Œå³å¯
</code></pre></li>
<li><p>csså¤šåˆ—ç­‰é«˜å¦‚ä½•å®ç°ï¼Ÿ</p>
<pre><code>åˆ©ç”¨padding-bottom|margin-bottomæ­£è´Ÿå€¼ç›¸æŠµï¼›
è®¾ç½®çˆ¶å®¹å™¨è®¾ç½®è¶…å‡ºéšè—ï¼ˆoverflow:hiddenï¼‰ï¼Œè¿™æ ·å­çˆ¶å®¹å™¨çš„é«˜åº¦å°±è¿˜æ˜¯å®ƒé‡Œé¢çš„åˆ—æ²¡æœ‰è®¾å®špadding-bottomæ—¶çš„é«˜åº¦ï¼Œ
å½“å®ƒé‡Œé¢çš„ä»» ä¸€åˆ—é«˜åº¦å¢åŠ äº†ï¼Œåˆ™çˆ¶å®¹å™¨çš„é«˜åº¦è¢«æ’‘åˆ°é‡Œé¢æœ€é«˜é‚£åˆ—çš„é«˜åº¦ï¼Œ
å…¶ä»–æ¯”è¿™åˆ—çŸ®çš„åˆ—ä¼šç”¨å®ƒä»¬çš„padding-bottomè¡¥å¿è¿™éƒ¨åˆ†é«˜åº¦å·®ã€‚
</code></pre></li>
</ul>
<ul>
<li><p>ç»å¸¸é‡åˆ°çš„æµè§ˆå™¨çš„å…¼å®¹æ€§æœ‰å“ªäº›ï¼ŸåŸå› ï¼Œè§£å†³æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Œå¸¸ç”¨hackçš„æŠ€å·§ ï¼Ÿ</p>
<pre><code>* png24ä½çš„å›¾ç‰‡åœ¨iE6æµè§ˆå™¨ä¸Šå‡ºç°èƒŒæ™¯ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åšæˆPNG8.

* æµè§ˆå™¨é»˜è®¤çš„marginå’Œpaddingä¸åŒã€‚è§£å†³æ–¹æ¡ˆæ˜¯åŠ ä¸€ä¸ªå…¨å±€çš„*{margin:0;padding:0;}æ¥ç»Ÿä¸€ã€‚

* IE6åŒè¾¹è·bug:å—å±æ€§æ ‡ç­¾floatåï¼Œåˆæœ‰æ¨ªè¡Œçš„marginæƒ…å†µä¸‹ï¼Œåœ¨ie6æ˜¾ç¤ºmarginæ¯”è®¾ç½®çš„å¤§ã€‚

  æµ®åŠ¨ieäº§ç”Ÿçš„åŒå€è·ç¦» #box{ float:left; width:10px; margin:0 0 0 100px;}

  è¿™ç§æƒ…å†µä¹‹ä¸‹IEä¼šäº§ç”Ÿ20pxçš„è·ç¦»ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯åœ¨floatçš„æ ‡ç­¾æ ·å¼æ§åˆ¶ä¸­åŠ å…¥ â€”â€”_display:inline;å°†å…¶è½¬åŒ–ä¸ºè¡Œå†…å±æ€§ã€‚(_è¿™ä¸ªç¬¦å·åªæœ‰ie6ä¼šè¯†åˆ«)

  æ¸è¿›è¯†åˆ«çš„æ–¹å¼ï¼Œä»æ€»ä½“ä¸­é€æ¸æ’é™¤å±€éƒ¨ã€‚

  é¦–å…ˆï¼Œå·§å¦™çš„ä½¿ç”¨â€œ\9â€è¿™ä¸€æ ‡è®°ï¼Œå°†IEæ¸¸è§ˆå™¨ä»æ‰€æœ‰æƒ…å†µä¸­åˆ†ç¦»å‡ºæ¥ã€‚
  æ¥ç€ï¼Œå†æ¬¡ä½¿ç”¨â€œ+â€å°†IE8å’ŒIE7ã€IE6åˆ†ç¦»å¼€æ¥ï¼Œè¿™æ ·IE8å·²ç»ç‹¬ç«‹è¯†åˆ«ã€‚

  css
      .bb{
          background-color:red;/*æ‰€æœ‰è¯†åˆ«*/
          background-color:#00deff\9; /*IE6ã€7ã€8è¯†åˆ«*/
          +background-color:#a200ff;/*IE6ã€7è¯†åˆ«*/
          _background-color:#1e0bd1;/*IE6è¯†åˆ«*/
      }
</code></pre></li>
</ul>
<pre><code>*  IEä¸‹,å¯ä»¥ä½¿ç”¨è·å–å¸¸è§„å±æ€§çš„æ–¹æ³•æ¥è·å–è‡ªå®šä¹‰å±æ€§,
   ä¹Ÿå¯ä»¥ä½¿ç”¨getAttribute()è·å–è‡ªå®šä¹‰å±æ€§;
   Firefoxä¸‹,åªèƒ½ä½¿ç”¨getAttribute()è·å–è‡ªå®šä¹‰å±æ€§ã€‚
   è§£å†³æ–¹æ³•:ç»Ÿä¸€é€šè¿‡getAttribute()è·å–è‡ªå®šä¹‰å±æ€§ã€‚

*  IEä¸‹,evenå¯¹è±¡æœ‰x,yå±æ€§,ä½†æ˜¯æ²¡æœ‰pageX,pageYå±æ€§;
   Firefoxä¸‹,eventå¯¹è±¡æœ‰pageX,pageYå±æ€§,ä½†æ˜¯æ²¡æœ‰x,yå±æ€§ã€‚

*  è§£å†³æ–¹æ³•ï¼šï¼ˆæ¡ä»¶æ³¨é‡Šï¼‰ç¼ºç‚¹æ˜¯åœ¨IEæµè§ˆå™¨ä¸‹å¯èƒ½ä¼šå¢åŠ é¢å¤–çš„HTTPè¯·æ±‚æ•°ã€‚

*  Chrome ä¸­æ–‡ç•Œé¢ä¸‹é»˜è®¤ä¼šå°†å°äº 12px çš„æ–‡æœ¬å¼ºåˆ¶æŒ‰ç…§ 12px æ˜¾ç¤º,
   å¯é€šè¿‡åŠ å…¥ CSS å±æ€§ -webkit-text-size-adjust: none; è§£å†³ã€‚

è¶…é“¾æ¥è®¿é—®è¿‡åhoveræ ·å¼å°±ä¸å‡ºç°äº† è¢«ç‚¹å‡»è®¿é—®è¿‡çš„è¶…é“¾æ¥æ ·å¼ä¸åœ¨å…·æœ‰hoverå’Œactiveäº†è§£å†³æ–¹æ³•æ˜¯æ”¹å˜CSSå±æ€§çš„æ’åˆ—é¡ºåº:
L-V-H-A :  a:link {} a:visited {} a:hover {} a:active {}
</code></pre><ul>
<li><p>liä¸liä¹‹é—´æœ‰çœ‹ä¸è§çš„ç©ºç™½é—´éš”æ˜¯ä»€ä¹ˆåŸå› å¼•èµ·çš„ï¼Ÿæœ‰ä»€ä¹ˆè§£å†³åŠæ³•ï¼Ÿ</p>
<pre><code>è¡Œæ¡†çš„æ’åˆ—ä¼šå—åˆ°ä¸­é—´ç©ºç™½ï¼ˆå›è½¦\ç©ºæ ¼ï¼‰ç­‰çš„å½±å“ï¼Œå› ä¸ºç©ºæ ¼ä¹Ÿå±äºå­—ç¬¦,è¿™äº›ç©ºç™½ä¹Ÿä¼šè¢«åº”ç”¨æ ·å¼ï¼Œå æ®ç©ºé—´ï¼Œæ‰€ä»¥ä¼šæœ‰é—´éš”ï¼ŒæŠŠå­—ç¬¦å¤§å°è®¾ä¸º0ï¼Œå°±æ²¡æœ‰ç©ºæ ¼äº†ã€‚
</code></pre></li>
</ul>
<ul>
<li><p>ä¸ºä»€ä¹ˆè¦åˆå§‹åŒ–CSSæ ·å¼ã€‚</p>
<pre><code>- å› ä¸ºæµè§ˆå™¨çš„å…¼å®¹é—®é¢˜ï¼Œä¸åŒæµè§ˆå™¨å¯¹æœ‰äº›æ ‡ç­¾çš„é»˜è®¤å€¼æ˜¯ä¸åŒçš„ï¼Œå¦‚æœæ²¡å¯¹CSSåˆå§‹åŒ–å¾€å¾€ä¼šå‡ºç°æµè§ˆå™¨ä¹‹é—´çš„é¡µé¢æ˜¾ç¤ºå·®å¼‚ã€‚

- å½“ç„¶ï¼Œåˆå§‹åŒ–æ ·å¼ä¼šå¯¹SEOæœ‰ä¸€å®šçš„å½±å“ï¼Œä½†é±¼å’Œç†ŠæŒä¸å¯å…¼å¾—ï¼Œä½†åŠ›æ±‚å½±å“æœ€å°çš„æƒ…å†µä¸‹åˆå§‹åŒ–ã€‚

æœ€ç®€å•çš„åˆå§‹åŒ–æ–¹æ³•ï¼š * {padding: 0; margin: 0;} ï¼ˆå¼ºçƒˆä¸å»ºè®®ï¼‰

æ·˜å®çš„æ ·å¼åˆå§‹åŒ–ä»£ç ï¼š
body, h1, h2, h3, h4, h5, h6, hr, p, blockquote, dl, dt, dd, ul, ol, li, pre, form, fieldset, legend, button, input, textarea, th, td { margin:0; padding:0; }
body, button, input, select, textarea { font:12px/1.5tahoma, arial, \5b8b\4f53; }
h1, h2, h3, h4, h5, h6{ font-size:100%; }
address, cite, dfn, em, var { font-style:normal; }
code, kbd, pre, samp { font-family:couriernew, courier, monospace; }
small{ font-size:12px; }
ul, ol { list-style:none; }
a { text-decoration:none; }
a:hover { text-decoration:underline; }
sup { vertical-align:text-top; }
sub{ vertical-align:text-bottom; }
legend { color:#000; }
fieldset, img { border:0; }
button, input, select, textarea { font-size:100%; }
table { border-collapse:collapse; border-spacing:0; }
</code></pre></li>
</ul>
<ul>
<li><p>absoluteçš„containing block(å®¹å™¨å—)è®¡ç®—æ–¹å¼è·Ÿæ­£å¸¸æµæœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</p>
<pre><code>æ— è®ºå±äºå“ªç§ï¼Œéƒ½è¦å…ˆæ‰¾åˆ°å…¶ç¥–å…ˆå…ƒç´ ä¸­æœ€è¿‘çš„ position å€¼ä¸ä¸º static çš„å…ƒç´ ï¼Œç„¶åå†åˆ¤æ–­ï¼š
1ã€è‹¥æ­¤å…ƒç´ ä¸º inline å…ƒç´ ï¼Œåˆ™ containing block ä¸ºèƒ½å¤ŸåŒ…å«è¿™ä¸ªå…ƒç´ ç”Ÿæˆçš„ç¬¬ä¸€ä¸ªå’Œæœ€åä¸€ä¸ª inline box çš„ padding box (é™¤ margin, border å¤–çš„åŒºåŸŸ) çš„æœ€å°çŸ©å½¢ï¼›
2ã€å¦åˆ™,åˆ™ç”±è¿™ä¸ªç¥–å…ˆå…ƒç´ çš„ padding box æ„æˆã€‚
å¦‚æœéƒ½æ‰¾ä¸åˆ°ï¼Œåˆ™ä¸º initial containing blockã€‚

è¡¥å……ï¼š
1. static(é»˜è®¤çš„)/relativeï¼šç®€å•è¯´å°±æ˜¯å®ƒçš„çˆ¶å…ƒç´ çš„å†…å®¹æ¡†ï¼ˆå³å»æ‰paddingçš„éƒ¨åˆ†ï¼‰
2. absolute: å‘ä¸Šæ‰¾æœ€è¿‘çš„å®šä½ä¸ºabsolute/relativeçš„å…ƒç´ 
3. fixed: å®ƒçš„containing blockä¸€å¾‹ä¸ºæ ¹å…ƒç´ (html/body)ï¼Œæ ¹å…ƒç´ ä¹Ÿæ˜¯initial containing block
</code></pre></li>
<li><p>CSSé‡Œçš„visibilityå±æ€§æœ‰ä¸ªcollapseå±æ€§å€¼æ˜¯å¹²å˜›ç”¨çš„ï¼Ÿåœ¨ä¸åŒæµè§ˆå™¨ä¸‹ä»¥åä»€ä¹ˆåŒºåˆ«ï¼Ÿ</p>
<p>  å¯¹äºæ™®é€šå…ƒç´ visibility:collapse;ä¼šå°†å…ƒç´ å®Œå…¨éšè—,ä¸å æ®é¡µé¢å¸ƒå±€ç©ºé—´,ä¸display:none;è¡¨ç°ç›¸åŒ.<br>  å¦‚æœç›®æ ‡å…ƒç´ ä¸ºtable,visibility:collapse;å°†tableéšè—,ä½†æ˜¯ä¼šå æ®é¡µé¢å¸ƒå±€ç©ºé—´.<br>  ä»…åœ¨Firefoxä¸‹èµ·ä½œç”¨,IEä¼šæ˜¾ç¤ºå…ƒç´ ,Chromeä¼šå°†å…ƒç´ éšè—,ä½†æ˜¯å æ®ç©ºé—´.</p>
</li>
<li><p>positionè·Ÿdisplayã€margin collapseã€overflowã€floatè¿™äº›ç‰¹æ€§ç›¸äº’å åŠ åä¼šæ€ä¹ˆæ ·ï¼Ÿ</p>
<p>  å¦‚æœå…ƒç´ çš„displayä¸ºnone,é‚£ä¹ˆå…ƒç´ ä¸è¢«æ¸²æŸ“,position,floatä¸èµ·ä½œç”¨,å¦‚æœå…ƒç´ æ‹¥æœ‰position:absolute;æˆ–è€…position:fixed;å±æ€§é‚£ä¹ˆå…ƒç´ å°†ä¸ºç»å¯¹å®šä½,floatä¸èµ·ä½œç”¨.å¦‚æœå…ƒç´ floatå±æ€§ä¸æ˜¯none,å…ƒç´ ä¼šè„±ç¦»æ–‡æ¡£æµ,æ ¹æ®floatå±æ€§å€¼æ¥æ˜¾ç¤º.æœ‰æµ®åŠ¨,ç»å¯¹å®šä½,inline-blockå±æ€§çš„å…ƒç´ ,marginä¸ä¼šå’Œå‚ç›´æ–¹å‘ä¸Šçš„å…¶ä»–å…ƒç´ marginæŠ˜å .</p>
</li>
<li><p>å¯¹BFCè§„èŒƒ(å—çº§æ ¼å¼åŒ–ä¸Šä¸‹æ–‡ï¼šblock formatting context)çš„ç†è§£ï¼Ÿ</p>
<pre><code>ï¼ˆW3C CSS 2.1 è§„èŒƒä¸­çš„ä¸€ä¸ªæ¦‚å¿µ,å®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹å®¹å™¨ï¼Œå†³å®šäº†å…ƒç´ å¦‚ä½•å¯¹å…¶å†…å®¹è¿›è¡Œå®šä½,ä»¥åŠä¸å…¶ä»–å…ƒç´ çš„å…³ç³»å’Œç›¸äº’ä½œç”¨ã€‚ï¼‰
 ä¸€ä¸ªé¡µé¢æ˜¯ç”±å¾ˆå¤šä¸ª Box ç»„æˆçš„,å…ƒç´ çš„ç±»å‹å’Œ display å±æ€§,å†³å®šäº†è¿™ä¸ª Box çš„ç±»å‹ã€‚
 ä¸åŒç±»å‹çš„ Box,ä¼šå‚ä¸ä¸åŒçš„ Formatting Contextï¼ˆå†³å®šå¦‚ä½•æ¸²æŸ“æ–‡æ¡£çš„å®¹å™¨ï¼‰,å› æ­¤Boxå†…çš„å…ƒç´ ä¼šä»¥ä¸åŒçš„æ–¹å¼æ¸²æŸ“,ä¹Ÿå°±æ˜¯è¯´BFCå†…éƒ¨çš„å…ƒç´ å’Œå¤–éƒ¨çš„å…ƒç´ ä¸ä¼šäº’ç›¸å½±å“ã€‚
</code></pre></li>
<li><p>csså®šä¹‰çš„æƒé‡</p>
<pre><code>ä»¥ä¸‹æ˜¯æƒé‡çš„è§„åˆ™ï¼šæ ‡ç­¾çš„æƒé‡ä¸º1ï¼Œclassçš„æƒé‡ä¸º10ï¼Œidçš„æƒé‡ä¸º100ï¼Œä»¥ä¸‹ä¾‹å­æ˜¯æ¼”ç¤ºå„ç§å®šä¹‰çš„æƒé‡å€¼ï¼š

/*æƒé‡ä¸º1*/
div{
}
/*æƒé‡ä¸º10*/
.class1{
}
/*æƒé‡ä¸º100*/
#id1{
}
/*æƒé‡ä¸º100+1=101*/
#id1 div{
}
/*æƒé‡ä¸º10+1=11*/
.class1 div{
}
/*æƒé‡ä¸º10+10+1=21*/
.class1 .class2 div{
}

å¦‚æœæƒé‡ç›¸åŒï¼Œåˆ™æœ€åå®šä¹‰çš„æ ·å¼ä¼šèµ·ä½œç”¨ï¼Œä½†æ˜¯åº”è¯¥é¿å…è¿™ç§æƒ…å†µå‡ºç°
</code></pre></li>
</ul>
<ul>
<li><p>è¯·è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆéœ€è¦æ¸…é™¤æµ®åŠ¨ï¼Ÿæ¸…é™¤æµ®åŠ¨çš„æ–¹å¼</p>
<p>  æ¸…é™¤æµ®åŠ¨æ˜¯ä¸ºäº†æ¸…é™¤ä½¿ç”¨æµ®åŠ¨å…ƒç´ äº§ç”Ÿçš„å½±å“ã€‚æµ®åŠ¨çš„å…ƒç´ ï¼Œé«˜åº¦ä¼šå¡Œé™·ï¼Œè€Œé«˜åº¦çš„å¡Œé™·ä½¿æˆ‘ä»¬é¡µé¢åé¢çš„å¸ƒå±€ä¸èƒ½æ­£å¸¸æ˜¾ç¤ºã€‚</p>
<pre><code>1ã€çˆ¶çº§divå®šä¹‰heightï¼›
2ã€çˆ¶çº§div ä¹Ÿä¸€èµ·æµ®åŠ¨ï¼›
3ã€å¸¸è§„çš„ä½¿ç”¨ä¸€ä¸ªclassï¼›
    .clearfix:before, .clearfix:after {
        content: &quot; &quot;;
        display: table;
    }
    .clearfix:after {
        clear: both;
    }
    .clearfix {
        *zoom: 1;
    }

4ã€SASSç¼–è¯‘çš„æ—¶å€™ï¼Œæµ®åŠ¨å…ƒç´ çš„çˆ¶çº§divå®šä¹‰ä¼ªç±»:after
    &amp;:after,&amp;:before{
        content: &quot; &quot;;
        visibility: hidden;
        display: block;
        height: 0;
        clear: both;
    }

è§£æåŸç†ï¼š
1) display:block ä½¿ç”Ÿæˆçš„å…ƒç´ ä»¥å—çº§å…ƒç´ æ˜¾ç¤º,å æ»¡å‰©ä½™ç©ºé—´;
2) height:0 é¿å…ç”Ÿæˆå†…å®¹ç ´ååŸæœ‰å¸ƒå±€çš„é«˜åº¦ã€‚
3) visibility:hidden ä½¿ç”Ÿæˆçš„å†…å®¹ä¸å¯è§ï¼Œå¹¶å…è®¸å¯èƒ½è¢«ç”Ÿæˆå†…å®¹ç›–ä½çš„å†…å®¹å¯ä»¥è¿›è¡Œç‚¹å‡»å’Œäº¤äº’;
4ï¼‰é€šè¿‡ content:&quot;.&quot;ç”Ÿæˆå†…å®¹ä½œä¸ºæœ€åä¸€ä¸ªå…ƒç´ ï¼Œè‡³äºcontenté‡Œé¢æ˜¯ç‚¹è¿˜æ˜¯å…¶ä»–éƒ½æ˜¯å¯ä»¥çš„ï¼Œä¾‹å¦‚oocssé‡Œé¢å°±æœ‰ç»å…¸çš„ content:&quot;.&quot;,æœ‰äº›ç‰ˆæœ¬å¯èƒ½content é‡Œé¢å†…å®¹ä¸ºç©º,ä¸€ä¸å†°å‡‰æ˜¯ä¸æ¨èè¿™æ ·åšçš„,firefoxç›´åˆ°7.0 content:â€&quot; ä»ç„¶ä¼šäº§ç”Ÿé¢å¤–çš„ç©ºéš™ï¼›
5ï¼‰zoomï¼š1 è§¦å‘IE hasLayoutã€‚

é€šè¿‡åˆ†æå‘ç°ï¼Œé™¤äº†clearï¼šbothç”¨æ¥é—­åˆæµ®åŠ¨çš„ï¼Œå…¶ä»–ä»£ç æ— ééƒ½æ˜¯ä¸ºäº†éšè—æ‰contentç”Ÿæˆçš„å†…å®¹ï¼Œè¿™ä¹Ÿå°±æ˜¯å…¶ä»–ç‰ˆæœ¬çš„é—­åˆæµ®åŠ¨ä¸ºä»€ä¹ˆä¼šæœ‰font-sizeï¼š0ï¼Œline-heightï¼š0ã€‚
</code></pre></li>
<li><p>ä»€ä¹ˆæ˜¯å¤–è¾¹è·åˆå¹¶ï¼Ÿ</p>
<pre><code>å¤–è¾¹è·åˆå¹¶æŒ‡çš„æ˜¯ï¼Œå½“ä¸¤ä¸ªå‚ç›´å¤–è¾¹è·ç›¸é‡æ—¶ï¼Œå®ƒä»¬å°†å½¢æˆä¸€ä¸ªå¤–è¾¹è·ã€‚
åˆå¹¶åçš„å¤–è¾¹è·çš„é«˜åº¦ç­‰äºä¸¤ä¸ªå‘ç”Ÿåˆå¹¶çš„å¤–è¾¹è·çš„é«˜åº¦ä¸­çš„è¾ƒå¤§è€…ã€‚
w3schoolä»‹ç»ç½‘å€ï¼š http://www.w3school.com.cn/css/css_margin_collapsing.asp
</code></pre></li>
<li><p>zoom:1çš„æ¸…é™¤æµ®åŠ¨åŸç†?</p>
<pre><code>æ¸…é™¤æµ®åŠ¨ï¼Œè§¦å‘hasLayoutï¼›
Zoomå±æ€§æ˜¯IEæµè§ˆå™¨çš„ä¸“æœ‰å±æ€§ï¼Œå®ƒå¯ä»¥è®¾ç½®æˆ–æ£€ç´¢å¯¹è±¡çš„ç¼©æ”¾æ¯”ä¾‹ã€‚è§£å†³ieä¸‹æ¯”è¾ƒå¥‡è‘©çš„bugã€‚
è­¬å¦‚å¤–è¾¹è·ï¼ˆmarginï¼‰çš„é‡å ï¼Œæµ®åŠ¨æ¸…é™¤ï¼Œè§¦å‘ieçš„haslayoutå±æ€§ç­‰ã€‚

æ¥é¾™å»è„‰å¤§æ¦‚å¦‚ä¸‹ï¼š
å½“è®¾ç½®äº†zoomçš„å€¼ä¹‹åï¼Œæ‰€è®¾ç½®çš„å…ƒç´ å°±ä¼šå°±ä¼šæ‰©å¤§æˆ–è€…ç¼©å°ï¼Œé«˜åº¦å®½åº¦å°±ä¼šé‡æ–°è®¡ç®—äº†ï¼Œè¿™é‡Œä¸€æ—¦æ”¹å˜zoomå€¼æ—¶å…¶å®ä¹Ÿä¼šå‘ç”Ÿé‡æ–°æ¸²æŸ“ï¼Œè¿ç”¨è¿™ä¸ªåŸç†ï¼Œä¹Ÿå°±è§£å†³äº†ieä¸‹å­å…ƒç´ æµ®åŠ¨æ—¶å€™çˆ¶å…ƒç´ ä¸éšç€è‡ªåŠ¨æ‰©å¤§çš„é—®é¢˜ã€‚

Zoomå±æ˜¯IEæµè§ˆå™¨çš„ä¸“æœ‰å±æ€§ï¼Œç«ç‹å’Œè€ç‰ˆæœ¬çš„webkitæ ¸å¿ƒçš„æµè§ˆå™¨éƒ½ä¸æ”¯æŒè¿™ä¸ªå±æ€§ã€‚ç„¶è€Œï¼Œzoomç°åœ¨å·²ç»è¢«é€æ­¥æ ‡å‡†åŒ–ï¼Œå‡ºç°åœ¨ CSS 3.0 è§„èŒƒè‰æ¡ˆä¸­ã€‚

ç›®å‰éieç”±äºä¸æ”¯æŒè¿™ä¸ªå±æ€§ï¼Œå®ƒä»¬åˆæ˜¯é€šè¿‡ä»€ä¹ˆå±æ€§æ¥å®ç°å…ƒç´ çš„ç¼©æ”¾å‘¢ï¼Ÿ
å¯ä»¥é€šè¿‡css3é‡Œé¢çš„åŠ¨ç”»å±æ€§scaleè¿›è¡Œç¼©æ”¾ã€‚
</code></pre></li>
<li><p>ç§»åŠ¨ç«¯çš„å¸ƒå±€ç”¨è¿‡åª’ä½“æŸ¥è¯¢å—ï¼Ÿ</p>
</li>
</ul>
<pre><code>å‡è®¾ä½ ç°åœ¨æ­£ç”¨ä¸€å°æ˜¾ç¤ºè®¾å¤‡æ¥é˜…è¯»è¿™ç¯‡æ–‡ç« ï¼ŒåŒæ—¶ä½ ä¹Ÿæƒ³æŠŠå®ƒæŠ•å½±åˆ°å±å¹•ä¸Šï¼Œæˆ–è€…æ‰“å°å‡ºæ¥ï¼Œ
è€Œæ˜¾ç¤ºè®¾å¤‡ã€å±å¹•æŠ•å½±å’Œæ‰“å°ç­‰è¿™äº›åª’ä»‹éƒ½æœ‰è‡ªå·±çš„ç‰¹ç‚¹ï¼ŒCSSå°±æ˜¯ä¸ºæ–‡æ¡£æä¾›åœ¨ä¸åŒåª’ä»‹ä¸Šå±•ç¤ºçš„é€‚é…æ–¹æ³•

&lt;!-- linkå…ƒç´ ä¸­çš„CSSåª’ä½“æŸ¥è¯¢ --&gt;
å½“åª’ä½“æŸ¥è¯¢ä¸ºçœŸæ—¶ï¼Œç›¸å…³çš„æ ·å¼è¡¨æˆ–æ ·å¼è§„åˆ™ä¼šæŒ‰ç…§æ­£å¸¸çš„çº§è”è§„è¢«åº”ç”¨ã€‚
å½“åª’ä½“æŸ¥è¯¢è¿”å›å‡ï¼Œ &lt;link&gt; æ ‡ç­¾ä¸Šå¸¦æœ‰åª’ä½“æŸ¥è¯¢çš„æ ·å¼è¡¨ ä»å°†è¢«ä¸‹è½½ ï¼ˆåªä¸è¿‡ä¸ä¼šè¢«åº”ç”¨ï¼‰ã€‚

&lt;link rel=&quot;stylesheet&quot; media=&quot;(max-width: 800px)&quot; href=&quot;example.css&quot; /&gt;

&lt;!-- æ ·å¼è¡¨ä¸­çš„CSSåª’ä½“æŸ¥è¯¢ --&gt;
åŒ…å«äº†ä¸€ä¸ªåª’ä½“ç±»å‹å’Œè‡³å°‘ä¸€ä¸ªä½¿ç”¨ å®½åº¦ã€é«˜åº¦å’Œé¢œè‰²ç­‰åª’ä½“å±æ€§æ¥é™åˆ¶æ ·å¼è¡¨èŒƒå›´çš„è¡¨è¾¾å¼ã€‚
CSS3åŠ å…¥çš„åª’ä½“æŸ¥è¯¢ä½¿å¾—æ— éœ€ä¿®æ”¹å†…å®¹ä¾¿å¯ä»¥ä½¿æ ·å¼åº”ç”¨äºæŸäº›ç‰¹å®šçš„è®¾å¤‡èŒƒå›´ã€‚

&lt;style&gt;
    @media (min-width: 700px) and (orientation: landscape){
      .sidebar {
        display: none;
      }
    }
&lt;/style&gt;
</code></pre><ul>
<li><p>ä½¿ç”¨ CSS é¢„å¤„ç†å™¨å—ï¼Ÿå–œæ¬¢é‚£ä¸ªï¼Ÿ</p>
<pre><code>SASS (SASSã€LESSæ²¡æœ‰æœ¬è´¨åŒºåˆ«ï¼Œåªå› ä¸ºå›¢é˜Ÿå‰ç«¯éƒ½æ˜¯ç”¨çš„SASS)
</code></pre></li>
</ul>
<ul>
<li><p>CSSä¼˜åŒ–ã€æé«˜æ€§èƒ½çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ</p>
<pre><code>å…³é”®é€‰æ‹©å™¨ï¼ˆkey selectorï¼‰ã€‚é€‰æ‹©å™¨çš„æœ€åé¢çš„éƒ¨åˆ†ä¸ºå…³é”®é€‰æ‹©å™¨ï¼ˆå³ç”¨æ¥åŒ¹é…ç›®æ ‡å…ƒç´ çš„éƒ¨åˆ†ï¼‰ï¼›
å¦‚æœè§„åˆ™æ‹¥æœ‰ ID é€‰æ‹©å™¨ä½œä¸ºå…¶å…³é”®é€‰æ‹©å™¨ï¼Œåˆ™ä¸è¦ä¸ºè§„åˆ™å¢åŠ æ ‡ç­¾ã€‚è¿‡æ»¤æ‰æ— å…³çš„è§„åˆ™ï¼ˆè¿™æ ·æ ·å¼ç³»ç»Ÿå°±ä¸ä¼šæµªè´¹æ—¶é—´å»åŒ¹é…å®ƒä»¬äº†ï¼‰ï¼›
æå–é¡¹ç›®çš„é€šç”¨å…¬æœ‰æ ·å¼ï¼Œå¢å¼ºå¯å¤ç”¨æ€§ï¼ŒæŒ‰æ¨¡å—ç¼–å†™ç»„ä»¶ï¼›å¢å¼ºé¡¹ç›®çš„ååŒå¼€å‘æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§;
ä½¿ç”¨é¢„å¤„ç†å·¥å…·æˆ–æ„å»ºå·¥å…·ï¼ˆgulpå¯¹cssè¿›è¡Œè¯­æ³•æ£€æŸ¥ã€è‡ªåŠ¨è¡¥å‰ç¼€ã€æ‰“åŒ…å‹ç¼©ã€è‡ªåŠ¨ä¼˜é›…é™çº§ï¼‰ï¼›
</code></pre></li>
</ul>
<ul>
<li><p>æµè§ˆå™¨æ˜¯æ€æ ·è§£æCSSé€‰æ‹©å™¨çš„ï¼Ÿ</p>
<pre><code>æ ·å¼ç³»ç»Ÿä»å…³é”®é€‰æ‹©å™¨å¼€å§‹åŒ¹é…ï¼Œç„¶åå·¦ç§»æŸ¥æ‰¾è§„åˆ™é€‰æ‹©å™¨çš„ç¥–å…ˆå…ƒç´ ã€‚
åªè¦é€‰æ‹©å™¨çš„å­æ ‘ä¸€ç›´åœ¨å·¥ä½œï¼Œæ ·å¼ç³»ç»Ÿå°±ä¼šæŒç»­å·¦ç§»ï¼Œç›´åˆ°å’Œè§„åˆ™åŒ¹é…ï¼Œæˆ–è€…æ˜¯å› ä¸ºä¸åŒ¹é…è€Œæ”¾å¼ƒè¯¥è§„åˆ™ã€‚
</code></pre></li>
</ul>
<ul>
<li><p>åœ¨ç½‘é¡µä¸­çš„åº”è¯¥ä½¿ç”¨å¥‡æ•°è¿˜æ˜¯å¶æ•°çš„å­—ä½“ï¼Ÿä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>
</li>
<li><p>marginå’Œpaddingåˆ†åˆ«é€‚åˆä»€ä¹ˆåœºæ™¯ä½¿ç”¨ï¼Ÿ</p>
<pre><code>marginæ˜¯ç”¨æ¥éš”å¼€å…ƒç´ ä¸å…ƒç´ çš„é—´è·ï¼›paddingæ˜¯ç”¨æ¥éš”å¼€å…ƒç´ ä¸å†…å®¹çš„é—´éš”ã€‚
marginç”¨äºå¸ƒå±€åˆ†å¼€å…ƒç´ ä½¿å…ƒç´ ä¸å…ƒç´ äº’ä¸ç›¸å¹²ï¼›
paddingç”¨äºå…ƒç´ ä¸å†…å®¹ä¹‹é—´çš„é—´éš”ï¼Œè®©å†…å®¹ï¼ˆæ–‡å­—ï¼‰ä¸ï¼ˆåŒ…è£¹ï¼‰å…ƒç´ ä¹‹é—´æœ‰ä¸€æ®µ
</code></pre></li>
</ul>
<ul>
<li><p>æŠ½ç¦»æ ·å¼æ¨¡å—æ€ä¹ˆå†™ï¼Œè¯´å‡ºæ€è·¯ï¼Œæœ‰æ— å®è·µç»éªŒï¼Ÿ[é˜¿é‡Œèˆªæ—…çš„é¢è¯•é¢˜]</p>
</li>
<li><p>å…ƒç´ ç«–å‘çš„ç™¾åˆ†æ¯”è®¾å®šæ˜¯ç›¸å¯¹äºå®¹å™¨çš„é«˜åº¦å—ï¼Ÿ</p>
</li>
<li><p>å…¨å±æ»šåŠ¨çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿç”¨åˆ°äº†CSSçš„é‚£äº›å±æ€§ï¼Ÿ</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯å“åº”å¼è®¾è®¡ï¼Ÿå“åº”å¼è®¾è®¡çš„åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•å…¼å®¹ä½ç‰ˆæœ¬çš„IEï¼Ÿ</p>
</li>
<li><p>è§†å·®æ»šåŠ¨æ•ˆæœï¼Œå¦‚ä½•ç»™æ¯é¡µåšä¸åŒçš„åŠ¨ç”»ï¼Ÿï¼ˆå›åˆ°é¡¶éƒ¨ï¼Œå‘ä¸‹æ»‘åŠ¨è¦å†æ¬¡å‡ºç°ï¼Œå’Œåªå‡ºç°ä¸€æ¬¡åˆ†åˆ«æ€ä¹ˆåšï¼Ÿï¼‰</p>
</li>
<li><p>::before å’Œ :afterä¸­åŒå†’å·å’Œå•å†’å· æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿè§£é‡Šä¸€ä¸‹è¿™2ä¸ªä¼ªå…ƒç´ çš„ä½œç”¨ã€‚</p>
<pre><code>å•å†’å·(:)ç”¨äºCSS3ä¼ªç±»ï¼ŒåŒå†’å·(::)ç”¨äºCSS3ä¼ªå…ƒç´ ã€‚ï¼ˆä¼ªå…ƒç´ ç”±åŒå†’å·å’Œä¼ªå…ƒç´ åç§°ç»„æˆï¼‰
åŒå†’å·æ˜¯åœ¨å½“å‰è§„èŒƒä¸­å¼•å…¥çš„ï¼Œç”¨äºåŒºåˆ†ä¼ªç±»å’Œä¼ªå…ƒç´ ã€‚ä¸è¿‡æµè§ˆå™¨éœ€è¦åŒæ—¶æ”¯æŒæ—§çš„å·²ç»å­˜åœ¨çš„ä¼ªå…ƒç´ å†™æ³•ï¼Œ
æ¯”å¦‚:first-lineã€:first-letterã€:beforeã€:afterç­‰ï¼Œ
è€Œæ–°çš„åœ¨CSS3ä¸­å¼•å…¥çš„ä¼ªå…ƒç´ åˆ™ä¸å…è®¸å†æ”¯æŒæ—§çš„å•å†’å·çš„å†™æ³•ã€‚

æƒ³è®©æ’å…¥çš„å†…å®¹å‡ºç°åœ¨å…¶å®ƒå†…å®¹å‰ï¼Œä½¿ç”¨::beforeï¼Œå¦è€…ï¼Œä½¿ç”¨::afterï¼›
åœ¨ä»£ç é¡ºåºä¸Šï¼Œ::afterç”Ÿæˆçš„å†…å®¹ä¹Ÿæ¯”::beforeç”Ÿæˆçš„å†…å®¹é åã€‚
å¦‚æœæŒ‰å †æ ˆè§†è§’ï¼Œ::afterç”Ÿæˆçš„å†…å®¹ä¼šåœ¨::beforeç”Ÿæˆçš„å†…å®¹ä¹‹ä¸Š
</code></pre></li>
</ul>
<ul>
<li><p>å¦‚ä½•ä¿®æ”¹chromeè®°ä½å¯†ç åè‡ªåŠ¨å¡«å……è¡¨å•çš„é»„è‰²èƒŒæ™¯ ï¼Ÿ</p>
<pre><code>input:-webkit-autofill, textarea:-webkit-autofill, select:-webkit-autofill {
  background-color: rgb(250, 255, 189); /* #FAFFBD; */
  background-image: none;
  color: rgb(0, 0, 0);
}
</code></pre></li>
<li><p>ä½ å¯¹line-heightæ˜¯å¦‚ä½•ç†è§£çš„ï¼Ÿ</p>
</li>
<li><p>è®¾ç½®å…ƒç´ æµ®åŠ¨åï¼Œè¯¥å…ƒç´ çš„displayå€¼æ˜¯å¤šå°‘ï¼Ÿ</p>
<pre><code>è‡ªåŠ¨å˜æˆäº† display:block
</code></pre></li>
<li><p>æ€ä¹ˆè®©Chromeæ”¯æŒå°äº12px çš„æ–‡å­—ï¼Ÿ</p>
<pre><code>1ã€ç”¨å›¾ç‰‡ï¼šå¦‚æœæ˜¯å†…å®¹å›ºå®šä¸å˜æƒ…å†µä¸‹ï¼Œä½¿ç”¨å°†å°äº12pxæ–‡å­—å†…å®¹åˆ‡å‡ºåšå›¾ç‰‡ï¼Œè¿™æ ·ä¸å½±å“å…¼å®¹ä¹Ÿä¸å½±å“ç¾è§‚ã€‚
2ã€ä½¿ç”¨12pxåŠ12pxä»¥ä¸Šå­—ä½“å¤§å°ï¼šä¸ºäº†å…¼å®¹å„å¤§ä¸»æµæµè§ˆå™¨ï¼Œå»ºè®®è®¾è®¡ç¾å·¥å›¾æ—¶å€™è®¾ç½®å¤§äºæˆ–ç­‰äº12pxçš„å­—ä½“å¤§å°ï¼Œå¦‚æœæ˜¯æ¥å•çš„è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç»™å®¢æˆ·è®²è§£å°äº12pxæµè§ˆå™¨ä¸å…¼å®¹ç­‰äº‹å®œã€‚
3ã€ç»§ç»­ä½¿ç”¨å°äº12pxå­—ä½“å¤§å°æ ·å¼è®¾ç½®ï¼šå¦‚æœä¸è€ƒè™‘chromeå¯ä»¥ä¸ç”¨è€ƒè™‘å…¼å®¹ï¼ŒåŒæ—¶åœ¨è®¾ç½®å°äº12pxå¯¹è±¡è®¾ç½®-webkit-text-size-adjust:noneï¼Œåšåˆ°æœ€å¤§å…¼å®¹è€ƒè™‘ã€‚
4ã€ä½¿ç”¨12pxä»¥ä¸Šå­—ä½“ï¼šä¸ºäº†å…¼å®¹ã€ä¸ºäº†ä»£ç æ›´ç®€å• ä»æ–°è€ƒè™‘æƒé‡ä¸‹å…¼å®¹æ€§ã€‚
</code></pre></li>
<li><p>è®©é¡µé¢é‡Œçš„å­—ä½“å˜æ¸…æ™°ï¼Œå˜ç»†ç”¨CSSæ€ä¹ˆåšï¼Ÿ</p>
<pre><code>-webkit-font-smoothing: antialiased;
</code></pre></li>
<li><p>font-styleå±æ€§å¯ä»¥è®©å®ƒèµ‹å€¼ä¸ºâ€œobliqueâ€ obliqueæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p>
<pre><code>å€¾æ–œçš„å­—ä½“æ ·å¼
</code></pre></li>
<li><p>position:fixed;åœ¨androidä¸‹æ— æ•ˆæ€ä¹ˆå¤„ç†ï¼Ÿ</p>
<pre><code>fixedçš„å…ƒç´ æ˜¯ç›¸å¯¹æ•´ä¸ªé¡µé¢å›ºå®šä½ç½®çš„ï¼Œä½ åœ¨å±å¹•ä¸Šæ»‘åŠ¨åªæ˜¯åœ¨ç§»åŠ¨è¿™ä¸ªæ‰€è°“çš„viewportï¼Œ
åŸæ¥çš„ç½‘é¡µè¿˜å¥½å¥½çš„åœ¨é‚£ï¼Œfixedçš„å†…å®¹ä¹Ÿæ²¡æœ‰å˜è¿‡ä½ç½®ï¼Œ
æ‰€ä»¥è¯´å¹¶ä¸æ˜¯iOSä¸æ”¯æŒfixedï¼Œåªæ˜¯fixedçš„å…ƒç´ ä¸æ˜¯ç›¸å¯¹æ‰‹æœºå±å¹•å›ºå®šçš„ã€‚
&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no&quot;/&gt;
</code></pre></li>
<li><p>å¦‚æœéœ€è¦æ‰‹åŠ¨å†™åŠ¨ç”»ï¼Œä½ è®¤ä¸ºæœ€å°æ—¶é—´é—´éš”æ˜¯å¤šä¹…ï¼Œä¸ºä»€ä¹ˆï¼Ÿï¼ˆé˜¿é‡Œï¼‰</p>
<pre><code>å¤šæ•°æ˜¾ç¤ºå™¨é»˜è®¤é¢‘ç‡æ˜¯60Hzï¼Œå³1ç§’åˆ·æ–°60æ¬¡ï¼Œæ‰€ä»¥ç†è®ºä¸Šæœ€å°é—´éš”ä¸º1/60ï¼Š1000ms ï¼ 16.7ms
</code></pre></li>
<li><p>display:inline-block ä»€ä¹ˆæ—¶å€™ä¼šæ˜¾ç¤ºé—´éš™ï¼Ÿ(æºç¨‹)</p>
<pre><code>ç§»é™¤ç©ºæ ¼ã€ä½¿ç”¨marginè´Ÿå€¼ã€ä½¿ç”¨font-size:0ã€letter-spacingã€word-spacing
</code></pre></li>
<li><p>overflow: scrollæ—¶ä¸èƒ½å¹³æ»‘æ»šåŠ¨çš„é—®é¢˜æ€ä¹ˆå¤„ç†ï¼Ÿ</p>
</li>
<li><p>æœ‰ä¸€ä¸ªé«˜åº¦è‡ªé€‚åº”çš„divï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªdivï¼Œä¸€ä¸ªé«˜åº¦100pxï¼Œå¸Œæœ›å¦ä¸€ä¸ªå¡«æ»¡å‰©ä¸‹çš„é«˜åº¦ã€‚</p>
</li>
<li><p>pngã€jpgã€gif è¿™äº›å›¾ç‰‡æ ¼å¼è§£é‡Šä¸€ä¸‹ï¼Œåˆ†åˆ«ä»€ä¹ˆæ—¶å€™ç”¨ã€‚æœ‰æ²¡æœ‰äº†è§£è¿‡webpï¼Ÿ</p>
</li>
</ul>
<ul>
<li><p>ä»€ä¹ˆæ˜¯Cookie éš”ç¦»ï¼Ÿï¼ˆæˆ–è€…è¯´ï¼šè¯·æ±‚èµ„æºçš„æ—¶å€™ä¸è¦è®©å®ƒå¸¦cookieæ€ä¹ˆåšï¼‰</p>
<pre><code>å¦‚æœé™æ€æ–‡ä»¶éƒ½æ”¾åœ¨ä¸»åŸŸåä¸‹ï¼Œé‚£é™æ€æ–‡ä»¶è¯·æ±‚çš„æ—¶å€™éƒ½å¸¦æœ‰çš„cookieçš„æ•°æ®æäº¤ç»™serverçš„ï¼Œéå¸¸æµªè´¹æµé‡ï¼Œ
æ‰€ä»¥ä¸å¦‚éš”ç¦»å¼€ã€‚

å› ä¸ºcookieæœ‰åŸŸçš„é™åˆ¶ï¼Œå› æ­¤ä¸èƒ½è·¨åŸŸæäº¤è¯·æ±‚ï¼Œæ•…ä½¿ç”¨éä¸»è¦åŸŸåçš„æ—¶å€™ï¼Œè¯·æ±‚å¤´ä¸­å°±ä¸ä¼šå¸¦æœ‰cookieæ•°æ®ï¼Œ
è¿™æ ·å¯ä»¥é™ä½è¯·æ±‚å¤´çš„å¤§å°ï¼Œé™ä½è¯·æ±‚æ—¶é—´ï¼Œä»è€Œè¾¾åˆ°é™ä½æ•´ä½“è¯·æ±‚å»¶æ—¶çš„ç›®çš„ã€‚

åŒæ—¶è¿™ç§æ–¹å¼ä¸ä¼šå°†cookieä¼ å…¥Web Serverï¼Œä¹Ÿå‡å°‘äº†Web Serverå¯¹cookieçš„å¤„ç†åˆ†æç¯èŠ‚ï¼Œ
æé«˜äº†webserverçš„httpè¯·æ±‚çš„è§£æé€Ÿåº¦ã€‚
</code></pre></li>
</ul>
<ul>
<li>styleæ ‡ç­¾å†™åœ¨bodyåä¸bodyå‰æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</li>
</ul>
<ul>
<li><p>ä»€ä¹ˆæ˜¯CSS é¢„å¤„ç†å™¨ / åå¤„ç†å™¨ï¼Ÿ</p>
<pre><code>- é¢„å¤„ç†å™¨ä¾‹å¦‚ï¼šLESSã€Sassã€Stylusï¼Œç”¨æ¥é¢„ç¼–è¯‘Sassæˆ–lessï¼Œå¢å¼ºäº†cssä»£ç çš„å¤ç”¨æ€§ï¼Œ
  è¿˜æœ‰å±‚çº§ã€mixinã€å˜é‡ã€å¾ªç¯ã€å‡½æ•°ç­‰ï¼Œå…·æœ‰å¾ˆæ–¹ä¾¿çš„UIç»„ä»¶æ¨¡å—åŒ–å¼€å‘èƒ½åŠ›ï¼Œæå¤§çš„æé«˜å·¥ä½œæ•ˆç‡ã€‚

- åå¤„ç†å™¨ä¾‹å¦‚ï¼šPostCSSï¼Œé€šå¸¸è¢«è§†ä¸ºåœ¨å®Œæˆçš„æ ·å¼è¡¨ä¸­æ ¹æ®CSSè§„èŒƒå¤„ç†CSSï¼Œè®©å…¶æ›´æœ‰æ•ˆï¼›ç›®å‰æœ€å¸¸åšçš„
  æ˜¯ç»™CSSå±æ€§æ·»åŠ æµè§ˆå™¨ç§æœ‰å‰ç¼€ï¼Œå®ç°è·¨æµè§ˆå™¨å…¼å®¹æ€§çš„é—®é¢˜ã€‚
</code></pre></li>
</ul>
<h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a><a name="js">JavaScript</a></h2><ul>
<li><p>ä»‹ç»jsçš„åŸºæœ¬æ•°æ®ç±»å‹ã€‚</p>
<pre><code>Undefinedã€Nullã€Booleanã€Numberã€Stringã€
ECMAScript 2015 æ–°å¢:Symbol(åˆ›å»ºåç‹¬ä¸€æ— äºŒä¸”ä¸å¯å˜çš„æ•°æ®ç±»å‹ )
</code></pre></li>
<li><p>ä»‹ç»jsæœ‰å“ªäº›å†…ç½®å¯¹è±¡ï¼Ÿ</p>
<pre><code>Object æ˜¯ JavaScript ä¸­æ‰€æœ‰å¯¹è±¡çš„çˆ¶å¯¹è±¡

æ•°æ®å°è£…ç±»å¯¹è±¡ï¼šObjectã€Arrayã€Booleanã€Number å’Œ String
å…¶ä»–å¯¹è±¡ï¼šFunctionã€Argumentsã€Mathã€Dateã€RegExpã€Error

å‚è€ƒï¼šhttp://www.ibm.com/developerworks/cn/web/wa-objectsinjs-v1b/index.html
</code></pre></li>
<li><p>è¯´å‡ æ¡å†™JavaScriptçš„åŸºæœ¬è§„èŒƒï¼Ÿ</p>
<pre><code>1.ä¸è¦åœ¨åŒä¸€è¡Œå£°æ˜å¤šä¸ªå˜é‡ã€‚
2.è¯·ä½¿ç”¨ ===/!==æ¥æ¯”è¾ƒtrue/falseæˆ–è€…æ•°å€¼
3.ä½¿ç”¨å¯¹è±¡å­—é¢é‡æ›¿ä»£new Arrayè¿™ç§å½¢å¼
4.ä¸è¦ä½¿ç”¨å…¨å±€å‡½æ•°ã€‚
5.Switchè¯­å¥å¿…é¡»å¸¦æœ‰defaultåˆ†æ”¯
6.å‡½æ•°ä¸åº”è¯¥æœ‰æ—¶å€™æœ‰è¿”å›å€¼ï¼Œæœ‰æ—¶å€™æ²¡æœ‰è¿”å›å€¼ã€‚
7.Forå¾ªç¯å¿…é¡»ä½¿ç”¨å¤§æ‹¬å·
8.Ifè¯­å¥å¿…é¡»ä½¿ç”¨å¤§æ‹¬å·
9.for-inå¾ªç¯ä¸­çš„å˜é‡ åº”è¯¥ä½¿ç”¨varå…³é”®å­—æ˜ç¡®é™å®šä½œç”¨åŸŸï¼Œä»è€Œé¿å…ä½œç”¨åŸŸæ±¡æŸ“ã€‚
</code></pre></li>
<li><p>JavaScriptåŸå‹ï¼ŒåŸå‹é“¾ ? æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</p>
<pre><code>æ¯ä¸ªå¯¹è±¡éƒ½ä¼šåœ¨å…¶å†…éƒ¨åˆå§‹åŒ–ä¸€ä¸ªå±æ€§ï¼Œå°±æ˜¯prototype(åŸå‹)ï¼Œå½“æˆ‘ä»¬è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ—¶ï¼Œ
å¦‚æœè¿™ä¸ªå¯¹è±¡å†…éƒ¨ä¸å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆä»–å°±ä¼šå»prototypeé‡Œæ‰¾è¿™ä¸ªå±æ€§ï¼Œè¿™ä¸ªprototypeåˆä¼šæœ‰è‡ªå·±çš„prototypeï¼Œ
äºæ˜¯å°±è¿™æ ·ä¸€ç›´æ‰¾ä¸‹å»ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬å¹³æ—¶æ‰€è¯´çš„åŸå‹é“¾çš„æ¦‚å¿µã€‚
å…³ç³»ï¼šinstance.constructor.prototype = instance.__proto__

ç‰¹ç‚¹ï¼š
JavaScriptå¯¹è±¡æ˜¯é€šè¿‡å¼•ç”¨æ¥ä¼ é€’çš„ï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ¯ä¸ªæ–°å¯¹è±¡å®ä½“ä¸­å¹¶æ²¡æœ‰ä¸€ä»½å±äºè‡ªå·±çš„åŸå‹å‰¯æœ¬ã€‚å½“æˆ‘ä»¬ä¿®æ”¹åŸå‹æ—¶ï¼Œä¸ä¹‹ç›¸å…³çš„å¯¹è±¡ä¹Ÿä¼šç»§æ‰¿è¿™ä¸€æ”¹å˜ã€‚
</code></pre></li>
</ul>
<pre><code>å½“æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå±æ€§çš„æ—¶ï¼ŒJavascriptå¼•æ“ä¼šå…ˆçœ‹å½“å‰å¯¹è±¡ä¸­æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ï¼Œ å¦‚æœæ²¡æœ‰çš„è¯ï¼Œ
å°±ä¼šæŸ¥æ‰¾ä»–çš„Prototypeå¯¹è±¡æ˜¯å¦æœ‰è¿™ä¸ªå±æ€§ï¼Œå¦‚æ­¤é€’æ¨ä¸‹å»ï¼Œä¸€ç›´æ£€ç´¢åˆ° Object å†…å»ºå¯¹è±¡ã€‚
   function Func(){}
   Func.prototype.name = &quot;Sean&quot;;
   Func.prototype.getInfo = function() {
     return this.name;
   }
   var person = new Func();//ç°åœ¨å¯ä»¥å‚è€ƒvar person = Object.create(oldObject);
   console.log(person.getInfo());//å®ƒæ‹¥æœ‰äº†Funcçš„å±æ€§å’Œæ–¹æ³•
   //&quot;Sean&quot;
   console.log(Func.prototype);
   // Func { name=&quot;Sean&quot;, getInfo=function()}
</code></pre><ul>
<li><p>JavaScriptæœ‰å‡ ç§ç±»å‹çš„å€¼ï¼Ÿï¼Œä½ èƒ½ç”»ä¸€ä¸‹ä»–ä»¬çš„å†…å­˜å›¾å—ï¼Ÿ</p>
<pre><code>æ ˆï¼šåŸå§‹æ•°æ®ç±»å‹ï¼ˆUndefinedï¼ŒNullï¼ŒBooleanï¼ŒNumberã€Stringï¼‰
å †ï¼šå¼•ç”¨æ•°æ®ç±»å‹ï¼ˆå¯¹è±¡ã€æ•°ç»„å’Œå‡½æ•°ï¼‰

ä¸¤ç§ç±»å‹çš„åŒºåˆ«æ˜¯ï¼šå­˜å‚¨ä½ç½®ä¸åŒï¼›
åŸå§‹æ•°æ®ç±»å‹ç›´æ¥å­˜å‚¨åœ¨æ ˆ(stack)ä¸­çš„ç®€å•æ•°æ®æ®µï¼Œå æ®ç©ºé—´å°ã€å¤§å°å›ºå®šï¼Œå±äºè¢«é¢‘ç¹ä½¿ç”¨æ•°æ®ï¼Œæ‰€ä»¥æ”¾å…¥æ ˆä¸­å­˜å‚¨ï¼›
å¼•ç”¨æ•°æ®ç±»å‹å­˜å‚¨åœ¨å †(heap)ä¸­çš„å¯¹è±¡,å æ®ç©ºé—´å¤§ã€å¤§å°ä¸å›ºå®šã€‚å¦‚æœå­˜å‚¨åœ¨æ ˆä¸­ï¼Œå°†ä¼šå½±å“ç¨‹åºè¿è¡Œçš„æ€§èƒ½ï¼›å¼•ç”¨æ•°æ®ç±»å‹åœ¨æ ˆä¸­å­˜å‚¨äº†æŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæŒ‡å‘å †ä¸­è¯¥å®ä½“çš„èµ·å§‹åœ°å€ã€‚å½“è§£é‡Šå™¨å¯»æ‰¾å¼•ç”¨å€¼æ—¶ï¼Œä¼šé¦–å…ˆæ£€ç´¢å…¶åœ¨æ ˆä¸­çš„åœ°å€ï¼Œå–å¾—åœ°å€åä»å †ä¸­è·å¾—å®ä½“
</code></pre><p> <img src="http://www.w3school.com.cn/i/ct_js_value.gif" alt="Stated Clearly Image"></p>
</li>
<li><p>å¦‚ä½•å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—ï¼Œä¾‹å¦‚â€™12.3bâ€™?</p>
<pre><code>* parseFloat(&apos;12.3b&apos;);
* æ­£åˆ™è¡¨è¾¾å¼ï¼Œ&apos;12.3b&apos;.match(/(\d)+(\.)?(\d)+/g)[0] * 1, ä½†æ˜¯è¿™ä¸ªä¸å¤ªé è°±ï¼Œæä¾›ä¸€ç§æ€è·¯è€Œå·²ã€‚
</code></pre></li>
<li><p>å¦‚ä½•å°†æµ®ç‚¹æ•°ç‚¹å·¦è¾¹çš„æ•°æ¯ä¸‰ä½æ·»åŠ ä¸€ä¸ªé€—å·ï¼Œå¦‚12000000.11è½¬åŒ–ä¸ºã€12,000,000.11ã€?</p>
<pre><code>function commafy(num){
    return num &amp;&amp; num
        .toString()
        .replace(/(\d)(?=(\d{3})+\.)/g, function($1, $2){
            return $2 + &apos;,&apos;;
        });
}
</code></pre></li>
<li><p>å¦‚ä½•å®ç°æ•°ç»„çš„éšæœºæ’åºï¼Ÿ</p>
<pre><code>æ–¹æ³•ä¸€ï¼š
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">randSort1</span>(<span class="params">arr</span>)</span>&#123;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>,len = arr.length;i &lt; len; i++ )&#123;</div><div class="line">		<span class="keyword">var</span> rand = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*len);</div><div class="line">		<span class="keyword">var</span> temp = arr[rand];</div><div class="line">		arr[rand] = arr[i];</div><div class="line">		arr[i] = temp;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> arr;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(randSort1(arr));</div></pre></td></tr></table></figure>

æ–¹æ³•äºŒï¼š
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">randSort2</span>(<span class="params">arr</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> mixedArray = [];</div><div class="line">	<span class="keyword">while</span>(arr.length &gt; <span class="number">0</span>)&#123;</div><div class="line">		<span class="keyword">var</span> randomIndex = <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random()*arr.length);</div><div class="line">		mixedArray.push(arr[randomIndex]);</div><div class="line">		arr.splice(randomIndex, <span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> mixedArray;</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(randSort2(arr));</div></pre></td></tr></table></figure>

æ–¹æ³•ä¸‰ï¼š
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</div><div class="line">arr.sort(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="built_in">Math</span>.random() - <span class="number">0.5</span>;</div><div class="line">&#125;)</div><div class="line"><span class="built_in">console</span>.log(arr);</div></pre></td></tr></table></figure>
</code></pre></li>
<li><p>Javascriptå¦‚ä½•å®ç°ç»§æ‰¿ï¼Ÿ</p>
<pre><code>1ã€æ„é€ ç»§æ‰¿
2ã€åŸå‹ç»§æ‰¿
3ã€å®ä¾‹ç»§æ‰¿
4ã€æ‹·è´ç»§æ‰¿

åŸå‹prototypeæœºåˆ¶æˆ–applyå’Œcallæ–¹æ³•å»å®ç°è¾ƒç®€å•ï¼Œå»ºè®®ä½¿ç”¨æ„é€ å‡½æ•°ä¸åŸå‹æ··åˆæ–¹å¼ã€‚
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Parent</span>(<span class="params"></span>)</span>&#123;</div><div class="line">      	<span class="keyword">this</span>.name = <span class="string">'wang'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Child</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.age = <span class="number">28</span>;</div><div class="line">&#125;</div><div class="line">Child.prototype = <span class="keyword">new</span> Parent();<span class="comment">//ç»§æ‰¿äº†Parentï¼Œé€šè¿‡åŸå‹</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> demo = <span class="keyword">new</span> Child();</div><div class="line">alert(demo.age);</div><div class="line">alert(demo.name);<span class="comment">//å¾—åˆ°è¢«ç»§æ‰¿çš„å±æ€§</span></div></pre></td></tr></table></figure>
</code></pre></li>
<li><p>JavaScriptç»§æ‰¿çš„å‡ ç§å®ç°æ–¹å¼ï¼Ÿ</p>
<ul>
<li>å‚è€ƒï¼š<a href="http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_inheritance.html" target="_blank" rel="external">æ„é€ å‡½æ•°çš„ç»§æ‰¿</a>ï¼Œ<a href="http://www.ruanyifeng.com/blog/2010/05/object-oriented_javascript_inheritance_continued.html" target="_blank" rel="external">éæ„é€ å‡½æ•°çš„ç»§æ‰¿</a>ï¼›</li>
</ul>
</li>
</ul>
<ul>
<li><p>javascriptåˆ›å»ºå¯¹è±¡çš„å‡ ç§æ–¹å¼ï¼Ÿ</p>
<pre><code>javascriptåˆ›å»ºå¯¹è±¡ç®€å•çš„è¯´,æ— éå°±æ˜¯ä½¿ç”¨å†…ç½®å¯¹è±¡æˆ–å„ç§è‡ªå®šä¹‰å¯¹è±¡ï¼Œå½“ç„¶è¿˜å¯ä»¥ç”¨JSONï¼›ä½†å†™æ³•æœ‰å¾ˆå¤šç§ï¼Œä¹Ÿèƒ½æ··åˆä½¿ç”¨ã€‚
</code></pre></li>
</ul>
<pre><code>1ã€å¯¹è±¡å­—é¢é‡çš„æ–¹å¼

    person={firstname:&quot;Mark&quot;,lastname:&quot;Yun&quot;,age:25,eyecolor:&quot;black&quot;};

2ã€ç”¨functionæ¥æ¨¡æ‹Ÿæ— å‚çš„æ„é€ å‡½æ•°

    function Person(){}
    var person=new Person();//å®šä¹‰ä¸€ä¸ªfunctionï¼Œå¦‚æœä½¿ç”¨new&quot;å®ä¾‹åŒ–&quot;,è¯¥functionå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªClass
    person.name=&quot;Mark&quot;;
    person.age=&quot;25&quot;;
    person.work=function(){
    alert(person.name+&quot; hello...&quot;);
    }
    person.work();

3ã€ç”¨functionæ¥æ¨¡æ‹Ÿå‚æ„é€ å‡½æ•°æ¥å®ç°ï¼ˆç”¨thiså…³é”®å­—å®šä¹‰æ„é€ çš„ä¸Šä¸‹æ–‡å±æ€§ï¼‰

    function Pet(name,age,hobby){
       this.name=name;//thisä½œç”¨åŸŸï¼šå½“å‰å¯¹è±¡
       this.age=age;
       this.hobby=hobby;
       this.eat=function(){
          alert(&quot;æˆ‘å«&quot;+this.name+&quot;,æˆ‘å–œæ¬¢&quot;+this.hobby+&quot;,æ˜¯ä¸ªç¨‹åºå‘˜&quot;);
       }
    }
    var maidou =new Pet(&quot;éº¦å…œ&quot;,25,&quot;coding&quot;);//å®ä¾‹åŒ–ã€åˆ›å»ºå¯¹è±¡
    maidou.eat();//è°ƒç”¨eatæ–¹æ³•


4ã€ç”¨å·¥å‚æ–¹å¼æ¥åˆ›å»ºï¼ˆå†…ç½®å¯¹è±¡ï¼‰

     var wcDog =new Object();
     wcDog.name=&quot;æ—ºè´¢&quot;;
     wcDog.age=3;
     wcDog.work=function(){
       alert(&quot;æˆ‘æ˜¯&quot;+wcDog.name+&quot;,æ±ªæ±ªæ±ª......&quot;);
     }
     wcDog.work();


5ã€ç”¨åŸå‹æ–¹å¼æ¥åˆ›å»º

    function Dog(){

     }
     Dog.prototype.name=&quot;æ—ºè´¢&quot;;
     Dog.prototype.eat=function(){
     alert(this.name+&quot;æ˜¯ä¸ªåƒè´§&quot;);
     }
     var wangcai =new Dog();
     wangcai.eat();


5ã€ç”¨æ··åˆæ–¹å¼æ¥åˆ›å»º

    function Car(name,price){
      this.name=name;
      this.price=price;
    }
     Car.prototype.sell=function(){
       alert(&quot;æˆ‘æ˜¯&quot;+this.name+&quot;ï¼Œæˆ‘ç°åœ¨å–&quot;+this.price+&quot;ä¸‡å…ƒ&quot;);
      }
    var camry =new Car(&quot;å‡¯ç¾ç‘&quot;,27);
    camry.sell();
</code></pre><ul>
<li><p>Javascriptä½œç”¨é“¾åŸŸ?</p>
<pre><code>å…¨å±€å‡½æ•°æ— æ³•æŸ¥çœ‹å±€éƒ¨å‡½æ•°çš„å†…éƒ¨ç»†èŠ‚ï¼Œä½†å±€éƒ¨å‡½æ•°å¯ä»¥æŸ¥çœ‹å…¶ä¸Šå±‚çš„å‡½æ•°ç»†èŠ‚ï¼Œç›´è‡³å…¨å±€ç»†èŠ‚ã€‚
å½“éœ€è¦ä»å±€éƒ¨å‡½æ•°æŸ¥æ‰¾æŸä¸€å±æ€§æˆ–æ–¹æ³•æ—¶ï¼Œå¦‚æœå½“å‰ä½œç”¨åŸŸæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¼šä¸Šæº¯åˆ°ä¸Šå±‚ä½œç”¨åŸŸæŸ¥æ‰¾ï¼Œ
ç›´è‡³å…¨å±€å‡½æ•°ï¼Œè¿™ç§ç»„ç»‡å½¢å¼å°±æ˜¯ä½œç”¨åŸŸé“¾ã€‚
</code></pre></li>
<li><p>è°ˆè°ˆThiså¯¹è±¡çš„ç†è§£ã€‚</p>
<ul>
<li>thisæ€»æ˜¯æŒ‡å‘å‡½æ•°çš„ç›´æ¥è°ƒç”¨è€…ï¼ˆè€Œéé—´æ¥è°ƒç”¨è€…ï¼‰ï¼›</li>
<li>å¦‚æœæœ‰newå…³é”®å­—ï¼ŒthisæŒ‡å‘newå‡ºæ¥çš„é‚£ä¸ªå¯¹è±¡ï¼›</li>
<li>åœ¨äº‹ä»¶ä¸­ï¼ŒthisæŒ‡å‘è§¦å‘è¿™ä¸ªäº‹ä»¶çš„å¯¹è±¡ï¼Œç‰¹æ®Šçš„æ˜¯ï¼ŒIEä¸­çš„attachEventä¸­çš„thisæ€»æ˜¯æŒ‡å‘å…¨å±€å¯¹è±¡Windowï¼›</li>
</ul>
</li>
<li><p>evalæ˜¯åšä»€ä¹ˆçš„ï¼Ÿ</p>
<pre><code>å®ƒçš„åŠŸèƒ½æ˜¯æŠŠå¯¹åº”çš„å­—ç¬¦ä¸²è§£ææˆJSä»£ç å¹¶è¿è¡Œï¼›
åº”è¯¥é¿å…ä½¿ç”¨evalï¼Œä¸å®‰å…¨ï¼Œéå¸¸è€—æ€§èƒ½ï¼ˆ2æ¬¡ï¼Œä¸€æ¬¡è§£ææˆjsè¯­å¥ï¼Œä¸€æ¬¡æ‰§è¡Œï¼‰ã€‚
ç”±JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºJSONå¯¹è±¡çš„æ—¶å€™å¯ä»¥ç”¨evalï¼Œvar obj =eval(&apos;(&apos;+ str +&apos;)&apos;);
</code></pre></li>
<li><p>ä»€ä¹ˆæ˜¯windowå¯¹è±¡? ä»€ä¹ˆæ˜¯documentå¯¹è±¡?</p>
<pre><code>windowå¯¹è±¡æ˜¯æŒ‡æµè§ˆå™¨æ‰“å¼€çš„çª—å£ã€‚
documentå¯¹è±¡æ˜¯Documentdå¯¹è±¡ï¼ˆHTML æ–‡æ¡£å¯¹è±¡ï¼‰çš„ä¸€ä¸ªåªè¯»å¼•ç”¨ï¼Œwindowå¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚
</code></pre></li>
<li><p>nullï¼Œundefined çš„åŒºåˆ«ï¼Ÿ</p>
<pre><code>null         è¡¨ç¤ºä¸€ä¸ªå¯¹è±¡æ˜¯â€œæ²¡æœ‰å€¼â€çš„å€¼ï¼Œä¹Ÿå°±æ˜¯å€¼ä¸ºâ€œç©ºâ€ï¼›
undefined     è¡¨ç¤ºä¸€ä¸ªå˜é‡å£°æ˜äº†æ²¡æœ‰åˆå§‹åŒ–(èµ‹å€¼)ï¼›

undefinedä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„JSONï¼Œè€Œnullæ˜¯ï¼›
undefinedçš„ç±»å‹(typeof)æ˜¯undefinedï¼›
nullçš„ç±»å‹(typeof)æ˜¯objectï¼›
</code></pre></li>
</ul>
<pre><code>    Javascriptå°†æœªèµ‹å€¼çš„å˜é‡é»˜è®¤å€¼è®¾ä¸ºundefinedï¼›
    Javascriptä»æ¥ä¸ä¼šå°†å˜é‡è®¾ä¸ºnullã€‚å®ƒæ˜¯ç”¨æ¥è®©ç¨‹åºå‘˜è¡¨æ˜æŸä¸ªç”¨varå£°æ˜çš„å˜é‡æ—¶æ²¡æœ‰å€¼çš„ã€‚

    typeof undefined
        //&quot;undefined&quot;
        undefined :æ˜¯ä¸€ä¸ªè¡¨ç¤º&quot;æ— &quot;çš„åŸå§‹å€¼æˆ–è€…è¯´è¡¨ç¤º&quot;ç¼ºå°‘å€¼&quot;ï¼Œå°±æ˜¯æ­¤å¤„åº”è¯¥æœ‰ä¸€ä¸ªå€¼ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å®šä¹‰ã€‚å½“å°è¯•è¯»å–æ—¶ä¼šè¿”å› undefinedï¼›
        ä¾‹å¦‚å˜é‡è¢«å£°æ˜äº†ï¼Œä½†æ²¡æœ‰èµ‹å€¼æ—¶ï¼Œå°±ç­‰äºundefined

    typeof null
        //&quot;object&quot;
        null : æ˜¯ä¸€ä¸ªå¯¹è±¡(ç©ºå¯¹è±¡, æ²¡æœ‰ä»»ä½•å±æ€§å’Œæ–¹æ³•)ï¼›
        ä¾‹å¦‚ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°çš„å‚æ•°ä¸æ˜¯å¯¹è±¡ï¼›

    æ³¨æ„ï¼š
        åœ¨éªŒè¯nullæ—¶ï¼Œä¸€å®šè¦ä½¿ç”¨ã€€=== ï¼Œå› ä¸º == æ— æ³•åˆ†åˆ« null å’Œã€€undefined
         null == undefined // true
          null === undefined // false

    å†æ¥ä¸€ä¸ªä¾‹å­ï¼š

        null
        Qï¼šæœ‰å¼ ä¸‰è¿™ä¸ªäººä¹ˆï¼Ÿ
        Aï¼šæœ‰ï¼
        Qï¼šå¼ ä¸‰æœ‰æˆ¿å­ä¹ˆï¼Ÿ
        Aï¼šæ²¡æœ‰ï¼

        undefined
        Qï¼šæœ‰å¼ ä¸‰è¿™ä¸ªäººä¹ˆï¼Ÿ
        Aï¼šæœ‰ï¼
        Q: å¼ ä¸‰æœ‰å¤šå°‘å²ï¼Ÿ
        A: ä¸çŸ¥é“ï¼ˆæ²¡æœ‰è¢«å‘Šè¯‰ï¼‰

å‚è€ƒé˜…è¯»ï¼š[undefinedä¸nullçš„åŒºåˆ«](http://www.ruanyifeng.com/blog/2014/03/undefined-vs-null.html)
</code></pre><ul>
<li><p>å†™ä¸€ä¸ªé€šç”¨çš„äº‹ä»¶ä¾¦å¬å™¨å‡½æ•°ã€‚</p>
<pre><code>// event(äº‹ä»¶)å·¥å…·é›†ï¼Œæ¥æºï¼šgithub.com/markyun
markyun.Event = {
    // é¡µé¢åŠ è½½å®Œæˆå
    readyEvent : function(fn) {
        if (fn==null) {
            fn=document;
        }
        var oldonload = window.onload;
        if (typeof window.onload != &apos;function&apos;) {
            window.onload = fn;
        } else {
            window.onload = function() {
                oldonload();
                fn();
            };
        }
    },
    // è§†èƒ½åŠ›åˆ†åˆ«ä½¿ç”¨dom0||dom2||IEæ–¹å¼ æ¥ç»‘å®šäº‹ä»¶
    // å‚æ•°ï¼š æ“ä½œçš„å…ƒç´ ,äº‹ä»¶åç§° ,äº‹ä»¶å¤„ç†ç¨‹åº
    addEvent : function(element, type, handler) {
        if (element.addEventListener) {
            //äº‹ä»¶ç±»å‹ã€éœ€è¦æ‰§è¡Œçš„å‡½æ•°ã€æ˜¯å¦æ•æ‰
            element.addEventListener(type, handler, false);
        } else if (element.attachEvent) {
            element.attachEvent(&apos;on&apos; + type, function() {
                handler.call(element);
            });
        } else {
            element[&apos;on&apos; + type] = handler;
        }
    },
    // ç§»é™¤äº‹ä»¶
    removeEvent : function(element, type, handler) {
        if (element.removeEventListener) {
            element.removeEventListener(type, handler, false);
        } else if (element.datachEvent) {
            element.detachEvent(&apos;on&apos; + type, handler);
        } else {
            element[&apos;on&apos; + type] = null;
        }
    },
    // é˜»æ­¢äº‹ä»¶ (ä¸»è¦æ˜¯äº‹ä»¶å†’æ³¡ï¼Œå› ä¸ºIEä¸æ”¯æŒäº‹ä»¶æ•è·)
    stopPropagation : function(ev) {
        if (ev.stopPropagation) {
            ev.stopPropagation();
        } else {
            ev.cancelBubble = true;
        }
    },
    // å–æ¶ˆäº‹ä»¶çš„é»˜è®¤è¡Œä¸º
    preventDefault : function(event) {
        if (event.preventDefault) {
            event.preventDefault();
        } else {
            event.returnValue = false;
        }
    },
    // è·å–äº‹ä»¶ç›®æ ‡
    getTarget : function(event) {
        return event.target || event.srcElement;
    },
    // è·å–eventå¯¹è±¡çš„å¼•ç”¨ï¼Œå–åˆ°äº‹ä»¶çš„æ‰€æœ‰ä¿¡æ¯ï¼Œç¡®ä¿éšæ—¶èƒ½ä½¿ç”¨eventï¼›
    getEvent : function(e) {
        var ev = e || window.event;
        if (!ev) {
            var c = this.getEvent.caller;
            while (c) {
                ev = c.arguments[0];
                if (ev &amp;&amp; Event == ev.constructor) {
                    break;
                }
                c = c.caller;
            }
        }
        return ev;
    }
};
</code></pre></li>
<li><p>[â€œ1â€, â€œ2â€, â€œ3â€].map(parseInt) ç­”æ¡ˆæ˜¯å¤šå°‘ï¼Ÿ</p>
<pre><code>parseInt() å‡½æ•°èƒ½è§£æä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ•´æ•°ï¼Œéœ€è¦ä¸¤ä¸ªå‚æ•° (val, radix)ï¼Œ
å…¶ä¸­ radix è¡¨ç¤ºè¦è§£æçš„æ•°å­—çš„åŸºæ•°ã€‚ã€è¯¥å€¼ä»‹äº 2 ~ 36 ä¹‹é—´ï¼Œå¹¶ä¸”å­—ç¬¦ä¸²ä¸­çš„æ•°å­—ä¸èƒ½å¤§äºradixæ‰èƒ½æ­£ç¡®è¿”å›æ•°å­—ç»“æœå€¼ã€‘;
ä½†æ­¤å¤„ map ä¼ äº† 3 ä¸ª (element, index, array),æˆ‘ä»¬é‡å†™parseIntå‡½æ•°æµ‹è¯•ä¸€ä¸‹æ˜¯å¦ç¬¦åˆä¸Šé¢çš„è§„åˆ™ã€‚

function parseInt(str, radix) {
    return str+&apos;-&apos;+radix;
};
var a=[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;];
a.map(parseInt);  // [&quot;1-0&quot;, &quot;2-1&quot;, &quot;3-2&quot;] ä¸èƒ½å¤§äºradix

å› ä¸ºäºŒè¿›åˆ¶é‡Œé¢ï¼Œæ²¡æœ‰æ•°å­—3,å¯¼è‡´å‡ºç°è¶…èŒƒå›´çš„radixèµ‹å€¼å’Œä¸åˆæ³•çš„è¿›åˆ¶è§£æï¼Œæ‰ä¼šè¿”å›NaN
æ‰€ä»¥[&quot;1&quot;, &quot;2&quot;, &quot;3&quot;].map(parseInt) ç­”æ¡ˆä¹Ÿå°±æ˜¯ï¼š[1, NaN, NaN]

è¯¦ç»†è§£æï¼šhttp://blog.csdn.net/justjavac/article/details/19473199
</code></pre></li>
<li><p>äº‹ä»¶æ˜¯ï¼ŸIEä¸ç«ç‹çš„äº‹ä»¶æœºåˆ¶æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å¦‚ä½•é˜»æ­¢å†’æ³¡ï¼Ÿ</p>
<pre><code>1. æˆ‘ä»¬åœ¨ç½‘é¡µä¸­çš„æŸä¸ªæ“ä½œï¼ˆæœ‰çš„æ“ä½œå¯¹åº”å¤šä¸ªäº‹ä»¶ï¼‰ã€‚ä¾‹å¦‚ï¼šå½“æˆ‘ä»¬ç‚¹å‡»ä¸€ä¸ªæŒ‰é’®å°±ä¼šäº§ç”Ÿä¸€ä¸ªäº‹ä»¶ã€‚æ˜¯å¯ä»¥è¢« JavaScript ä¾¦æµ‹åˆ°çš„è¡Œä¸ºã€‚
2. äº‹ä»¶å¤„ç†æœºåˆ¶ï¼šIEæ˜¯äº‹ä»¶å†’æ³¡ã€FirefoxåŒæ—¶æ”¯æŒä¸¤ç§äº‹ä»¶æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯ï¼šæ•è·å‹äº‹ä»¶å’Œå†’æ³¡å‹äº‹ä»¶ï¼›
3. ev.stopPropagation();ï¼ˆæ—§ieçš„æ–¹æ³• ev.cancelBubble = true;ï¼‰
</code></pre></li>
</ul>
<ul>
<li><p>ä»€ä¹ˆæ˜¯é—­åŒ…ï¼ˆclosureï¼‰ï¼Œä¸ºä»€ä¹ˆè¦ç”¨å®ƒï¼Ÿ</p>
<pre><code>é—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­å˜é‡çš„å‡½æ•°ï¼Œåˆ›å»ºé—­åŒ…çš„æœ€å¸¸è§çš„æ–¹å¼å°±æ˜¯åœ¨ä¸€ä¸ªå‡½æ•°å†…åˆ›å»ºå¦ä¸€ä¸ªå‡½æ•°ï¼Œé€šè¿‡å¦ä¸€ä¸ªå‡½æ•°è®¿é—®è¿™ä¸ªå‡½æ•°çš„å±€éƒ¨å˜é‡,åˆ©ç”¨é—­åŒ…å¯ä»¥çªç ´ä½œç”¨é“¾åŸŸï¼Œå°†å‡½æ•°å†…éƒ¨çš„å˜é‡å’Œæ–¹æ³•ä¼ é€’åˆ°å¤–éƒ¨ã€‚

é—­åŒ…çš„ç‰¹æ€§ï¼š

1.å‡½æ•°å†…å†åµŒå¥—å‡½æ•°
2.å†…éƒ¨å‡½æ•°å¯ä»¥å¼•ç”¨å¤–å±‚çš„å‚æ•°å’Œå˜é‡
3.å‚æ•°å’Œå˜é‡ä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶

//lièŠ‚ç‚¹çš„onclickäº‹ä»¶éƒ½èƒ½æ­£ç¡®çš„å¼¹å‡ºå½“å‰è¢«ç‚¹å‡»çš„liç´¢å¼•
 &lt;ul id=&quot;testUL&quot;&gt;
    &lt;li&gt; index = 0&lt;/li&gt;
    &lt;li&gt; index = 1&lt;/li&gt;
    &lt;li&gt; index = 2&lt;/li&gt;
    &lt;li&gt; index = 3&lt;/li&gt;
&lt;/ul&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
      var nodes = document.getElementsByTagName(&quot;li&quot;);
    for(i = 0;i&lt;nodes.length;i+= 1){
        nodes[i].onclick = (function(i){
                  return function() {
                     console.log(i);
                  } //ä¸ç”¨é—­åŒ…çš„è¯ï¼Œå€¼æ¯æ¬¡éƒ½æ˜¯4
                })(i);
    }
&lt;/script&gt;
</code></pre></li>
</ul>
<pre><code>æ‰§è¡Œsay667()å,say667()é—­åŒ…å†…éƒ¨å˜é‡ä¼šå­˜åœ¨,è€Œé—­åŒ…å†…éƒ¨å‡½æ•°çš„å†…éƒ¨å˜é‡ä¸ä¼šå­˜åœ¨
ä½¿å¾—Javascriptçš„åƒåœ¾å›æ”¶æœºåˆ¶GCä¸ä¼šæ”¶å›say667()æ‰€å ç”¨çš„èµ„æº
å› ä¸ºsay667()çš„å†…éƒ¨å‡½æ•°çš„æ‰§è¡Œéœ€è¦ä¾èµ–say667()ä¸­çš„å˜é‡
è¿™æ˜¯å¯¹é—­åŒ…ä½œç”¨çš„éå¸¸ç›´ç™½çš„æè¿°

  function say667() {
    // Local variable that ends up within closure
    var num = 666;
    var sayAlert = function() {
        alert(num);
    }
    num++;
    return sayAlert;
}

 var sayAlert = say667();
 sayAlert()//æ‰§è¡Œç»“æœåº”è¯¥å¼¹å‡ºçš„667
</code></pre><ul>
<li><p>javascript ä»£ç ä¸­çš„â€use strictâ€;æ˜¯ä»€ä¹ˆæ„æ€ ? ä½¿ç”¨å®ƒåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<pre><code>use strictæ˜¯ä¸€ç§ECMAscript 5 æ·»åŠ çš„ï¼ˆä¸¥æ ¼ï¼‰è¿è¡Œæ¨¡å¼,è¿™ç§æ¨¡å¼ä½¿å¾— Javascript åœ¨æ›´ä¸¥æ ¼çš„æ¡ä»¶ä¸‹è¿è¡Œ,

ä½¿JSç¼–ç æ›´åŠ è§„èŒƒåŒ–çš„æ¨¡å¼,æ¶ˆé™¤Javascriptè¯­æ³•çš„ä¸€äº›ä¸åˆç†ã€ä¸ä¸¥è°¨ä¹‹å¤„ï¼Œå‡å°‘ä¸€äº›æ€ªå¼‚è¡Œä¸ºã€‚
é»˜è®¤æ”¯æŒçš„ç³Ÿç³•ç‰¹æ€§éƒ½ä¼šè¢«ç¦ç”¨ï¼Œæ¯”å¦‚ä¸èƒ½ç”¨withï¼Œä¹Ÿä¸èƒ½åœ¨æ„å¤–çš„æƒ…å†µä¸‹ç»™å…¨å±€å˜é‡èµ‹å€¼;
å…¨å±€å˜é‡çš„æ˜¾ç¤ºå£°æ˜,å‡½æ•°å¿…é¡»å£°æ˜åœ¨é¡¶å±‚ï¼Œä¸å…è®¸åœ¨éå‡½æ•°ä»£ç å—å†…å£°æ˜å‡½æ•°,arguments.calleeä¹Ÿä¸å…è®¸ä½¿ç”¨ï¼›
æ¶ˆé™¤ä»£ç è¿è¡Œçš„ä¸€äº›ä¸å®‰å…¨ä¹‹å¤„ï¼Œä¿è¯ä»£ç è¿è¡Œçš„å®‰å…¨,é™åˆ¶å‡½æ•°ä¸­çš„argumentsä¿®æ”¹ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹çš„evalå‡½æ•°çš„è¡Œä¸ºå’Œéä¸¥æ ¼æ¨¡å¼çš„ä¹Ÿä¸ç›¸åŒ;

æé«˜ç¼–è¯‘å™¨æ•ˆç‡ï¼Œå¢åŠ è¿è¡Œé€Ÿåº¦ï¼›
ä¸ºæœªæ¥æ–°ç‰ˆæœ¬çš„Javascriptæ ‡å‡†åŒ–åšé“ºå«ã€‚
</code></pre></li>
</ul>
<ul>
<li><p>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å±äºæŸä¸ªç±»ï¼Ÿ</p>
<pre><code>ä½¿ç”¨instanceof ï¼ˆå¾…å®Œå–„ï¼‰
if(a instanceof Person){
    alert(&apos;yes&apos;);
}
</code></pre></li>
<li><p>newæ“ä½œç¬¦å…·ä½“å¹²äº†ä»€ä¹ˆå‘¢?</p>
<pre><code>     1ã€åˆ›å»ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå¹¶ä¸” this å˜é‡å¼•ç”¨è¯¥å¯¹è±¡ï¼ŒåŒæ—¶è¿˜ç»§æ‰¿äº†è¯¥å‡½æ•°çš„åŸå‹ã€‚
         2ã€å±æ€§å’Œæ–¹æ³•è¢«åŠ å…¥åˆ° this å¼•ç”¨çš„å¯¹è±¡ä¸­ã€‚
      3ã€æ–°åˆ›å»ºçš„å¯¹è±¡ç”± this æ‰€å¼•ç”¨ï¼Œå¹¶ä¸”æœ€åéšå¼çš„è¿”å› this ã€‚

var obj  = {};
obj.__proto__ = Base.prototype;
Base.call(obj);
</code></pre></li>
</ul>
<ul>
<li>ç”¨åŸç”ŸJavaScriptçš„å®ç°è¿‡ä»€ä¹ˆåŠŸèƒ½å—ï¼Ÿ</li>
</ul>
<ul>
<li><p>Javascriptä¸­ï¼Œæœ‰ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œæ—¶å¯¹è±¡æŸ¥æ‰¾æ—¶ï¼Œæ°¸è¿œä¸ä¼šå»æŸ¥æ‰¾åŸå‹ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ï¼Ÿ</p>
<pre><code>hasOwnProperty

javaScriptä¸­hasOwnPropertyå‡½æ•°æ–¹æ³•æ˜¯è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼ŒæŒ‡å‡ºä¸€ä¸ªå¯¹è±¡æ˜¯å¦å…·æœ‰æŒ‡å®šåç§°çš„å±æ€§ã€‚æ­¤æ–¹æ³•æ— æ³•æ£€æŸ¥è¯¥å¯¹è±¡çš„åŸå‹é“¾ä¸­æ˜¯å¦å…·æœ‰è¯¥å±æ€§ï¼›è¯¥å±æ€§å¿…é¡»æ˜¯å¯¹è±¡æœ¬èº«çš„ä¸€ä¸ªæˆå‘˜ã€‚
ä½¿ç”¨æ–¹æ³•ï¼š
object.hasOwnProperty(proName)
å…¶ä¸­å‚æ•°objectæ˜¯å¿…é€‰é¡¹ã€‚ä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹ã€‚
proNameæ˜¯å¿…é€‰é¡¹ã€‚ä¸€ä¸ªå±æ€§åç§°çš„å­—ç¬¦ä¸²å€¼ã€‚

å¦‚æœ object å…·æœ‰æŒ‡å®šåç§°çš„å±æ€§ï¼Œé‚£ä¹ˆJavaScriptä¸­hasOwnPropertyå‡½æ•°æ–¹æ³•è¿”å› trueï¼Œåä¹‹åˆ™è¿”å› falseã€‚
</code></pre></li>
<li><p>JSON çš„äº†è§£ï¼Ÿ</p>
<pre><code>JSON(JavaScript Object Notation) æ˜¯ä¸€ç§è½»é‡çº§çš„æ•°æ®äº¤æ¢æ ¼å¼ã€‚
å®ƒæ˜¯åŸºäºJavaScriptçš„ä¸€ä¸ªå­é›†ã€‚æ•°æ®æ ¼å¼ç®€å•, æ˜“äºè¯»å†™, å ç”¨å¸¦å®½å°
å¦‚ï¼š{&quot;age&quot;:&quot;12&quot;, &quot;name&quot;:&quot;back&quot;}

JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºJSONå¯¹è±¡:
var obj =eval(&apos;(&apos;+ str +&apos;)&apos;);
var obj = str.parseJSON();
var obj = JSON.parse(str);

JSONå¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²ï¼š
var last=obj.toJSONString();
var last=JSON.stringify(obj);
</code></pre></li>
<li><p><code>[].forEach.call($$(&quot;*&quot;),function(a){a.style.outline=&quot;1px solid #&quot;+(~~(Math.random()*(1&lt;&lt;24))).toString(16)})</code> èƒ½è§£é‡Šä¸€ä¸‹è¿™æ®µä»£ç çš„æ„æ€å—ï¼Ÿ</p>
</li>
</ul>
<ul>
<li><p>jså»¶è¿ŸåŠ è½½çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</p>
<pre><code>deferå’Œasyncã€åŠ¨æ€åˆ›å»ºDOMæ–¹å¼ï¼ˆç”¨å¾—æœ€å¤šï¼‰ã€æŒ‰éœ€å¼‚æ­¥è½½å…¥js
</code></pre></li>
</ul>
<ul>
<li><p>Ajax æ˜¯ä»€ä¹ˆ? å¦‚ä½•åˆ›å»ºä¸€ä¸ªAjaxï¼Ÿ</p>
<pre><code>ajaxçš„å…¨ç§°ï¼šAsynchronous Javascript And XMLã€‚
å¼‚æ­¥ä¼ è¾“+js+xmlã€‚
æ‰€è°“å¼‚æ­¥ï¼Œåœ¨è¿™é‡Œç®€å•åœ°è§£é‡Šå°±æ˜¯ï¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¸å¿…ç­‰å¾…ç»“æœï¼Œè€Œæ˜¯å¯ä»¥åŒæ—¶åšå…¶ä»–çš„äº‹æƒ…ï¼Œç­‰åˆ°æœ‰äº†ç»“æœå®ƒè‡ªå·±ä¼šæ ¹æ®è®¾å®šè¿›è¡Œåç»­æ“ä½œï¼Œä¸æ­¤åŒæ—¶ï¼Œé¡µé¢æ˜¯ä¸ä¼šå‘ç”Ÿæ•´é¡µåˆ·æ–°çš„ï¼Œæé«˜äº†ç”¨æˆ·ä½“éªŒã€‚

(1)åˆ›å»ºXMLHttpRequestå¯¹è±¡,ä¹Ÿå°±æ˜¯åˆ›å»ºä¸€ä¸ªå¼‚æ­¥è°ƒç”¨å¯¹è±¡
(2)åˆ›å»ºä¸€ä¸ªæ–°çš„HTTPè¯·æ±‚,å¹¶æŒ‡å®šè¯¥HTTPè¯·æ±‚çš„æ–¹æ³•ã€URLåŠéªŒè¯ä¿¡æ¯
(3)è®¾ç½®å“åº”HTTPè¯·æ±‚çŠ¶æ€å˜åŒ–çš„å‡½æ•°
(4)å‘é€HTTPè¯·æ±‚
(5)è·å–å¼‚æ­¥è°ƒç”¨è¿”å›çš„æ•°æ®
(6)ä½¿ç”¨JavaScriptå’ŒDOMå®ç°å±€éƒ¨åˆ·æ–°
</code></pre></li>
<li><p>Ajax è§£å†³æµè§ˆå™¨ç¼“å­˜é—®é¢˜ï¼Ÿ</p>
<pre><code>1ã€åœ¨ajaxå‘é€è¯·æ±‚å‰åŠ ä¸Š anyAjaxObj.setRequestHeader(&quot;If-Modified-Since&quot;,&quot;0&quot;)ã€‚

2ã€åœ¨ajaxå‘é€è¯·æ±‚å‰åŠ ä¸Š anyAjaxObj.setRequestHeader(&quot;Cache-Control&quot;,&quot;no-cache&quot;)ã€‚

3ã€åœ¨URLåé¢åŠ ä¸Šä¸€ä¸ªéšæœºæ•°ï¼š &quot;fresh=&quot; + Math.random();ã€‚

4ã€åœ¨URLåé¢åŠ ä¸Šæ—¶é—´æ“ï¼š&quot;nowtime=&quot; + new Date().getTime();ã€‚

5ã€å¦‚æœæ˜¯ä½¿ç”¨jQueryï¼Œç›´æ¥è¿™æ ·å°±å¯ä»¥äº† $.ajaxSetup({cache:false})ã€‚è¿™æ ·é¡µé¢çš„æ‰€æœ‰ajaxéƒ½ä¼šæ‰§è¡Œè¿™æ¡è¯­å¥å°±æ˜¯ä¸éœ€è¦ä¿å­˜ç¼“å­˜è®°å½•ã€‚
</code></pre></li>
<li><p>åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«?</p>
<p> åŒæ­¥çš„æ¦‚å¿µåº”è¯¥æ˜¯æ¥è‡ªäºOSä¸­å…³äºåŒæ­¥çš„æ¦‚å¿µ:ä¸åŒè¿›ç¨‹ä¸ºååŒå®ŒæˆæŸé¡¹å·¥ä½œè€Œåœ¨å…ˆåæ¬¡åºä¸Šè°ƒæ•´(é€šè¿‡é˜»å¡,å”¤é†’ç­‰æ–¹å¼).åŒæ­¥å¼ºè°ƒçš„æ˜¯é¡ºåºæ€§.è°å…ˆè°å.å¼‚æ­¥åˆ™ä¸å­˜åœ¨è¿™ç§é¡ºåºæ€§.</p>
</li>
</ul>
<pre><code>åŒæ­¥ï¼šæµè§ˆå™¨è®¿é—®æœåŠ¡å™¨è¯·æ±‚ï¼Œç”¨æˆ·çœ‹å¾—åˆ°é¡µé¢åˆ·æ–°ï¼Œé‡æ–°å‘è¯·æ±‚,ç­‰è¯·æ±‚å®Œï¼Œé¡µé¢åˆ·æ–°ï¼Œæ–°å†…å®¹å‡ºç°ï¼Œç”¨æˆ·çœ‹åˆ°æ–°å†…å®¹,è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚

å¼‚æ­¥ï¼šæµè§ˆå™¨è®¿é—®æœåŠ¡å™¨è¯·æ±‚ï¼Œç”¨æˆ·æ­£å¸¸æ“ä½œï¼Œæµè§ˆå™¨åç«¯è¿›è¡Œè¯·æ±‚ã€‚ç­‰è¯·æ±‚å®Œï¼Œé¡µé¢ä¸åˆ·æ–°ï¼Œæ–°å†…å®¹ä¹Ÿä¼šå‡ºç°ï¼Œç”¨æˆ·çœ‹åˆ°æ–°å†…å®¹ã€‚



ï¼ˆå¾…å®Œå–„ï¼‰
</code></pre><ul>
<li><p>å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜?</p>
<pre><code>jsonpã€ iframeã€window.nameã€window.postMessageã€æœåŠ¡å™¨ä¸Šè®¾ç½®ä»£ç†é¡µé¢
</code></pre></li>
<li><p>é¡µé¢ç¼–ç å’Œè¢«è¯·æ±‚çš„èµ„æºç¼–ç å¦‚æœä¸ä¸€è‡´å¦‚ä½•å¤„ç†ï¼Ÿ</p>
</li>
<li><p>æ¨¡å—åŒ–å¼€å‘æ€ä¹ˆåšï¼Ÿ</p>
<p>  <a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/" target="_blank" rel="external"> ç«‹å³æ‰§è¡Œå‡½æ•°</a>,ä¸æš´éœ²ç§æœ‰æˆå‘˜</p>
<pre><code>var module1 = (function(){
ã€€ã€€ã€€ã€€var _count = 0;
ã€€ã€€ã€€ã€€var m1 = function(){
ã€€ã€€ã€€ã€€ã€€ã€€//...
ã€€ã€€ã€€ã€€};
ã€€ã€€ã€€ã€€var m2 = function(){
ã€€ã€€ã€€ã€€ã€€ã€€//...
ã€€ã€€ã€€ã€€};
ã€€ã€€ã€€ã€€return {
ã€€ã€€ã€€ã€€ã€€ã€€m1 : m1,
ã€€ã€€ã€€ã€€ã€€ã€€m2 : m2
ã€€ã€€ã€€ã€€};
ã€€ã€€})();
</code></pre><p> ï¼ˆå¾…å®Œå–„ï¼‰</p>
</li>
<li><p>AMDï¼ˆModules/Asynchronous-Definitionï¼‰ã€CMDï¼ˆCommon Module Definitionï¼‰è§„èŒƒåŒºåˆ«ï¼Ÿ</p>
<blockquote>
<p>AMD è§„èŒƒåœ¨è¿™é‡Œï¼š<a href="https://github.com/amdjs/amdjs-api/wiki/AMD" target="_blank" rel="external">https://github.com/amdjs/amdjs-api/wiki/AMD</a></p>
<p>CMD è§„èŒƒåœ¨è¿™é‡Œï¼š<a href="https://github.com/seajs/seajs/issues/242" target="_blank" rel="external">https://github.com/seajs/seajs/issues/242</a></p>
</blockquote>
<pre><code>Asynchronous Module Definitionï¼Œå¼‚æ­¥æ¨¡å—å®šä¹‰ï¼Œæ‰€æœ‰çš„æ¨¡å—å°†è¢«å¼‚æ­¥åŠ è½½ï¼Œæ¨¡å—åŠ è½½ä¸å½±å“åé¢è¯­å¥è¿è¡Œã€‚æ‰€æœ‰ä¾èµ–æŸäº›æ¨¡å—çš„è¯­å¥å‡æ”¾ç½®åœ¨å›è°ƒå‡½æ•°ä¸­ã€‚

 åŒºåˆ«ï¼š

    1. å¯¹äºä¾èµ–çš„æ¨¡å—ï¼ŒAMD æ˜¯æå‰æ‰§è¡Œï¼ŒCMD æ˜¯å»¶è¿Ÿæ‰§è¡Œã€‚ä¸è¿‡ RequireJS ä» 2.0 å¼€å§‹ï¼Œä¹Ÿæ”¹æˆå¯ä»¥å»¶è¿Ÿæ‰§è¡Œï¼ˆæ ¹æ®å†™æ³•ä¸åŒï¼Œå¤„ç†æ–¹å¼ä¸åŒï¼‰ã€‚CMD æ¨å´‡ as lazy as possible.
    2. CMD æ¨å´‡ä¾èµ–å°±è¿‘ï¼ŒAMD æ¨å´‡ä¾èµ–å‰ç½®ã€‚çœ‹ä»£ç ï¼š

// CMD
define(function(require, exports, module) {
    var a = require(&apos;./a&apos;)
    a.doSomething()
    // æ­¤å¤„ç•¥å» 100 è¡Œ
    var b = require(&apos;./b&apos;) // ä¾èµ–å¯ä»¥å°±è¿‘ä¹¦å†™
    b.doSomething()
    // ...
})

// AMD é»˜è®¤æ¨è
define([&apos;./a&apos;, &apos;./b&apos;], function(a, b) { // ä¾èµ–å¿…é¡»ä¸€å¼€å§‹å°±å†™å¥½
    a.doSomething()
    // æ­¤å¤„ç•¥å» 100 è¡Œ
    b.doSomething()
    // ...
})
</code></pre></li>
</ul>
<ul>
<li><p>requireJSçš„æ ¸å¿ƒåŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå¦‚ä½•åŠ¨æ€åŠ è½½çš„ï¼Ÿå¦‚ä½•é¿å…å¤šæ¬¡åŠ è½½çš„ï¼Ÿå¦‚ä½•<br>ç¼“å­˜çš„ï¼Ÿï¼‰</p>
<pre><code>å‚è€ƒï¼šhttp://annn.me/how-to-realize-cmd-loader/
</code></pre></li>
<li><p>JSæ¨¡å—åŠ è½½å™¨çš„è½®å­æ€ä¹ˆé€ ï¼Œä¹Ÿå°±æ˜¯å¦‚ä½•å®ç°ä¸€ä¸ªæ¨¡å—åŠ è½½å™¨ï¼Ÿ</p>
</li>
<li><p>è°ˆä¸€è°ˆä½ å¯¹ECMAScript6çš„äº†è§£ï¼Ÿ</p>
</li>
<li><p>ECMAScript6 æ€ä¹ˆå†™classä¹ˆï¼Œä¸ºä»€ä¹ˆä¼šå‡ºç°classè¿™ç§ä¸œè¥¿?</p>
</li>
<li><p>å¼‚æ­¥åŠ è½½JSçš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ</p>
<pre><code>(1) deferï¼Œåªæ”¯æŒIE

(2) asyncï¼š

(3) åˆ›å»ºscriptï¼Œæ’å…¥åˆ°DOMä¸­ï¼ŒåŠ è½½å®Œæ¯•åcallBack
</code></pre></li>
<li><p>documen.writeå’Œ innerHTMLçš„åŒºåˆ«</p>
<pre><code>document.writeåªèƒ½é‡ç»˜æ•´ä¸ªé¡µé¢

innerHTMLå¯ä»¥é‡ç»˜é¡µé¢çš„ä¸€éƒ¨åˆ†
</code></pre></li>
<li><p>DOMæ“ä½œâ€”â€”æ€æ ·æ·»åŠ ã€ç§»é™¤ã€ç§»åŠ¨ã€å¤åˆ¶ã€åˆ›å»ºå’ŒæŸ¥æ‰¾èŠ‚ç‚¹?</p>
<pre><code>ï¼ˆ1ï¼‰åˆ›å»ºæ–°èŠ‚ç‚¹
  createDocumentFragment()    //åˆ›å»ºä¸€ä¸ªDOMç‰‡æ®µ
  createElement()   //åˆ›å»ºä¸€ä¸ªå…·ä½“çš„å…ƒç´ 
  createTextNode()   //åˆ›å»ºä¸€ä¸ªæ–‡æœ¬èŠ‚ç‚¹
ï¼ˆ2ï¼‰æ·»åŠ ã€ç§»é™¤ã€æ›¿æ¢ã€æ’å…¥
  appendChild()
  removeChild()
  replaceChild()
  insertBefore() //åœ¨å·²æœ‰çš„å­èŠ‚ç‚¹å‰æ’å…¥ä¸€ä¸ªæ–°çš„å­èŠ‚ç‚¹
ï¼ˆ3ï¼‰æŸ¥æ‰¾
  getElementsByTagName()    //é€šè¿‡æ ‡ç­¾åç§°
  getElementsByName()    //é€šè¿‡å…ƒç´ çš„Nameå±æ€§çš„å€¼(IEå®¹é”™èƒ½åŠ›è¾ƒå¼ºï¼Œä¼šå¾—åˆ°ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­åŒ…æ‹¬idç­‰äºnameå€¼çš„)
  getElementById()    //é€šè¿‡å…ƒç´ Idï¼Œå”¯ä¸€æ€§
</code></pre></li>
<li><p>.call() å’Œ .apply() çš„åŒºåˆ«ï¼Ÿ</p>
</li>
</ul>
<pre><code>ä¾‹å­ä¸­ç”¨ add æ¥æ›¿æ¢ subï¼Œadd.call(sub,3,1) == add(3,1) ï¼Œæ‰€ä»¥è¿è¡Œç»“æœä¸ºï¼šalert(4);

æ³¨æ„ï¼šjs ä¸­çš„å‡½æ•°å…¶å®æ˜¯å¯¹è±¡ï¼Œå‡½æ•°åæ˜¯å¯¹ Function å¯¹è±¡çš„å¼•ç”¨ã€‚

  function add(a,b)
  {
      alert(a+b);
  }

  function sub(a,b)
  {
      alert(a-b);
  }

  add.call(sub,3,1);
</code></pre><ul>
<li><p>æ•°ç»„å’Œå¯¹è±¡æœ‰å“ªäº›åŸç”Ÿæ–¹æ³•ï¼Œåˆ—ä¸¾ä¸€ä¸‹ï¼Ÿ</p>
</li>
<li><p>JS æ€ä¹ˆå®ç°ä¸€ä¸ªç±»ã€‚æ€ä¹ˆå®ä¾‹åŒ–è¿™ä¸ªç±»</p>
</li>
<li><p>JavaScriptä¸­çš„ä½œç”¨åŸŸä¸å˜é‡å£°æ˜æå‡ï¼Ÿ</p>
</li>
<li><p>å¦‚ä½•ç¼–å†™é«˜æ€§èƒ½çš„Javascriptï¼Ÿ</p>
</li>
<li><p>é‚£äº›æ“ä½œä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Ÿ</p>
</li>
<li><p>JQueryçš„æºç çœ‹è¿‡å—ï¼Ÿèƒ½ä¸èƒ½ç®€å•æ¦‚å†µä¸€ä¸‹å®ƒçš„å®ç°åŸç†ï¼Ÿ</p>
</li>
<li><p>jQuery.fnçš„initæ–¹æ³•è¿”å›çš„thisæŒ‡çš„æ˜¯ä»€ä¹ˆå¯¹è±¡ï¼Ÿä¸ºä»€ä¹ˆè¦è¿”å›thisï¼Ÿ</p>
</li>
<li><p>jqueryä¸­å¦‚ä½•å°†æ•°ç»„è½¬åŒ–ä¸ºjsonå­—ç¬¦ä¸²ï¼Œç„¶åå†è½¬åŒ–å›æ¥ï¼Ÿ</p>
</li>
<li><p>jQuery çš„å±æ€§æ‹·è´(extend)çš„å®ç°åŸç†æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•å®ç°æ·±æ‹·è´ï¼Ÿ</p>
</li>
<li><p>jquery.extend ä¸ jquery.fn.extendçš„åŒºåˆ«ï¼Ÿ</p>
<pre><code>* jquery.extend ä¸ºjqueryç±»æ·»åŠ ç±»æ–¹æ³•ï¼Œå¯ä»¥ç†è§£ä¸ºæ·»åŠ é™æ€æ–¹æ³•
* jquery.fn.extend:
    æºç ä¸­jquery.fn = jquery.prototypeï¼Œæ‰€ä»¥å¯¹jquery.fnçš„æ‰©å±•ï¼Œå°±æ˜¯ä¸ºjqueryç±»æ·»åŠ æˆå‘˜å‡½æ•°
ä½¿ç”¨ï¼š
jquery.extendæ‰©å±•ï¼Œéœ€è¦é€šè¿‡jqueryç±»æ¥è°ƒç”¨ï¼Œè€Œjquery.fn.extendæ‰©å±•ï¼Œæ‰€æœ‰jqueryå®ä¾‹éƒ½å¯ä»¥ç›´æ¥è°ƒç”¨ã€‚
</code></pre></li>
</ul>
<ul>
<li><p>jQuery çš„é˜Ÿåˆ—æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿé˜Ÿåˆ—å¯ä»¥ç”¨åœ¨å“ªäº›åœ°æ–¹ï¼Ÿ</p>
</li>
<li><p>è°ˆä¸€ä¸‹Jqueryä¸­çš„bind(),live(),delegate(),on()çš„åŒºåˆ«ï¼Ÿ</p>
</li>
<li><p>JQueryä¸€ä¸ªå¯¹è±¡å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ªäº‹ä»¶ï¼Œè¿™æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</p>
</li>
<li><p>æ˜¯å¦çŸ¥é“è‡ªå®šä¹‰äº‹ä»¶ã€‚jQueryé‡Œçš„fireå‡½æ•°æ˜¯ä»€ä¹ˆæ„æ€ï¼Œä»€ä¹ˆæ—¶å€™ç”¨ï¼Ÿ</p>
</li>
<li><p>jQuery æ˜¯é€šè¿‡å“ªä¸ªæ–¹æ³•å’Œ Sizzle é€‰æ‹©å™¨ç»“åˆçš„ï¼Ÿï¼ˆjQuery.fn.find()è¿›å…¥Sizzleï¼‰</p>
</li>
<li><p>é’ˆå¯¹ jQueryæ€§èƒ½çš„ä¼˜åŒ–æ–¹æ³•ï¼Ÿ</p>
</li>
<li><p>Jqueryä¸jQuery UI æœ‰å•¥åŒºåˆ«ï¼Ÿ</p>
</li>
</ul>
<pre><code>*jQueryæ˜¯ä¸€ä¸ªjsåº“ï¼Œä¸»è¦æä¾›çš„åŠŸèƒ½æ˜¯é€‰æ‹©å™¨ï¼Œå±æ€§ä¿®æ”¹å’Œäº‹ä»¶ç»‘å®šç­‰ç­‰ã€‚

*jQuery UIåˆ™æ˜¯åœ¨jQueryçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨jQueryçš„æ‰©å±•æ€§ï¼Œè®¾è®¡çš„æ’ä»¶ã€‚
 æä¾›äº†ä¸€äº›å¸¸ç”¨çš„ç•Œé¢å…ƒç´ ï¼Œè¯¸å¦‚å¯¹è¯æ¡†ã€æ‹–åŠ¨è¡Œä¸ºã€æ”¹å˜å¤§å°è¡Œä¸ºç­‰ç­‰
</code></pre><ul>
<li><p>JQueryçš„æºç çœ‹è¿‡å—ï¼Ÿèƒ½ä¸èƒ½ç®€å•è¯´ä¸€ä¸‹å®ƒçš„å®ç°åŸç†ï¼Ÿ</p>
</li>
<li><p>jquery ä¸­å¦‚ä½•å°†æ•°ç»„è½¬åŒ–ä¸ºjsonå­—ç¬¦ä¸²ï¼Œç„¶åå†è½¬åŒ–å›æ¥ï¼Ÿ</p>
</li>
</ul>
<p>jQueryä¸­æ²¡æœ‰æä¾›è¿™ä¸ªåŠŸèƒ½ï¼Œæ‰€ä»¥ä½ éœ€è¦å…ˆç¼–å†™ä¸¤ä¸ªjQueryçš„æ‰©å±•ï¼š</p>
<pre><code>$.fn.stringifyArray = function(array) {
    return JSON.stringify(array)
}

$.fn.parseArray = function(array) {
    return JSON.parse(array)
}

ç„¶åè°ƒç”¨ï¼š
$(&quot;&quot;).stringifyArray(array)
</code></pre><ul>
<li><p>jQueryå’ŒZeptoçš„åŒºåˆ«ï¼Ÿå„è‡ªçš„ä½¿ç”¨åœºæ™¯ï¼Ÿ</p>
</li>
<li><p>é’ˆå¯¹ jQuery çš„ä¼˜åŒ–æ–¹æ³•ï¼Ÿ</p>
<pre><code>*åŸºäºClassçš„é€‰æ‹©æ€§çš„æ€§èƒ½ç›¸å¯¹äºIdé€‰æ‹©å™¨å¼€é”€å¾ˆå¤§ï¼Œå› ä¸ºéœ€éå†æ‰€æœ‰DOMå…ƒç´ ã€‚

*é¢‘ç¹æ“ä½œçš„DOMï¼Œå…ˆç¼“å­˜èµ·æ¥å†æ“ä½œã€‚ç”¨Jqueryçš„é“¾å¼è°ƒç”¨æ›´å¥½ã€‚
 æ¯”å¦‚ï¼švar str=$(&quot;a&quot;).attr(&quot;href&quot;);

*for (var i = size; i &lt; arr.length; i++) {}
 for å¾ªç¯æ¯ä¸€æ¬¡å¾ªç¯éƒ½æŸ¥æ‰¾äº†æ•°ç»„ (arr) çš„.length å±æ€§ï¼Œåœ¨å¼€å§‹å¾ªç¯çš„æ—¶å€™è®¾ç½®ä¸€ä¸ªå˜é‡æ¥å­˜å‚¨è¿™ä¸ªæ•°å­—ï¼Œå¯ä»¥è®©å¾ªç¯è·‘å¾—æ›´å¿«ï¼š
 for (var i = size, length = arr.length; i &lt; length; i++) {}
</code></pre></li>
</ul>
<ul>
<li><p>Zeptoçš„ç‚¹é€é—®é¢˜å¦‚ä½•è§£å†³ï¼Ÿ</p>
</li>
<li><p>jQueryUIå¦‚ä½•è‡ªå®šä¹‰ç»„ä»¶?</p>
</li>
<li><p>éœ€æ±‚ï¼šå®ç°ä¸€ä¸ªé¡µé¢æ“ä½œä¸ä¼šæ•´é¡µåˆ·æ–°çš„ç½‘ç«™ï¼Œå¹¶ä¸”èƒ½åœ¨æµè§ˆå™¨å‰è¿›ã€åé€€æ—¶æ­£ç¡®å“åº”ã€‚ç»™å‡ºä½ çš„æŠ€æœ¯å®ç°æ–¹æ¡ˆï¼Ÿ</p>
</li>
<li><p>å¦‚ä½•åˆ¤æ–­å½“å‰è„šæœ¬è¿è¡Œåœ¨æµè§ˆå™¨è¿˜æ˜¯nodeç¯å¢ƒä¸­ï¼Ÿï¼ˆé˜¿é‡Œï¼‰</p>
<pre><code>this === window ? &apos;browser&apos; : &apos;node&apos;;

é€šè¿‡åˆ¤æ–­Globalå¯¹è±¡æ˜¯å¦ä¸ºwindowï¼Œå¦‚æœä¸ä¸ºwindowï¼Œå½“å‰è„šæœ¬æ²¡æœ‰è¿è¡Œåœ¨æµè§ˆå™¨ä¸­
</code></pre></li>
<li><p>ç§»åŠ¨ç«¯æœ€å°è§¦æ§åŒºåŸŸæ˜¯å¤šå¤§ï¼Ÿ</p>
</li>
<li><p>jQuery çš„ slideUpåŠ¨ç”» ï¼Œå¦‚æœç›®æ ‡å…ƒç´ æ˜¯è¢«å¤–éƒ¨äº‹ä»¶é©±åŠ¨, å½“é¼ æ ‡å¿«é€Ÿåœ°è¿ç»­è§¦å‘å¤–éƒ¨å…ƒç´ äº‹ä»¶, åŠ¨ç”»ä¼šæ»åçš„åå¤æ‰§è¡Œï¼Œè¯¥å¦‚ä½•å¤„ç†å‘¢?</p>
<pre><code>jquery stop(): å¦‚ï¼š$(&quot;#div&quot;).stop().animate({width:&quot;100px&quot;},100);
</code></pre></li>
<li><p>æŠŠ Script æ ‡ç­¾ æ”¾åœ¨é¡µé¢çš„æœ€åº•éƒ¨çš„bodyå°é—­ä¹‹å‰ å’Œå°é—­ä¹‹åæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæµè§ˆå™¨ä¼šå¦‚ä½•è§£æå®ƒä»¬ï¼Ÿ</p>
</li>
<li><p>ç§»åŠ¨ç«¯çš„ç‚¹å‡»äº‹ä»¶çš„æœ‰å»¶è¿Ÿï¼Œæ—¶é—´æ˜¯å¤šä¹…ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ï¼Ÿ æ€ä¹ˆè§£å†³è¿™ä¸ªå»¶æ—¶ï¼Ÿï¼ˆclick æœ‰ 300ms å»¶è¿Ÿ,ä¸ºäº†å®ç°safariçš„åŒå‡»äº‹ä»¶çš„è®¾è®¡ï¼Œæµè§ˆå™¨è¦çŸ¥é“ä½ æ˜¯ä¸æ˜¯è¦åŒå‡»æ“ä½œã€‚ï¼‰</p>
</li>
<li><p>çŸ¥é“å„ç§JSæ¡†æ¶(Angular, Backbone, Ember, React, Meteor, Knockoutâ€¦)ä¹ˆ? èƒ½è®²å‡ºä»–ä»¬å„è‡ªçš„ä¼˜ç‚¹å’Œç¼ºç‚¹ä¹ˆ?</p>
</li>
<li><p>Underscore å¯¹å“ªäº› JS åŸç”Ÿå¯¹è±¡è¿›è¡Œäº†æ‰©å±•ä»¥åŠæä¾›äº†å“ªäº›å¥½ç”¨çš„å‡½æ•°æ–¹æ³•ï¼Ÿ</p>
</li>
<li><p>è§£é‡ŠJavaScriptä¸­çš„ä½œç”¨åŸŸä¸å˜é‡å£°æ˜æå‡ï¼Ÿ</p>
</li>
<li><p>é‚£äº›æ“ä½œä¼šé€ æˆå†…å­˜æ³„æ¼ï¼Ÿ</p>
<pre><code>å†…å­˜æ³„æ¼æŒ‡ä»»ä½•å¯¹è±¡åœ¨æ‚¨ä¸å†æ‹¥æœ‰æˆ–éœ€è¦å®ƒä¹‹åä»ç„¶å­˜åœ¨ã€‚
åƒåœ¾å›æ”¶å™¨å®šæœŸæ‰«æå¯¹è±¡ï¼Œå¹¶è®¡ç®—å¼•ç”¨äº†æ¯ä¸ªå¯¹è±¡çš„å…¶ä»–å¯¹è±¡çš„æ•°é‡ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨æ•°é‡ä¸º 0ï¼ˆæ²¡æœ‰å…¶ä»–å¯¹è±¡å¼•ç”¨è¿‡è¯¥å¯¹è±¡ï¼‰ï¼Œæˆ–å¯¹è¯¥å¯¹è±¡çš„æƒŸä¸€å¼•ç”¨æ˜¯å¾ªç¯çš„ï¼Œé‚£ä¹ˆè¯¥å¯¹è±¡çš„å†…å­˜å³å¯å›æ”¶ã€‚

setTimeout çš„ç¬¬ä¸€ä¸ªå‚æ•°ä½¿ç”¨å­—ç¬¦ä¸²è€Œéå‡½æ•°çš„è¯ï¼Œä¼šå¼•å‘å†…å­˜æ³„æ¼ã€‚
é—­åŒ…ã€æ§åˆ¶å°æ—¥å¿—ã€å¾ªç¯ï¼ˆåœ¨ä¸¤ä¸ªå¯¹è±¡å½¼æ­¤å¼•ç”¨ä¸”å½¼æ­¤ä¿ç•™æ—¶ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªå¾ªç¯ï¼‰
</code></pre></li>
<li><p>JQueryä¸€ä¸ªå¯¹è±¡å¯ä»¥åŒæ—¶ç»‘å®šå¤šä¸ªäº‹ä»¶ï¼Œè¿™æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</p>
<pre><code>* å¤šä¸ªäº‹ä»¶åŒä¸€ä¸ªå‡½æ•°ï¼š
    $(&quot;div&quot;).on(&quot;click mouseover&quot;, function(){});
* å¤šä¸ªäº‹ä»¶ä¸åŒå‡½æ•°
    $(&quot;div&quot;).on({
        click: function(){},
        mouseover: function(){}
    });
</code></pre></li>
<li><p>Node.jsçš„é€‚ç”¨åœºæ™¯ï¼Ÿ</p>
</li>
<li><p>(å¦‚æœä¼šç”¨node)çŸ¥é“route, middleware, cluster, nodemon, pm2, server-side renderingä¹ˆ?</p>
</li>
<li><p>è§£é‡Šä¸€ä¸‹ Backbone çš„ MVC å®ç°æ–¹å¼ï¼Ÿ</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯â€œå‰ç«¯è·¯ç”±â€?ä»€ä¹ˆæ—¶å€™é€‚åˆä½¿ç”¨â€œå‰ç«¯è·¯ç”±â€? â€œå‰ç«¯è·¯ç”±â€æœ‰å“ªäº›ä¼˜ç‚¹å’Œç¼ºç‚¹?</p>
</li>
<li><p>çŸ¥é“ä»€ä¹ˆæ˜¯webkitä¹ˆ? çŸ¥é“æ€ä¹ˆç”¨æµè§ˆå™¨çš„å„ç§å·¥å…·æ¥è°ƒè¯•å’Œdebugä»£ç ä¹ˆ?</p>
<pre><code>Chrome,Safariæµè§ˆå™¨å†…æ ¸ã€‚
</code></pre></li>
<li><p>å¦‚ä½•æµ‹è¯•å‰ç«¯ä»£ç ä¹ˆ? çŸ¥é“BDD, TDD, Unit Testä¹ˆ? çŸ¥é“æ€ä¹ˆæµ‹è¯•ä½ çš„å‰ç«¯å·¥ç¨‹ä¹ˆ(mocha, sinon, jasmin, qUnit..)?</p>
</li>
<li><p>å‰ç«¯templating(Mustache, underscore, handlebars)æ˜¯å¹²å˜›çš„, æ€ä¹ˆç”¨?</p>
</li>
<li><p>ç®€è¿°ä¸€ä¸‹ Handlebars çš„åŸºæœ¬ç”¨æ³•ï¼Ÿ</p>
</li>
<li><p>ç®€è¿°ä¸€ä¸‹ Handlerbars çš„å¯¹æ¨¡æ¿çš„åŸºæœ¬å¤„ç†æµç¨‹ï¼Œ å¦‚ä½•ç¼–è¯‘çš„ï¼Ÿå¦‚ä½•ç¼“å­˜çš„ï¼Ÿ</p>
</li>
<li><p>ç”¨jså®ç°åƒä½åˆ†éš”ç¬¦?(æ¥æºï¼š<a href="http://div.io/topic/744" target="_blank" rel="external">å‰ç«¯å†œæ°‘å·¥</a>ï¼Œæç¤ºï¼šæ­£åˆ™+replace)</p>
</li>
</ul>
<pre><code>å‚è€ƒï¼šhttp://www.tuicool.com/articles/ArQZfui
function commafy(num) {
    return num &amp;&amp; num
        .toString()
        .replace(/(\d)(?=(\d{3})+\.)/g, function($0, $1) {
            return $1 + &quot;,&quot;;
        });
}
console.log(commafy(1234567.90)); //1,234,567.90
</code></pre><ul>
<li><p>æ£€æµ‹æµè§ˆå™¨ç‰ˆæœ¬ç‰ˆæœ¬æœ‰å“ªäº›æ–¹å¼ï¼Ÿ</p>
<pre><code>åŠŸèƒ½æ£€æµ‹ã€userAgentç‰¹å¾æ£€æµ‹

æ¯”å¦‚ï¼šnavigator.userAgent
//&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36
  (KHTML, like Gecko) Chrome/41.0.2272.101 Safari/537.36&quot;
</code></pre></li>
</ul>
<ul>
<li><p>What is a Polyfill?</p>
<pre><code>polyfill æ˜¯â€œåœ¨æ—§ç‰ˆæµè§ˆå™¨ä¸Šå¤åˆ¶æ ‡å‡† API çš„ JavaScript è¡¥å……â€,å¯ä»¥åŠ¨æ€åœ°åŠ è½½ JavaScript ä»£ç æˆ–åº“ï¼Œåœ¨ä¸æ”¯æŒè¿™äº›æ ‡å‡† API çš„æµè§ˆå™¨ä¸­æ¨¡æ‹Ÿå®ƒä»¬ã€‚
ä¾‹å¦‚ï¼Œgeolocationï¼ˆåœ°ç†ä½ç½®ï¼‰polyfill å¯ä»¥åœ¨ navigator å¯¹è±¡ä¸Šæ·»åŠ å…¨å±€çš„ geolocation å¯¹è±¡ï¼Œè¿˜èƒ½æ·»åŠ  getCurrentPosition å‡½æ•°ä»¥åŠâ€œåæ ‡â€å›è°ƒå¯¹è±¡ï¼Œ
æ‰€æœ‰è¿™äº›éƒ½æ˜¯ W3C åœ°ç†ä½ç½® API å®šä¹‰çš„å¯¹è±¡å’Œå‡½æ•°ã€‚å› ä¸º polyfill æ¨¡æ‹Ÿæ ‡å‡† APIï¼Œæ‰€ä»¥èƒ½å¤Ÿä»¥ä¸€ç§é¢å‘æ‰€æœ‰æµè§ˆå™¨æœªæ¥çš„æ–¹å¼é’ˆå¯¹è¿™äº› API è¿›è¡Œå¼€å‘ï¼Œ
ä¸€æ—¦å¯¹è¿™äº› API çš„æ”¯æŒå˜æˆç»å¯¹å¤§å¤šæ•°ï¼Œåˆ™å¯ä»¥æ–¹ä¾¿åœ°å»æ‰ polyfillï¼Œæ— éœ€åšä»»ä½•é¢å¤–å·¥ä½œã€‚
</code></pre></li>
<li><p>åšçš„é¡¹ç›®ä¸­ï¼Œæœ‰æ²¡æœ‰ç”¨è¿‡æˆ–è‡ªå·±å®ç°ä¸€äº› polyfill æ–¹æ¡ˆï¼ˆå…¼å®¹æ€§å¤„ç†æ–¹æ¡ˆï¼‰ï¼Ÿ</p>
<pre><code>æ¯”å¦‚ï¼š html5shivã€Geolocationã€Placeholder
</code></pre></li>
<li><p>æˆ‘ä»¬ç»™ä¸€ä¸ªdomåŒæ—¶ç»‘å®šä¸¤ä¸ªç‚¹å‡»äº‹ä»¶ï¼Œä¸€ä¸ªç”¨æ•è·ï¼Œä¸€ä¸ªç”¨å†’æ³¡ã€‚ä¼šæ‰§è¡Œå‡ æ¬¡äº‹ä»¶ï¼Œä¼šå…ˆæ‰§è¡Œå†’æ³¡è¿˜æ˜¯æ•è·ï¼Ÿ</p>
</li>
</ul>
<ul>
<li><p>ä½¿ç”¨JSå®ç°è·å–æ–‡ä»¶æ‰©å±•åï¼Ÿ</p>
<pre><code>function getFileExtension(filename) {
  return filename.slice((filename.lastIndexOf(&quot;.&quot;) - 1 &gt;&gt;&gt; 0) + 2);
}

String.lastIndexOf() æ–¹æ³•è¿”å›æŒ‡å®šå€¼ï¼ˆæœ¬ä¾‹ä¸­çš„&apos;.&apos;ï¼‰åœ¨è°ƒç”¨è¯¥æ–¹æ³•çš„å­—ç¬¦ä¸²ä¸­æœ€åå‡ºç°çš„ä½ç½®ï¼Œå¦‚æœæ²¡æ‰¾åˆ°åˆ™è¿”å› -1ã€‚
å¯¹äº&apos;filename&apos;å’Œ&apos;.hiddenfile&apos;ï¼ŒlastIndexOfçš„è¿”å›å€¼åˆ†åˆ«ä¸º0å’Œ-1æ— ç¬¦å·å³ç§»æ“ä½œç¬¦(Â»&gt;) å°†-1è½¬æ¢ä¸º4294967295ï¼Œå°†-2è½¬æ¢ä¸º4294967294ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥ä¿è¯è¾¹ç¼˜æƒ…å†µæ—¶æ–‡ä»¶åä¸å˜ã€‚
String.prototype.slice() ä»ä¸Šé¢è®¡ç®—çš„ç´¢å¼•å¤„æå–æ–‡ä»¶çš„æ‰©å±•åã€‚å¦‚æœç´¢å¼•æ¯”æ–‡ä»¶åçš„é•¿åº¦å¤§ï¼Œç»“æœä¸º&quot;&quot;ã€‚
</code></pre></li>
</ul>
<h4 id="ECMAScript6-ç›¸å…³"><a href="#ECMAScript6-ç›¸å…³" class="headerlink" title="ECMAScript6 ç›¸å…³"></a><a name="other">ECMAScript6 ç›¸å…³</a></h4><ul>
<li><p>Object.is() ä¸åŸæ¥çš„æ¯”è¾ƒæ“ä½œç¬¦â€œ ===â€ã€â€œ ==â€çš„åŒºåˆ«ï¼Ÿ</p>
<pre><code>ä¸¤ç­‰å·åˆ¤ç­‰ï¼Œä¼šåœ¨æ¯”è¾ƒæ—¶è¿›è¡Œç±»å‹è½¬æ¢ï¼›
ä¸‰ç­‰å·åˆ¤ç­‰(åˆ¤æ–­ä¸¥æ ¼)ï¼Œæ¯”è¾ƒæ—¶ä¸è¿›è¡Œéšå¼ç±»å‹è½¬æ¢,ï¼ˆç±»å‹ä¸åŒåˆ™ä¼šè¿”å›falseï¼‰ï¼›

Object.is åœ¨ä¸‰ç­‰å·åˆ¤ç­‰çš„åŸºç¡€ä¸Šç‰¹åˆ«å¤„ç†äº† NaN ã€-0 å’Œ +0 ï¼Œä¿è¯ -0 å’Œ +0 ä¸å†ç›¸åŒï¼Œ
ä½† Object.is(NaN, NaN) ä¼šè¿”å› true.

 Object.is åº”è¢«è®¤ä¸ºæœ‰å…¶ç‰¹æ®Šçš„ç”¨é€”ï¼Œè€Œä¸èƒ½ç”¨å®ƒè®¤ä¸ºå®ƒæ¯”å…¶å®ƒçš„ç›¸ç­‰å¯¹æ¯”æ›´å®½æ¾æˆ–ä¸¥æ ¼ã€‚
</code></pre></li>
</ul>
<h4 id="å‰ç«¯æ¡†æ¶ç›¸å…³"><a href="#å‰ç«¯æ¡†æ¶ç›¸å…³" class="headerlink" title="å‰ç«¯æ¡†æ¶ç›¸å…³"></a><a name="other">å‰ç«¯æ¡†æ¶ç›¸å…³</a></h4><ul>
<li><p>react-router è·¯ç”±ç³»ç»Ÿçš„å®ç°åŸç†ï¼Ÿ</p>
</li>
<li><p>Reactä¸­å¦‚ä½•è§£å†³ç¬¬ä¸‰æ–¹ç±»åº“çš„é—®é¢˜?</p>
</li>
</ul>
<h2 id="å…¶ä»–é—®é¢˜"><a href="#å…¶ä»–é—®é¢˜" class="headerlink" title="å…¶ä»–é—®é¢˜"></a><a name="other">å…¶ä»–é—®é¢˜</a></h2><ul>
<li><p>åŸæ¥å…¬å¸å·¥ä½œæµç¨‹æ˜¯æ€ä¹ˆæ ·çš„ï¼Œå¦‚ä½•ä¸å…¶ä»–äººåä½œçš„ï¼Ÿå¦‚ä½•å¤¸éƒ¨é—¨åˆä½œçš„ï¼Ÿ</p>
</li>
<li><p>ä½ é‡åˆ°è¿‡æ¯”è¾ƒéš¾çš„æŠ€æœ¯é—®é¢˜æ˜¯ï¼Ÿä½ æ˜¯å¦‚ä½•è§£å†³çš„ï¼Ÿ</p>
</li>
<li><p>è®¾è®¡æ¨¡å¼ çŸ¥é“ä»€ä¹ˆæ˜¯singleton, factory, strategy, decratorä¹ˆ?</p>
</li>
<li><p>å¸¸ä½¿ç”¨çš„åº“æœ‰å“ªäº›ï¼Ÿå¸¸ç”¨çš„å‰ç«¯å¼€å‘å·¥å…·ï¼Ÿå¼€å‘è¿‡ä»€ä¹ˆåº”ç”¨æˆ–ç»„ä»¶ï¼Ÿ</p>
</li>
<li><p>é¡µé¢é‡æ„æ€ä¹ˆæ“ä½œï¼Ÿ</p>
<pre><code>ç½‘ç«™é‡æ„ï¼šåœ¨ä¸æ”¹å˜å¤–éƒ¨è¡Œä¸ºçš„å‰æä¸‹ï¼Œç®€åŒ–ç»“æ„ã€æ·»åŠ å¯è¯»æ€§ï¼Œè€Œåœ¨ç½‘ç«™å‰ç«¯ä¿æŒä¸€è‡´çš„è¡Œä¸ºã€‚
ä¹Ÿå°±æ˜¯è¯´æ˜¯åœ¨ä¸æ”¹å˜UIçš„æƒ…å†µä¸‹ï¼Œå¯¹ç½‘ç«™è¿›è¡Œä¼˜åŒ–ï¼Œåœ¨æ‰©å±•çš„åŒæ—¶ä¿æŒä¸€è‡´çš„UIã€‚

å¯¹äºä¼ ç»Ÿçš„ç½‘ç«™æ¥è¯´é‡æ„é€šå¸¸æ˜¯ï¼š

è¡¨æ ¼(table)å¸ƒå±€æ”¹ä¸ºDIV+CSS
ä½¿ç½‘ç«™å‰ç«¯å…¼å®¹äºç°ä»£æµè§ˆå™¨(é’ˆå¯¹äºä¸åˆè§„èŒƒçš„CSSã€å¦‚å¯¹IE6æœ‰æ•ˆçš„)
å¯¹äºç§»åŠ¨å¹³å°çš„ä¼˜åŒ–
é’ˆå¯¹äºSEOè¿›è¡Œä¼˜åŒ–
æ·±å±‚æ¬¡çš„ç½‘ç«™é‡æ„åº”è¯¥è€ƒè™‘çš„æ–¹é¢

å‡å°‘ä»£ç é—´çš„è€¦åˆ
è®©ä»£ç ä¿æŒå¼¹æ€§
ä¸¥æ ¼æŒ‰è§„èŒƒç¼–å†™ä»£ç 
è®¾è®¡å¯æ‰©å±•çš„API
ä»£æ›¿æ—§æœ‰çš„æ¡†æ¶ã€è¯­è¨€(å¦‚VB)
å¢å¼ºç”¨æˆ·ä½“éªŒ
é€šå¸¸æ¥è¯´å¯¹äºé€Ÿåº¦çš„ä¼˜åŒ–ä¹ŸåŒ…å«åœ¨é‡æ„ä¸­

å‹ç¼©JSã€CSSã€imageç­‰å‰ç«¯èµ„æº(é€šå¸¸æ˜¯ç”±æœåŠ¡å™¨æ¥è§£å†³)
ç¨‹åºçš„æ€§èƒ½ä¼˜åŒ–(å¦‚æ•°æ®è¯»å†™)
é‡‡ç”¨CDNæ¥åŠ é€Ÿèµ„æºåŠ è½½
å¯¹äºJS DOMçš„ä¼˜åŒ–
HTTPæœåŠ¡å™¨çš„æ–‡ä»¶ç¼“å­˜
</code></pre></li>
<li><p>åˆ—ä¸¾IEä¸å…¶ä»–æµè§ˆå™¨ä¸ä¸€æ ·çš„ç‰¹æ€§ï¼Ÿ</p>
</li>
</ul>
<pre><code>1ã€äº‹ä»¶ä¸åŒä¹‹å¤„ï¼š

       è§¦å‘äº‹ä»¶çš„å…ƒç´ è¢«è®¤ä¸ºæ˜¯ç›®æ ‡ï¼ˆtargetï¼‰ã€‚è€Œåœ¨ IE ä¸­ï¼Œç›®æ ‡åŒ…å«åœ¨ event å¯¹è±¡çš„ srcElement å±æ€§ï¼›

    è·å–å­—ç¬¦ä»£ç ã€å¦‚æœæŒ‰é”®ä»£è¡¨ä¸€ä¸ªå­—ç¬¦ï¼ˆshiftã€ctrlã€alté™¤å¤–ï¼‰ï¼ŒIE çš„ keyCode ä¼šè¿”å›å­—ç¬¦ä»£ç ï¼ˆUnicodeï¼‰ï¼ŒDOM ä¸­æŒ‰é”®çš„ä»£ç å’Œå­—ç¬¦æ˜¯åˆ†ç¦»çš„ï¼Œè¦è·å–å­—ç¬¦ä»£ç ï¼Œéœ€è¦ä½¿ç”¨ charCode å±æ€§ï¼›

    é˜»æ­¢æŸä¸ªäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼ŒIE ä¸­é˜»æ­¢æŸä¸ªäº‹ä»¶çš„é»˜è®¤è¡Œä¸ºï¼Œå¿…é¡»å°† returnValue å±æ€§è®¾ç½®ä¸º falseï¼ŒMozilla ä¸­ï¼Œéœ€è¦è°ƒç”¨ preventDefault() æ–¹æ³•ï¼›

    åœæ­¢äº‹ä»¶å†’æ³¡ï¼ŒIE ä¸­é˜»æ­¢äº‹ä»¶è¿›ä¸€æ­¥å†’æ³¡ï¼Œéœ€è¦è®¾ç½® cancelBubble ä¸º trueï¼ŒMozzilla ä¸­ï¼Œéœ€è¦è°ƒç”¨ stopPropagation()ï¼›
</code></pre><ul>
<li><p>99%çš„ç½‘ç«™éƒ½éœ€è¦è¢«é‡æ„æ˜¯é‚£æœ¬ä¹¦ä¸Šå†™çš„ï¼Ÿ</p>
<pre><code>ç½‘ç«™é‡æ„ï¼šåº”ç”¨webæ ‡å‡†è¿›è¡Œè®¾è®¡ï¼ˆç¬¬2ç‰ˆï¼‰
</code></pre></li>
<li><p>ä»€ä¹ˆå«ä¼˜é›…é™çº§å’Œæ¸è¿›å¢å¼ºï¼Ÿ</p>
<pre><code>ä¼˜é›…é™çº§ï¼šWebç«™ç‚¹åœ¨æ‰€æœ‰æ–°å¼æµè§ˆå™¨ä¸­éƒ½èƒ½æ­£å¸¸å·¥ä½œï¼Œå¦‚æœç”¨æˆ·ä½¿ç”¨çš„æ˜¯è€å¼æµè§ˆå™¨ï¼Œåˆ™ä»£ç ä¼šé’ˆå¯¹æ—§ç‰ˆæœ¬çš„IEè¿›è¡Œé™çº§å¤„ç†äº†,ä½¿ä¹‹åœ¨æ—§å¼æµè§ˆå™¨ä¸Šä»¥æŸç§å½¢å¼é™çº§ä½“éªŒå´ä¸è‡³äºå®Œå…¨ä¸èƒ½ç”¨ã€‚
å¦‚ï¼šborder-shadow

æ¸è¿›å¢å¼ºï¼šä»è¢«æ‰€æœ‰æµè§ˆå™¨æ”¯æŒçš„åŸºæœ¬åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥åœ°æ·»åŠ é‚£äº›åªæœ‰æ–°ç‰ˆæœ¬æµè§ˆå™¨æ‰æ”¯æŒçš„åŠŸèƒ½,å‘é¡µé¢å¢åŠ ä¸å½±å“åŸºç¡€æµè§ˆå™¨çš„é¢å¤–æ ·å¼å’ŒåŠŸèƒ½çš„ã€‚å½“æµè§ˆå™¨æ”¯æŒæ—¶ï¼Œå®ƒä»¬ä¼šè‡ªåŠ¨åœ°å‘ˆç°å‡ºæ¥å¹¶å‘æŒ¥ä½œç”¨ã€‚
å¦‚ï¼šé»˜è®¤ä½¿ç”¨flashä¸Šä¼ ï¼Œä½†å¦‚æœæµè§ˆå™¨æ”¯æŒ HTML5 çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œåˆ™ä½¿ç”¨HTML5å®ç°æ›´å¥½çš„ä½“éªŒï¼›
</code></pre></li>
<li><p>æ˜¯å¦äº†è§£å…¬é’¥åŠ å¯†å’Œç§é’¥åŠ å¯†ã€‚</p>
<pre><code>ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯æŒ‡ç§é’¥ç”¨äºå¯¹æ•°æ®è¿›è¡Œç­¾åï¼Œå…¬é’¥ç”¨äºå¯¹ç­¾åè¿›è¡ŒéªŒè¯;
HTTPç½‘ç«™åœ¨æµè§ˆå™¨ç«¯ç”¨å…¬é’¥åŠ å¯†æ•æ„Ÿæ•°æ®ï¼Œç„¶ååœ¨æœåŠ¡å™¨ç«¯å†ç”¨ç§é’¥è§£å¯†ã€‚
</code></pre></li>
</ul>
<ul>
<li><p>WEBåº”ç”¨ä»æœåŠ¡å™¨ä¸»åŠ¨æ¨é€Dataåˆ°å®¢æˆ·ç«¯æœ‰é‚£äº›æ–¹å¼ï¼Ÿ</p>
<pre><code>html5æä¾›çš„Websocket
ä¸å¯è§çš„iframe
WebSocketé€šè¿‡Flash
XHRé•¿æ—¶é—´è¿æ¥
XHR Multipart Streaming
&lt;script&gt;æ ‡ç­¾çš„é•¿æ—¶é—´è¿æ¥(å¯è·¨åŸŸ)
</code></pre></li>
<li><p>å¯¹Nodeçš„ä¼˜ç‚¹å’Œç¼ºç‚¹æå‡ºäº†è‡ªå·±çš„çœ‹æ³•ï¼Ÿ</p>
</li>
</ul>
<pre><code>*ï¼ˆä¼˜ç‚¹ï¼‰å› ä¸ºNodeæ˜¯åŸºäºäº‹ä»¶é©±åŠ¨å’Œæ— é˜»å¡çš„ï¼Œæ‰€ä»¥éå¸¸é€‚åˆå¤„ç†å¹¶å‘è¯·æ±‚ï¼Œ
  å› æ­¤æ„å»ºåœ¨Nodeä¸Šçš„ä»£ç†æœåŠ¡å™¨ç›¸æ¯”å…¶ä»–æŠ€æœ¯å®ç°ï¼ˆå¦‚Rubyï¼‰çš„æœåŠ¡å™¨è¡¨ç°è¦å¥½å¾—å¤šã€‚
  æ­¤å¤–ï¼Œä¸Nodeä»£ç†æœåŠ¡å™¨äº¤äº’çš„å®¢æˆ·ç«¯ä»£ç æ˜¯ç”±javascriptè¯­è¨€ç¼–å†™çš„ï¼Œ
  å› æ­¤å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½ç”¨åŒä¸€ç§è¯­è¨€ç¼–å†™ï¼Œè¿™æ˜¯éå¸¸ç¾å¦™çš„äº‹æƒ…ã€‚

*ï¼ˆç¼ºç‚¹ï¼‰Nodeæ˜¯ä¸€ä¸ªç›¸å¯¹æ–°çš„å¼€æºé¡¹ç›®ï¼Œæ‰€ä»¥ä¸å¤ªç¨³å®šï¼Œå®ƒæ€»æ˜¯ä¸€ç›´åœ¨å˜ï¼Œ
  è€Œä¸”ç¼ºå°‘è¶³å¤Ÿå¤šçš„ç¬¬ä¸‰æ–¹åº“æ”¯æŒã€‚çœ‹èµ·æ¥ï¼Œå°±åƒæ˜¯Ruby/Railså½“å¹´çš„æ ·å­ã€‚
</code></pre><ul>
<li><p>ä½ æœ‰ç”¨è¿‡å“ªäº›å‰ç«¯æ€§èƒ½ä¼˜åŒ–çš„æ–¹æ³•ï¼Ÿ</p>
<pre><code>ï¼ˆ1ï¼‰ å‡å°‘httpè¯·æ±‚æ¬¡æ•°ï¼šCSS Sprites, JSã€CSSæºç å‹ç¼©ã€å›¾ç‰‡å¤§å°æ§åˆ¶åˆé€‚ï¼›ç½‘é¡µGzipï¼ŒCDNæ‰˜ç®¡ï¼Œdataç¼“å­˜ ï¼Œå›¾ç‰‡æœåŠ¡å™¨ã€‚

ï¼ˆ2ï¼‰ å‰ç«¯æ¨¡æ¿ JS+æ•°æ®ï¼Œå‡å°‘ç”±äºHTMLæ ‡ç­¾å¯¼è‡´çš„å¸¦å®½æµªè´¹ï¼Œå‰ç«¯ç”¨å˜é‡ä¿å­˜AJAXè¯·æ±‚ç»“æœï¼Œæ¯æ¬¡æ“ä½œæœ¬åœ°å˜é‡ï¼Œä¸ç”¨è¯·æ±‚ï¼Œå‡å°‘è¯·æ±‚æ¬¡æ•°

ï¼ˆ3ï¼‰ ç”¨innerHTMLä»£æ›¿DOMæ“ä½œï¼Œå‡å°‘DOMæ“ä½œæ¬¡æ•°ï¼Œä¼˜åŒ–javascriptæ€§èƒ½ã€‚

ï¼ˆ4ï¼‰ å½“éœ€è¦è®¾ç½®çš„æ ·å¼å¾ˆå¤šæ—¶è®¾ç½®classNameè€Œä¸æ˜¯ç›´æ¥æ“ä½œstyleã€‚

ï¼ˆ5ï¼‰ å°‘ç”¨å…¨å±€å˜é‡ã€ç¼“å­˜DOMèŠ‚ç‚¹æŸ¥æ‰¾çš„ç»“æœã€‚å‡å°‘IOè¯»å–æ“ä½œã€‚

ï¼ˆ6ï¼‰ é¿å…ä½¿ç”¨CSS Expressionï¼ˆcssè¡¨è¾¾å¼)åˆç§°Dynamic properties(åŠ¨æ€å±æ€§)ã€‚

ï¼ˆ7ï¼‰ å›¾ç‰‡é¢„åŠ è½½ï¼Œå°†æ ·å¼è¡¨æ”¾åœ¨é¡¶éƒ¨ï¼Œå°†è„šæœ¬æ”¾åœ¨åº•éƒ¨  åŠ ä¸Šæ—¶é—´æˆ³ã€‚

ï¼ˆ8ï¼‰ é¿å…åœ¨é¡µé¢çš„ä¸»ä½“å¸ƒå±€ä¸­ä½¿ç”¨tableï¼Œtableè¦ç­‰å…¶ä¸­çš„å†…å®¹å®Œå…¨ä¸‹è½½ä¹‹åæ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œæ˜¾ç¤ºæ¯”div+csså¸ƒå±€æ…¢ã€‚
å¯¹æ™®é€šçš„ç½‘ç«™æœ‰ä¸€ä¸ªç»Ÿä¸€çš„æ€è·¯ï¼Œå°±æ˜¯å°½é‡å‘å‰ç«¯ä¼˜åŒ–ã€å‡å°‘æ•°æ®åº“æ“ä½œã€å‡å°‘ç£ç›˜IOã€‚å‘å‰ç«¯ä¼˜åŒ–æŒ‡çš„æ˜¯ï¼Œåœ¨ä¸å½±å“åŠŸèƒ½å’Œä½“éªŒçš„æƒ…å†µä¸‹ï¼Œèƒ½åœ¨æµè§ˆå™¨æ‰§è¡Œçš„ä¸è¦åœ¨æœåŠ¡ç«¯æ‰§è¡Œï¼Œèƒ½åœ¨ç¼“å­˜æœåŠ¡å™¨ä¸Šç›´æ¥è¿”å›çš„ä¸è¦åˆ°åº”ç”¨æœåŠ¡å™¨ï¼Œç¨‹åºèƒ½ç›´æ¥å–å¾—çš„ç»“æœä¸è¦åˆ°å¤–éƒ¨å–å¾—ï¼Œæœ¬æœºå†…èƒ½å–å¾—çš„æ•°æ®ä¸è¦åˆ°è¿œç¨‹å–ï¼Œå†…å­˜èƒ½å–åˆ°çš„ä¸è¦åˆ°ç£ç›˜å–ï¼Œç¼“å­˜ä¸­æœ‰çš„ä¸è¦å»æ•°æ®åº“æŸ¥è¯¢ã€‚å‡å°‘æ•°æ®åº“æ“ä½œæŒ‡å‡å°‘æ›´æ–°æ¬¡æ•°ã€ç¼“å­˜ç»“æœå‡å°‘æŸ¥è¯¢æ¬¡æ•°ã€å°†æ•°æ®åº“æ‰§è¡Œçš„æ“ä½œå°½å¯èƒ½çš„è®©ä½ çš„ç¨‹åºå®Œæˆï¼ˆä¾‹å¦‚joinæŸ¥è¯¢ï¼‰ï¼Œå‡å°‘ç£ç›˜IOæŒ‡å°½é‡ä¸ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿä½œä¸ºç¼“å­˜ã€å‡å°‘è¯»å†™æ–‡ä»¶æ¬¡æ•°ç­‰ã€‚ç¨‹åºä¼˜åŒ–æ°¸è¿œè¦ä¼˜åŒ–æ…¢çš„éƒ¨åˆ†ï¼Œæ¢è¯­è¨€æ˜¯æ— æ³•â€œä¼˜åŒ–â€çš„ã€‚
</code></pre></li>
<li><p>httpçŠ¶æ€ç æœ‰é‚£äº›ï¼Ÿåˆ†åˆ«ä»£è¡¨æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</p>
<pre><code>  ç®€å•ç‰ˆ
  [
      100  Continue    ç»§ç»­ï¼Œä¸€èˆ¬åœ¨å‘é€postè¯·æ±‚æ—¶ï¼Œå·²å‘é€äº†http headerä¹‹åæœåŠ¡ç«¯å°†è¿”å›æ­¤ä¿¡æ¯ï¼Œè¡¨ç¤ºç¡®è®¤ï¼Œä¹‹åå‘é€å…·ä½“å‚æ•°ä¿¡æ¯
      200  OK         æ­£å¸¸è¿”å›ä¿¡æ¯
      201  Created      è¯·æ±‚æˆåŠŸå¹¶ä¸”æœåŠ¡å™¨åˆ›å»ºäº†æ–°çš„èµ„æº
      202  Accepted     æœåŠ¡å™¨å·²æ¥å—è¯·æ±‚ï¼Œä½†å°šæœªå¤„ç†
      301  Moved Permanently  è¯·æ±‚çš„ç½‘é¡µå·²æ°¸ä¹…ç§»åŠ¨åˆ°æ–°ä½ç½®ã€‚
      302 Found          ä¸´æ—¶æ€§é‡å®šå‘ã€‚
      303 See Other      ä¸´æ—¶æ€§é‡å®šå‘ï¼Œä¸”æ€»æ˜¯ä½¿ç”¨ GET è¯·æ±‚æ–°çš„ URIã€‚
      304  Not Modified è‡ªä»ä¸Šæ¬¡è¯·æ±‚åï¼Œè¯·æ±‚çš„ç½‘é¡µæœªä¿®æ”¹è¿‡ã€‚

      400 Bad Request  æœåŠ¡å™¨æ— æ³•ç†è§£è¯·æ±‚çš„æ ¼å¼ï¼Œå®¢æˆ·ç«¯ä¸åº”å½“å°è¯•å†æ¬¡ä½¿ç”¨ç›¸åŒçš„å†…å®¹å‘èµ·è¯·æ±‚ã€‚
      401 Unauthorized è¯·æ±‚æœªæˆæƒã€‚
      403 Forbidden      ç¦æ­¢è®¿é—®ã€‚
      404 Not Found      æ‰¾ä¸åˆ°å¦‚ä½•ä¸ URI ç›¸åŒ¹é…çš„èµ„æºã€‚

      500 Internal Server Error  æœ€å¸¸è§çš„æœåŠ¡å™¨ç«¯é”™è¯¯ã€‚
      503 Service Unavailable æœåŠ¡å™¨ç«¯æš‚æ—¶æ— æ³•å¤„ç†è¯·æ±‚ï¼ˆå¯èƒ½æ˜¯è¿‡è½½æˆ–ç»´æŠ¤ï¼‰ã€‚
  ]

å®Œæ•´ç‰ˆ
1**(ä¿¡æ¯ç±»)ï¼šè¡¨ç¤ºæ¥æ”¶åˆ°è¯·æ±‚å¹¶ä¸”ç»§ç»­å¤„ç†
  100â€”â€”å®¢æˆ·å¿…é¡»ç»§ç»­å‘å‡ºè¯·æ±‚
  101â€”â€”å®¢æˆ·è¦æ±‚æœåŠ¡å™¨æ ¹æ®è¯·æ±‚è½¬æ¢HTTPåè®®ç‰ˆæœ¬

2**(å“åº”æˆåŠŸ)ï¼šè¡¨ç¤ºåŠ¨ä½œè¢«æˆåŠŸæ¥æ”¶ã€ç†è§£å’Œæ¥å—
  200â€”â€”è¡¨æ˜è¯¥è¯·æ±‚è¢«æˆåŠŸåœ°å®Œæˆï¼Œæ‰€è¯·æ±‚çš„èµ„æºå‘é€å›å®¢æˆ·ç«¯
  201â€”â€”æç¤ºçŸ¥é“æ–°æ–‡ä»¶çš„URL
  202â€”â€”æ¥å—å’Œå¤„ç†ã€ä½†å¤„ç†æœªå®Œæˆ
  203â€”â€”è¿”å›ä¿¡æ¯ä¸ç¡®å®šæˆ–ä¸å®Œæ•´
  204â€”â€”è¯·æ±‚æ”¶åˆ°ï¼Œä½†è¿”å›ä¿¡æ¯ä¸ºç©º
  205â€”â€”æœåŠ¡å™¨å®Œæˆäº†è¯·æ±‚ï¼Œç”¨æˆ·ä»£ç†å¿…é¡»å¤ä½å½“å‰å·²ç»æµè§ˆè¿‡çš„æ–‡ä»¶
  206â€”â€”æœåŠ¡å™¨å·²ç»å®Œæˆäº†éƒ¨åˆ†ç”¨æˆ·çš„GETè¯·æ±‚

3**(é‡å®šå‘ç±»)ï¼šä¸ºäº†å®ŒæˆæŒ‡å®šçš„åŠ¨ä½œï¼Œå¿…é¡»æ¥å—è¿›ä¸€æ­¥å¤„ç†
  300â€”â€”è¯·æ±‚çš„èµ„æºå¯åœ¨å¤šå¤„å¾—åˆ°
  301â€”â€”æœ¬ç½‘é¡µè¢«æ°¸ä¹…æ€§è½¬ç§»åˆ°å¦ä¸€ä¸ªURL
  302â€”â€”è¯·æ±‚çš„ç½‘é¡µè¢«è½¬ç§»åˆ°ä¸€ä¸ªæ–°çš„åœ°å€ï¼Œä½†å®¢æˆ·è®¿é—®ä»ç»§ç»­é€šè¿‡åŸå§‹URLåœ°å€ï¼Œé‡å®šå‘ï¼Œæ–°çš„URLä¼šåœ¨responseä¸­çš„Locationä¸­è¿”å›ï¼Œæµè§ˆå™¨å°†ä¼šä½¿ç”¨æ–°çš„URLå‘å‡ºæ–°çš„Requestã€‚
  303â€”â€”å»ºè®®å®¢æˆ·è®¿é—®å…¶ä»–URLæˆ–è®¿é—®æ–¹å¼
  304â€”â€”è‡ªä»ä¸Šæ¬¡è¯·æ±‚åï¼Œè¯·æ±‚çš„ç½‘é¡µæœªä¿®æ”¹è¿‡ï¼ŒæœåŠ¡å™¨è¿”å›æ­¤å“åº”æ—¶ï¼Œä¸ä¼šè¿”å›ç½‘é¡µå†…å®¹ï¼Œä»£è¡¨ä¸Šæ¬¡çš„æ–‡æ¡£å·²ç»è¢«ç¼“å­˜äº†ï¼Œè¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨
  305â€”â€”è¯·æ±‚çš„èµ„æºå¿…é¡»ä»æœåŠ¡å™¨æŒ‡å®šçš„åœ°å€å¾—åˆ°
  306â€”â€”å‰ä¸€ç‰ˆæœ¬HTTPä¸­ä½¿ç”¨çš„ä»£ç ï¼Œç°è¡Œç‰ˆæœ¬ä¸­ä¸å†ä½¿ç”¨
  307â€”â€”ç”³æ˜è¯·æ±‚çš„èµ„æºä¸´æ—¶æ€§åˆ é™¤

4**(å®¢æˆ·ç«¯é”™è¯¯ç±»)ï¼šè¯·æ±‚åŒ…å«é”™è¯¯è¯­æ³•æˆ–ä¸èƒ½æ­£ç¡®æ‰§è¡Œ
  400â€”â€”å®¢æˆ·ç«¯è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯ï¼Œä¸èƒ½è¢«æœåŠ¡å™¨æ‰€ç†è§£
  401â€”â€”è¯·æ±‚æœªç»æˆæƒï¼Œè¿™ä¸ªçŠ¶æ€ä»£ç å¿…é¡»å’ŒWWW-AuthenticateæŠ¥å¤´åŸŸä¸€èµ·ä½¿ç”¨
  HTTP 401.1 - æœªæˆæƒï¼šç™»å½•å¤±è´¥
  ã€€ã€€HTTP 401.2 - æœªæˆæƒï¼šæœåŠ¡å™¨é…ç½®é—®é¢˜å¯¼è‡´ç™»å½•å¤±è´¥
  ã€€ã€€HTTP 401.3 - ACL ç¦æ­¢è®¿é—®èµ„æº
  ã€€ã€€HTTP 401.4 - æœªæˆæƒï¼šæˆæƒè¢«ç­›é€‰å™¨æ‹’ç»
  HTTP 401.5 - æœªæˆæƒï¼šISAPI æˆ– CGI æˆæƒå¤±è´¥
  402â€”â€”ä¿ç•™æœ‰æ•ˆChargeToå¤´å“åº”
  403â€”â€”ç¦æ­¢è®¿é—®ï¼ŒæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œä½†æ˜¯æ‹’ç»æä¾›æœåŠ¡
  HTTP 403.1 ç¦æ­¢è®¿é—®ï¼šç¦æ­¢å¯æ‰§è¡Œè®¿é—®
  ã€€ã€€HTTP 403.2 - ç¦æ­¢è®¿é—®ï¼šç¦æ­¢è¯»è®¿é—®
  ã€€ã€€HTTP 403.3 - ç¦æ­¢è®¿é—®ï¼šç¦æ­¢å†™è®¿é—®
  ã€€ã€€HTTP 403.4 - ç¦æ­¢è®¿é—®ï¼šè¦æ±‚ SSL
  ã€€ã€€HTTP 403.5 - ç¦æ­¢è®¿é—®ï¼šè¦æ±‚ SSL 128
  ã€€ã€€HTTP 403.6 - ç¦æ­¢è®¿é—®ï¼šIP åœ°å€è¢«æ‹’ç»
  ã€€ã€€HTTP 403.7 - ç¦æ­¢è®¿é—®ï¼šè¦æ±‚å®¢æˆ·è¯ä¹¦
  ã€€ã€€HTTP 403.8 - ç¦æ­¢è®¿é—®ï¼šç¦æ­¢ç«™ç‚¹è®¿é—®
  ã€€ã€€HTTP 403.9 - ç¦æ­¢è®¿é—®ï¼šè¿æ¥çš„ç”¨æˆ·è¿‡å¤š
  ã€€ã€€HTTP 403.10 - ç¦æ­¢è®¿é—®ï¼šé…ç½®æ— æ•ˆ
  ã€€ã€€HTTP 403.11 - ç¦æ­¢è®¿é—®ï¼šå¯†ç æ›´æ”¹
  ã€€ã€€HTTP 403.12 - ç¦æ­¢è®¿é—®ï¼šæ˜ å°„å™¨æ‹’ç»è®¿é—®
  ã€€ã€€HTTP 403.13 - ç¦æ­¢è®¿é—®ï¼šå®¢æˆ·è¯ä¹¦å·²è¢«åŠé”€
  ã€€ã€€HTTP 403.15 - ç¦æ­¢è®¿é—®ï¼šå®¢æˆ·è®¿é—®è®¸å¯è¿‡å¤š
  ã€€ã€€HTTP 403.16 - ç¦æ­¢è®¿é—®ï¼šå®¢æˆ·è¯ä¹¦ä¸å¯ä¿¡æˆ–è€…æ— æ•ˆ
  HTTP 403.17 - ç¦æ­¢è®¿é—®ï¼šå®¢æˆ·è¯ä¹¦å·²ç»åˆ°æœŸæˆ–è€…å°šæœªç”Ÿæ•ˆ
  404â€”â€”ä¸€ä¸ª404é”™è¯¯è¡¨æ˜å¯è¿æ¥æœåŠ¡å™¨ï¼Œä½†æœåŠ¡å™¨æ— æ³•å–å¾—æ‰€è¯·æ±‚çš„ç½‘é¡µï¼Œè¯·æ±‚èµ„æºä¸å­˜åœ¨ã€‚egï¼šè¾“å…¥äº†é”™è¯¯çš„URL
  405â€”â€”ç”¨æˆ·åœ¨Request-Lineå­—æ®µå®šä¹‰çš„æ–¹æ³•ä¸å…è®¸
  406â€”â€”æ ¹æ®ç”¨æˆ·å‘é€çš„Acceptæ‹–ï¼Œè¯·æ±‚èµ„æºä¸å¯è®¿é—®
  407â€”â€”ç±»ä¼¼401ï¼Œç”¨æˆ·å¿…é¡»é¦–å…ˆåœ¨ä»£ç†æœåŠ¡å™¨ä¸Šå¾—åˆ°æˆæƒ
  408â€”â€”å®¢æˆ·ç«¯æ²¡æœ‰åœ¨ç”¨æˆ·æŒ‡å®šçš„é¥¿æ—¶é—´å†…å®Œæˆè¯·æ±‚
  409â€”â€”å¯¹å½“å‰èµ„æºçŠ¶æ€ï¼Œè¯·æ±‚ä¸èƒ½å®Œæˆ
  410â€”â€”æœåŠ¡å™¨ä¸Šä¸å†æœ‰æ­¤èµ„æºä¸”æ— è¿›ä¸€æ­¥çš„å‚è€ƒåœ°å€
  411â€”â€”æœåŠ¡å™¨æ‹’ç»ç”¨æˆ·å®šä¹‰çš„Content-Lengthå±æ€§è¯·æ±‚
  412â€”â€”ä¸€ä¸ªæˆ–å¤šä¸ªè¯·æ±‚å¤´å­—æ®µåœ¨å½“å‰è¯·æ±‚ä¸­é”™è¯¯
  413â€”â€”è¯·æ±‚çš„èµ„æºå¤§äºæœåŠ¡å™¨å…è®¸çš„å¤§å°
  414â€”â€”è¯·æ±‚çš„èµ„æºURLé•¿äºæœåŠ¡å™¨å…è®¸çš„é•¿åº¦
  415â€”â€”è¯·æ±‚èµ„æºä¸æ”¯æŒè¯·æ±‚é¡¹ç›®æ ¼å¼
  416â€”â€”è¯·æ±‚ä¸­åŒ…å«Rangeè¯·æ±‚å¤´å­—æ®µï¼Œåœ¨å½“å‰è¯·æ±‚èµ„æºèŒƒå›´å†…æ²¡æœ‰rangeæŒ‡ç¤ºå€¼ï¼Œè¯·æ±‚ä¹Ÿä¸åŒ…å«If-Rangeè¯·æ±‚å¤´å­—æ®µ
  417â€”â€”æœåŠ¡å™¨ä¸æ»¡è¶³è¯·æ±‚Expectå¤´å­—æ®µæŒ‡å®šçš„æœŸæœ›å€¼ï¼Œå¦‚æœæ˜¯ä»£ç†æœåŠ¡å™¨ï¼Œå¯èƒ½æ˜¯ä¸‹ä¸€çº§æœåŠ¡å™¨ä¸èƒ½æ»¡è¶³è¯·æ±‚é•¿ã€‚

5**(æœåŠ¡ç«¯é”™è¯¯ç±»)ï¼šæœåŠ¡å™¨ä¸èƒ½æ­£ç¡®æ‰§è¡Œä¸€ä¸ªæ­£ç¡®çš„è¯·æ±‚
  HTTP 500 - æœåŠ¡å™¨é‡åˆ°é”™è¯¯ï¼Œæ— æ³•å®Œæˆè¯·æ±‚
  ã€€ã€€HTTP 500.100 - å†…éƒ¨æœåŠ¡å™¨é”™è¯¯ - ASP é”™è¯¯
  ã€€ã€€HTTP 500-11 æœåŠ¡å™¨å…³é—­
  ã€€ã€€HTTP 500-12 åº”ç”¨ç¨‹åºé‡æ–°å¯åŠ¨
  ã€€ã€€HTTP 500-13 - æœåŠ¡å™¨å¤ªå¿™
  ã€€ã€€HTTP 500-14 - åº”ç”¨ç¨‹åºæ— æ•ˆ
  ã€€ã€€HTTP 500-15 - ä¸å…è®¸è¯·æ±‚ global.asa
  ã€€ã€€Error 501 - æœªå®ç°
HTTP 502 - ç½‘å…³é”™è¯¯
HTTP 503ï¼šç”±äºè¶…è½½æˆ–åœæœºç»´æŠ¤ï¼ŒæœåŠ¡å™¨ç›®å‰æ— æ³•ä½¿ç”¨ï¼Œä¸€æ®µæ—¶é—´åå¯èƒ½æ¢å¤æ­£å¸¸
</code></pre></li>
<li><p>ä¸€ä¸ªé¡µé¢ä»è¾“å…¥ URL åˆ°é¡µé¢åŠ è½½æ˜¾ç¤ºå®Œæˆï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿï¼ˆæµç¨‹è¯´çš„è¶Šè¯¦ç»†è¶Šå¥½ï¼‰</p>
<pre><code>æ³¨ï¼šè¿™é¢˜èƒœåœ¨åŒºåˆ†åº¦é«˜ï¼ŒçŸ¥è¯†ç‚¹è¦†ç›–å¹¿ï¼Œå†ä¸æ‡‚çš„äººï¼Œä¹Ÿèƒ½ç­”å‡ºå‡ å¥ï¼Œ
è€Œé«˜æ‰‹å¯ä»¥æ ¹æ®è‡ªå·±æ“…é•¿çš„é¢†åŸŸè‡ªç”±å‘æŒ¥ï¼Œä»URLè§„èŒƒã€HTTPåè®®ã€DNSã€CDNã€æ•°æ®åº“æŸ¥è¯¢ã€
åˆ°æµè§ˆå™¨æµå¼è§£æã€CSSè§„åˆ™æ„å»ºã€layoutã€paintã€onload/domreadyã€JSæ‰§è¡Œã€JS APIç»‘å®šç­‰ç­‰ï¼›

è¯¦ç»†ç‰ˆï¼š
  1ã€æµè§ˆå™¨ä¼šå¼€å¯ä¸€ä¸ªçº¿ç¨‹æ¥å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå¯¹ URL åˆ†æåˆ¤æ–­å¦‚æœæ˜¯ http åè®®å°±æŒ‰ç…§ Web æ–¹å¼æ¥å¤„ç†;
  2ã€è°ƒç”¨æµè§ˆå™¨å†…æ ¸ä¸­çš„å¯¹åº”æ–¹æ³•ï¼Œæ¯”å¦‚ WebView ä¸­çš„ loadUrl æ–¹æ³•;
  3ã€é€šè¿‡DNSè§£æè·å–ç½‘å€çš„IPåœ°å€ï¼Œè®¾ç½® UA ç­‰ä¿¡æ¯å‘å‡ºç¬¬äºŒä¸ªGETè¯·æ±‚;
  4ã€è¿›è¡ŒHTTPåè®®ä¼šè¯ï¼Œå®¢æˆ·ç«¯å‘é€æŠ¥å¤´(è¯·æ±‚æŠ¥å¤´);
  5ã€è¿›å…¥åˆ°webæœåŠ¡å™¨ä¸Šçš„ Web Serverï¼Œå¦‚ Apacheã€Tomcatã€Node.JS ç­‰æœåŠ¡å™¨;
  6ã€è¿›å…¥éƒ¨ç½²å¥½çš„åç«¯åº”ç”¨ï¼Œå¦‚ PHPã€Javaã€JavaScriptã€Python ç­‰ï¼Œæ‰¾åˆ°å¯¹åº”çš„è¯·æ±‚å¤„ç†;
  7ã€å¤„ç†ç»“æŸå›é¦ˆæŠ¥å¤´ï¼Œæ­¤å¤„å¦‚æœæµè§ˆå™¨è®¿é—®è¿‡ï¼Œç¼“å­˜ä¸Šæœ‰å¯¹åº”èµ„æºï¼Œä¼šä¸æœåŠ¡å™¨æœ€åä¿®æ”¹æ—¶é—´å¯¹æ¯”ï¼Œä¸€è‡´åˆ™è¿”å›304;
  8ã€æµè§ˆå™¨å¼€å§‹ä¸‹è½½htmlæ–‡æ¡£(å“åº”æŠ¥å¤´ï¼ŒçŠ¶æ€ç 200)ï¼ŒåŒæ—¶ä½¿ç”¨ç¼“å­˜;
  9ã€æ–‡æ¡£æ ‘å»ºç«‹ï¼Œæ ¹æ®æ ‡è®°è¯·æ±‚æ‰€éœ€æŒ‡å®šMIMEç±»å‹çš„æ–‡ä»¶ï¼ˆæ¯”å¦‚cssã€jsï¼‰,åŒæ—¶è®¾ç½®äº†cookie;
  10ã€é¡µé¢å¼€å§‹æ¸²æŸ“DOMï¼ŒJSæ ¹æ®DOM APIæ“ä½œDOM,æ‰§è¡Œäº‹ä»¶ç»‘å®šç­‰ï¼Œé¡µé¢æ˜¾ç¤ºå®Œæˆã€‚

ç®€æ´ç‰ˆï¼š
  æµè§ˆå™¨æ ¹æ®è¯·æ±‚çš„URLäº¤ç»™DNSåŸŸåè§£æï¼Œæ‰¾åˆ°çœŸå®IPï¼Œå‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼›
  æœåŠ¡å™¨äº¤ç»™åå°å¤„ç†å®Œæˆåè¿”å›æ•°æ®ï¼Œæµè§ˆå™¨æ¥æ”¶æ–‡ä»¶ï¼ˆHTMLã€JSã€CSSã€å›¾è±¡ç­‰ï¼‰ï¼›
  æµè§ˆå™¨å¯¹åŠ è½½åˆ°çš„èµ„æºï¼ˆHTMLã€JSã€CSSç­‰ï¼‰è¿›è¡Œè¯­æ³•è§£æï¼Œå»ºç«‹ç›¸åº”çš„å†…éƒ¨æ•°æ®ç»“æ„ï¼ˆå¦‚HTMLçš„DOMï¼‰ï¼›
  è½½å…¥è§£æåˆ°çš„èµ„æºæ–‡ä»¶ï¼Œæ¸²æŸ“é¡µé¢ï¼Œå®Œæˆã€‚
</code></pre></li>
<li><p>éƒ¨åˆ†åœ°åŒºç”¨æˆ·ååº”ç½‘ç«™å¾ˆå¡ï¼Œè¯·é—®æœ‰å“ªäº›å¯èƒ½æ€§çš„åŸå› ï¼Œä»¥åŠè§£å†³æ–¹æ³•ï¼Ÿ</p>
</li>
<li><p>ä»æ‰“å¼€appåˆ°åˆ·æ–°å‡ºå†…å®¹ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸­éƒ½å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¦‚æœæ„Ÿè§‰æ…¢ï¼Œæ€ä¹ˆå®šä½é—®é¢˜ï¼Œæ€ä¹ˆè§£å†³?</p>
</li>
<li><p>é™¤äº†å‰ç«¯ä»¥å¤–è¿˜äº†è§£ä»€ä¹ˆå…¶å®ƒæŠ€æœ¯ä¹ˆï¼Ÿä½ æœ€æœ€å‰å®³çš„æŠ€èƒ½æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</li>
<li><p>ä½ ç”¨çš„å¾—å¿ƒåº”æ‰‹ç”¨çš„ç†Ÿç»ƒåœ°ç¼–è¾‘å™¨&amp;å¼€å‘ç¯å¢ƒæ˜¯ä»€ä¹ˆæ ·å­ï¼Ÿ</p>
<pre><code>Sublime Text 3 + ç›¸å…³æ’ä»¶ç¼–å†™å‰ç«¯ä»£ç 
Google chrome ã€Mozilla Firefoxæµè§ˆå™¨ +firebug å…¼å®¹æµ‹è¯•å’Œé¢„è§ˆé¡µé¢UIã€åŠ¨ç”»æ•ˆæœå’Œäº¤äº’åŠŸèƒ½
Node.js+Gulp
git ç”¨äºç‰ˆæœ¬æ§åˆ¶å’ŒCode Review
</code></pre></li>
<li><p>å¯¹å‰ç«¯å·¥ç¨‹å¸ˆè¿™ä¸ªèŒä½æ˜¯æ€ä¹ˆæ ·ç†è§£çš„ï¼Ÿå®ƒçš„å‰æ™¯ä¼šæ€ä¹ˆæ ·ï¼Ÿ</p>
<pre><code>å‰ç«¯æ˜¯æœ€è´´è¿‘ç”¨æˆ·çš„ç¨‹åºå‘˜ï¼Œæ¯”åç«¯ã€æ•°æ®åº“ã€äº§å“ç»ç†ã€è¿è¥ã€å®‰å…¨éƒ½è¿‘ã€‚
1ã€å®ç°ç•Œé¢äº¤äº’
2ã€æå‡ç”¨æˆ·ä½“éªŒ
3ã€æœ‰äº†Node.jsï¼Œå‰ç«¯å¯ä»¥å®ç°æœåŠ¡ç«¯çš„ä¸€äº›äº‹æƒ…
</code></pre></li>
</ul>
<pre><code>å‰ç«¯æ˜¯æœ€è´´è¿‘ç”¨æˆ·çš„ç¨‹åºå‘˜ï¼Œå‰ç«¯çš„èƒ½åŠ›å°±æ˜¯èƒ½è®©äº§å“ä» 90åˆ†è¿›åŒ–åˆ° 100 åˆ†ï¼Œç”šè‡³æ›´å¥½ï¼Œ

å‚ä¸é¡¹ç›®ï¼Œå¿«é€Ÿé«˜è´¨é‡å®Œæˆå®ç°æ•ˆæœå›¾ï¼Œç²¾ç¡®åˆ°1pxï¼›

ä¸å›¢é˜Ÿæˆå‘˜ï¼ŒUIè®¾è®¡ï¼Œäº§å“ç»ç†çš„æ²Ÿé€šï¼›

åšå¥½çš„é¡µé¢ç»“æ„ï¼Œé¡µé¢é‡æ„å’Œç”¨æˆ·ä½“éªŒï¼›

å¤„ç†hackï¼Œå…¼å®¹ã€å†™å‡ºä¼˜ç¾çš„ä»£ç æ ¼å¼ï¼›

é’ˆå¯¹æœåŠ¡å™¨çš„ä¼˜åŒ–ã€æ‹¥æŠ±æœ€æ–°å‰ç«¯æŠ€æœ¯ã€‚
</code></pre><ul>
<li><p>ä½ æ€ä¹ˆçœ‹å¾…Web App ã€hybrid Appã€Native Appï¼Ÿ</p>
</li>
<li><p>ä½ ç§»åŠ¨ç«¯å‰ç«¯å¼€å‘çš„ç†è§£ï¼Ÿï¼ˆå’Œ Web å‰ç«¯å¼€å‘çš„ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿï¼‰</p>
</li>
<li><p>ä½ å¯¹åŠ ç­çš„çœ‹æ³•ï¼Ÿ</p>
</li>
</ul>
<pre><code>åŠ ç­å°±åƒå€Ÿé’±ï¼ŒåŸåˆ™åº”å½“æ˜¯------æ•‘æ€¥ä¸æ•‘ç©·
</code></pre><ul>
<li><p>å¹³æ—¶å¦‚ä½•ç®¡ç†ä½ çš„é¡¹ç›®ï¼Ÿ</p>
<pre><code>å…ˆæœŸå›¢é˜Ÿå¿…é¡»ç¡®å®šå¥½å…¨å±€æ ·å¼ï¼ˆglobe.cssï¼‰ï¼Œç¼–ç æ¨¡å¼(utf-8) ç­‰ï¼›

ç¼–å†™ä¹ æƒ¯å¿…é¡»ä¸€è‡´ï¼ˆä¾‹å¦‚éƒ½æ˜¯é‡‡ç”¨ç»§æ‰¿å¼çš„å†™æ³•ï¼Œå•æ ·å¼éƒ½å†™æˆä¸€è¡Œï¼‰ï¼›

æ ‡æ³¨æ ·å¼ç¼–å†™äººï¼Œå„æ¨¡å—éƒ½åŠæ—¶æ ‡æ³¨ï¼ˆæ ‡æ³¨å…³é”®æ ·å¼è°ƒç”¨çš„åœ°æ–¹ï¼‰ï¼›

é¡µé¢è¿›è¡Œæ ‡æ³¨ï¼ˆä¾‹å¦‚ é¡µé¢ æ¨¡å— å¼€å§‹å’Œç»“æŸï¼‰ï¼›

CSSè·ŸHTML åˆ†æ–‡ä»¶å¤¹å¹¶è¡Œå­˜æ”¾ï¼Œå‘½åéƒ½å¾—ç»Ÿä¸€ï¼ˆä¾‹å¦‚style.cssï¼‰ï¼›

JS åˆ†æ–‡ä»¶å¤¹å­˜æ”¾ å‘½åä»¥è¯¥JSåŠŸèƒ½ä¸ºå‡†çš„è‹±æ–‡ç¿»è¯‘ã€‚

å›¾ç‰‡é‡‡ç”¨æ•´åˆçš„ images.png png8 æ ¼å¼æ–‡ä»¶ä½¿ç”¨ å°½é‡æ•´åˆåœ¨ä¸€èµ·ä½¿ç”¨æ–¹ä¾¿å°†æ¥çš„ç®¡ç†
</code></pre></li>
<li><p>å¦‚ä½•è®¾è®¡çªå‘å¤§è§„æ¨¡å¹¶å‘æ¶æ„ï¼Ÿ</p>
</li>
</ul>
<ul>
<li><p>å½“å›¢é˜Ÿäººæ‰‹ä¸è¶³ï¼ŒæŠŠåŠŸèƒ½ä»£ç å†™å®Œå·²ç»éœ€è¦åŠ ç­çš„æƒ…å†µä¸‹ï¼Œä½ ä¼šåšå‰ç«¯ä»£ç çš„æµ‹è¯•å—ï¼Ÿ</p>
</li>
<li><p>è¯´è¯´æœ€è¿‘æœ€æµè¡Œçš„ä¸€äº›ä¸œè¥¿å§ï¼Ÿå¸¸å»å“ªäº›ç½‘ç«™ï¼Ÿ</p>
<pre><code>ES6\WebAssembly\Node\MVVM\Web Components\React\React Native\Webpack ç»„ä»¶åŒ–
</code></pre></li>
<li><p>çŸ¥é“ä»€ä¹ˆæ˜¯SEOå¹¶ä¸”æ€ä¹ˆä¼˜åŒ–ä¹ˆ? çŸ¥é“å„ç§meta dataçš„å«ä¹‰ä¹ˆ?</p>
</li>
</ul>
<ul>
<li><p>ç§»åŠ¨ç«¯ï¼ˆAndroid IOSï¼‰æ€ä¹ˆåšå¥½ç”¨æˆ·ä½“éªŒ?</p>
<pre><code>æ¸…æ™°çš„è§†è§‰çºµçº¿ã€
ä¿¡æ¯çš„åˆ†ç»„ã€æè‡´çš„å‡æ³•ã€
åˆ©ç”¨é€‰æ‹©ä»£æ›¿è¾“å…¥ã€
æ ‡ç­¾åŠæ–‡å­—çš„æ’å¸ƒæ–¹å¼ã€
ä¾é æ˜æ–‡ç¡®è®¤å¯†ç ã€
åˆç†çš„é”®ç›˜åˆ©ç”¨ã€
</code></pre></li>
<li><p>ç®€å•æè¿°ä¸€ä¸‹ä½ åšè¿‡çš„ç§»åŠ¨APPé¡¹ç›®ç ”å‘æµç¨‹ï¼Ÿ</p>
</li>
<li><p>ä½ åœ¨ç°åœ¨çš„å›¢é˜Ÿå¤„äºä»€ä¹ˆæ ·çš„è§’è‰²ï¼Œèµ·åˆ°äº†ä»€ä¹ˆæ˜æ˜¾çš„ä½œç”¨ï¼Ÿ</p>
</li>
<li><p>ä½ è®¤ä¸ºæ€æ ·æ‰æ˜¯å…¨ç«¯å·¥ç¨‹å¸ˆï¼ˆFull Stack developerï¼‰ï¼Ÿ</p>
</li>
<li><p>ä»‹ç»ä¸€ä¸ªä½ æœ€å¾—æ„çš„ä½œå“å§ï¼Ÿ</p>
</li>
<li><p>ä½ æœ‰è‡ªå·±çš„æŠ€æœ¯åšå®¢å—ï¼Œç”¨äº†å“ªäº›æŠ€æœ¯ï¼Ÿ</p>
</li>
<li><p>å¯¹å‰ç«¯å®‰å…¨æœ‰ä»€ä¹ˆçœ‹æ³•ï¼Ÿ</p>
</li>
<li><p>æ˜¯å¦äº†è§£Webæ³¨å…¥æ”»å‡»ï¼Œè¯´ä¸‹åŸç†ï¼Œæœ€å¸¸è§çš„ä¸¤ç§æ”»å‡»ï¼ˆXSS å’Œ CSRFï¼‰äº†è§£åˆ°ä»€ä¹ˆç¨‹åº¦ï¼Ÿ</p>
</li>
<li><p>é¡¹ç›®ä¸­é‡åˆ°å›½å“ªäº›å°è±¡æ·±åˆ»çš„æŠ€æœ¯éš¾é¢˜ï¼Œå…·ä½“æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œæ€ä¹ˆè§£å†³ï¼Ÿã€‚</p>
</li>
<li><p>æœ€è¿‘åœ¨å­¦ä»€ä¹ˆä¸œè¥¿ï¼Ÿ</p>
</li>
<li><p>ä½ çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p>
</li>
<li><p>å¦‚ä½•ç®¡ç†å‰ç«¯å›¢é˜Ÿ?</p>
</li>
<li><p>æœ€è¿‘åœ¨å­¦ä»€ä¹ˆï¼Ÿèƒ½è°ˆè°ˆä½ æœªæ¥3ï¼Œ5å¹´ç»™è‡ªå·±çš„è§„åˆ’å—ï¼Ÿ</p>
</li>
</ul>
<h2 id="å‰ç«¯å­¦ä¹ ç½‘ç«™æ¨è"><a href="#å‰ç«¯å­¦ä¹ ç½‘ç«™æ¨è" class="headerlink" title="å‰ç«¯å­¦ä¹ ç½‘ç«™æ¨è"></a><a name="web">å‰ç«¯å­¦ä¹ ç½‘ç«™æ¨è</a></h2><pre><code>1. æå®¢æ ‡ç­¾ï¼š     http://www.gbtags.com/

2. ç å†œå‘¨åˆŠï¼š     http://weekly.manong.io/issues/

3. å‰ç«¯å‘¨åˆŠï¼š     http://www.feweekly.com/issues

4. æ…•è¯¾ç½‘ï¼š       http://www.imooc.com/

5. div.ioï¼š         http://div.io

6. Hacker Newsï¼š https://news.ycombinator.com/news

7. InfoQï¼š       http://www.infoq.com/

8. w3cplusï¼š     http://www.w3cplus.com/

9. Stack Overflowï¼š http://stackoverflow.com/

10.w3schoolï¼š    http://www.w3school.com.cn/

11.mozillaï¼š     https://developer.mozilla.org/zh-CN/docs/Web/JavaScript
</code></pre><h2 id="æ–‡æ¡£æ¨è"><a href="#æ–‡æ¡£æ¨è" class="headerlink" title="æ–‡æ¡£æ¨è"></a><a name="web">æ–‡æ¡£æ¨è</a></h2><ol>
<li><p><a href="http://docs.huihoo.com/jquery/jquery-fundamentals/zh-cn/index.html" title="jQuery åŸºæœ¬åŸç†" target="_blank" rel="external">jQuery åŸºæœ¬åŸç†</a></p>
</li>
<li><p><a href="http://bonsaiden.github.io/JavaScript-Garden/zh/" target="_blank" rel="external">JavaScript ç§˜å¯†èŠ±å›­</a></p>
</li>
<li><p><a href="http://css.doyoe.com/" target="_blank" rel="external">CSSå‚è€ƒæ‰‹å†Œ</a></p>
</li>
<li><p><a href="http://javascript.ruanyifeng.com/" target="_blank" rel="external">JavaScript æ ‡å‡†å‚è€ƒæ•™ç¨‹</a></p>
</li>
<li><p><a href="http://es6.ruanyifeng.com/" target="_blank" rel="external">ECMAScript 6å…¥é—¨</a></p>
</li>
</ol>
<p><strong>å¤‡æ³¨ï¼š</strong></p>
<pre><code>æ ¹æ®è‡ªå·±éœ€è¦é€‰æ‹©æ€§é˜…è¯»ï¼Œé¢è¯•é¢˜æ˜¯å¯¹ç†è®ºçŸ¥è¯†çš„æ€»ç»“ï¼Œè®©è‡ªå·±å­¦ä¼šåº”è¯¥å¦‚ä½•è¡¨è¾¾ã€‚

èµ„æ–™ç­”æ¡ˆä¸å¤Ÿæ­£ç¡®å’Œå…¨é¢ï¼Œæ¬¢è¿æ¬¢è¿Starå’Œæäº¤issuesã€‚

æ ¼å¼ä¸æ–­ä¿®æ”¹æ›´æ–°ä¸­ã€‚

åœ¨ github é¡¹ç›®çš„å³ä¸Šè§’ï¼Œæœ‰ä¸‰ä¸ªæŒ‰é’®,åˆ†åˆ«æ˜¯ watchã€starã€forkï¼Œæ–°æ¥çš„åŒå­¦æ³¨æ„ä¸è¦ç”¨é”™äº†ï¼Œæ— ä¼‘æ­¢çš„é‚®ä»¶æé†’ä¼šç»™ä½ é€ æˆä¸å¿…è¦çš„ä¿¡æ¯å¹²æ‰°ã€‚

å½“ä½ é€‰æ‹©Watchingï¼Œè¡¨ç¤ºä½ ä»¥åä¼šå…³æ³¨è¿™ä¸ªé¡¹ç›®çš„å…¨éƒ¨åŠ¨æ€ï¼Œä»¥ååªè¦è¿™ä¸ªé¡¹ç›®å‘ç”Ÿå˜åŠ¨ï¼Œè¢«åˆ«äººæäº¤äº†pull requestã€è¢«å‘èµ·äº†issueç­‰æƒ…å†µä½ éƒ½ä¼šæ”¶åˆ°é‚®ä»¶é€šçŸ¥ã€‚

starç›¸å½“äºæ˜¯ç‚¹èµæˆ–æ”¶è—ï¼Œæ–¹ä¾¿ä»¥åæŸ¥æ‰¾ã€‚

forkè¡¨ç¤ºä½ æƒ³è¦è¡¥å……å®Œå–„è¿™ä¸ªé¡¹ç›®çš„å†…å®¹ã€‚
</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å‰ç«¯å¼€å‘é¢è¯•é¢˜&quot;&gt;&lt;a href=&quot;#å‰ç«¯å¼€å‘é¢è¯•é¢˜&quot; class=&quot;headerlink&quot; title=&quot;å‰ç«¯å¼€å‘é¢è¯•é¢˜&quot;&gt;&lt;/a&gt;å‰ç«¯å¼€å‘é¢è¯•é¢˜&lt;/h1&gt;&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰
    
    </summary>
    
    
      <category term="é¢è¯•" scheme="http://microzz.com/tags/%E9%9D%A2%E8%AF%95/"/>
    
      <category term="å‰ç«¯" scheme="http://microzz.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
      <category term="æ±‚èŒ" scheme="http://microzz.com/tags/%E6%B1%82%E8%81%8C/"/>
    
  </entry>
  
  <entry>
    <title>ES6ç¼–ç¨‹é£æ ¼</title>
    <link href="http://microzz.com/2017/02/06/es6-style/"/>
    <id>http://microzz.com/2017/02/06/es6-style/</id>
    <published>2017-02-06T10:00:23.000Z</published>
    <updated>2017-02-06T10:05:11.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ç¼–ç¨‹é£æ ¼"><a href="#ç¼–ç¨‹é£æ ¼" class="headerlink" title="ç¼–ç¨‹é£æ ¼"></a>ç¼–ç¨‹é£æ ¼</h1><p>æœ¬ç« æ¢è®¨å¦‚ä½•å°†ES6çš„æ–°è¯­æ³•ï¼Œè¿ç”¨åˆ°ç¼–ç å®è·µä¹‹ä¸­ï¼Œä¸ä¼ ç»Ÿçš„JavaScriptè¯­æ³•ç»“åˆåœ¨ä¸€èµ·ï¼Œå†™å‡ºåˆç†çš„ã€æ˜“äºé˜…è¯»å’Œç»´æŠ¤çš„ä»£ç ã€‚</p>
<p>å¤šå®¶å…¬å¸å’Œç»„ç»‡å·²ç»å…¬å¼€äº†å®ƒä»¬çš„é£æ ¼è§„èŒƒï¼Œå…·ä½“å¯å‚é˜…<a href="http://jscs.info/" target="_blank" rel="external">jscs.info</a>ï¼Œä¸‹é¢çš„å†…å®¹ä¸»è¦å‚è€ƒäº†<a href="https://github.com/airbnb/javascript" target="_blank" rel="external">Airbnb</a>çš„JavaScripté£æ ¼è§„èŒƒã€‚</p>
<h2 id="å—çº§ä½œç”¨åŸŸ"><a href="#å—çº§ä½œç”¨åŸŸ" class="headerlink" title="å—çº§ä½œç”¨åŸŸ"></a>å—çº§ä½œç”¨åŸŸ</h2><p><strong>ï¼ˆ1ï¼‰let å–ä»£ var</strong></p>
<p>ES6æå‡ºäº†ä¸¤ä¸ªæ–°çš„å£°æ˜å˜é‡çš„å‘½ä»¤ï¼š<code>let</code>å’Œ<code>const</code>ã€‚å…¶ä¸­ï¼Œ<code>let</code>å®Œå…¨å¯ä»¥å–ä»£<code>var</code>ï¼Œå› ä¸ºä¸¤è€…è¯­ä¹‰ç›¸åŒï¼Œè€Œä¸”<code>let</code>æ²¡æœ‰å‰¯ä½œç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="keyword">let</span> x = <span class="string">'hello'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¦‚æœç”¨<code>var</code>æ›¿ä»£<code>let</code>ï¼Œå®é™…ä¸Šå°±å£°æ˜äº†ä¸¤ä¸ªå…¨å±€å˜é‡ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æœ¬æ„ã€‚å˜é‡åº”è¯¥åªåœ¨å…¶å£°æ˜çš„ä»£ç å—å†…æœ‰æ•ˆï¼Œ<code>var</code>å‘½ä»¤åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p><code>var</code>å‘½ä»¤å­˜åœ¨å˜é‡æå‡æ•ˆç”¨ï¼Œ<code>let</code>å‘½ä»¤æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="literal">true</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(x); <span class="comment">// ReferenceError</span></div><div class="line">  <span class="keyword">let</span> x = <span class="string">'hello'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¦‚æœä½¿ç”¨<code>var</code>æ›¿ä»£<code>let</code>ï¼Œ<code>console.log</code>é‚£ä¸€è¡Œå°±ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯ä¼šè¾“å‡º<code>undefined</code>ï¼Œå› ä¸ºå˜é‡å£°æ˜æå‡åˆ°ä»£ç å—çš„å¤´éƒ¨ã€‚è¿™è¿åäº†å˜é‡å…ˆå£°æ˜åä½¿ç”¨çš„åŸåˆ™ã€‚</p>
<p>æ‰€ä»¥ï¼Œå»ºè®®ä¸å†ä½¿ç”¨<code>var</code>å‘½ä»¤ï¼Œè€Œæ˜¯ä½¿ç”¨<code>let</code>å‘½ä»¤å–ä»£ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰å…¨å±€å¸¸é‡å’Œçº¿ç¨‹å®‰å…¨</strong></p>
<p>åœ¨<code>let</code>å’Œ<code>const</code>ä¹‹é—´ï¼Œå»ºè®®ä¼˜å…ˆä½¿ç”¨<code>const</code>ï¼Œå°¤å…¶æ˜¯åœ¨å…¨å±€ç¯å¢ƒï¼Œä¸åº”è¯¥è®¾ç½®å˜é‡ï¼Œåªåº”è®¾ç½®å¸¸é‡ã€‚</p>
<p><code>const</code>ä¼˜äº<code>let</code>æœ‰å‡ ä¸ªåŸå› ã€‚ä¸€ä¸ªæ˜¯<code>const</code>å¯ä»¥æé†’é˜…è¯»ç¨‹åºçš„äººï¼Œè¿™ä¸ªå˜é‡ä¸åº”è¯¥æ”¹å˜ï¼›å¦ä¸€ä¸ªæ˜¯<code>const</code>æ¯”è¾ƒç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹æ€æƒ³ï¼Œè¿ç®—ä¸æ”¹å˜å€¼ï¼Œåªæ˜¯æ–°å»ºå€¼ï¼Œè€Œä¸”è¿™æ ·ä¹Ÿæœ‰åˆ©äºå°†æ¥çš„åˆ†å¸ƒå¼è¿ç®—ï¼›æœ€åä¸€ä¸ªåŸå› æ˜¯ JavaScript ç¼–è¯‘å™¨ä¼šå¯¹<code>const</code>è¿›è¡Œä¼˜åŒ–ï¼Œæ‰€ä»¥å¤šä½¿ç”¨<code>const</code>ï¼Œæœ‰åˆ©äºæä¾›ç¨‹åºçš„è¿è¡Œæ•ˆç‡ï¼Œä¹Ÿå°±æ˜¯è¯´<code>let</code>å’Œ<code>const</code>çš„æœ¬è´¨åŒºåˆ«ï¼Œå…¶å®æ˜¯ç¼–è¯‘å™¨å†…éƒ¨çš„å¤„ç†ä¸åŒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</div><div class="line"><span class="keyword">const</span> b = <span class="number">2</span>;</div><div class="line"><span class="keyword">const</span> c = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">// best</span></div><div class="line"><span class="keyword">const</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div></pre></td></tr></table></figure>
<p><code>const</code>å£°æ˜å¸¸é‡è¿˜æœ‰ä¸¤ä¸ªå¥½å¤„ï¼Œä¸€æ˜¯é˜…è¯»ä»£ç çš„äººç«‹åˆ»ä¼šæ„è¯†åˆ°ä¸åº”è¯¥ä¿®æ”¹è¿™ä¸ªå€¼ï¼ŒäºŒæ˜¯é˜²æ­¢äº†æ— æ„é—´ä¿®æ”¹å˜é‡å€¼æ‰€å¯¼è‡´çš„é”™è¯¯ã€‚</p>
<p>æ‰€æœ‰çš„å‡½æ•°éƒ½åº”è¯¥è®¾ç½®ä¸ºå¸¸é‡ã€‚</p>
<p>é•¿è¿œæ¥çœ‹ï¼ŒJavaScriptå¯èƒ½ä¼šæœ‰å¤šçº¿ç¨‹çš„å®ç°ï¼ˆæ¯”å¦‚Intelçš„River Trailé‚£ä¸€ç±»çš„é¡¹ç›®ï¼‰ï¼Œè¿™æ—¶<code>let</code>è¡¨ç¤ºçš„å˜é‡ï¼Œåªåº”å‡ºç°åœ¨å•çº¿ç¨‹è¿è¡Œçš„ä»£ç ä¸­ï¼Œä¸èƒ½æ˜¯å¤šçº¿ç¨‹å…±äº«çš„ï¼Œè¿™æ ·æœ‰åˆ©äºä¿è¯çº¿ç¨‹å®‰å…¨ã€‚</p>
<h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><p>é™æ€å­—ç¬¦ä¸²ä¸€å¾‹ä½¿ç”¨å•å¼•å·æˆ–åå¼•å·ï¼Œä¸ä½¿ç”¨åŒå¼•å·ã€‚åŠ¨æ€å­—ç¬¦ä¸²ä½¿ç”¨åå¼•å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> a = <span class="string">"foobar"</span>;</div><div class="line"><span class="keyword">const</span> b = <span class="string">'foo'</span> + a + <span class="string">'bar'</span>;</div><div class="line"></div><div class="line"><span class="comment">// acceptable</span></div><div class="line"><span class="keyword">const</span> c = <span class="string">`foobar`</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> a = <span class="string">'foobar'</span>;</div><div class="line"><span class="keyword">const</span> b = <span class="string">`foo<span class="subst">$&#123;a&#125;</span>bar`</span>;</div><div class="line"><span class="keyword">const</span> c = <span class="string">'foobar'</span>;</div></pre></td></tr></table></figure>
<h2 id="è§£æ„èµ‹å€¼"><a href="#è§£æ„èµ‹å€¼" class="headerlink" title="è§£æ„èµ‹å€¼"></a>è§£æ„èµ‹å€¼</h2><p>ä½¿ç”¨æ•°ç»„æˆå‘˜å¯¹å˜é‡èµ‹å€¼æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> first = arr[<span class="number">0</span>];</div><div class="line"><span class="keyword">const</span> second = arr[<span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> [first, second] = arr;</div></pre></td></tr></table></figure>
<p>å‡½æ•°çš„å‚æ•°å¦‚æœæ˜¯å¯¹è±¡çš„æˆå‘˜ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">user</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> firstName = user.firstName;</div><div class="line">  <span class="keyword">const</span> lastName = user.lastName;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> &#123; firstName, lastName &#125; = obj;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// best</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">&#123; firstName, lastName &#125;</span>) </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœå‡½æ•°è¿”å›å¤šä¸ªå€¼ï¼Œä¼˜å…ˆä½¿ç”¨å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œè€Œä¸æ˜¯æ•°ç»„çš„è§£æ„èµ‹å€¼ã€‚è¿™æ ·ä¾¿äºä»¥åæ·»åŠ è¿”å›å€¼ï¼Œä»¥åŠæ›´æ”¹è¿”å›å€¼çš„é¡ºåºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processInput</span>(<span class="params">input</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [left, right, top, bottom];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processInput</span>(<span class="params">input</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123; left, right, top, bottom &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> &#123; left, right &#125; = processInput(input);</div></pre></td></tr></table></figure>
<h2 id="å¯¹è±¡"><a href="#å¯¹è±¡" class="headerlink" title="å¯¹è±¡"></a>å¯¹è±¡</h2><p>å•è¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä¸ä»¥é€—å·ç»“å°¾ã€‚å¤šè¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä»¥é€—å·ç»“å°¾ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> a = &#123; <span class="attr">k1</span>: v1, <span class="attr">k2</span>: v2, &#125;;</div><div class="line"><span class="keyword">const</span> b = &#123;</div><div class="line">  <span class="attr">k1</span>: v1,</div><div class="line">  <span class="attr">k2</span>: v2</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> a = &#123; <span class="attr">k1</span>: v1, <span class="attr">k2</span>: v2 &#125;;</div><div class="line"><span class="keyword">const</span> b = &#123;</div><div class="line">  <span class="attr">k1</span>: v1,</div><div class="line">  <span class="attr">k2</span>: v2,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å¯¹è±¡å°½é‡é™æ€åŒ–ï¼Œä¸€æ—¦å®šä¹‰ï¼Œå°±ä¸å¾—éšæ„æ·»åŠ æ–°çš„å±æ€§ã€‚å¦‚æœæ·»åŠ å±æ€§ä¸å¯é¿å…ï¼Œè¦ä½¿ç”¨<code>Object.assign</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> a = &#123;&#125;;</div><div class="line">a.x = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">// if reshape unavoidable</span></div><div class="line"><span class="keyword">const</span> a = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.assign(a, &#123; <span class="attr">x</span>: <span class="number">3</span> &#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> a = &#123; <span class="attr">x</span>: <span class="literal">null</span> &#125;;</div><div class="line">a.x = <span class="number">3</span>;</div></pre></td></tr></table></figure>
<p>å¦‚æœå¯¹è±¡çš„å±æ€§åæ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥åœ¨åˆ›é€ å¯¹è±¡çš„æ—¶å€™ï¼Œä½¿ç”¨å±æ€§è¡¨è¾¾å¼å®šä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">5</span>,</div><div class="line">  <span class="attr">name</span>: <span class="string">'San Francisco'</span>,</div><div class="line">&#125;;</div><div class="line">obj[getKey(<span class="string">'enabled'</span>)] = <span class="literal">true</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">5</span>,</div><div class="line">  <span class="attr">name</span>: <span class="string">'San Francisco'</span>,</div><div class="line">  [getKey(<span class="string">'enabled'</span>)]: <span class="literal">true</span>,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡<code>obj</code>çš„æœ€åä¸€ä¸ªå±æ€§åï¼Œéœ€è¦è®¡ç®—å¾—åˆ°ã€‚è¿™æ—¶æœ€å¥½é‡‡ç”¨å±æ€§è¡¨è¾¾å¼ï¼Œåœ¨æ–°å»º<code>obj</code>çš„æ—¶å€™ï¼Œå°†è¯¥å±æ€§ä¸å…¶ä»–å±æ€§å®šä¹‰åœ¨ä¸€èµ·ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰å±æ€§å°±åœ¨ä¸€ä¸ªåœ°æ–¹å®šä¹‰äº†ã€‚</p>
<p>å¦å¤–ï¼Œå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°½é‡é‡‡ç”¨ç®€æ´è¡¨è¾¾æ³•ï¼Œè¿™æ ·æ˜“äºæè¿°å’Œä¹¦å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ref = <span class="string">'some value'</span>;</div><div class="line"></div><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> atom = &#123;</div><div class="line">  <span class="attr">ref</span>: ref,</div><div class="line"></div><div class="line">  <span class="attr">value</span>: <span class="number">1</span>,</div><div class="line"></div><div class="line">  <span class="attr">addValue</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> atom.value + value;</div><div class="line">  &#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> atom = &#123;</div><div class="line">  ref,</div><div class="line"></div><div class="line">  <span class="attr">value</span>: <span class="number">1</span>,</div><div class="line"></div><div class="line">  addValue(value) &#123;</div><div class="line">    <span class="keyword">return</span> atom.value + value;</div><div class="line">  &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><p>ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰æ‹·è´æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> len = items.length;</div><div class="line"><span class="keyword">const</span> itemsCopy = [];</div><div class="line"><span class="keyword">let</span> i;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</div><div class="line">  itemsCopy[i] = items[i];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">const</span> itemsCopy = [...items];</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨Array.fromæ–¹æ³•ï¼Œå°†ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡è½¬ä¸ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foo = <span class="built_in">document</span>.querySelectorAll(<span class="string">'.foo'</span>);</div><div class="line"><span class="keyword">const</span> nodes = <span class="built_in">Array</span>.from(foo);</div></pre></td></tr></table></figure>
<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><p>ç«‹å³æ‰§è¡Œå‡½æ•°å¯ä»¥å†™æˆç®­å¤´å‡½æ•°çš„å½¢å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Welcome to the Internet.'</span>);</div><div class="line">&#125;)();</div></pre></td></tr></table></figure>
<p>é‚£äº›éœ€è¦ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„åœºåˆï¼Œå°½é‡ç”¨ç®­å¤´å‡½æ•°ä»£æ›¿ã€‚å› ä¸ºè¿™æ ·æ›´ç®€æ´ï¼Œè€Œä¸”ç»‘å®šäº†thisã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x * x;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function">(<span class="params">x</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> x * x;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// best</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</div></pre></td></tr></table></figure>
<p>ç®­å¤´å‡½æ•°å–ä»£<code>Function.prototype.bind</code>ï¼Œä¸åº”å†ç”¨self/_this/thatç»‘å®š thisã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> self = <span class="keyword">this</span>;</div><div class="line"><span class="keyword">const</span> boundMethod = <span class="function"><span class="keyword">function</span>(<span class="params">...params</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> method.apply(self, params);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// acceptable</span></div><div class="line"><span class="keyword">const</span> boundMethod = method.bind(<span class="keyword">this</span>);</div><div class="line"></div><div class="line"><span class="comment">// best</span></div><div class="line"><span class="keyword">const</span> boundMethod = <span class="function">(<span class="params">...params</span>) =&gt;</span> method.apply(<span class="keyword">this</span>, params);</div></pre></td></tr></table></figure>
<p>ç®€å•çš„ã€å•è¡Œçš„ã€ä¸ä¼šå¤ç”¨çš„å‡½æ•°ï¼Œå»ºè®®é‡‡ç”¨ç®­å¤´å‡½æ•°ã€‚å¦‚æœå‡½æ•°ä½“è¾ƒä¸ºå¤æ‚ï¼Œè¡Œæ•°è¾ƒå¤šï¼Œè¿˜æ˜¯åº”è¯¥é‡‡ç”¨ä¼ ç»Ÿçš„å‡½æ•°å†™æ³•ã€‚</p>
<p>æ‰€æœ‰é…ç½®é¡¹éƒ½åº”è¯¥é›†ä¸­åœ¨ä¸€ä¸ªå¯¹è±¡ï¼Œæ”¾åœ¨æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¸ƒå°”å€¼ä¸å¯ä»¥ç›´æ¥ä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">a, b, option = false </span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">a, b, &#123; option = false &#125; = &#123;&#125;</span>) </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸è¦åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨argumentså˜é‡ï¼Œä½¿ç”¨restè¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰ä»£æ›¿ã€‚å› ä¸ºrestè¿ç®—ç¬¦æ˜¾å¼è¡¨æ˜ä½ æƒ³è¦è·å–å‚æ•°ï¼Œè€Œä¸”argumentsæ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œè€Œrestè¿ç®—ç¬¦å¯ä»¥æä¾›ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</div><div class="line">  <span class="keyword">return</span> args.join(<span class="string">''</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params">...args</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> args.join(<span class="string">''</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨é»˜è®¤å€¼è¯­æ³•è®¾ç½®å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts</span>) </span>&#123;</div><div class="line">  opts = opts || &#123;&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts = &#123;&#125;</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Mapç»“æ„"><a href="#Mapç»“æ„" class="headerlink" title="Mapç»“æ„"></a>Mapç»“æ„</h2><p>æ³¨æ„åŒºåˆ†Objectå’ŒMapï¼Œåªæœ‰æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„å®ä½“å¯¹è±¡æ—¶ï¼Œæ‰ä½¿ç”¨Objectã€‚å¦‚æœåªæ˜¯éœ€è¦<code>key: value</code>çš„æ•°æ®ç»“æ„ï¼Œä½¿ç”¨Mapç»“æ„ã€‚å› ä¸ºMapæœ‰å†…å»ºçš„éå†æœºåˆ¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(arr);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> map.keys()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> map.values()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> map.entries()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(item[<span class="number">0</span>], item[<span class="number">1</span>]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h2><p>æ€»æ˜¯ç”¨Classï¼Œå–ä»£éœ€è¦prototypeçš„æ“ä½œã€‚å› ä¸ºClassçš„å†™æ³•æ›´ç®€æ´ï¼Œæ›´æ˜“äºç†è§£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Queue</span>(<span class="params">contents = []</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>._queue = [...contents];</div><div class="line">&#125;</div><div class="line">Queue.prototype.pop = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> value = <span class="keyword">this</span>._queue[<span class="number">0</span>];</div><div class="line">  <span class="keyword">this</span>._queue.splice(<span class="number">0</span>, <span class="number">1</span>);</div><div class="line">  <span class="keyword">return</span> value;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Queue</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(contents = []) &#123;</div><div class="line">    <span class="keyword">this</span>._queue = [...contents];</div><div class="line">  &#125;</div><div class="line">  pop() &#123;</div><div class="line">    <span class="keyword">const</span> value = <span class="keyword">this</span>._queue[<span class="number">0</span>];</div><div class="line">    <span class="keyword">this</span>._queue.splice(<span class="number">0</span>, <span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> value;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>extends</code>å®ç°ç»§æ‰¿ï¼Œå› ä¸ºè¿™æ ·æ›´ç®€å•ï¼Œä¸ä¼šæœ‰ç ´å<code>instanceof</code>è¿ç®—çš„å±é™©ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> inherits = <span class="built_in">require</span>(<span class="string">'inherits'</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">PeekableQueue</span>(<span class="params">contents</span>) </span>&#123;</div><div class="line">  Queue.apply(<span class="keyword">this</span>, contents);</div><div class="line">&#125;</div><div class="line">inherits(PeekableQueue, Queue);</div><div class="line">PeekableQueue.prototype.peek = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>._queue[<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PeekableQueue</span> <span class="keyword">extends</span> <span class="title">Queue</span> </span>&#123;</div><div class="line">  peek() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._queue[<span class="number">0</span>];</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h2><p>é¦–å…ˆï¼ŒModuleè¯­æ³•æ˜¯JavaScriptæ¨¡å—çš„æ ‡å‡†å†™æ³•ï¼ŒåšæŒä½¿ç”¨è¿™ç§å†™æ³•ã€‚ä½¿ç”¨<code>import</code>å–ä»£<code>require</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">const</span> moduleA = <span class="built_in">require</span>(<span class="string">'moduleA'</span>);</div><div class="line"><span class="keyword">const</span> func1 = moduleA.func1;</div><div class="line"><span class="keyword">const</span> func2 = moduleA.func2;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">import</span> &#123; func1, func2 &#125; <span class="keyword">from</span> <span class="string">'moduleA'</span>;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>export</code>å–ä»£<code>module.exports</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// commonJSçš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> React = <span class="built_in">require</span>(<span class="string">'react'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> Breadcrumbs = React.createClass(&#123;</div><div class="line">  render() &#123;</div><div class="line">    <span class="keyword">return</span> &lt;nav /&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">module.exports = Breadcrumbs;</div><div class="line"></div><div class="line">// ES6çš„å†™æ³•</div><div class="line">import React from 'react';</div><div class="line"></div><div class="line">const Breadcrumbs = React.createClass(&#123;</div><div class="line">  render() &#123;</div><div class="line">    return &lt;nav /&gt;;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">export default Breadcrumbs</div></pre></td></tr></table></figure>
<p>å¦‚æœæ¨¡å—åªæœ‰ä¸€ä¸ªè¾“å‡ºå€¼ï¼Œå°±ä½¿ç”¨<code>export default</code>ï¼Œå¦‚æœæ¨¡å—æœ‰å¤šä¸ªè¾“å‡ºå€¼ï¼Œå°±ä¸ä½¿ç”¨<code>export default</code>ï¼Œä¸è¦<code>export default</code>ä¸æ™®é€šçš„<code>export</code>åŒæ—¶ä½¿ç”¨ã€‚</p>
<p>ä¸è¦åœ¨æ¨¡å—è¾“å…¥ä¸­ä½¿ç”¨é€šé…ç¬¦ã€‚å› ä¸ºè¿™æ ·å¯ä»¥ç¡®ä¿ä½ çš„æ¨¡å—ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ªé»˜è®¤è¾“å‡ºï¼ˆexport defaultï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> myObject <span class="string">'./importModule'</span>;</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line"><span class="keyword">import</span> myObject <span class="keyword">from</span> <span class="string">'./importModule'</span>;</div></pre></td></tr></table></figure>
<p>å¦‚æœæ¨¡å—é»˜è®¤è¾“å‡ºä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°åçš„é¦–å­—æ¯åº”è¯¥å°å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeStyleGuide</span>(<span class="params"></span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> makeStyleGuide;</div></pre></td></tr></table></figure>
<p>å¦‚æœæ¨¡å—é»˜è®¤è¾“å‡ºä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡åçš„é¦–å­—æ¯åº”è¯¥å¤§å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> StyleGuide = &#123;</div><div class="line">  <span class="attr">es6</span>: &#123;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> StyleGuide;</div></pre></td></tr></table></figure>
<h2 id="ESLintçš„ä½¿ç”¨"><a href="#ESLintçš„ä½¿ç”¨" class="headerlink" title="ESLintçš„ä½¿ç”¨"></a>ESLintçš„ä½¿ç”¨</h2><p>ESLintæ˜¯ä¸€ä¸ªè¯­æ³•è§„åˆ™å’Œä»£ç é£æ ¼çš„æ£€æŸ¥å·¥å…·ï¼Œå¯ä»¥ç”¨æ¥ä¿è¯å†™å‡ºè¯­æ³•æ­£ç¡®ã€é£æ ¼ç»Ÿä¸€çš„ä»£ç ã€‚</p>
<p>é¦–å…ˆï¼Œå®‰è£…ESLintã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm i -g eslint</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå®‰è£…Airbnbè¯­æ³•è§„åˆ™ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm i -g eslint-config-airbnb</div></pre></td></tr></table></figure>
<p>æœ€åï¼Œåœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª<code>.eslintrc</code>æ–‡ä»¶ï¼Œé…ç½®ESLintã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"extends"</span>: <span class="string">"eslint-config-airbnb"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨å°±å¯ä»¥æ£€æŸ¥ï¼Œå½“å‰é¡¹ç›®çš„ä»£ç æ˜¯å¦ç¬¦åˆé¢„è®¾çš„è§„åˆ™ã€‚</p>
<p><code>index.js</code>æ–‡ä»¶çš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> unusued = <span class="string">'I have no purpose!'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">greet</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> message = <span class="string">'Hello, World!'</span>;</div><div class="line">    alert(message);</div><div class="line">&#125;</div><div class="line"></div><div class="line">greet();</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ESLintæ£€æŸ¥è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ eslint index.js</div><div class="line">index.js</div><div class="line">  1:5  error  unusued is defined but never used                 no-unused-vars</div><div class="line">  4:5  error  Expected indentation of 2 characters but found 4  indent</div><div class="line">  5:5  error  Expected indentation of 2 characters but found 4  indent</div><div class="line"></div><div class="line">âœ– 3 problems (3 errors, 0 warnings)</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼ŒåŸæ–‡ä»¶æœ‰ä¸‰ä¸ªé”™è¯¯ï¼Œä¸€ä¸ªæ˜¯å®šä¹‰äº†å˜é‡ï¼Œå´æ²¡æœ‰ä½¿ç”¨ï¼Œå¦å¤–ä¸¤ä¸ªæ˜¯è¡Œé¦–ç¼©è¿›ä¸º4ä¸ªç©ºæ ¼ï¼Œè€Œä¸æ˜¯è§„å®šçš„2ä¸ªç©ºæ ¼ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ç¼–ç¨‹é£æ ¼&quot;&gt;&lt;a href=&quot;#ç¼–ç¨‹é£æ ¼&quot; class=&quot;headerlink&quot; title=&quot;ç¼–ç¨‹é£æ ¼&quot;&gt;&lt;/a&gt;ç¼–ç¨‹é£æ ¼&lt;/h1&gt;&lt;p&gt;æœ¬ç« æ¢è®¨å¦‚ä½•å°†ES6çš„æ–°è¯­æ³•ï¼Œè¿ç”¨åˆ°ç¼–ç å®è·µä¹‹ä¸­ï¼Œä¸ä¼ ç»Ÿçš„JavaScriptè¯­æ³•ç»“åˆåœ¨ä¸€èµ·ï¼Œå†™å‡ºåˆç†çš„ã€æ˜“äºé˜…è¯»å’Œç»´æŠ¤çš„ä»£
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="è§„èŒƒ" scheme="http://microzz.com/tags/%E8%A7%84%E8%8C%83/"/>
    
  </entry>
  
  <entry>
    <title>ã€å¼€å‘åˆ©å™¨ã€‘ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†</title>
    <link href="http://microzz.com/2017/02/03/API/"/>
    <id>http://microzz.com/2017/02/03/API/</id>
    <published>2017-02-03T07:00:19.000Z</published>
    <updated>2017-02-06T03:31:03.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†"><a href="#ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†" class="headerlink" title="ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†"></a>ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†</h1><h3 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h3><ul>
<li><a href="#ç¬”è®°">ç¬”è®°</a></li>
<li><a href="#å‡ºè¡Œ">å‡ºè¡Œ</a></li>
<li><a href="#è¯å…¸">è¯å…¸</a></li>
<li><a href="#ç”µå•†">ç”µå•†</a></li>
<li><a href="#åœ°å›¾">åœ°å›¾</a></li>
<li><a href="#ç”µå½±">ç”µå½±</a></li>
<li><a href="#å³æ—¶é€šè®¯">å³æ—¶é€šè®¯</a></li>
<li><a href="#å¼€å‘è€…ç½‘ç«™">å¼€å‘è€…ç½‘ç«™</a></li>
<li><a href="#å¿«é€’æŸ¥è¯¢">å¿«é€’æŸ¥è¯¢</a></li>
<li><a href="#æ—…æ¸¸">æ—…æ¸¸</a></li>
<li><a href="#ç¤¾äº¤">ç¤¾äº¤</a></li>
<li><a href="#è§†é¢‘">è§†é¢‘</a></li>
<li><a href="#å¤©æ°”">å¤©æ°”</a></li>
<li><a href="#å›¢é˜Ÿåä½œ">å›¢é˜Ÿåä½œ</a></li>
<li><a href="#å›¾ç‰‡ä¸å›¾åƒå¤„ç†">å›¾ç‰‡ä¸å›¾åƒå¤„ç†</a></li>
<li><a href="#å¤–å–">å¤–å–</a></li>
<li><a href="#æ¶ˆæ¯æ¨é€">æ¶ˆæ¯æ¨é€</a></li>
<li><a href="#éŸ³ä¹">éŸ³ä¹</a></li>
<li><a href="#äº‘">äº‘</a></li>
<li><a href="#è¯­éŸ³è¯†åˆ«">è¯­éŸ³è¯†åˆ«</a></li>
<li><a href="#ç»¼åˆ">ç»¼åˆ</a></li>
</ul>
<h4 id="ç¬”è®°"><a href="#ç¬”è®°" class="headerlink" title="ç¬”è®°"></a>ç¬”è®°</h4><ul>
<li><a href="https://msdn.microsoft.com/en-us/office/office365/howto/onenote-landing" target="_blank" rel="external">OneNote</a> - OneNoteæ”¯æŒè·å–ï¼Œå¤åˆ¶ï¼Œåˆ›å»ºï¼Œæ›´æ–°ï¼Œå¯¼å…¥ä¸å¯¼å‡ºç¬”è®°ï¼Œæ”¯æŒä¸ºç¬”è®°æ·»åŠ å¤šåª’ä½“å†…å®¹ï¼Œç®¡ç†æƒé™ç­‰ã€‚æä¾›SDKå’ŒDemoã€‚</li>
<li><a href="http://www.wiz.cn/manual/plugin/" target="_blank" rel="external">ä¸ºçŸ¥ç¬”è®°</a> - ä¸ºçŸ¥ç¬”è®°Windowså®¢æˆ·ç«¯å¼€æ”¾äº†å¤§é‡çš„APIï¼Œå…¶ä¸­ç»å¤§éƒ¨åˆ†ï¼Œéƒ½é€šè¿‡COMæä¾›ï¼Œå¯ä»¥åœ¨javascript, C#, C++, Delphiç­‰è¯­è¨€ä¸­ä½¿ç”¨ã€‚æ¥å£é€šè¿‡IDL(Interface description language)è¯­è¨€æè¿°ã€‚</li>
<li><a href="https://dev.yinxiang.com/" target="_blank" rel="external">å°è±¡ç¬”è®°</a> - å°è±¡ç¬”è®°æä¾›äº†ActionScript 3, Android, C++, Windows, iOS, Java, JavaScript, OS X, Perl, PHP, Python, Rubyç­‰å¹³å°çš„SDKå’Œå®Œæ•´çš„APIå‚è€ƒæ–‡æ¡£ï¼Œå¯é€šè¿‡APIè¿›è¡Œè®¤è¯ï¼Œç¬”è®°ï¼Œç¬”è®°æœ¬ï¼Œé™„ä»¶ï¼Œæœç´¢ï¼ŒåŒæ­¥ç­‰æ“ä½œï¼ŒåŒæ—¶æä¾›ä¼ä¸šç‰ˆå’Œæœ¬åœ°APIã€‚</li>
<li><a href="http://note.youdao.com/open/" target="_blank" rel="external">æœ‰é“äº‘ç¬”è®°</a> - æœ‰é“äº‘ç¬”è®°æä¾›äº†Android SDKï¼ŒåŒæ—¶Open APIå…è®¸è¿›è¡Œæˆæƒï¼Œç”¨æˆ·ï¼Œç¬”è®°æœ¬ï¼Œç¬”è®°ï¼Œåˆ†äº«ï¼Œé™„ä»¶ç­‰æ–¹é¢çš„æ“ä½œã€‚</li>
</ul>
<h4 id="å‡ºè¡Œ"><a href="#å‡ºè¡Œ" class="headerlink" title="å‡ºè¡Œ"></a>å‡ºè¡Œ</h4><ul>
<li><a href="http://open.xiaojukeji.com/" target="_blank" rel="external">æ»´æ»´</a> - æ»´æ»´æä¾›äº†iOSå’ŒAndroid SDK, å¯å®ç°æ‹‰èµ·æ»´æ»´å«è½¦ç­‰æ–¹é¢çš„æ“ä½œã€‚</li>
<li><a href="http://developerpre.10101111.com/" target="_blank" rel="external">ç¥å·ä¸“è½¦</a> - ç¥å·ä¸“è½¦æä¾›äº†APIæ¨¡å¼å’ŒH5æ¨¡å¼ä¸¤ç§æ¥å…¥æ¨¡å¼ï¼Œå…è®¸è¿›è¡ŒåŸºç¡€ä¿¡æ¯ï¼Œè®¢å•ï¼Œæ”¯ä»˜ï¼Œå……å€¼ï¼Œç”¨æˆ·ï¼Œå‘ç¥¨ï¼Œä»£é‡‘åˆ¸ï¼Œä¼ä¸šç­‰æ–¹é¢çš„æ“ä½œã€‚</li>
<li><a href="https://developer.uber.com/" target="_blank" rel="external">Uber</a> - Uberæä¾›äº†Androidå’ŒiOSçš„SDK,å…è®¸è¿›è¡Œä¹˜å®¢ï¼Œè¡Œç¨‹ä½“éªŒï¼Œå¸æœºï¼Œæ´¾é€æ¬¡æ•°ç­‰å››å¤§æ–¹é¢çš„æ“ä½œã€‚</li>
</ul>
<h4 id="è¯å…¸"><a href="#è¯å…¸" class="headerlink" title="è¯å…¸"></a>è¯å…¸</h4><ul>
<li><a href="http://api.fanyi.baidu.com/api/trans/product/index" target="_blank" rel="external">ç™¾åº¦ç¿»è¯‘</a> - ç™¾åº¦ç¿»è¯‘æ”¯æŒå¤šç§è¯­è¨€äº’ç›¸ç¿»è¯‘ï¼ŒåŒ…å«PHP, JS, Python, C, Javaç‰ˆDemoã€‚</li>
<li><a href="https://www.microsoft.com/en-us/translator/translatorapi.aspx" target="_blank" rel="external">å¿…åº”è¯å…¸</a> - å¾®è½¯ç¿»è¯‘APIæ”¯æŒæ–‡å­—å’Œè¯­éŸ³ä¸¤ç§ç±»å‹ï¼Œæ”¯æŒå¤šç§è¯­è¨€äº’ç›¸ç¿»è¯‘ï¼Œæä¾›C#ç‰ˆæœ¬Demoã€‚</li>
<li><a href="http://open.iciba.com/?c=api" target="_blank" rel="external">é‡‘å±±è¯éœ¸</a> - é‡‘å±±è¯éœ¸å…è®¸è¿›è¡Œç®€å•çš„ç¿»è¯‘æ“ä½œã€‚</li>
<li><a href="https://www.shanbay.com/help/developer/api_v1/" target="_blank" rel="external">æ‰‡è´</a> - æ‰‡è´æä¾›äº†å®Œæ•´çš„APIï¼Œå…è®¸è¿›è¡Œç”¨æˆ·ï¼ŒæŸ¥è¯¢ï¼Œæ·»åŠ å­¦ä¹ è®°å½•ï¼Œå¿˜è®°å•è¯ï¼Œä¾‹å¥ï¼Œç¬”è®°ç­‰æ–¹é¢çš„æ“ä½œã€‚</li>
<li><a href="http://fanyi.youdao.com/openapi" target="_blank" rel="external">æœ‰é“è¯å…¸</a> - æœ‰é“è¯å…¸å…è®¸è¿›è¡Œç®€å•çš„ç¿»è¯‘æ“ä½œã€‚</li>
</ul>
<h4 id="ç”µå•†"><a href="#ç”µå•†" class="headerlink" title="ç”µå•†"></a>ç”µå•†</h4><ul>
<li><a href="http://open.dangdang.com/" target="_blank" rel="external">å½“å½“</a> - å½“å½“å…è®¸å•†å®¶ç”¨æˆ·å’Œç½‘ç«™æ¥å…¥æˆæƒï¼Œå¯è¿›è¡Œå•†å“ï¼Œè®¢å•ï¼Œå›¾ç‰‡ï¼Œé—®ç­”ï¼Œåº—é“ºå’Œä¿ƒé”€ç­‰æ–¹é¢çš„æ“ä½œã€‚</li>
<li><a href="https://jos.jd.com/api/index.htm" target="_blank" rel="external">äº¬ä¸œ</a> - äº¬ä¸œæä¾›äº†Java, PHP, .netçš„SDKï¼Œæˆæƒåå¯è¿›è¡Œå¤šç§æ“ä½œã€‚</li>
<li><a href="http://open.suning.com/ospos/apipage/toApiListMenu.do" target="_blank" rel="external">è‹å®å¼€æ”¾æœåŠ¡</a> - è‹å®æä¾›äº†Java, PHP, .Net, Pythonç‰ˆæœ¬çš„SDKï¼Œæˆæƒåå¯è¿›è¡Œå¤šç§æ“ä½œã€‚</li>
<li><a href="https://open.taobao.com/doc2/api_list.htm" target="_blank" rel="external">æ·˜å®å¼€æ”¾å¹³å°</a> - æ·˜å®æä¾›äº†Java, .Net, PHP, Pythonç‰ˆæœ¬çš„SDKï¼Œæˆæƒåæä¾›å¤šç§æ“ä½œã€‚</li>
<li><a href="https://developer.amazon.com/public/zh" target="_blank" rel="external">äºšé©¬é€Š</a> - äºšé©¬é€Šæä¾›å¤šç§è¯­è¨€ç‰ˆæœ¬çš„SDKï¼Œæˆæƒåå…è®¸å¤šç§æ“ä½œã€‚</li>
</ul>
<h4 id="åœ°å›¾"><a href="#åœ°å›¾" class="headerlink" title="åœ°å›¾"></a>åœ°å›¾</h4><ul>
<li><a href="http://lbsyun.baidu.com/" target="_blank" rel="external">ç™¾åº¦åœ°å›¾</a> - ç™¾åº¦åœ°å›¾æä¾›äº†Android, iOSç‰ˆæœ¬çš„SDKå’ŒJavaScript APIï¼Œå¯è¿›è¡Œå®šä½ã€åœ°å›¾ã€æ•°æ®ã€å‡ºè¡Œã€é¹°çœ¼è½¨è¿¹å’Œåˆ†ææœåŠ¡ã€‚</li>
<li><a href="http://lbs.amap.com/" target="_blank" rel="external">é«˜å¾·åœ°å›¾</a> - é«˜å¾·åœ°å›¾æä¾›äº†JavaScriptå’ŒwebæœåŠ¡APIï¼ŒAndroidå’ŒiOS SDKï¼Œæ”¯æŒåœ°å›¾ï¼Œå®šä½ï¼Œæœç´¢ï¼Œè·¯çº¿è§„åˆ’ï¼Œå¯¼èˆªå’Œå®¤å†…åœ°å›¾ç­‰ã€‚</li>
<li><a href="http://lbs.qq.com/" target="_blank" rel="external">è…¾è®¯åœ°å›¾</a> - è…¾è®¯åœ°å›¾æä¾›äº†JavaScript APIï¼ŒAndroidå’ŒiOS SDKï¼Œæ”¯æŒå®šä½ï¼Œåœ°å›¾ï¼Œåœ°ç‚¹æœç´¢ï¼Œè·¯çº¿å’Œå¯¼èˆªç­‰ã€‚</li>
<li><a href="http://lbs.tianditu.com/api-new/home.html" target="_blank" rel="external">å¤©åœ°å›¾</a> - å¤©åœ°å›¾æä¾›äº†H5 APIå’ŒJavaScript APIç­‰web APIï¼ŒåŒæ—¶æä¾›äº†Androidå’ŒiOS SDKï¼Œæ”¯æŒåŸºç¡€åœ°å›¾æœåŠ¡ï¼Œå›¾å±‚ç®¡ç†ï¼Œåœ°å›¾è¦†ç›–ç‰©ï¼Œåœ°å›¾å·¥å…·ï¼Œåœ°åæœç´¢å’Œå‡ºè¡Œè§„åˆ’æœåŠ¡ã€‚</li>
<li><a href="http://open.mapbar.com/" target="_blank" rel="external">å›¾å§åœ°å›¾</a> - å›¾å§æä¾›äº†JavaScriptå’ŒFlash APIï¼ŒAndroidå’ŒiOS SDKï¼Œæ”¯æŒå®šä½ï¼Œåœ°å€è§£æï¼Œä½ç½®æ ‡æ³¨ï¼Œä½ç½®æˆªå›¾ï¼Œè·¯çº¿è§„åˆ’ï¼Œå‘¨è¾¹æŸ¥è¯¢ï¼Œå…´è¶£ç‚¹æœç´¢å’Œåœ¨çº¿å¯¼èˆªã€‚</li>
</ul>
<h4 id="ç”µå½±"><a href="#ç”µå½±" class="headerlink" title="ç”µå½±"></a>ç”µå½±</h4><ul>
<li><a href="https://developers.douban.com/wiki/?title=movie_v2" target="_blank" rel="external">è±†ç“£ç”µå½±</a> - è±†ç“£ç”µå½±æ”¯æŒç”µå½±æ¡ç›®ï¼Œå½±äººæ¡ç›®ï¼Œæœç´¢å’Œæ¦œå•ç­‰ã€‚</li>
<li><a href="http://www.jianshu.com/p/9855610eb1d4" target="_blank" rel="external">çŒ«çœ¼ç”µå½±(éå®˜æ–¹)</a> - æ”¯æŒæŸ¥è¯¢é¦–é¡µç”µå½±åˆ—è¡¨ï¼Œç”µå½±è¯¦æƒ…(å«è¯„è®º)ï¼Œæœ¬åœ°å½±é™¢å’Œå½±é™¢è¯¦æƒ…ï¼Œé€‰åº§ã€‚ #éå®˜æ–¹</li>
<li><a href="https://github.com/avenwu/vplus/blob/master/doc/v%E7%94%B5%E5%BD%B1api%E6%8E%A5%E5%8F%A3.md" target="_blank" rel="external">Vç”µå½±(éå®˜æ–¹)</a> - æ”¯æŒè·å–<a href="http://www.vmovier.com/" target="_blank" rel="external">Vç”µå½±</a>ç½‘ç«™çš„æ•°æ®ã€‚ #éå®˜æ–¹</li>
<li><a href="https://github.com/jokermonn/-Api/blob/master/Time.md" target="_blank" rel="external">Timeæ—¶å…‰(éå®˜æ–¹)</a> - æ”¯æŒè·å–<a href="http://www.mtime.com/" target="_blank" rel="external">æ—¶å…‰ç½‘</a>ç½‘ç«™æ•°æ®ã€‚ #éå®˜æ–¹</li>
</ul>
<h4 id="å³æ—¶é€šè®¯"><a href="#å³æ—¶é€šè®¯" class="headerlink" title="å³æ—¶é€šè®¯"></a>å³æ—¶é€šè®¯</h4><ul>
<li><a href="http://www.easemob.com/" target="_blank" rel="external">ç¯ä¿¡</a> - æ”¯æŒAndroid, iOS, WebIM, Linux, RESTé›†æˆï¼Œæ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ã€‚</li>
<li><a href="http://rongcloud.cn/" target="_blank" rel="external">èäº‘</a> - æ”¯æŒAndroid, iOS, Web, æ¸¸æˆé›†æˆï¼Œæ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ã€‚</li>
<li><a href="http://netease.im/" target="_blank" rel="external">ç½‘æ˜“äº‘ä¿¡</a> - æ”¯æŒIMå®æ—¶é€šè®¯ï¼Œå®æ—¶éŸ³è§†é¢‘ï¼Œæ•™å­¦ç™½ç­ï¼Œä¸“çº¿ç”µè¯ï¼ŒçŸ­ä¿¡ï¼ŒèŠå¤©å®¤ï¼Œæä¾›iOS, Android, Windowså’ŒWeb SDKã€‚</li>
<li><a href="https://www.qcloud.com/product/im" target="_blank" rel="external">è…¾è®¯äº‘é€šä¿¡IM</a> - æä¾›iOS, Android, Windowså’ŒWeb SDKï¼Œæ”¯æŒå¤šç§æ¶ˆæ¯ç±»å‹ã€‚</li>
</ul>
<h4 id="å¼€å‘è€…ç½‘ç«™"><a href="#å¼€å‘è€…ç½‘ç«™" class="headerlink" title="å¼€å‘è€…ç½‘ç«™"></a>å¼€å‘è€…ç½‘ç«™</h4><ul>
<li><a href="https://open.coding.net/" target="_blank" rel="external">Coding</a> - æˆæƒåå¯è®¿é—®coding.netç½‘ç«™çš„å†…å®¹ã€‚</li>
<li><a href="http://gank.io/api" target="_blank" rel="external">å¹²è´§é›†ä¸­è¥</a> - æä¾›å¦¹å­å›¾å’ŒAndroid, iOS, å‰ç«¯ï¼Œæ‹“å±•èµ„æºç­‰å†…å®¹ã€‚</li>
<li><a href="https://www.diycode.cc/api" target="_blank" rel="external">diycode</a> - æˆæƒåå¯è®¿é—®diycodeç½‘ç«™çš„å†…å®¹ã€‚</li>
<li><a href="http://www.oschina.net/openapi" target="_blank" rel="external">å¼€æºä¸­å›½</a> - æˆæƒåå¯è®¿é—®å¼€æºä¸­å›½ç½‘ç«™çš„å†…å®¹ã€‚</li>
<li><a href="https://laravel-china.org/topics/3097" target="_blank" rel="external">Laravel China</a> - æˆæƒåå¯è®¿é—® Laravel China ç½‘ç«™çš„å†…å®¹ã€‚</li>
<li><a href="https://ruby-china.org/api-doc/" target="_blank" rel="external">Ruby China</a> - æˆæƒåå¯è®¿é—®Ruby Chinaç½‘ç«™çš„å†…å®¹ã€‚</li>
<li><a href="https://www.v2ex.com/p/7v9TEc53" target="_blank" rel="external">V2EX</a> - å¯è®¿é—®V2EXç½‘ç«™çš„å†…å®¹ã€‚</li>
</ul>
<h4 id="å¿«é€’æŸ¥è¯¢"><a href="#å¿«é€’æŸ¥è¯¢" class="headerlink" title="å¿«é€’æŸ¥è¯¢"></a>å¿«é€’æŸ¥è¯¢</h4><ul>
<li><a href="http://www.aikuaidi.cn/api/" target="_blank" rel="external">çˆ±å¿«é€’</a> - çˆ±å¿«é€’æ”¯æŒå›½å†…90å¤šå®¶å¿«é€’ç‰©æµè®¢å•æŸ¥è¯¢æœåŠ¡ï¼Œå…è´¹ç‰ˆæœ‰ä½¿ç”¨æ¬¡æ•°é™åˆ¶ï¼Œå¯ç”¨äºç”µå­å•†åŸå•å·è·Ÿè¸ª,æ‰‹æœºåº”ç”¨,å¾®ä¿¡å¿«é€’æ¥å£ç­‰æœåŠ¡ã€‚</li>
<li><a href="http://www.kuaidi100.com/openapi/" target="_blank" rel="external">å¿«é€’100</a> - å¿«é€’100æ”¯æŒ300å®¶å›½å†…å›½é™…å¿«é€’ï¼Œå…è´¹ç‰ˆæœ‰ä½¿ç”¨æ¬¡æ•°é™åˆ¶ã€‚</li>
<li><a href="http://www.kdniao.com/" target="_blank" rel="external">å¿«é€’é¸Ÿ</a> - å¿«é€’é¸Ÿæ”¯æŒå›½å†…å¤–400å¤šå®¶å¿«é€’å…¬å¸ï¼Œå…è´¹ç‰ˆæœ‰ä½¿ç”¨æ¬¡æ•°é™åˆ¶ï¼ŒåŒ…å«.Net, PHP, Javaç‰ˆDemoã€‚</li>
<li><a href="http://www.kuaidi.com/openapi.html" target="_blank" rel="external">å¿«é€’ç½‘</a> - å¿«é€’ç½‘æ”¯æŒä¸Šç™¾å®¶å¿«é€’æŸ¥è¯¢æœåŠ¡ï¼Œå…è´¹ç‰ˆæœ‰ä½¿ç”¨æ¬¡æ•°é™åˆ¶ã€‚</li>
</ul>
<h4 id="æ—…æ¸¸"><a href="#æ—…æ¸¸" class="headerlink" title="æ—…æ¸¸"></a>æ—…æ¸¸</h4><ul>
<li><a href="http://open.qunar.com/" target="_blank" rel="external">å»å“ªå„¿</a> - æ”¯æŒè·å–å»å“ªå„¿ç½‘çš„å†…å®¹ã€‚</li>
<li><a href="http://open.tuniu.cn/" target="_blank" rel="external">é€”ç‰›</a> - æ”¯æŒé€”ç‰›ç½‘çš„å†…å®¹ï¼Œä»…å¼€æ”¾ç»™ä¾›åº”å•†ç³»ç»Ÿã€‚</li>
<li><a href="http://u.ctrip.com/union/help/Termsofuse.aspx" target="_blank" rel="external">æºç¨‹</a> - æ”¯æŒæºç¨‹ç½‘çš„å†…å®¹ã€‚</li>
<li><a href="http://open.elong.com/wiki/API%E6%96%87%E6%A1%A3" target="_blank" rel="external">è‰ºé¾™</a> - æ”¯æŒè·å–äº§å“æ•°æ®ï¼Œå®Œæˆç”¨æˆ·çš„é¢„è®¢ï¼Œè¿›è¡Œè®¢å•æŸ¥è¯¢ã€æ›´æ”¹æˆ–å–æ¶ˆã€‚æä¾›åœ¨çº¿å·¥å…·ï¼Œä»¥åŠH5, Java, C#, PHP, Rubyç‰ˆæœ¬çš„Demoã€‚</li>
<li><a href="https://github.com/jokermonn/-Api/blob/master/12306.md" target="_blank" rel="external">12306(éå®˜æ–¹)</a> - æ”¯æŒè·å–12306ç«è½¦ç¥¨ç¥¨æ•°ã€ç¥¨ä»·æŸ¥è¯¢ã€‚ #éå®˜æ–¹</li>
</ul>
<h4 id="ç¤¾äº¤"><a href="#ç¤¾äº¤" class="headerlink" title="ç¤¾äº¤"></a>ç¤¾äº¤</h4><ul>
<li><a href="https://open-doc.dingtalk.com/" target="_blank" rel="external">é’‰é’‰</a> - æ”¯æŒå…ç™»ï¼Œä¼ä¸šé€šè®¯å½•ï¼ŒæœåŠ¡çª—ï¼Œé’‰ç›˜ï¼Œåœ°å›¾ï¼Œä¼šè¯ï¼ŒDINGï¼Œç”µè¯ï¼ŒéŸ³é¢‘ï¼Œæ‰«ç ï¼Œæ”¯ä»˜ï¼Œåˆ†äº«ç­‰æœåŠ¡ï¼Œæä¾›SDKå’ŒDemoï¼ŒPCç‰ˆUIè§„èŒƒï¼Œè°ƒè¯•å·¥å…·å’Œé’‰é’‰UIç»„ä»¶åº“ã€‚</li>
<li><a href="https://developers.douban.com/wiki/?title=guide" target="_blank" rel="external">è±†ç“£</a> - æ”¯æŒå›¾ä¹¦ï¼Œç”µå½±ï¼ŒéŸ³ä¹ï¼ŒåŒåŸï¼Œå¹¿æ’­ï¼Œç”¨æˆ·ï¼Œæ—¥è®°ï¼Œç›¸å†Œï¼Œçº¿ä¸Šæ´»åŠ¨ï¼Œè®ºå›ï¼Œå›å¤å’Œæˆ‘å»ç­‰åŠŸèƒ½ï¼Œæä¾›è±†ç“£ç»„ä»¶ï¼Œè±†ç“£æ ‡ç¤ºå’ŒDemoã€‚</li>
<li><a href="http://open.kaixin001.com/document.php" target="_blank" rel="external">å¼€å¿ƒç½‘</a> - æ”¯æŒç”¨æˆ·ä¿¡æ¯ï¼Œç™»å½•æˆæƒï¼Œå¥½å‹ï¼Œä¼ æ’­åº”ç”¨ï¼Œæ”¯ä»˜ï¼Œåˆ†äº«å†…å®¹ï¼Œæ¶ˆæ¯ï¼Œäº¤äº’ï¼Œå¼€å¿ƒç½‘åº”ç”¨ç­‰å†…å®¹ï¼Œæä¾›SDKï¼Œå¼€æºæ’ä»¶å’Œæ ‡ç¤ºç´ æã€‚</li>
<li><a href="http://wiki.connect.qq.com/api%E5%88%97%E8%A1%A8" target="_blank" rel="external">QQäº’è”</a> - æ”¯æŒç”¨æˆ·èµ„æ–™ï¼ŒQQä¼šå‘˜ä¿¡æ¯ï¼Œç©ºé—´ç›¸å†Œï¼Œè…¾è®¯å¾®åšèµ„æ–™ï¼Œåˆ†äº«åˆ°è…¾è®¯å¾®åšï¼Œå¾®åšå¥½å‹ä¿¡æ¯ï¼Œè´¢ä»˜é€šä¿¡æ¯ç­‰å†…å®¹ï¼Œæä¾›SDK, Demo, ä»¥åŠè®¾è®¡èµ„æºã€‚</li>
<li><a href="http://open.weibo.com/wiki/API" target="_blank" rel="external">å¾®åš</a> - æ”¯æŒç²‰ä¸æœåŠ¡ï¼Œå¾®åšï¼Œè¯„è®ºï¼Œç”¨æˆ·ï¼Œå…³ç³»ï¼Œè´¦å·ï¼Œæ”¶è—ï¼Œæœç´¢ï¼Œæé†’ï¼ŒçŸ­é“¾ï¼Œå…¬å…±æœåŠ¡ï¼Œä½ç½®æœåŠ¡ï¼Œåœ°ç†ä¿¡æ¯ï¼Œåœ°å›¾å¼•æ“ï¼Œæ”¯ä»˜ä»¥åŠOAuth2.0æˆæƒç­‰å†…å®¹ï¼Œæä¾›å¾®åšæ ‡ç¤ºåŠSDKã€‚</li>
<li><a href="https://open.weixin.qq.com/" target="_blank" rel="external">å¾®ä¿¡</a> - æ”¯æŒç§»åŠ¨åº”ç”¨ï¼Œç½‘ç«™åº”ç”¨ï¼Œå…¬ä¼—è´¦å·ï¼Œå…¬ä¼—å·ç¬¬ä¸‰æ–¹å¹³å°ç­‰å†…å®¹ï¼Œæä¾›SDK, Demo, ä»¥åŠè®¾è®¡èµ„æºã€‚</li>
</ul>
<h4 id="è§†é¢‘"><a href="#è§†é¢‘" class="headerlink" title="è§†é¢‘"></a>è§†é¢‘</h4><ul>
<li><a href="http://open.iqiyi.com/" target="_blank" rel="external">çˆ±å¥‡è‰º</a> - æ”¯æŒå¼¹å¹•ï¼Œå…¨è‰²å½©æ’­æ”¾å™¨ï¼Œé«˜æ¸…ç æµï¼Œè§†é¢‘æ‰˜ç®¡ï¼Œæ’­æ”¾çˆ±å¥‡è‰ºè§†é¢‘ï¼Œåº”ç”¨åˆ†å‘ï¼ŒIOCPç­‰å†…å®¹ã€‚</li>
<li><a href="https://github.com/fython/BilibiliAPIDocs" target="_blank" rel="external">Bilibili(éå®˜æ–¹)</a> - æ”¯æŒç™»å½•ï¼Œæˆ‘çš„ä¿¡æ¯ï¼Œç•ªå‰§ä¸“é¢˜ï¼Œè§†é¢‘/ä¸“é¢˜æ”¶è—ã€å…³æ³¨ï¼Œç•ªå‰§ï¼Œå¼¹å¹•ç­‰ã€‚ #éå®˜æ–¹</li>
<li><a href="http://www.lecloud.com/zh-cn/help/api.html" target="_blank" rel="external">ä¹è§†</a> - æ”¯æŒæ ‡å‡†ç›´æ’­ï¼Œæ ‡å‡†ç‚¹æ’­ï¼Œè§†é¢‘å‘è¡Œå¹³å°ï¼Œç§»åŠ¨ç›´æ’­ç­‰å†…å®¹ï¼Œæä¾›SDKä¸‹è½½ã€‚</li>
<li><a href="http://lm.tv.sohu.com/union/open_platform.do" target="_blank" rel="external">æœç‹è§†é¢‘</a> - æ”¯æŒä¸€äºŒçº§å†…å®¹è·å–ï¼Œå†…å®¹åˆ†ç±»è·å–ï¼Œè§†é¢‘è¯¦æƒ…ä¿¡æ¯ï¼Œä¸“è¾‘è¯¦æƒ…ä¿¡æ¯ï¼Œåˆ†çº§åˆ—è¡¨è·å–ï¼Œå…³é”®è¯æœç´¢ç­‰å†…å®¹ã€‚</li>
<li><a href="http://api.tudou.com/apidoc/index.php/%E9%A6%96%E9%A1%B5" target="_blank" rel="external">åœŸè±†</a> - æ”¯æŒè§†é¢‘æ¨¡å—ï¼Œè±†å•æ¨¡å—ï¼Œå½±è§†åº“æ¨¡å—ï¼Œç”¨æˆ·æ¨¡å—ï¼Œè½¬å¸–æ¨¡å—ï¼Œå­—æ®µå®šä¹‰æ¨¡å—ç­‰å†…å®¹ã€‚</li>
<li><a href="http://doc.open.youku.com/?spm=0.0.0.0.fOn6ND" target="_blank" rel="external">ä¼˜é…·</a> - æ”¯æŒå†…å®¹è¾“å‡ºï¼Œè§†é¢‘æœç´¢ï¼Œæ™ºèƒ½æ¨èï¼Œç”¨æˆ·ç™»å½•ï¼Œç”¨æˆ·äº’åŠ¨ï¼Œç”¨æˆ·ä¿¡æ¯ï¼Œè§†é¢‘ä¸Šä¼ è‡³ä¼˜é…·ï¼Œè§†é¢‘äº’åŠ¨ç­‰å†…å®¹ï¼Œæä¾›SDKã€‚</li>
</ul>
<h4 id="å¤©æ°”"><a href="#å¤©æ°”" class="headerlink" title="å¤©æ°”"></a>å¤©æ°”</h4><ul>
<li><a href="http://wiki.swarma.net/index.php/%E5%BD%A9%E4%BA%91%E5%A4%A9%E6%B0%94API/v2" target="_blank" rel="external">å½©äº‘å¤©æ°”</a> - æ”¯æŒå…¨çƒå¤©æ°”æ•°æ®ï¼Œä¸¤ç§ç©ºæ°”è´¨é‡æ•°æ®ï¼Œå¤©æ°”é¢„æŠ¥ï¼Œå®å†µå¤©æ°”ï¼Œç‹¬å®¶é™æ°´é¢„æŠ¥ï¼Œç‹¬å®¶ç©ºæ°”è´¨é‡é¢„æŠ¥ï¼Œå…­ç§å¤©æ°”æ•°æ®ï¼Œå››ç§ç”Ÿæ´»æŒ‡æ•°æ•°æ®ç­‰å†…å®¹ï¼Œéƒ¨åˆ†åŠŸèƒ½æ”¶è´¹ã€‚</li>
<li><a href="http://www.kancloud.cn/hefengyun/weather/222344" target="_blank" rel="external">å’Œé£å¤©æ°”</a> - æ”¯æŒ7-10å¤©é¢„æŠ¥ï¼Œå®å†µå¤©æ°”ï¼Œæ¯å°æ—¶é¢„æŠ¥ï¼Œç”Ÿæ´»æŒ‡æ•°ï¼Œç¾å®³é¢„è­¦ï¼Œæ™¯ç‚¹å¤©æ°”ï¼Œå†å²å¤©æ°”ï¼ŒåŸå¸‚æŸ¥è¯¢ç­‰å†…å®¹ï¼Œä»…å›½å†…æ•°æ®å…è´¹ã€‚</li>
<li><a href="http://www.thinkpage.cn/doc" target="_blank" rel="external">å¿ƒçŸ¥å¤©æ°”</a> - æ”¯æŒå¤©æ°”å®å†µï¼Œé€æ—¥é¢„æŠ¥å’Œå†å²ï¼Œ24å°æ—¶é€å°æ—¶é¢„æŠ¥ï¼Œè¿‡å»24å°æ—¶å¤©æ°”å†å²è®°å½•ï¼Œæ°”è±¡ç¾å®³é¢„è­¦ï¼Œç©ºæ°”è´¨é‡å®å†µä¸åŸå¸‚æ’è¡Œï¼Œé€æ—¥å’Œé€å°æ—¶ç©ºæ°”è´¨é‡é¢„æŠ¥ï¼Œè¿‡å»24å°æ—¶ç©ºæ°”è´¨é‡å†å²è®°å½•ï¼Œç”Ÿæ´»æŒ‡æ•°ï¼Œå†œå†ã€èŠ‚æ°”ã€ç”Ÿè‚–ï¼ŒæœºåŠ¨è½¦å°¾å·é™è¡Œï¼Œæ—¥å‡ºæ—¥è½ï¼Œæœˆåˆæœˆè½å’Œæœˆåƒï¼ŒåŸå¸‚æœç´¢ç­‰å†…å®¹ï¼Œä»…å›½å†…æ•°æ®å…è´¹ã€‚</li>
</ul>
<h4 id="å›¢é˜Ÿåä½œ"><a href="#å›¢é˜Ÿåä½œ" class="headerlink" title="å›¢é˜Ÿåä½œ"></a>å›¢é˜Ÿåä½œ</h4><ul>
<li><a href="https://www.teambition.com/developer/open-platform" target="_blank" rel="external">Teambition</a> - æ”¯æŒè¯¦ç»†çš„æ–‡æ¡£è¯´æ˜ï¼Œéƒ¨åˆ†å¹³å°æä¾›demoã€‚</li>
</ul>
<h4 id="å›¾ç‰‡ä¸å›¾åƒå¤„ç†"><a href="#å›¾ç‰‡ä¸å›¾åƒå¤„ç†" class="headerlink" title="å›¾ç‰‡ä¸å›¾åƒå¤„ç†"></a>å›¾ç‰‡ä¸å›¾åƒå¤„ç†</h4><ul>
<li><a href="https://www.v2ex.com/t/157267" target="_blank" rel="external">Bingæ¯æ—¥å£çº¸(éå®˜æ–¹)</a> - æ”¯æŒå›¾ç‰‡URLå’Œå›¾ç‰‡æè¿°ï¼Œå¯è·å–ä¸åŒåœ°åŒºçš„æ•°æ®ã€‚ #éå®˜æ–¹</li>
<li><a href="https://github.com/pinguo/PGSkinPrettifyEngine" target="_blank" rel="external">Camera360</a> - æ”¯æŒå…¨å¸§ç‡ç›´æ’­ç¾ç™½æ»¤é•œï¼Œæä¾›SDKå’ŒDemoã€‚</li>
<li><a href="http://imgsdk.com/" target="_blank" rel="external">å—¨å›¾</a> - æ”¯æŒå›¾ç‰‡æ ‡æ³¨ï¼Œä»…æä¾›iOSç‰ˆæœ¬SDKã€‚</li>
<li><a href="https://dev.camcard.com/?language=zh-cn" target="_blank" rel="external">åç‰‡å…¨èƒ½ç‹</a> - æ”¯æŒç²¾å‡†è¯†åˆ«å‡ åç§è¯­è¨€çš„åç‰‡ï¼Œè‡ªåŠ¨åˆ‡è¾¹å¹¶ç¾åŒ–åç‰‡å›¾åƒï¼Œè‡ªåŠ¨è¿”å›è¯†åˆ«ç»“æœï¼Œæä¾›å¤šç§ç‰ˆæœ¬SDKï¼Œæ”¶è´¹ã€‚</li>
<li><a href="http://www.intsig.com/zh/products/camcard_for_id" target="_blank" rel="external">ä¼ä¸šè¯ä»¶è¯†åˆ«</a> - æ”¯æŒèº«ä»½è¯ï¼Œé©¾é©¶è¯ï¼ŒæŠ¤ç…§ç­‰ï¼Œæ”¶è´¹ã€‚</li>
<li><a href="https://dev.camscanner.com/?language=zh-cn" target="_blank" rel="external">æ‰«æå…¨èƒ½ç‹</a> - æ”¯æŒå›¾åƒæ™ºèƒ½å‰ªè£ï¼Œäº”ç§å›¾åƒå¢å¼ºæ¨¡å¼ï¼Œæ‰‹åŠ¨è°ƒèŠ‚å›¾åƒç»†èŠ‚ï¼Œè‡ªåŠ¨è¿”å›æ‰«æç»“æœç­‰ï¼Œæä¾›iOSä¸Androidç‰ˆæœ¬SDKï¼Œæ”¶è´¹ã€‚</li>
<li><a href="http://api1.wozhitu.com/" target="_blank" rel="external">æˆ‘çŸ¥å›¾</a> - æ”¯æŒç›¸ä¼¼å›¾åƒæœç´¢ï¼Œå›¾åƒè¯†åˆ«åŒ¹é…ï¼Œå›¾åƒè¯†åˆ«å…³é”®è¯æ¨èï¼Œé‡å¤å›¾ç‰‡æ¢æµ‹ç­‰å†…å®¹ã€‚</li>
<li><a href="http://www.intsig.com/zh/products/creditcard" target="_blank" rel="external">é“¶è¡Œå¡|ä¿¡ç”¨å¡è¯†åˆ«</a> - æä¾›SDKå’ŒAPIï¼Œæ”¶è´¹ã€‚</li>
</ul>
<h4 id="å¤–å–"><a href="#å¤–å–" class="headerlink" title="å¤–å–"></a>å¤–å–</h4><ul>
<li><a href="http://dev.waimai.baidu.com/" target="_blank" rel="external">ç™¾åº¦å¤–å–</a> - æ”¯æŒå•†æˆ·ï¼Œèœå“ï¼Œå•†å“ï¼Œè®¢å•å’ŒåŸºç¡€æ•°æ®ç­‰å†…å®¹ï¼Œæä¾›SDKå’ŒDemoã€‚</li>
<li><a href="http://developer.dianping.com/" target="_blank" rel="external">å¤§ä¼—ç‚¹è¯„</a> - æ”¯æŒå•†æˆ·ï¼Œå›¢è´­ï¼Œåœ¨çº¿é¢„å®šï¼Œå•†å“ç‚¹è¯„ï¼Œæ•°æ®ç»Ÿè®¡ï¼Œå…ƒæ•°æ®ç­‰å†…å®¹ã€‚</li>
<li><a href="http://openapi.eleme.io/v2/quickstart.html" target="_blank" rel="external">é¥¿äº†ä¹ˆ</a> - æ”¯æŒæŸ¥è¯¢ï¼Œé¢„å®šï¼Œè®¢å•ï¼Œå…¶ä»–è®¢å•ï¼Œæ•°æ®æ¨é€ï¼Œæ”¯ä»˜ï¼Œè¯„ä»·ï¼Œæ´»åŠ¨ï¼Œè´¦æˆ·åŒæ­¥ï¼Œæ•°æ®è½åœ°åŒæ­¥ç­‰å†…å®¹ã€‚</li>
<li><a href="http://developer.waimai.meituan.com/doc/show" target="_blank" rel="external">ç¾å›¢å¤–å–</a> - æ”¯æŒé—¨åº—ï¼Œé…é€èŒƒå›´ï¼Œèœå“ï¼Œè¯å“ï¼Œè®¢å•ï¼Œè®¢å•æ¨é€ç­‰å†…å®¹ã€‚</li>
</ul>
<h4 id="æ¶ˆæ¯æ¨é€"><a href="#æ¶ˆæ¯æ¨é€" class="headerlink" title="æ¶ˆæ¯æ¨é€"></a>æ¶ˆæ¯æ¨é€</h4><ul>
<li><a href="http://push.baidu.com/doc/restapi/restapi" target="_blank" rel="external">ç™¾åº¦äº‘æ¨é€</a> - æ”¯æŒiOS, Androidå’ŒæœåŠ¡å™¨ç«¯ï¼Œæ”¯æŒæ¨é€ï¼Œç»Ÿè®¡ï¼Œç»„ç®¡ç†ç­‰Rest APIæ¥å£ã€‚æœåŠ¡å™¨ç«¯æ”¯æŒJava, Python, PHP, REST APIã€‚æä¾›æ‰€æ”¯æŒå„è¯­è¨€ç‰ˆæœ¬çš„SDKã€‚</li>
<li><a href="http://developer.huawei.com/push" target="_blank" rel="external">åä¸ºæ¨é€</a> - æ”¯æŒAndroidï¼Œæä¾›SDKã€‚</li>
<li><a href="https://docs.jiguang.cn/jpush/server/push/rest_api_v3_push/" target="_blank" rel="external">æå…‰</a> - æ”¯æŒAndroid, iOS, WindowsPhone, æœåŠ¡å™¨ç«¯REST API, æä¾›Java, Python, PHP, Ruby, C#, Node.jsç­‰ç‰ˆæœ¬çš„SDKã€‚</li>
<li><a href="https://leancloud.cn/docs/push_guide.html" target="_blank" rel="external">LeanCloud</a> - æ”¯æŒAndroid, iOS, WindowsPhoneå’ŒWebç½‘é¡µæ¨é€ï¼Œä½¿ç”¨äº‘å¼•æ“å’ŒJavaScriptåˆ›å»ºæ¨é€ï¼Œä½¿ç”¨REST APIæ¨é€æ¶ˆæ¯ã€‚æä¾›Objectvie-C(å¼€æ”¾æºç ), JavaScript(å¼€æ”¾æºç ), Android, Unity, .Net, WindowsPhone, Java(å¼€æ”¾æºç ), Python(å¼€æ”¾æºç ), PHP(å¼€æ”¾æºç ), C++(å¼€æ”¾æºç ), Swift(å¼€æ”¾æºç )ç‰ˆæœ¬SDKã€‚åŒæ—¶æä¾›Demoã€‚</li>
<li><a href="http://xg.qq.com/" target="_blank" rel="external">è…¾è®¯ä¿¡é¸½</a> - æ”¯æŒiOSå’ŒAndroidå¹³å°ï¼ŒæœåŠ¡å™¨ç«¯é‡‡ç”¨Rest API, åŒæ—¶æœåŠ¡å™¨ç«¯æ”¯æŒJava, PHP, Pythonç­‰è¯­è¨€å¹¶æä¾›SDKã€‚</li>
<li><a href="http://dev.xiaomi.com/console/appservice/push.html" target="_blank" rel="external">å°ç±³</a> - æ”¯æŒAndroidå’ŒiOSå¹³å°ï¼ŒæœåŠ¡å™¨ç«¯æ”¯æŒJava, Pythonå¹¶æä¾›SDKã€‚</li>
<li><a href="http://dev.umeng.com/push/android/api-doc" target="_blank" rel="external">å‹ç›Ÿ</a> - æ”¯æŒAndroidå’ŒiOSå¹³å°ï¼ŒæœåŠ¡å™¨ç«¯æ”¯æŒPHP, Java, Pythonå¹¶æä¾›SDKã€‚</li>
</ul>
<h4 id="éŸ³ä¹"><a href="#éŸ³ä¹" class="headerlink" title="éŸ³ä¹"></a>éŸ³ä¹</h4><ul>
<li><a href="https://my.oschina.net/skiden/blog/102025" target="_blank" rel="external">ç™¾åº¦éŸ³ä¹(éå®˜æ–¹)</a> - æ”¯æŒé¢‘é“æ­Œæ›²åˆ—è¡¨ï¼Œä¸“è¾‘çš„æ­Œæ›²åˆ—è¡¨ï¼Œæ­Œæ›²çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ­Œæ‰‹ä¸“è¾‘ä¿¡æ¯ï¼Œæœç´¢ï¼Œæ­Œæ‰‹çš„æ‰€æœ‰æ­Œæ›²ï¼Œæ’è¡Œæ¦œï¼Œæ‰€æœ‰ä¸“è¾‘ï¼Œæ‰€æœ‰æ­Œæ‰‹ï¼Œæ­Œæ‰‹çš„ä¸“è¾‘åˆ—è¡¨ï¼Œæ­Œæ‰‹ä¿¡æ¯ï¼Œæ­Œè¯æœç´¢ï¼Œæ­Œæ›²æ–‡ä»¶è¯¦ç»†ä¿¡æ¯ã€‚ #éå®˜æ–¹</li>
<li><a href="https://developers.douban.com/wiki/?title=music_v2" target="_blank" rel="external">è±†ç“£éŸ³ä¹</a> - æ”¯æŒéŸ³ä¹ä¿¡æ¯ï¼Œè¯„è®ºä¿¡æ¯ï¼Œæ ‡ç­¾ä¿¡æ¯ï¼Œæœç´¢éŸ³ä¹ï¼ŒæŸä¸ªéŸ³ä¹ä¸­æ ‡è®°æœ€å¤šçš„æ ‡ç­¾ï¼Œå‘è¡¨ã€ä¿®æ”¹ã€åˆ é™¤è¯„è®ºï¼Œç”¨æˆ·å¯¹éŸ³ä¹çš„æ‰€æœ‰æ ‡ç­¾ç­‰å†…å®¹ã€‚</li>
<li><a href="https://github.com/kaolafm/api" target="_blank" rel="external">è€ƒæ‹‰FM</a> - æ”¯æŒè·å–æŒ‡å®šåˆ†ç±»ä¸‹åˆ—è¡¨å’Œå†…å®¹ï¼Œæœç´¢æŒ‡å®šå…³é”®å­—å†…å®¹ï¼Œä¸“è¾‘/ç”µå°/ç›´æ’­è¯¦æƒ…ï¼ŒæŒ‡å®šä¸“è¾‘ä¸‹åˆ—è¡¨ï¼ŒæŒ‡å®šç”µå°æ’­å•ï¼Œåˆ†ç±»ä¸‹ä¸“è¾‘TOP50ï¼ŒæŒ‡å®šæœŸ(ç¢ç‰‡)æ‰€åœ¨ä¸“è¾‘æœ€æ–°åˆ†é¡µåŠŸèƒ½ï¼Œåˆ†ç±»ä¸‹å…¨éƒ¨ç›´æ’­è®¡åˆ’ï¼Œç‰ˆæœ¬å‡çº§æ¥å£ï¼Œæ’è¡Œæ¦œï¼Œç²¾é€‰ï¼Œä¼ ç»Ÿç”µå°åˆ—è¡¨/è¯¦æƒ…/åœ°åŒºç­‰ã€‚</li>
<li><a href="http://119.29.39.252/index.php/2016/10/20/1-2/" target="_blank" rel="external">é…·ç‹—éŸ³ä¹(éå®˜æ–¹)</a> - æ”¯æŒæœç´¢ï¼Œå„ç§æ’è¡Œæ¦œï¼Œæ­Œæ‰‹ä¸“è¾‘ä¿¡æ¯ï¼Œä¸‹è½½å’Œè·å–æ’­æ”¾åœ°å€ã€‚ #éå®˜æ–¹</li>
<li><a href="http://wq.qq.com/" target="_blank" rel="external">ä¼é¹…FM</a> - æ”¯æŒè·å–ç”µå°åˆ†ç±»åˆ—è¡¨ï¼Œç”µå°åˆ†ç±»ä¸‹çš„ä¸“è¾‘ä¿¡æ¯åˆ—è¡¨ï¼Œä¸“è¾‘ä¸‹èŠ‚ç›®ä¿¡æ¯åˆ—è¡¨ï¼Œç”µå°èŠ‚ç›®æ’­æ”¾é“¾æ¥ï¼Œæœç´¢å…³é”®å­—ç›¸å…³ä¸»æ’­/ä¸“è¾‘/èŠ‚ç›®ï¼Œä¸»æ’­åä¸‹ä¸“è¾‘ï¼Œç‰¹å®šæ—¶é—´æ®µå†…æ–°å¢ä¸»æ’­/æ›´æ–°çš„ä¸“è¾‘/æ–°å¢çš„ä¸“è¾‘ç­‰ã€‚</li>
<li><a href="https://github.com/ccchangkong/article/issues/23" target="_blank" rel="external">QQéŸ³ä¹(éå®˜æ–¹)</a> - æ”¯æŒæ­Œæ›²æ¦œå•ï¼Œæ­Œæ›²/æ­Œè¯åœ°å€ï¼Œæ­Œæ›²å›¾ç‰‡ã€‚ #éå®˜æ–¹</li>
<li><a href="http://open.qingting.fm/" target="_blank" rel="external">èœ»èœ“FM</a> - æ”¯æŒOAuth2.0æˆæƒï¼ŒéŸ³é¢‘æ•°æ®ä¸­å¿ƒï¼Œåˆ†ç±»ï¼Œç‚¹æ’­ï¼Œç›´æ’­ï¼Œä¸´æ—¶ç›´æ’­ï¼Œæ’è¡Œæ¦œï¼Œæœç´¢ï¼Œå†…å®¹æ›´æ–°çŠ¶æ€ï¼Œä¸»æ’­ï¼Œæ­¤åˆ»ï¼Œä¸“é¢˜ï¼Œæ´»åŠ¨ç­‰å†…å®¹ã€‚</li>
<li><a href="https://github.com/darknessomi/musicbox/wiki/%E7%BD%91%E6%98%93%E4%BA%91%E9%9F%B3%E4%B9%90%E6%96%B0%E7%89%88WebAPI%E5%88%86%E6%9E%90%E3%80%82" target="_blank" rel="external">ç½‘æ˜“äº‘éŸ³ä¹(éå®˜æ–¹)</a> - æ”¯æŒè·å–ç”¨æˆ·æ­Œå•ï¼Œæ­Œå•è¯¦æƒ…ï¼Œæ­Œæ›²URLã€‚ #éå®˜æ–¹</li>
<li><a href="http://open.ximalaya.com/index" target="_blank" rel="external">å–œé©¬æ‹‰é›…FM</a> - æ”¯æŒAndroidå’ŒiOSå¹³å°ï¼Œå¹¶æä¾›ç›¸åº”çš„SDKå’ŒDemoï¼Œå…·ä½“æ”¯æŒå†…å®¹è¯·ä¸‹è½½ç›¸å…³æ–‡ä»¶æŸ¥çœ‹ã€‚</li>
</ul>
<h4 id="äº‘"><a href="#äº‘" class="headerlink" title="äº‘"></a>äº‘</h4><ul>
<li><a href="https://develop.aliyun.com/api?spm=5176.8142029.388261.274.4FJSwV" target="_blank" rel="external">é˜¿é‡Œäº‘</a> - æ”¯æŒå¼¹æ€§è®¡ç®—ï¼Œæ•°æ®åº“ï¼Œå­˜å‚¨ä¸CDNï¼Œç½‘ç»œï¼Œåº”ç”¨æœåŠ¡ï¼ŒåŸŸåä¸ç½‘ç«™ç­‰ç±»åˆ«çš„å†…å®¹ï¼Œå¹¶æä¾›äº†ç›¸å…³SDKã€‚</li>
<li><a href="https://cloud.baidu.com/doc/index.html" target="_blank" rel="external">ç™¾åº¦äº‘</a> - æ”¯æŒè®¡ç®—å’Œç½‘ç»œï¼Œå­˜å‚¨å’ŒCDNï¼Œæ•°æ®åº“ï¼Œå®‰å…¨å’Œç®¡ç†ï¼Œæ•°æ®åˆ†æï¼Œæ™ºèƒ½å¤šåª’ä½“æœåŠ¡ï¼Œç‰©è”ç½‘æœåŠ¡ï¼Œäººå·¥æ™ºèƒ½ï¼Œåº”ç”¨æœåŠ¡ï¼Œç½‘ç«™æœåŠ¡ï¼Œæ•°å­—è¥é”€æœåŠ¡ç­‰å†…å®¹ï¼Œå¹¶æä¾›ç›¸å…³çš„SDKã€‚</li>
<li><a href="http://www.bmob.cn/" target="_blank" rel="external">Bmob</a> - æ”¯æŒäº‘æ•°æ®åº“ï¼Œå®¹å™¨æœåŠ¡ï¼Œæ¶ˆæ¯æ¨é€ï¼Œæ–‡ä»¶å­˜å‚¨ï¼ŒçŸ­ä¿¡éªŒè¯ç ï¼ŒåŠæ—¶é€šè®¯ï¼Œäº‘ç«¯é€»è¾‘ï¼Œå®šæ—¶ä»»åŠ¡ï¼Œåœ°ç†ä½ç½®ç­‰ã€‚</li>
<li><a href="https://leancloud.cn/" target="_blank" rel="external">LeanCloud</a> -     æ”¯æŒäº‘å­˜å‚¨ï¼Œæ•°æ®åˆ†æï¼Œç”¨æˆ·å…³ç³»ï¼Œå®æ—¶é€šè®¯ï¼Œæ¶ˆæ¯æ¨é€ï¼Œç§»åŠ¨ç»Ÿè®¡ç­‰ã€‚</li>
<li><a href="http://www.qiniu.com/" target="_blank" rel="external">ä¸ƒç‰›äº‘</a> - æ”¯æŒå¯¹è±¡å­˜å‚¨ï¼ŒèåˆCDNï¼Œç›´æ’­äº‘ï¼Œæ•°æ®å¤„ç†ç­‰ã€‚</li>
<li><a href="https://www.qcloud.com/doc/api" target="_blank" rel="external">è…¾è®¯äº‘</a> - æ”¯æŒè®¡ç®—ï¼Œç½‘ç»œï¼Œå­˜å‚¨ä¸CDNï¼Œæ•°æ®åº“ï¼Œå®‰å…¨æœåŠ¡ï¼Œç›‘æ§ä¸ç®¡ç†ï¼ŒåŸŸåæœåŠ¡ï¼Œè§†é¢‘æœåŠ¡ï¼Œå¤§æ•°æ®ä¸AIç­‰å†…å®¹ï¼Œæä¾›ç›¸å…³SDKã€‚</li>
<li><a href="https://www.wilddog.com/" target="_blank" rel="external">é‡ç‹—</a> - æ”¯æŒå®æ—¶æ•°æ®åŒæ­¥ï¼Œå®æ—¶è§†é¢‘é€šè¯ï¼ŒåŠæ—¶é€šè®¯ï¼ŒçŸ­ä¿¡ï¼Œèº«ä»½è®¤è¯ç­‰ã€‚</li>
</ul>
<h4 id="è¯­éŸ³è¯†åˆ«"><a href="#è¯­éŸ³è¯†åˆ«" class="headerlink" title="è¯­éŸ³è¯†åˆ«"></a>è¯­éŸ³è¯†åˆ«</h4><ul>
<li><a href="http://yuyin.baidu.com/" target="_blank" rel="external">ç™¾åº¦è¯­éŸ³</a> - æ”¯æŒå…¨å¹³å°REST API, ç¦»çº¿åœ¨çº¿èåˆæ¨¡å¼ï¼Œæ·±åº¦è¯­ä¹‰è§£æï¼Œåœºæ™¯è¯†åˆ«å®šåˆ¶ï¼Œè‡ªå®šä¹‰ä¸Šä¼ è¯­æ–™ã€è®­ç»ƒæ¨¡å‹ï¼ŒåŸºç¡€æœåŠ¡æ°¸ä¹…å…è´¹ã€‚æä¾›ç›¸åº”SDKå’ŒDemoåº”ç”¨ã€‚</li>
<li><a href="http://openspeech.sogou.com/Sogou/php/index.php" target="_blank" rel="external">æœç‹—è¯­éŸ³äº‘å¼€æ”¾å¹³å°</a> - æ”¯æŒåœ¨çº¿/ç¦»çº¿è¯­éŸ³è¯†åˆ«ï¼Œåœ¨çº¿å¬æ­Œè¯†æ›²ï¼Œç¦»çº¿è¯­éŸ³åˆæˆç­‰å†…å®¹ã€‚æä¾›ç›¸åº”å¹³å°SDKã€‚</li>
<li><a href="http://www.xfyun.cn/" target="_blank" rel="external">è®¯é£å¼€æ”¾å¹³å°</a> - æ”¯æŒè¯­éŸ³å¬å†™/è½¬å†™ï¼Œåœ¨çº¿/ç¦»çº¿å‘½ä»¤è¯è¯†åˆ«ï¼Œè¯­éŸ³å”¤é†’ç­‰å†…å®¹ï¼Œå¹³å°æ”¯æŒå¹¿æ³›ï¼Œæä¾›ç›¸åº”SDKã€‚</li>
</ul>
<h4 id="æ‚å¿—"><a href="#æ‚å¿—" class="headerlink" title="æ‚å¿—"></a>æ‚å¿—</h4><ul>
<li><a href="https://github.com/ZongweiBai/DoubanOpenDaily/blob/b87473b90911e687d291e847b133b5c4c4a700a3/app/src/main/java/com/monosky/daily/constant/APIConstData.java" target="_blank" rel="external">è±†ç“£ä¸€åˆ»(éå®˜æ–¹)</a> - æ”¯æŒè·å–æŒ‡å®šæ—¥æœŸæ–‡ç« åˆ—è¡¨ï¼Œæ ç›®æ€»è§ˆï¼Œæ¨èä½œè€…ï¼Œä½œè€…ä¿¡æ¯ï¼Œä½œè€…æ›´å¤šæ–‡ç« ä¿¡æ¯ï¼Œæ ç›®æ–‡ç« åˆ—è¡¨åŠç¿»é¡µï¼Œæ–‡ç« è¯„è®ºåŠçƒ­é—¨è¯„è®ºåˆ—è¡¨ã€‚ #éå®˜æ–¹</li>
<li><a href="https://github.com/jokermonn/-Api/blob/master/ONEv3.5.0~.md" target="_blank" rel="external">Oneä¸€ä¸ª(éå®˜æ–¹)</a> - æ”¯æŒè·å–é¦–é¡µå›¾ç‰‡ï¼Œæ–‡ç« ï¼ŒéŸ³ä¹åŠç”µå½±ã€‚ #éå®˜æ–¹</li>
<li><a href="https://github.com/izzyleung/ZhihuDailyPurify/wiki/%E7%9F%A5%E4%B9%8E%E6%97%A5%E6%8A%A5-API-%E5%88%86%E6%9E%90" target="_blank" rel="external">çŸ¥ä¹æ—¥æŠ¥(éå®˜æ–¹)</a> - æ”¯æŒè·å–ç•Œé¢å¯åŠ¨å›¾åƒï¼Œè½¯ä»¶ç‰ˆæœ¬æŸ¥è¯¢ï¼Œæœ€æ–°æ¶ˆæ¯ï¼Œæ¶ˆæ¯å†…å®¹è·å–ä¸ç¦»çº¿ä¸‹è½½ï¼Œè¿‡å¾€æ¶ˆæ¯ï¼Œæ–°é—»é¢å¤–æ¶ˆæ¯ï¼Œæ–°é—»å¯¹åº”é•¿/çŸ­è¯„è®ºæŸ¥çœ‹ï¼Œä¸»é¢˜æ—¥æŠ¥åˆ—è¡¨ï¼Œä¸»é¢˜æ—¥æŠ¥å†…å®¹ï¼Œçƒ­é—¨æ¶ˆæ¯ï¼Œæ ç›®æ€»è§ˆï¼Œæ ç›®å…·ä½“æ¶ˆæ¯ï¼Œæ–°é—»çš„æ¨èè€…ï¼ŒæŸä¸ªä¸“æ ä¹‹å‰çš„æ–°é—»ï¼ŒEditorçš„ä¸»é¡µç­‰ã€‚ #éå®˜æ–¹</li>
<li><a href="https://github.com/marktony/zhuanlan/wiki" target="_blank" rel="external">çŸ¥ä¹ä¸“æ (éå®˜æ–¹)</a> - æ”¯æŒè·å–æŒ‡å®šä¸“æ çš„ä¿¡æ¯ï¼ŒæŒ‡å®šä¸“æ çš„æ–‡ç« åˆ—è¡¨ï¼ŒæŒ‡å®šçš„æ–‡ç« å†…å®¹ï¼Œè¯„è®ºåˆ—è¡¨ï¼Œç‚¹èµä¿¡æ¯ã€‚ #éå®˜æ–¹</li>
</ul>
<h4 id="ç»¼åˆ"><a href="#ç»¼åˆ" class="headerlink" title="ç»¼åˆ"></a>ç»¼åˆ</h4><ul>
<li><a href="http://www.avatardata.cn/Docs" target="_blank" rel="external">é˜¿å‡¡è¾¾æ•°æ®</a> - æ”¯æŒé‡‘èè‚¡ç¥¨ï¼Œå……å€¼è®¤è¯ï¼Œä¾¿æ°‘ç±»ï¼Œæ–°é—»æ–‡ç« ï¼ŒåŒ»è¯äº¤é€šï¼Œç§‘æ•™æ–‡è‰ºï¼Œåˆ›æ„æ•°æ®ï¼ŒåŠæ—¶é€šè®¯ç­‰å†…å®¹ã€‚</li>
<li><a href="http://www.alidayu.com/" target="_blank" rel="external">é˜¿é‡Œå¤§äº</a> - æ”¯æŒéªŒè¯ç ï¼ŒçŸ­ä¿¡é€šçŸ¥ï¼Œè¯­éŸ³é€šçŸ¥ï¼Œæµé‡é’±åŒ…å……å€¼ï¼Œç§å¯†ä¸“çº¿ï¼Œç¾¤å‘åŠ©æ‰‹ç­‰å†…å®¹ã€‚</li>
<li><a href="https://www.apix.cn/" target="_blank" rel="external">APiX</a> - æ”¯æŒåŸºç¡€å¾ä¿¡æ•°æ®ï¼Œä¿¡ç”¨åˆ†ææœåŠ¡ï¼Œæ”¯ä»˜ç¼´è´¹æ¥å£ç­‰æ•°æ®ï¼Œéƒ¨åˆ†å…è´¹ã€‚</li>
<li><a href="http://apistore.baidu.com/" target="_blank" rel="external">ç™¾åº¦API STORE</a> - æ”¯æŒå¤šç§ç±»å‹æ•°æ®ï¼Œéƒ¨åˆ†å…è´¹ï¼Œæä¾›SDKã€‚</li>
<li><a href="http://www.haoservice.com/" target="_blank" rel="external">HaoService</a> - æ”¯æŒå¤šç§ç±»å‹æ•°æ®ã€‚</li>
<li><a href="https://www.juhe.cn/" target="_blank" rel="external">èšåˆæ•°æ®</a> - æ”¯æŒå¤šç§ç±»å‹æ•°æ®ï¼Œéƒ¨åˆ†å…è´¹ã€‚</li>
<li><a href="https://m.datayes.com/" target="_blank" rel="external">é€šè”æ•°æ®</a> - æä¾›é‡‘èç±»æ•°æ®ï¼Œæ”¯æŒå…è´¹è¯•ç”¨ã€‚</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†&quot;&gt;&lt;a href=&quot;#ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†&quot; class=&quot;headerlink&quot; title=&quot;ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†&quot;&gt;&lt;/a&gt;ä¸­å›½å›½å†…å¯ç”¨APIåˆé›†&lt;/h1&gt;&lt;h3 id=&quot;ç›®å½•&quot;&gt;&lt;a href=&quot;#ç›®å½•&quot; class=&quot;head
    
    </summary>
    
    
      <category term="API" scheme="http://microzz.com/tags/API/"/>
    
      <category term="å¼€å‘è€…" scheme="http://microzz.com/tags/%E5%BC%80%E5%8F%91%E8%80%85/"/>
    
  </entry>
  
  <entry>
    <title>JavaScriptä¸­æ‰‹åŠ¨æ¨¡æ‹Ÿåˆ›å»ºIteratorsè¿­ä»£å™¨(éå†å™¨)</title>
    <link href="http://microzz.com/2017/01/29/iterators-test/"/>
    <id>http://microzz.com/2017/01/29/iterators-test/</id>
    <published>2017-01-29T12:58:35.000Z</published>
    <updated>2017-01-29T13:22:31.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>&nbsp;&nbsp;&nbsp;Generatorå‡½æ•°æ˜¯ES6æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“è¯·çœ‹<a href="http://microzz.com/2017/01/13/generator/">Generatorå‡½æ•°æ•™ç¨‹</a>ã€‚Generatorå‡½æ•°æœ‰å¤šç§ç†è§£è§’åº¦ã€‚ä»è¯­æ³•ä¸Šï¼Œé¦–å…ˆå¯ä»¥æŠŠå®ƒç†è§£æˆï¼ŒGeneratorå‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚<br>&nbsp;&nbsp;&nbsp;æ‰§è¡ŒGeneratorå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGeneratorå‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ã€‚è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå†Generatorå‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚</p>
</blockquote>
<h1 id="JavaScriptä¸­å¦‚ä½•æ‰‹åŠ¨æ¨¡æ‹Ÿåˆ›å»ºIteratorsè¿­ä»£å™¨-éå†å™¨"><a href="#JavaScriptä¸­å¦‚ä½•æ‰‹åŠ¨æ¨¡æ‹Ÿåˆ›å»ºIteratorsè¿­ä»£å™¨-éå†å™¨" class="headerlink" title="JavaScriptä¸­å¦‚ä½•æ‰‹åŠ¨æ¨¡æ‹Ÿåˆ›å»ºIteratorsè¿­ä»£å™¨(éå†å™¨)"></a>JavaScriptä¸­å¦‚ä½•æ‰‹åŠ¨æ¨¡æ‹Ÿåˆ›å»ºIteratorsè¿­ä»£å™¨(éå†å™¨)</h1><h2 id="é€šè¿‡ä»£ç å®ç°ï¼Œå…·ä½“å¦‚ä¸‹"><a href="#é€šè¿‡ä»£ç å®ç°ï¼Œå…·ä½“å¦‚ä¸‹" class="headerlink" title="é€šè¿‡ä»£ç å®ç°ï¼Œå…·ä½“å¦‚ä¸‹"></a>é€šè¿‡ä»£ç å®ç°ï¼Œå…·ä½“å¦‚ä¸‹</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * JavaScriptä¸­æ‰‹åŠ¨æ¨¡æ‹Ÿåˆ›å»ºIteratorsè¿­ä»£å™¨</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Iterators</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> i = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    next() &#123;</div><div class="line">      <span class="keyword">let</span> done = (i &gt;= args.length);</div><div class="line">      <span class="keyword">let</span> value = done ? <span class="literal">undefined</span> : args[i++];</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">value</span>: value,</div><div class="line">        <span class="attr">done</span>: done</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//è¿›è¡Œæµ‹è¯•éªŒè¯ç»“æœ</span></div><div class="line"><span class="keyword">let</span> test = Iterators([<span class="string">'microzz'</span>, <span class="string">'æ¶µæœˆå¤©'</span>, <span class="string">'ITæŠ€æœ¯åˆ†äº«'</span>]);</div><div class="line"><span class="built_in">console</span>.log(test.next()); <span class="comment">// &#123; value: 'microzz', done: false &#125;</span></div><div class="line"><span class="built_in">console</span>.log(test.next()); <span class="comment">// &#123; value: 'æ¶µæœˆå¤©', done: false &#125;</span></div><div class="line"><span class="built_in">console</span>.log(test.next()); <span class="comment">// &#123; value: 'ITæŠ€æœ¯åˆ†äº«', done: false &#125;</span></div><div class="line"><span class="built_in">console</span>.log(test.next()); <span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;Generatorå‡½æ•°æ˜¯ES6æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“è¯·çœ‹&lt;a href=&quot;http://microzz.com/2017/01/13/generator/&quot;&gt;Generatorå‡½æ•°æ•™ç¨‹&lt;/a&gt;ã€‚Gene
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Iterators" scheme="http://microzz.com/tags/Iterators/"/>
    
  </entry>
  
  <entry>
    <title>JavaScriptè‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´</title>
    <link href="http://microzz.com/2017/01/26/deep-copy/"/>
    <id>http://microzz.com/2017/01/26/deep-copy/</id>
    <published>2017-01-26T11:11:02.000Z</published>
    <updated>2017-01-26T12:02:27.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JavaScriptè‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´"><a href="#JavaScriptè‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´" class="headerlink" title="JavaScriptè‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´"></a>JavaScriptè‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´</h1><h3 id="ES6ä¸­çš„Object-assignæ–¹æ³•"><a href="#ES6ä¸­çš„Object-assignæ–¹æ³•" class="headerlink" title="ES6ä¸­çš„Object.assignæ–¹æ³•"></a>ES6ä¸­çš„Object.assignæ–¹æ³•</h3><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES6ä¸­æ–°å¢Object.assignæ–¹æ³•ç”¨äºå¯¹è±¡çš„åˆå¹¶ï¼Œå°†æºå¯¹è±¡ï¼ˆsourceï¼‰çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼Œå¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ï¼ˆtargetï¼‰ã€‚</p>
<hr>
<h4 id="â—ï¸æ³¨æ„ç‚¹"><a href="#â—ï¸æ³¨æ„ç‚¹" class="headerlink" title="â—ï¸æ³¨æ„ç‚¹:"></a>â—ï¸æ³¨æ„ç‚¹:</h4><blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;Object.assignæ–¹æ³•å®è¡Œçš„æ˜¯æµ…æ‹·è´ï¼Œè€Œä¸æ˜¯æ·±æ‹·è´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæºå¯¹è±¡æŸä¸ªå±æ€§çš„å€¼æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç›®æ ‡å¯¹è±¡æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</p>
</blockquote>
<hr>
<h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è‡ªå·±åŠ¨æ‰‹æ¥æ‰‹å·¥å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´æ–¹æ³•ï¼Œå…·ä½“å®ç°æœ‰å¦‚ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p>
<h2 id="æ–¹æ³•1âƒ£ï¸"><a href="#æ–¹æ³•1âƒ£ï¸" class="headerlink" title="æ–¹æ³•1âƒ£ï¸"></a>æ–¹æ³•1âƒ£ï¸</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> * è‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´</div><div class="line"> */</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> copy = &#123;&#125;;</div><div class="line"></div><div class="line">  <span class="comment">// å¦‚æœæ˜¯åŸºæœ¬ç±»å‹ç›´æ¥èµ‹å€¼ï¼Œ</span></div><div class="line">  <span class="comment">// å¦‚æœæ˜¯æ•°ç»„åˆ™æ‹·è´ï¼Œ</span></div><div class="line">  <span class="comment">// å…¶ä»–å¯¹è±¡åˆ™é€’å½’è°ƒç”¨deepCopyæ–¹æ³•</span></div><div class="line">    <span class="built_in">Object</span>.keys(obj).forEach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</div><div class="line"></div><div class="line">      <span class="keyword">if</span> (obj[key] <span class="keyword">instanceof</span> <span class="built_in">Array</span>) &#123;</div><div class="line">        copy[key] = <span class="built_in">Array</span>.from(obj[key]);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> obj[key] === <span class="string">'object'</span>) &#123;</div><div class="line">        copy[key] = deepCopy(obj[key]);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">else</span> &#123;</div><div class="line">        copy[key] = obj[key];</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line"></div><div class="line">  <span class="keyword">return</span> copy;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ–¹æ³•2âƒ£ï¸"><a href="#æ–¹æ³•2âƒ£ï¸" class="headerlink" title="æ–¹æ³•2âƒ£ï¸"></a>æ–¹æ³•2âƒ£ï¸</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h1 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h1><p>&nbsp;&nbsp;ä»¥ä¸Šé€šè¿‡ä¸¤ç§æ–¹æ³•å®ç°äº†å¯¹è±¡çš„æ·±æ‹·è´ï¼Œä¸‹é¢é€šè¿‡æ•°æ®è¿›è¡Œç®€å•éªŒè¯:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è‡ªå®šä¹‰ä¸€ä¸ªå¤æ‚æ•°æ®å¯¹è±¡</span></div><div class="line"><span class="keyword">let</span> data = &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'Zhao'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">22</span>,</div><div class="line">  <span class="attr">url</span>: <span class="string">'http://microzz.com'</span>,</div><div class="line">  <span class="attr">scores</span>:&#123;</div><div class="line">    <span class="attr">math</span>: <span class="number">66</span>,</div><div class="line">    <span class="attr">java</span>: <span class="number">88</span>,</div><div class="line">    <span class="attr">test</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">skills</span>: [<span class="string">'Node.js'</span>, <span class="string">'ReactJS'</span>, <span class="string">'ES6'</span>],</div><div class="line">  say() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`My name is <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>`</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//è¿›è¡Œæ·±æ‹·è´ï¼ŒæŠŠæ•°æ®ä¿å­˜åœ¨copyData</span></div><div class="line"><span class="keyword">let</span> copyData = deepCopy(data);</div><div class="line"></div><div class="line"><span class="comment">//å¯¹copyDataè¿›è¡Œä¿®æ”¹ï¼Œçœ‹æ˜¯å¦å¯¹åŸæ•°æ®æœ‰å½±å“</span></div><div class="line">copyData.name = <span class="string">'Hui'</span>;</div><div class="line">copyData.scores.math = <span class="number">99</span>;</div><div class="line">copyData.scores.test[<span class="number">1</span>] = <span class="number">100</span>;</div><div class="line">copyData.skills[<span class="number">2</span>] = <span class="string">'ES5'</span>;</div><div class="line">copyData.say = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`Copy: My name is <span class="subst">$&#123;<span class="keyword">this</span>.name&#125;</span>`</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//æ‰“å°è¾“å‡ºæŸ¥çœ‹ç»“æœè¿›è¡ŒéªŒè¯</span></div><div class="line"><span class="built_in">console</span>.log(data);</div><div class="line"><span class="comment">/*</span></div><div class="line">&#123; name: 'Zhao',</div><div class="line">age: 22,</div><div class="line">url: 'http://microzz.com',</div><div class="line">scores: &#123; math: 66, java: 88, test: [ 1, 2, 3 ] &#125;,</div><div class="line">skills: [ 'Node.js', 'ReactJS', 'ES6' ],</div><div class="line">say: [Function: say] &#125;</div><div class="line"> */</div><div class="line"> </div><div class="line"><span class="built_in">console</span>.log(copyData);</div><div class="line"><span class="comment">/*</span></div><div class="line">&#123; name: 'Hui',</div><div class="line">age: 22,</div><div class="line">url: 'http://microzz.com',</div><div class="line">scores: &#123; math: 99, java: 88, test: [ 1, 100, 3 ] &#125;,</div><div class="line">skills: [ 'Node.js', 'ReactJS', 'ES5' ],</div><div class="line">say: [Function] &#125;</div><div class="line"> */</div><div class="line"> </div><div class="line">data.say(); <span class="comment">// My name is Zhao</span></div><div class="line">copyData.say(); <span class="comment">// Copy: My name is Hui</span></div></pre></td></tr></table></figure>
<hr>
<blockquote>
<p>&nbsp;&nbsp;&nbsp;&nbsp;ä¸¤ç§æ–¹æ³•çš„ç»“æœå‡ä¸€è‡´ï¼Œå®ç°äº†å¯¹è±¡çš„æ·±æ‹·è´ï¼Œä½†æ˜¯ç¬¬äºŒç§æ–¹æ³•é€šè¿‡åŸç”Ÿçš„JSON.parseå’ŒJSON.stringifyæ–¹æ³•æ›´ä¸ºç®€å•æ˜“æ‡‚ã€‚</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JavaScriptè‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´&quot;&gt;&lt;a href=&quot;#JavaScriptè‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´&quot; class=&quot;headerlink&quot; title=&quot;JavaScriptè‡ªå®šä¹‰æ–¹æ³•å®ç°å¤æ‚å¯¹è±¡çš„æ·±æ‹·è´&quot;&gt;&lt;/a&gt;JavaScriptè‡ª
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="æ·±æ‹·è´" scheme="http://microzz.com/tags/%E6%B7%B1%E6%8B%B7%E8%B4%9D/"/>
    
  </entry>
  
  <entry>
    <title>ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„(Destructuring)</title>
    <link href="http://microzz.com/2017/01/24/destructuringTest/"/>
    <id>http://microzz.com/2017/01/24/destructuringTest/</id>
    <published>2017-01-24T11:17:51.000Z</published>
    <updated>2017-01-24T11:51:37.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„"><a href="#ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„" class="headerlink" title="ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„"></a>ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„</h1><blockquote>
<p>å¯¹äºæ™®é€šå¯¹è±¡çš„è§£æ„å¤§å®¶åº”è¯¥æ²¡ä»€ä¹ˆé—®é¢˜(è¯¦ç»†å­¦ä¹ ES6çš„è§£æ„çŸ¥è¯†è¯·çœ‹è¿™é‡ŒğŸ‘‰ <a href="http://microzz.com/2016/11/13/destructuring/">å˜é‡çš„è§£æ„èµ‹å€¼(Destructuring)</a> )ï¼Œä½†æ˜¯é‡åˆ°å¤æ‚å¯¹è±¡ç»“æ„çš„åº”è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿå¯ä»¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å£°æ˜ä¸€ä¸ªå¯¹è±¡ä¿å­˜ä¿¡æ¯</span></div><div class="line"><span class="keyword">let</span> jsonData = &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'Zhao'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">22</span>,</div><div class="line">  <span class="attr">score</span>: &#123;</div><div class="line">    <span class="attr">Chinese</span>: <span class="number">77</span>,</div><div class="line">    <span class="attr">math</span>: <span class="number">99</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//å¯¹åµŒå¥—ç»“æ„çš„å¯¹è±¡è¿›è¡Œè§£æ„1</span></div><div class="line"><span class="keyword">let</span> &#123;name, age, <span class="attr">score</span>:&#123;Chinese, math&#125;&#125; = jsonData;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`name is <span class="subst">$&#123;name&#125;</span>`</span>); <span class="comment">//name is Zhao</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`age is <span class="subst">$&#123;age&#125;</span>`</span>); <span class="comment">//age is 22</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`Chinese score is <span class="subst">$&#123;Chinese&#125;</span>`</span>); <span class="comment">//Chinese score is 77</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`math score is <span class="subst">$&#123;math&#125;</span>`</span>);  <span class="comment">//math score is 99</span></div><div class="line"></div><div class="line"><span class="comment">//å¦å¤–ä¸€ä¸ªä¾‹å­ğŸ˜„</span></div><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  <span class="attr">p</span>: [</div><div class="line">    <span class="string">'Hello'</span>,</div><div class="line">    &#123; <span class="attr">y</span>: <span class="string">'World'</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">//å¯¹åµŒå¥—ç»“æ„çš„å¯¹è±¡è¿›è¡Œè§£æ„2</span></div><div class="line"><span class="keyword">let</span> &#123; <span class="attr">p</span>: [x, &#123; y &#125;] &#125; = obj;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">`x is <span class="subst">$&#123;x&#125;</span>`</span>); <span class="comment">// x is Hello</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`y is <span class="subst">$&#123;y&#125;</span>`</span>); <span class="comment">// y is World</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„&quot;&gt;&lt;a href=&quot;#ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„&quot; class=&quot;headerlink&quot; title=&quot;ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„&quot;&gt;&lt;/a&gt;ES6ä¸­åµŒå¥—çš„å¯¹è±¡å¦‚ä½•è§£æ„&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;å¯¹äºæ™®é€šå¯¹è±¡çš„è§£æ„å¤§å®¶åº”è¯¥
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Destructuring" scheme="http://microzz.com/tags/Destructuring/"/>
    
  </entry>
  
  <entry>
    <title>JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶å¯¹è±¡</title>
    <link href="http://microzz.com/2017/01/21/listener-event/"/>
    <id>http://microzz.com/2017/01/21/listener-event/</id>
    <published>2017-01-21T14:13:02.000Z</published>
    <updated>2017-01-21T14:27:35.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶å¯¹è±¡"><a href="#JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶å¯¹è±¡" class="headerlink" title="JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶å¯¹è±¡"></a>JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶å¯¹è±¡</h1><h3 id="å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š"><a href="#å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š" class="headerlink" title="å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š"></a>å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š</h3><blockquote>
<ol>
<li>æ·»åŠ ç›‘å¬è€…</li>
<li>ç§»é™¤ç›‘å¬è€…</li>
<li>æ¸…ç©ºç›‘å¬è€…</li>
<li>å‘èµ·äº‹ä»¶ä¿¡å·</li>
</ol>
</blockquote>
<h3 id="è®¾è®¡æ€è·¯å¦‚ä¸‹ï¼š"><a href="#è®¾è®¡æ€è·¯å¦‚ä¸‹ï¼š" class="headerlink" title="è®¾è®¡æ€è·¯å¦‚ä¸‹ï¼š"></a>è®¾è®¡æ€è·¯å¦‚ä¸‹ï¼š</h3><blockquote>
<p>  å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸€ä¸ªå®ä¾‹æˆå‘˜listenersï¼Œç”¨äºè®°å½•æ‰€æœ‰çš„ç›‘å¬è€…<br>ä¸ºå¯¹è±¡çš„åŸå‹å¢åŠ ï¼Œæ–°å¢ã€åˆ é™¤ã€æ¸…ç©ºå’Œæ‰§è¡Œå››ä¸ªæˆå‘˜<br>å…·ä½“ä»£ç å¯ä»¥å‚è§ä¸‹é¢ç¤ºä¾‹</p>
</blockquote>
<h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">myEvent</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.listeners = [];	<span class="comment">//ç›‘å¬è€…åˆ—è¡¨</span></div><div class="line">&#125;</div><div class="line"><span class="comment">//æ·»åŠ ä¸€ä¸ªç›‘å¬è€…</span></div><div class="line">myEvent.prototype.addListener = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.listeners.push(fn);</div><div class="line">&#125;;</div><div class="line"><span class="comment">//é™¤ç§»ä¸€ä¸ªç›‘å¬è€…</span></div><div class="line">myEvent.prototype.removeListener = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> index = <span class="keyword">this</span>.listeners.indexOf(fn);</div><div class="line">    <span class="keyword">this</span>.listeners.splice(index,<span class="number">1</span>);</div><div class="line">&#125;;</div><div class="line"><span class="comment">//æ¸…é™¤æ‰€æœ‰ç›‘å¬è€…</span></div><div class="line">myEvent.prototype.clearListeners = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.listeners = [];</div><div class="line">&#125;;</div><div class="line"><span class="comment">//å‘å‡ºæ‰§è¡Œä¿¡å·ï¼Œå¹¶å‘Šä¹‹æ‰€æœ‰ç›‘å¬è€…</span></div><div class="line">myEvent.prototype.raise = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">	<span class="keyword">var</span> l = <span class="keyword">this</span>.listeners.length;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; l; i++)&#123;</div><div class="line">    	<span class="keyword">this</span>.listeners[i](e);	<span class="comment">//æ‰§è¡Œæ‰€æœ‰ç›‘å¬æ–¹æ³•</span></div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> me = <span class="keyword">new</span> myEvent();</div><div class="line"></div><div class="line"><span class="comment">//äº‹ä»¶fun1</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun1</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'fun1: '</span> + e);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//äº‹ä»¶fun2</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun2</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">	<span class="built_in">console</span>.log(<span class="string">'fun2: '</span> + e);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//è°ƒç”¨ç›¸å…³æ–¹æ³•è¿›è¡Œæµ‹è¯•</span></div><div class="line">me.addListener(fun1);</div><div class="line">me.addListener(fun2);</div><div class="line">me.removeListener(fun1)</div><div class="line"><span class="comment">//me.clearListeners();</span></div><div class="line">me.raise(<span class="string">"a"</span>);</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶å¯¹è±¡&quot;&gt;&lt;a href=&quot;#JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶å¯¹è±¡&quot; class=&quot;headerlink&quot; title=&quot;JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶å¯¹è±¡&quot;&gt;&lt;/a&gt;JavaScripté€šè¿‡åŸå‹è®¾è®¡ä¸€ä¸ªäº‹ä»¶
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="äº‹ä»¶" scheme="http://microzz.com/tags/%E4%BA%8B%E4%BB%B6/"/>
    
      <category term="event" scheme="http://microzz.com/tags/event/"/>
    
      <category term="åŸå‹" scheme="http://microzz.com/tags/%E5%8E%9F%E5%9E%8B/"/>
    
  </entry>
  
  <entry>
    <title>ES6 Module</title>
    <link href="http://microzz.com/2017/01/18/module/"/>
    <id>http://microzz.com/2017/01/18/module/</id>
    <published>2017-01-18T09:01:23.000Z</published>
    <updated>2017-01-18T09:07:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h1><p>å†å²ä¸Šï¼ŒJavaScript ä¸€ç›´æ²¡æœ‰æ¨¡å—ï¼ˆmoduleï¼‰ä½“ç³»ï¼Œæ— æ³•å°†ä¸€ä¸ªå¤§ç¨‹åºæ‹†åˆ†æˆäº’ç›¸ä¾èµ–çš„å°æ–‡ä»¶ï¼Œå†ç”¨ç®€å•çš„æ–¹æ³•æ‹¼è£…èµ·æ¥ã€‚å…¶ä»–è¯­è¨€éƒ½æœ‰è¿™é¡¹åŠŸèƒ½ï¼Œæ¯”å¦‚ Ruby çš„<code>require</code>ã€Python çš„<code>import</code>ï¼Œç”šè‡³å°±è¿ CSS éƒ½æœ‰<code>@import</code>ï¼Œä½†æ˜¯ JavaScript ä»»ä½•è¿™æ–¹é¢çš„æ”¯æŒéƒ½æ²¡æœ‰ï¼Œè¿™å¯¹å¼€å‘å¤§å‹çš„ã€å¤æ‚çš„é¡¹ç›®å½¢æˆäº†å·¨å¤§éšœç¢ã€‚</p>
<p>åœ¨ ES6 ä¹‹å‰ï¼Œç¤¾åŒºåˆ¶å®šäº†ä¸€äº›æ¨¡å—åŠ è½½æ–¹æ¡ˆï¼Œæœ€ä¸»è¦çš„æœ‰ CommonJS å’Œ AMD ä¸¤ç§ã€‚å‰è€…ç”¨äºæœåŠ¡å™¨ï¼Œåè€…ç”¨äºæµè§ˆå™¨ã€‚ES6 åœ¨è¯­è¨€æ ‡å‡†çš„å±‚é¢ä¸Šï¼Œå®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œè€Œä¸”å®ç°å¾—ç›¸å½“ç®€å•ï¼Œå®Œå…¨å¯ä»¥å–ä»£ç°æœ‰çš„ CommonJS å’Œ AMD è§„èŒƒï¼Œæˆä¸ºæµè§ˆå™¨å’ŒæœåŠ¡å™¨é€šç”¨çš„æ¨¡å—è§£å†³æ–¹æ¡ˆã€‚</p>
<p>ES6 æ¨¡å—çš„è®¾è®¡æ€æƒ³ï¼Œæ˜¯å°½é‡çš„é™æ€åŒ–ï¼Œä½¿å¾—ç¼–è¯‘æ—¶å°±èƒ½ç¡®å®šæ¨¡å—çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠè¾“å…¥å’Œè¾“å‡ºçš„å˜é‡ã€‚CommonJS å’Œ AMD æ¨¡å—ï¼Œéƒ½åªèƒ½åœ¨è¿è¡Œæ—¶ç¡®å®šè¿™äº›ä¸œè¥¿ã€‚æ¯”å¦‚ï¼ŒCommonJS æ¨¡å—å°±æ˜¯å¯¹è±¡ï¼Œè¾“å…¥æ—¶å¿…é¡»æŸ¥æ‰¾å¯¹è±¡å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// CommonJSæ¨¡å—</span></div><div class="line"><span class="keyword">let</span> &#123; stat, exists, readFile &#125; = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">let</span> _fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">let</span> stat = _fs.stat, exists = _fs.exists, readfile = _fs.readfile;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„å®è´¨æ˜¯æ•´ä½“åŠ è½½<code>fs</code>æ¨¡å—ï¼ˆå³åŠ è½½<code>fs</code>çš„æ‰€æœ‰æ–¹æ³•ï¼‰ï¼Œç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼ˆ<code>_fs</code>ï¼‰ï¼Œç„¶åå†ä»è¿™ä¸ªå¯¹è±¡ä¸Šé¢è¯»å–3ä¸ªæ–¹æ³•ã€‚è¿™ç§åŠ è½½ç§°ä¸ºâ€œè¿è¡Œæ—¶åŠ è½½â€ï¼Œå› ä¸ºåªæœ‰è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œå¯¼è‡´å®Œå…¨æ²¡åŠæ³•åœ¨ç¼–è¯‘æ—¶åšâ€œé™æ€ä¼˜åŒ–â€ã€‚</p>
<p>ES6 æ¨¡å—ä¸æ˜¯å¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡<code>export</code>å‘½ä»¤æ˜¾å¼æŒ‡å®šè¾“å‡ºçš„ä»£ç ï¼Œå†é€šè¿‡<code>import</code>å‘½ä»¤è¾“å…¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6æ¨¡å—</span></div><div class="line"><span class="keyword">import</span> &#123; stat, exists, readFile &#125; <span class="keyword">from</span> <span class="string">'fs'</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„å®è´¨æ˜¯ä»<code>fs</code>æ¨¡å—åŠ è½½3ä¸ªæ–¹æ³•ï¼Œå…¶ä»–æ–¹æ³•ä¸åŠ è½½ã€‚è¿™ç§åŠ è½½ç§°ä¸ºâ€œç¼–è¯‘æ—¶åŠ è½½â€æˆ–è€…é™æ€åŠ è½½ï¼Œå³ ES6 å¯ä»¥åœ¨ç¼–è¯‘æ—¶å°±å®Œæˆæ¨¡å—åŠ è½½ï¼Œæ•ˆç‡è¦æ¯” CommonJS æ¨¡å—çš„åŠ è½½æ–¹å¼é«˜ã€‚å½“ç„¶ï¼Œè¿™ä¹Ÿå¯¼è‡´äº†æ²¡æ³•å¼•ç”¨ ES6 æ¨¡å—æœ¬èº«ï¼Œå› ä¸ºå®ƒä¸æ˜¯å¯¹è±¡ã€‚</p>
<p>ç”±äº ES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶åŠ è½½ï¼Œä½¿å¾—é™æ€åˆ†ææˆä¸ºå¯èƒ½ã€‚æœ‰äº†å®ƒï¼Œå°±èƒ½è¿›ä¸€æ­¥æ‹“å®½ JavaScript çš„è¯­æ³•ï¼Œæ¯”å¦‚å¼•å…¥å®ï¼ˆmacroï¼‰å’Œç±»å‹æ£€éªŒï¼ˆtype systemï¼‰è¿™äº›åªèƒ½é é™æ€åˆ†æå®ç°çš„åŠŸèƒ½ã€‚</p>
<p>é™¤äº†é™æ€åŠ è½½å¸¦æ¥çš„å„ç§å¥½å¤„ï¼ŒES6 æ¨¡å—è¿˜æœ‰ä»¥ä¸‹å¥½å¤„ã€‚</p>
<ul>
<li>ä¸å†éœ€è¦<code>UMD</code>æ¨¡å—æ ¼å¼äº†ï¼Œå°†æ¥æœåŠ¡å™¨å’Œæµè§ˆå™¨éƒ½ä¼šæ”¯æŒ ES6 æ¨¡å—æ ¼å¼ã€‚ç›®å‰ï¼Œé€šè¿‡å„ç§å·¥å…·åº“ï¼Œå…¶å®å·²ç»åšåˆ°äº†è¿™ä¸€ç‚¹ã€‚</li>
<li>å°†æ¥æµè§ˆå™¨çš„æ–° API å°±èƒ½ç”¨æ¨¡å—æ ¼å¼æä¾›ï¼Œä¸å†å¿…é¡»åšæˆå…¨å±€å˜é‡æˆ–è€…<code>navigator</code>å¯¹è±¡çš„å±æ€§ã€‚</li>
<li>ä¸å†éœ€è¦å¯¹è±¡ä½œä¸ºå‘½åç©ºé—´ï¼ˆæ¯”å¦‚<code>Math</code>å¯¹è±¡ï¼‰ï¼Œæœªæ¥è¿™äº›åŠŸèƒ½å¯ä»¥é€šè¿‡æ¨¡å—æä¾›ã€‚</li>
</ul>
<h2 id="ä¸¥æ ¼æ¨¡å¼"><a href="#ä¸¥æ ¼æ¨¡å¼" class="headerlink" title="ä¸¥æ ¼æ¨¡å¼"></a>ä¸¥æ ¼æ¨¡å¼</h2><p>ES6 çš„æ¨¡å—è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å¼ï¼Œä¸ç®¡ä½ æœ‰æ²¡æœ‰åœ¨æ¨¡å—å¤´éƒ¨åŠ ä¸Š<code>&quot;use strict&quot;;</code>ã€‚</p>
<p>ä¸¥æ ¼æ¨¡å¼ä¸»è¦æœ‰ä»¥ä¸‹é™åˆ¶ã€‚</p>
<ul>
<li>å˜é‡å¿…é¡»å£°æ˜åå†ä½¿ç”¨</li>
<li>å‡½æ•°çš„å‚æ•°ä¸èƒ½æœ‰åŒåå±æ€§ï¼Œå¦åˆ™æŠ¥é”™</li>
<li>ä¸èƒ½ä½¿ç”¨<code>with</code>è¯­å¥</li>
<li>ä¸èƒ½å¯¹åªè¯»å±æ€§èµ‹å€¼ï¼Œå¦åˆ™æŠ¥é”™</li>
<li>ä¸èƒ½ä½¿ç”¨å‰ç¼€0è¡¨ç¤ºå…«è¿›åˆ¶æ•°ï¼Œå¦åˆ™æŠ¥é”™</li>
<li>ä¸èƒ½åˆ é™¤ä¸å¯åˆ é™¤çš„å±æ€§ï¼Œå¦åˆ™æŠ¥é”™</li>
<li>ä¸èƒ½åˆ é™¤å˜é‡<code>delete prop</code>ï¼Œä¼šæŠ¥é”™ï¼Œåªèƒ½åˆ é™¤å±æ€§<code>delete global[prop]</code></li>
<li><code>eval</code>ä¸ä¼šåœ¨å®ƒçš„å¤–å±‚ä½œç”¨åŸŸå¼•å…¥å˜é‡</li>
<li><code>eval</code>å’Œ<code>arguments</code>ä¸èƒ½è¢«é‡æ–°èµ‹å€¼</li>
<li><code>arguments</code>ä¸ä¼šè‡ªåŠ¨åæ˜ å‡½æ•°å‚æ•°çš„å˜åŒ–</li>
<li>ä¸èƒ½ä½¿ç”¨<code>arguments.callee</code></li>
<li>ä¸èƒ½ä½¿ç”¨<code>arguments.caller</code></li>
<li>ç¦æ­¢<code>this</code>æŒ‡å‘å…¨å±€å¯¹è±¡</li>
<li>ä¸èƒ½ä½¿ç”¨<code>fn.caller</code>å’Œ<code>fn.arguments</code>è·å–å‡½æ•°è°ƒç”¨çš„å †æ ˆ</li>
<li>å¢åŠ äº†ä¿ç•™å­—ï¼ˆæ¯”å¦‚<code>protected</code>ã€<code>static</code>å’Œ<code>interface</code>ï¼‰</li>
</ul>
<p>ä¸Šé¢è¿™äº›é™åˆ¶ï¼Œæ¨¡å—éƒ½å¿…é¡»éµå®ˆã€‚ç”±äºä¸¥æ ¼æ¨¡å¼æ˜¯ ES5 å¼•å…¥çš„ï¼Œä¸å±äº ES6ï¼Œæ‰€ä»¥è¯·å‚é˜…ç›¸å…³ ES5 ä¹¦ç±ï¼Œæœ¬ä¹¦ä¸å†è¯¦ç»†ä»‹ç»äº†ã€‚</p>
<h2 id="export-å‘½ä»¤"><a href="#export-å‘½ä»¤" class="headerlink" title="export å‘½ä»¤"></a>export å‘½ä»¤</h2><p>æ¨¡å—åŠŸèƒ½ä¸»è¦ç”±ä¸¤ä¸ªå‘½ä»¤æ„æˆï¼š<code>export</code>å’Œ<code>import</code>ã€‚<code>export</code>å‘½ä»¤ç”¨äºè§„å®šæ¨¡å—çš„å¯¹å¤–æ¥å£ï¼Œ<code>import</code>å‘½ä»¤ç”¨äºè¾“å…¥å…¶ä»–æ¨¡å—æä¾›çš„åŠŸèƒ½ã€‚</p>
<p>ä¸€ä¸ªæ¨¡å—å°±æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶å†…éƒ¨çš„æ‰€æœ‰å˜é‡ï¼Œå¤–éƒ¨æ— æ³•è·å–ã€‚å¦‚æœä½ å¸Œæœ›å¤–éƒ¨èƒ½å¤Ÿè¯»å–æ¨¡å—å†…éƒ¨çš„æŸä¸ªå˜é‡ï¼Œå°±å¿…é¡»ä½¿ç”¨<code>export</code>å…³é”®å­—è¾“å‡ºè¯¥å˜é‡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ª JS æ–‡ä»¶ï¼Œé‡Œé¢ä½¿ç”¨<code>export</code>å‘½ä»¤è¾“å‡ºå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// profile.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> firstName = <span class="string">'Michael'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> lastName = <span class="string">'Jackson'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> year = <span class="number">1958</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯<code>profile.js</code>æ–‡ä»¶ï¼Œä¿å­˜äº†ç”¨æˆ·ä¿¡æ¯ã€‚ES6å°†å…¶è§†ä¸ºä¸€ä¸ªæ¨¡å—ï¼Œé‡Œé¢ç”¨<code>export</code>å‘½ä»¤å¯¹å¤–éƒ¨è¾“å‡ºäº†ä¸‰ä¸ªå˜é‡ã€‚</p>
<p><code>export</code>çš„å†™æ³•ï¼Œé™¤äº†åƒä¸Šé¢è¿™æ ·ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// profile.js</span></div><div class="line"><span class="keyword">var</span> firstName = <span class="string">'Michael'</span>;</div><div class="line"><span class="keyword">var</span> lastName = <span class="string">'Jackson'</span>;</div><div class="line"><span class="keyword">var</span> year = <span class="number">1958</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123;firstName, lastName, year&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨<code>export</code>å‘½ä»¤åé¢ï¼Œä½¿ç”¨å¤§æ‹¬å·æŒ‡å®šæ‰€è¦è¾“å‡ºçš„ä¸€ç»„å˜é‡ã€‚å®ƒä¸å‰ä¸€ç§å†™æ³•ï¼ˆç›´æ¥æ”¾ç½®åœ¨<code>var</code>è¯­å¥å‰ï¼‰æ˜¯ç­‰ä»·çš„ï¼Œä½†æ˜¯åº”è¯¥ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨è¿™ç§å†™æ³•ã€‚å› ä¸ºè¿™æ ·å°±å¯ä»¥åœ¨è„šæœ¬å°¾éƒ¨ï¼Œä¸€çœ¼çœ‹æ¸…æ¥šè¾“å‡ºäº†å“ªäº›å˜é‡ã€‚</p>
<p>exportå‘½ä»¤é™¤äº†è¾“å‡ºå˜é‡ï¼Œè¿˜å¯ä»¥è¾“å‡ºå‡½æ•°æˆ–ç±»ï¼ˆclassï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">multiply</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x * y;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯¹å¤–è¾“å‡ºä¸€ä¸ªå‡½æ•°<code>multiply</code>ã€‚</p>
<p>é€šå¸¸æƒ…å†µä¸‹ï¼Œ<code>export</code>è¾“å‡ºçš„å˜é‡å°±æ˜¯æœ¬æ¥çš„åå­—ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>as</code>å…³é”®å­—é‡å‘½åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">v1</span>(<span class="params"></span>) </span>&#123; ... &#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">v2</span>(<span class="params"></span>) </span>&#123; ... &#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123;</div><div class="line">  v1 <span class="keyword">as</span> streamV1,</div><div class="line">  v2 <span class="keyword">as</span> streamV2,</div><div class="line">  v2 <span class="keyword">as</span> streamLatestVersion</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨<code>as</code>å…³é”®å­—ï¼Œé‡å‘½åäº†å‡½æ•°<code>v1</code>å’Œ<code>v2</code>çš„å¯¹å¤–æ¥å£ã€‚é‡å‘½ååï¼Œ<code>v2</code>å¯ä»¥ç”¨ä¸åŒçš„åå­—è¾“å‡ºä¸¤æ¬¡ã€‚</p>
<p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œ<code>export</code>å‘½ä»¤è§„å®šçš„æ˜¯å¯¹å¤–çš„æ¥å£ï¼Œå¿…é¡»ä¸æ¨¡å—å†…éƒ¨çš„å˜é‡å»ºç«‹ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">export</span> <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">var</span> m = <span class="number">1</span>;</div><div class="line"><span class="keyword">export</span> m;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ç§å†™æ³•éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ²¡æœ‰æä¾›å¯¹å¤–çš„æ¥å£ã€‚ç¬¬ä¸€ç§å†™æ³•ç›´æ¥è¾“å‡º1ï¼Œç¬¬äºŒç§å†™æ³•é€šè¿‡å˜é‡<code>m</code>ï¼Œè¿˜æ˜¯ç›´æ¥è¾“å‡º1ã€‚<code>1</code>åªæ˜¯ä¸€ä¸ªå€¼ï¼Œä¸æ˜¯æ¥å£ã€‚æ­£ç¡®çš„å†™æ³•æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å†™æ³•ä¸€</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> m = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="comment">// å†™æ³•äºŒ</span></div><div class="line"><span class="keyword">var</span> m = <span class="number">1</span>;</div><div class="line"><span class="keyword">export</span> &#123;m&#125;;</div><div class="line"></div><div class="line"><span class="comment">// å†™æ³•ä¸‰</span></div><div class="line"><span class="keyword">var</span> n = <span class="number">1</span>;</div><div class="line"><span class="keyword">export</span> &#123;n <span class="keyword">as</span> m&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸‰ç§å†™æ³•éƒ½æ˜¯æ­£ç¡®çš„ï¼Œè§„å®šäº†å¯¹å¤–çš„æ¥å£<code>m</code>ã€‚å…¶ä»–è„šæœ¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ¥å£ï¼Œå–åˆ°å€¼<code>1</code>ã€‚å®ƒä»¬çš„å®è´¨æ˜¯ï¼Œåœ¨æ¥å£åä¸æ¨¡å—å†…éƒ¨å˜é‡ä¹‹é—´ï¼Œå»ºç«‹äº†ä¸€ä¸€å¯¹åº”çš„å…³ç³»ã€‚</p>
<p>åŒæ ·çš„ï¼Œ<code>function</code>å’Œ<code>class</code>çš„è¾“å‡ºï¼Œä¹Ÿå¿…é¡»éµå®ˆè¿™æ ·çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"><span class="keyword">export</span> f;</div><div class="line"></div><div class="line"><span class="comment">// æ­£ç¡®</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æ­£ç¡®</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"><span class="keyword">export</span> &#123;f&#125;;</div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œ<code>export</code>è¯­å¥è¾“å‡ºçš„æ¥å£ï¼Œä¸å…¶å¯¹åº”çš„å€¼æ˜¯åŠ¨æ€ç»‘å®šå…³ç³»ï¼Œå³é€šè¿‡è¯¥æ¥å£ï¼Œå¯ä»¥å–åˆ°æ¨¡å—å†…éƒ¨å®æ—¶çš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> foo = <span class="string">'bar'</span>;</div><div class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> foo = <span class="string">'baz'</span>, <span class="number">500</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¾“å‡ºå˜é‡<code>foo</code>ï¼Œå€¼ä¸º<code>bar</code>ï¼Œ500æ¯«ç§’ä¹‹åå˜æˆ<code>baz</code>ã€‚</p>
<p>è¿™ä¸€ç‚¹ä¸CommonJSè§„èŒƒå®Œå…¨ä¸åŒã€‚CommonJSæ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„ç¼“å­˜ï¼Œä¸å­˜åœ¨åŠ¨æ€æ›´æ–°ï¼Œè¯¦è§ä¸‹æ–‡ã€ŠES6æ¨¡å—åŠ è½½çš„å®è´¨ã€‹ä¸€èŠ‚ã€‚</p>
<p>æœ€åï¼Œ<code>export</code>å‘½ä»¤å¯ä»¥å‡ºç°åœ¨æ¨¡å—çš„ä»»ä½•ä½ç½®ï¼Œåªè¦å¤„äºæ¨¡å—é¡¶å±‚å°±å¯ä»¥ã€‚å¦‚æœå¤„äºå—çº§ä½œç”¨åŸŸå†…ï¼Œå°±ä¼šæŠ¥é”™ï¼Œä¸‹ä¸€èŠ‚çš„<code>import</code>å‘½ä»¤ä¹Ÿæ˜¯å¦‚æ­¤ã€‚è¿™æ˜¯å› ä¸ºå¤„äºæ¡ä»¶ä»£ç å—ä¹‹ä¸­ï¼Œå°±æ²¡æ³•åšé™æ€ä¼˜åŒ–äº†ï¼Œè¿èƒŒäº†ES6æ¨¡å—çš„è®¾è®¡åˆè¡·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'bar'</span> <span class="comment">// SyntaxError</span></div><div class="line">&#125;</div><div class="line">foo()</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>export</code>è¯­å¥æ”¾åœ¨å‡½æ•°ä¹‹ä¸­ï¼Œç»“æœæŠ¥é”™ã€‚</p>
<h2 id="import-å‘½ä»¤"><a href="#import-å‘½ä»¤" class="headerlink" title="import å‘½ä»¤"></a>import å‘½ä»¤</h2><p>ä½¿ç”¨<code>export</code>å‘½ä»¤å®šä¹‰äº†æ¨¡å—çš„å¯¹å¤–æ¥å£ä»¥åï¼Œå…¶ä»– JS æ–‡ä»¶å°±å¯ä»¥é€šè¿‡<code>import</code>å‘½ä»¤åŠ è½½è¿™ä¸ªæ¨¡å—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="keyword">import</span> &#123;firstName, lastName, year&#125; <span class="keyword">from</span> <span class="string">'./profile'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setName</span>(<span class="params">element</span>) </span>&#123;</div><div class="line">  element.textContent = firstName + <span class="string">' '</span> + lastName;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>import</code>å‘½ä»¤ï¼Œç”¨äºåŠ è½½<code>profile.js</code>æ–‡ä»¶ï¼Œå¹¶ä»ä¸­è¾“å…¥å˜é‡ã€‚<code>import</code>å‘½ä»¤æ¥å—ä¸€å¯¹å¤§æ‹¬å·ï¼Œé‡Œé¢æŒ‡å®šè¦ä»å…¶ä»–æ¨¡å—å¯¼å…¥çš„å˜é‡åã€‚å¤§æ‹¬å·é‡Œé¢çš„å˜é‡åï¼Œå¿…é¡»ä¸è¢«å¯¼å…¥æ¨¡å—ï¼ˆ<code>profile.js</code>ï¼‰å¯¹å¤–æ¥å£çš„åç§°ç›¸åŒã€‚</p>
<p>å¦‚æœæƒ³ä¸ºè¾“å…¥çš„å˜é‡é‡æ–°å–ä¸€ä¸ªåå­—ï¼Œ<code>import</code>å‘½ä»¤è¦ä½¿ç”¨<code>as</code>å…³é”®å­—ï¼Œå°†è¾“å…¥çš„å˜é‡é‡å‘½åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; lastName <span class="keyword">as</span> surname &#125; <span class="keyword">from</span> <span class="string">'./profile'</span>;</div></pre></td></tr></table></figure>
<p><code>import</code>åé¢çš„<code>from</code>æŒ‡å®šæ¨¡å—æ–‡ä»¶çš„ä½ç½®ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œ<code>.js</code>è·¯å¾„å¯ä»¥çœç•¥ã€‚å¦‚æœåªæ˜¯æ¨¡å—åï¼Œä¸å¸¦æœ‰è·¯å¾„ï¼Œé‚£ä¹ˆå¿…é¡»æœ‰é…ç½®æ–‡ä»¶ï¼Œå‘Šè¯‰ JavaScript å¼•æ“è¯¥æ¨¡å—çš„ä½ç½®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123;myMethod&#125; <span class="keyword">from</span> <span class="string">'util'</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>util</code>æ˜¯æ¨¡å—æ–‡ä»¶åï¼Œç”±äºä¸å¸¦æœ‰è·¯å¾„ï¼Œå¿…é¡»é€šè¿‡é…ç½®ï¼Œå‘Šè¯‰å¼•æ“æ€ä¹ˆå–åˆ°è¿™ä¸ªæ¨¡å—ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>import</code>å‘½ä»¤å…·æœ‰æå‡æ•ˆæœï¼Œä¼šæå‡åˆ°æ•´ä¸ªæ¨¡å—çš„å¤´éƒ¨ï¼Œé¦–å…ˆæ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">foo();</div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸º<code>import</code>çš„æ‰§è¡Œæ—©äº<code>foo</code>çš„è°ƒç”¨ã€‚è¿™ç§è¡Œä¸ºçš„æœ¬è´¨æ˜¯ï¼Œ<code>import</code>å‘½ä»¤æ˜¯ç¼–è¯‘é˜¶æ®µæ‰§è¡Œçš„ï¼Œåœ¨ä»£ç è¿è¡Œä¹‹å‰ã€‚</p>
<p>ç”±äº<code>import</code>æ˜¯é™æ€æ‰§è¡Œï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è¡¨è¾¾å¼å’Œå˜é‡ï¼Œè¿™äº›åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½å¾—åˆ°ç»“æœçš„è¯­æ³•ç»“æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">import</span> &#123; <span class="string">'f'</span> + <span class="string">'oo'</span> &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">let</span> <span class="built_in">module</span> = <span class="string">'my_module'</span>;</div><div class="line"><span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="built_in">module</span>;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">if</span> (x === <span class="number">1</span>) &#123;</div><div class="line">  <span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">'module1'</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  <span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">'module2'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸‰ç§å†™æ³•éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®ƒä»¬ç”¨åˆ°äº†è¡¨è¾¾å¼ã€å˜é‡å’Œ<code>if</code>ç»“æ„ã€‚åœ¨é™æ€åˆ†æé˜¶æ®µï¼Œè¿™äº›è¯­æ³•éƒ½æ˜¯æ²¡æ³•å¾—åˆ°å€¼çš„ã€‚</p>
<p>æœ€åï¼Œ<code>import</code>è¯­å¥ä¼šæ‰§è¡Œæ‰€åŠ è½½çš„æ¨¡å—ï¼Œå› æ­¤å¯ä»¥æœ‰ä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="string">'lodash'</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä»…ä»…æ‰§è¡Œ<code>lodash</code>æ¨¡å—ï¼Œä½†æ˜¯ä¸è¾“å…¥ä»»ä½•å€¼ã€‚</p>
<p>å¦‚æœå¤šæ¬¡é‡å¤æ‰§è¡ŒåŒä¸€å¥<code>import</code>è¯­å¥ï¼Œé‚£ä¹ˆåªä¼šæ‰§è¡Œä¸€æ¬¡ï¼Œè€Œä¸ä¼šæ‰§è¡Œå¤šæ¬¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="string">'lodash'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'lodash'</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åŠ è½½äº†ä¸¤æ¬¡<code>lodash</code>ï¼Œä½†æ˜¯åªä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; foo &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</div><div class="line"><span class="keyword">import</span> &#123; bar &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">import</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè™½ç„¶<code>foo</code>å’Œ<code>bar</code>åœ¨ä¸¤ä¸ªè¯­å¥ä¸­åŠ è½½ï¼Œä½†æ˜¯å®ƒä»¬å¯¹åº”çš„æ˜¯åŒä¸€ä¸ª<code>my_module</code>å®ä¾‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>import</code>è¯­å¥æ˜¯ Singleton æ¨¡å¼ã€‚</p>
<h2 id="æ¨¡å—çš„æ•´ä½“åŠ è½½"><a href="#æ¨¡å—çš„æ•´ä½“åŠ è½½" class="headerlink" title="æ¨¡å—çš„æ•´ä½“åŠ è½½"></a>æ¨¡å—çš„æ•´ä½“åŠ è½½</h2><p>é™¤äº†æŒ‡å®šåŠ è½½æŸä¸ªè¾“å‡ºå€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ•´ä½“åŠ è½½ï¼Œå³ç”¨æ˜Ÿå·ï¼ˆ<code>*</code>ï¼‰æŒ‡å®šä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰è¾“å‡ºå€¼éƒ½åŠ è½½åœ¨è¿™ä¸ªå¯¹è±¡ä¸Šé¢ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ª<code>circle.js</code>æ–‡ä»¶ï¼Œå®ƒè¾“å‡ºä¸¤ä¸ªæ–¹æ³•<code>area</code>å’Œ<code>circumference</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// circle.js</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">area</span>(<span class="params">radius</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.PI * radius * radius;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">circumference</span>(<span class="params">radius</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="number">2</span> * <span class="built_in">Math</span>.PI * radius;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç°åœ¨ï¼ŒåŠ è½½è¿™ä¸ªæ¨¡å—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; area, circumference &#125; <span class="keyword">from</span> <span class="string">'./circle'</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'åœ†é¢ç§¯ï¼š'</span> + area(<span class="number">4</span>));</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'åœ†å‘¨é•¿ï¼š'</span> + circumference(<span class="number">14</span>));</div></pre></td></tr></table></figure>
<p>ä¸Šé¢å†™æ³•æ˜¯é€ä¸€æŒ‡å®šè¦åŠ è½½çš„æ–¹æ³•ï¼Œæ•´ä½“åŠ è½½çš„å†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> circle <span class="keyword">from</span> <span class="string">'./circle'</span>;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'åœ†é¢ç§¯ï¼š'</span> + circle.area(<span class="number">4</span>));</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'åœ†å‘¨é•¿ï¼š'</span> + circle.circumference(<span class="number">14</span>));</div></pre></td></tr></table></figure>
<h2 id="export-default-å‘½ä»¤"><a href="#export-default-å‘½ä»¤" class="headerlink" title="export default å‘½ä»¤"></a>export default å‘½ä»¤</h2><p>ä»å‰é¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œä½¿ç”¨<code>import</code>å‘½ä»¤çš„æ—¶å€™ï¼Œç”¨æˆ·éœ€è¦çŸ¥é“æ‰€è¦åŠ è½½çš„å˜é‡åæˆ–å‡½æ•°åï¼Œå¦åˆ™æ— æ³•åŠ è½½ã€‚ä½†æ˜¯ï¼Œç”¨æˆ·è‚¯å®šå¸Œæœ›å¿«é€Ÿä¸Šæ‰‹ï¼Œæœªå¿…æ„¿æ„é˜…è¯»æ–‡æ¡£ï¼Œå»äº†è§£æ¨¡å—æœ‰å“ªäº›å±æ€§å’Œæ–¹æ³•ã€‚</p>
<p>ä¸ºäº†ç»™ç”¨æˆ·æä¾›æ–¹ä¾¿ï¼Œè®©ä»–ä»¬ä¸ç”¨é˜…è¯»æ–‡æ¡£å°±èƒ½åŠ è½½æ¨¡å—ï¼Œå°±è¦ç”¨åˆ°<code>export default</code>å‘½ä»¤ï¼Œä¸ºæ¨¡å—æŒ‡å®šé»˜è®¤è¾“å‡ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// export-default.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªæ¨¡å—æ–‡ä»¶<code>export-default.js</code>ï¼Œå®ƒçš„é»˜è®¤è¾“å‡ºæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</p>
<p>å…¶ä»–æ¨¡å—åŠ è½½è¯¥æ¨¡å—æ—¶ï¼Œ<code>import</code>å‘½ä»¤å¯ä»¥ä¸ºè¯¥åŒ¿åå‡½æ•°æŒ‡å®šä»»æ„åå­—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// import-default.js</span></div><div class="line"><span class="keyword">import</span> customName <span class="keyword">from</span> <span class="string">'./export-default'</span>;</div><div class="line">customName(); <span class="comment">// 'foo'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>import</code>å‘½ä»¤ï¼Œå¯ä»¥ç”¨ä»»æ„åç§°æŒ‡å‘<code>export-default.js</code>è¾“å‡ºçš„æ–¹æ³•ï¼Œè¿™æ—¶å°±ä¸éœ€è¦çŸ¥é“åŸæ¨¡å—è¾“å‡ºçš„å‡½æ•°åã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ—¶<code>import</code>å‘½ä»¤åé¢ï¼Œä¸ä½¿ç”¨å¤§æ‹¬å·ã€‚</p>
<p><code>export default</code>å‘½ä»¤ç”¨åœ¨éåŒ¿åå‡½æ•°å‰ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// export-default.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æˆ–è€…å†™æˆ</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> foo;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>foo</code>å‡½æ•°çš„å‡½æ•°å<code>foo</code>ï¼Œåœ¨æ¨¡å—å¤–éƒ¨æ˜¯æ— æ•ˆçš„ã€‚åŠ è½½çš„æ—¶å€™ï¼Œè§†åŒåŒ¿åå‡½æ•°åŠ è½½ã€‚</p>
<p>ä¸‹é¢æ¯”è¾ƒä¸€ä¸‹é»˜è®¤è¾“å‡ºå’Œæ­£å¸¸è¾“å‡ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ç¬¬ä¸€ç»„</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">crc32</span>(<span class="params"></span>) </span>&#123; <span class="comment">// è¾“å‡º</span></div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">import</span> crc32 <span class="keyword">from</span> <span class="string">'crc32'</span>; <span class="comment">// è¾“å…¥</span></div><div class="line"></div><div class="line"><span class="comment">// ç¬¬äºŒç»„</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">crc32</span>(<span class="params"></span>) </span>&#123; <span class="comment">// è¾“å‡º</span></div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123;crc32&#125; <span class="keyword">from</span> <span class="string">'crc32'</span>; <span class="comment">// è¾“å…¥</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„ä¸¤ç»„å†™æ³•ï¼Œç¬¬ä¸€ç»„æ˜¯ä½¿ç”¨<code>export default</code>æ—¶ï¼Œå¯¹åº”çš„<code>import</code>è¯­å¥ä¸éœ€è¦ä½¿ç”¨å¤§æ‹¬å·ï¼›ç¬¬äºŒç»„æ˜¯ä¸ä½¿ç”¨<code>export default</code>æ—¶ï¼Œå¯¹åº”çš„<code>import</code>è¯­å¥éœ€è¦ä½¿ç”¨å¤§æ‹¬å·ã€‚</p>
<p><code>export default</code>å‘½ä»¤ç”¨äºæŒ‡å®šæ¨¡å—çš„é»˜è®¤è¾“å‡ºã€‚æ˜¾ç„¶ï¼Œä¸€ä¸ªæ¨¡å—åªèƒ½æœ‰ä¸€ä¸ªé»˜è®¤è¾“å‡ºï¼Œå› æ­¤<code>export default</code>å‘½ä»¤åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€‚æ‰€ä»¥ï¼Œ<code>import</code>å‘½ä»¤åé¢æ‰ä¸ç”¨åŠ å¤§æ‹¬å·ï¼Œå› ä¸ºåªå¯èƒ½å¯¹åº”ä¸€ä¸ªæ–¹æ³•ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼Œ<code>export default</code>å°±æ˜¯è¾“å‡ºä¸€ä¸ªå«åš<code>default</code>çš„å˜é‡æˆ–æ–¹æ³•ï¼Œç„¶åç³»ç»Ÿå…è®¸ä½ ä¸ºå®ƒå–ä»»æ„åå­—ã€‚æ‰€ä»¥ï¼Œä¸‹é¢çš„å†™æ³•æ˜¯æœ‰æ•ˆçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// modules.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x * y;</div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> &#123;add <span class="keyword">as</span> <span class="keyword">default</span>&#125;;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="comment">// export default add;</span></div><div class="line"></div><div class="line"><span class="comment">// app.js</span></div><div class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> xxx &#125; <span class="keyword">from</span> <span class="string">'modules'</span>;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="comment">// import xxx from 'modules';</span></div></pre></td></tr></table></figure>
<p>æ­£æ˜¯å› ä¸º<code>export default</code>å‘½ä»¤å…¶å®åªæ˜¯è¾“å‡ºä¸€ä¸ªå«åš<code>default</code>çš„å˜é‡ï¼Œæ‰€ä»¥å®ƒåé¢ä¸èƒ½è·Ÿå˜é‡å£°æ˜è¯­å¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ­£ç¡®</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="comment">// æ­£ç¡®</span></div><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> a;</div><div class="line"></div><div class="line"><span class="comment">// é”™è¯¯</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">var</span> a = <span class="number">1</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>export default a</code>çš„å«ä¹‰æ˜¯å°†å˜é‡<code>a</code>çš„å€¼èµ‹ç»™å˜é‡<code>default</code>ã€‚æ‰€ä»¥ï¼Œæœ€åä¸€ç§å†™æ³•ä¼šæŠ¥é”™ã€‚</p>
<p>æœ‰äº†<code>export default</code>å‘½ä»¤ï¼Œè¾“å…¥æ¨¡å—æ—¶å°±éå¸¸ç›´è§‚äº†ï¼Œä»¥è¾“å…¥ lodash æ¨¡å—ä¸ºä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span>;</div></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³åœ¨ä¸€æ¡<code>import</code>è¯­å¥ä¸­ï¼ŒåŒæ—¶è¾“å…¥é»˜è®¤æ–¹æ³•å’Œå…¶ä»–å˜é‡ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> _, &#123; each &#125; <span class="keyword">from</span> <span class="string">'lodash'</span>;</div></pre></td></tr></table></figure>
<p>å¯¹åº”ä¸Šé¢ä»£ç çš„<code>export</code>è¯­å¥å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="comment">// Â·Â·Â·</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">each</span>(<span class="params">obj, iterator, context</span>) </span>&#123;</div><div class="line">  <span class="comment">// Â·Â·Â·</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">export</span> &#123; each <span class="keyword">as</span> forEach &#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„æœ€åä¸€è¡Œçš„æ„æ€æ˜¯ï¼Œæš´éœ²å‡º<code>forEach</code>æ¥å£ï¼Œé»˜è®¤æŒ‡å‘<code>each</code>æ¥å£ï¼Œå³<code>forEach</code>å’Œ<code>each</code>æŒ‡å‘åŒä¸€ä¸ªæ–¹æ³•ã€‚</p>
<p>å¦‚æœè¦è¾“å‡ºé»˜è®¤çš„å€¼ï¼Œåªéœ€å°†å€¼è·Ÿåœ¨<code>export default</code>ä¹‹åå³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="number">42</span>;</div></pre></td></tr></table></figure>
<p><code>export default</code>ä¹Ÿå¯ä»¥ç”¨æ¥è¾“å‡ºç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// MyClass.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> </span>&#123; ... &#125;</div><div class="line"></div><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="keyword">import</span> MyClass <span class="keyword">from</span> <span class="string">'MyClass'</span>;</div><div class="line"><span class="keyword">let</span> o = <span class="keyword">new</span> MyClass();</div></pre></td></tr></table></figure>
<h2 id="export-ä¸-import-çš„å¤åˆå†™æ³•"><a href="#export-ä¸-import-çš„å¤åˆå†™æ³•" class="headerlink" title="export ä¸ import çš„å¤åˆå†™æ³•"></a>export ä¸ import çš„å¤åˆå†™æ³•</h2><p>å¦‚æœåœ¨ä¸€ä¸ªæ¨¡å—ä¹‹ä¸­ï¼Œå…ˆè¾“å…¥åè¾“å‡ºåŒä¸€ä¸ªæ¨¡å—ï¼Œ<code>import</code>è¯­å¥å¯ä»¥ä¸<code>export</code>è¯­å¥å†™åœ¨ä¸€èµ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">import</span> &#123; foo, bar &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</div><div class="line"><span class="keyword">export</span> &#123; foo, bar &#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>export</code>å’Œ<code>import</code>è¯­å¥å¯ä»¥ç»“åˆåœ¨ä¸€èµ·ï¼Œå†™æˆä¸€è¡Œã€‚</p>
<p>æ¨¡å—çš„æ¥å£æ”¹åå’Œæ•´ä½“è¾“å‡ºï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨è¿™ç§å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ¥å£æ”¹å</span></div><div class="line"><span class="keyword">export</span> &#123; foo <span class="keyword">as</span> myFoo &#125; <span class="keyword">from</span> <span class="string">'my_module'</span>;</div><div class="line"></div><div class="line"><span class="comment">// æ•´ä½“è¾“å‡º</span></div><div class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">'my_module'</span>;</div></pre></td></tr></table></figure>
<p>é»˜è®¤æ¥å£çš„å†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'foo'</span>;</div></pre></td></tr></table></figure>
<p>å…·åæ¥å£æ”¹ä¸ºé»˜è®¤æ¥å£çš„å†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> &#123; es6 <span class="keyword">as</span> <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'./someModule'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">import</span> &#123; es6 &#125; <span class="keyword">from</span> <span class="string">'./someModule'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> es6;</div></pre></td></tr></table></figure>
<p>åŒæ ·åœ°ï¼Œé»˜è®¤æ¥å£ä¹Ÿå¯ä»¥æ”¹åä¸ºå…·åæ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> es6 &#125; <span class="keyword">from</span> <span class="string">'./someModule'</span>;</div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼ŒES7æœ‰ä¸€ä¸ª<a href="https://github.com/leebyron/ecmascript-more-export-from" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œç®€åŒ–å…ˆè¾“å…¥åè¾“å‡ºçš„å†™æ³•ï¼Œæ‹¿æ‰è¾“å‡ºæ—¶çš„å¤§æ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ç°è¡Œçš„å†™æ³•</span></div><div class="line"><span class="keyword">export</span> &#123;v&#125; <span class="keyword">from</span> <span class="string">'mod'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ææ¡ˆçš„å†™æ³•</span></div><div class="line"><span class="keyword">export</span> v <span class="keyword">from</span> <span class="string">'mod'</span>;</div></pre></td></tr></table></figure>
<h2 id="æ¨¡å—çš„ç»§æ‰¿"><a href="#æ¨¡å—çš„ç»§æ‰¿" class="headerlink" title="æ¨¡å—çš„ç»§æ‰¿"></a>æ¨¡å—çš„ç»§æ‰¿</h2><p>æ¨¡å—ä¹‹é—´ä¹Ÿå¯ä»¥ç»§æ‰¿ã€‚</p>
<p>å‡è®¾æœ‰ä¸€ä¸ª<code>circleplus</code>æ¨¡å—ï¼Œç»§æ‰¿äº†<code>circle</code>æ¨¡å—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// circleplus.js</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> * <span class="keyword">from</span> <span class="string">'circle'</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> e = <span class="number">2.71828182846</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.exp(x);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­çš„<code>export *</code>ï¼Œè¡¨ç¤ºå†è¾“å‡º<code>circle</code>æ¨¡å—çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚æ³¨æ„ï¼Œ<code>export *</code>å‘½ä»¤ä¼šå¿½ç•¥<code>circle</code>æ¨¡å—çš„<code>default</code>æ–¹æ³•ã€‚ç„¶åï¼Œä¸Šé¢ä»£ç åˆè¾“å‡ºäº†è‡ªå®šä¹‰çš„<code>e</code>å˜é‡å’Œé»˜è®¤æ–¹æ³•ã€‚</p>
<p>è¿™æ—¶ï¼Œä¹Ÿå¯ä»¥å°†<code>circle</code>çš„å±æ€§æˆ–æ–¹æ³•ï¼Œæ”¹ååå†è¾“å‡ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// circleplus.js</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> &#123; area <span class="keyword">as</span> circleArea &#125; <span class="keyword">from</span> <span class="string">'circle'</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œåªè¾“å‡º<code>circle</code>æ¨¡å—çš„<code>area</code>æ–¹æ³•ï¼Œä¸”å°†å…¶æ”¹åä¸º<code>circleArea</code>ã€‚</p>
<p>åŠ è½½ä¸Šé¢æ¨¡å—çš„å†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.js</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> math <span class="keyword">from</span> <span class="string">'circleplus'</span>;</div><div class="line"><span class="keyword">import</span> exp <span class="keyword">from</span> <span class="string">'circleplus'</span>;</div><div class="line"><span class="built_in">console</span>.log(exp(math.e));</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­çš„<code>import exp</code>è¡¨ç¤ºï¼Œå°†<code>circleplus</code>æ¨¡å—çš„é»˜è®¤æ–¹æ³•åŠ è½½ä¸º<code>exp</code>æ–¹æ³•ã€‚</p>
<h2 id="ES6æ¨¡å—åŠ è½½çš„å®è´¨"><a href="#ES6æ¨¡å—åŠ è½½çš„å®è´¨" class="headerlink" title="ES6æ¨¡å—åŠ è½½çš„å®è´¨"></a>ES6æ¨¡å—åŠ è½½çš„å®è´¨</h2><p>ES6æ¨¡å—åŠ è½½çš„æœºåˆ¶ï¼Œä¸CommonJSæ¨¡å—å®Œå…¨ä¸åŒã€‚CommonJSæ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼Œè€ŒES6æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ã€‚</p>
<p>CommonJSæ¨¡å—è¾“å‡ºçš„æ˜¯è¢«è¾“å‡ºå€¼çš„æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦è¾“å‡ºä¸€ä¸ªå€¼ï¼Œæ¨¡å—å†…éƒ¨çš„å˜åŒ–å°±å½±å“ä¸åˆ°è¿™ä¸ªå€¼ã€‚è¯·çœ‹ä¸‹é¢è¿™ä¸ªæ¨¡å—æ–‡ä»¶<code>lib.js</code>çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// lib.js</span></div><div class="line"><span class="keyword">var</span> counter = <span class="number">3</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">incCounter</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  counter++;</div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">counter</span>: counter,</div><div class="line">  <span class="attr">incCounter</span>: incCounter,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¾“å‡ºå†…éƒ¨å˜é‡<code>counter</code>å’Œæ”¹å†™è¿™ä¸ªå˜é‡çš„å†…éƒ¨æ–¹æ³•<code>incCounter</code>ã€‚ç„¶åï¼Œåœ¨<code>main.js</code>é‡Œé¢åŠ è½½è¿™ä¸ªæ¨¡å—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="keyword">var</span> mod = <span class="built_in">require</span>(<span class="string">'./lib'</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(mod.counter);  <span class="comment">// 3</span></div><div class="line">mod.incCounter();</div><div class="line"><span class="built_in">console</span>.log(mod.counter); <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼Œ<code>lib.js</code>æ¨¡å—åŠ è½½ä»¥åï¼Œå®ƒçš„å†…éƒ¨å˜åŒ–å°±å½±å“ä¸åˆ°è¾“å‡ºçš„<code>mod.counter</code>äº†ã€‚è¿™æ˜¯å› ä¸º<code>mod.counter</code>æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¼šè¢«ç¼“å­˜ã€‚é™¤éå†™æˆä¸€ä¸ªå‡½æ•°ï¼Œæ‰èƒ½å¾—åˆ°å†…éƒ¨å˜åŠ¨åçš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// lib.js</span></div><div class="line"><span class="keyword">var</span> counter = <span class="number">3</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">incCounter</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  counter++;</div><div class="line">&#125;</div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  get counter() &#123;</div><div class="line">    <span class="keyword">return</span> counter</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">incCounter</span>: incCounter,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè¾“å‡ºçš„<code>counter</code>å±æ€§å®é™…ä¸Šæ˜¯ä¸€ä¸ªå–å€¼å™¨å‡½æ•°ã€‚ç°åœ¨å†æ‰§è¡Œ<code>main.js</code>ï¼Œå°±å¯ä»¥æ­£ç¡®è¯»å–å†…éƒ¨å˜é‡<code>counter</code>çš„å˜åŠ¨äº†ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ node main.js</div><div class="line">3</div><div class="line">4</div></pre></td></tr></table></figure>
<p>ES6æ¨¡å—çš„è¿è¡Œæœºåˆ¶ä¸CommonJSä¸ä¸€æ ·ï¼Œå®ƒé‡åˆ°æ¨¡å—åŠ è½½å‘½ä»¤<code>import</code>æ—¶ï¼Œä¸ä¼šå»æ‰§è¡Œæ¨¡å—ï¼Œè€Œæ˜¯åªç”Ÿæˆä¸€ä¸ªåŠ¨æ€çš„åªè¯»å¼•ç”¨ã€‚ç­‰åˆ°çœŸçš„éœ€è¦ç”¨åˆ°æ—¶ï¼Œå†åˆ°æ¨¡å—é‡Œé¢å»å–å€¼ï¼Œæ¢å¥è¯è¯´ï¼ŒES6çš„è¾“å…¥æœ‰ç‚¹åƒUnixç³»ç»Ÿçš„â€œç¬¦å·è¿æ¥â€ï¼ŒåŸå§‹å€¼å˜äº†ï¼Œ<code>import</code>è¾“å…¥çš„å€¼ä¹Ÿä¼šè·Ÿç€å˜ã€‚å› æ­¤ï¼ŒES6æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå¹¶ä¸”ä¸ä¼šç¼“å­˜å€¼ï¼Œæ¨¡å—é‡Œé¢çš„å˜é‡ç»‘å®šå…¶æ‰€åœ¨çš„æ¨¡å—ã€‚</p>
<p>è¿˜æ˜¯ä¸¾ä¸Šé¢çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// lib.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">let</span> counter = <span class="number">3</span>;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">incCounter</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  counter++;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="keyword">import</span> &#123; counter, incCounter &#125; <span class="keyword">from</span> <span class="string">'./lib'</span>;</div><div class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 3</span></div><div class="line">incCounter();</div><div class="line"><span class="built_in">console</span>.log(counter); <span class="comment">// 4</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼ŒES6æ¨¡å—è¾“å…¥çš„å˜é‡<code>counter</code>æ˜¯æ´»çš„ï¼Œå®Œå…¨ååº”å…¶æ‰€åœ¨æ¨¡å—<code>lib.js</code>å†…éƒ¨çš„å˜åŒ–ã€‚</p>
<p>å†ä¸¾ä¸€ä¸ªå‡ºç°åœ¨<code>export</code>ä¸€èŠ‚ä¸­çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// m1.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> foo = <span class="string">'bar'</span>;</div><div class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> foo = <span class="string">'baz'</span>, <span class="number">500</span>);</div><div class="line"></div><div class="line"><span class="comment">// m2.js</span></div><div class="line"><span class="keyword">import</span> &#123;foo&#125; <span class="keyword">from</span> <span class="string">'./m1.js'</span>;</div><div class="line"><span class="built_in">console</span>.log(foo);</div><div class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(foo), <span class="number">500</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>m1.js</code>çš„å˜é‡<code>foo</code>ï¼Œåœ¨åˆšåŠ è½½æ—¶ç­‰äº<code>bar</code>ï¼Œè¿‡äº†500æ¯«ç§’ï¼Œåˆå˜ä¸ºç­‰äº<code>baz</code>ã€‚</p>
<p>è®©æˆ‘ä»¬çœ‹çœ‹ï¼Œ<code>m2.js</code>èƒ½å¦æ­£ç¡®è¯»å–è¿™ä¸ªå˜åŒ–ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ babel-node m2.js</div><div class="line"></div><div class="line">bar</div><div class="line">baz</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨æ˜ï¼ŒES6æ¨¡å—ä¸ä¼šç¼“å­˜è¿è¡Œç»“æœï¼Œè€Œæ˜¯åŠ¨æ€åœ°å»è¢«åŠ è½½çš„æ¨¡å—å–å€¼ï¼Œå¹¶ä¸”å˜é‡æ€»æ˜¯ç»‘å®šå…¶æ‰€åœ¨çš„æ¨¡å—ã€‚</p>
<p>ç”±äºES6è¾“å…¥çš„æ¨¡å—å˜é‡ï¼Œåªæ˜¯ä¸€ä¸ªâ€œç¬¦å·è¿æ¥â€ï¼Œæ‰€ä»¥è¿™ä¸ªå˜é‡æ˜¯åªè¯»çš„ï¼Œå¯¹å®ƒè¿›è¡Œé‡æ–°èµ‹å€¼ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// lib.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">let</span> obj = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="keyword">import</span> &#123; obj &#125; <span class="keyword">from</span> <span class="string">'./lib'</span>;</div><div class="line"></div><div class="line">obj.prop = <span class="number">123</span>; <span class="comment">// OK</span></div><div class="line">obj = &#123;&#125;; <span class="comment">// TypeError</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>main.js</code>ä»<code>lib.js</code>è¾“å…¥å˜é‡<code>obj</code>ï¼Œå¯ä»¥å¯¹<code>obj</code>æ·»åŠ å±æ€§ï¼Œä½†æ˜¯é‡æ–°èµ‹å€¼å°±ä¼šæŠ¥é”™ã€‚å› ä¸ºå˜é‡<code>obj</code>æŒ‡å‘çš„åœ°å€æ˜¯åªè¯»çš„ï¼Œä¸èƒ½é‡æ–°èµ‹å€¼ï¼Œè¿™å°±å¥½æ¯”<code>main.js</code>åˆ›é€ äº†ä¸€ä¸ªåä¸º<code>obj</code>çš„constå˜é‡ã€‚</p>
<p>æœ€åï¼Œ<code>export</code>é€šè¿‡æ¥å£ï¼Œè¾“å‡ºçš„æ˜¯åŒä¸€ä¸ªå€¼ã€‚ä¸åŒçš„è„šæœ¬åŠ è½½è¿™ä¸ªæ¥å£ï¼Œå¾—åˆ°çš„éƒ½æ˜¯åŒæ ·çš„å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mod.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">C</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.sum = <span class="number">0</span>;</div><div class="line">  <span class="keyword">this</span>.add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.sum += <span class="number">1</span>;</div><div class="line">  &#125;;</div><div class="line">  <span class="keyword">this</span>.show = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.sum);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">let</span> c = <span class="keyword">new</span> C();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è„šæœ¬<code>mod.js</code>ï¼Œè¾“å‡ºçš„æ˜¯ä¸€ä¸ª<code>C</code>çš„å®ä¾‹ã€‚ä¸åŒçš„è„šæœ¬åŠ è½½è¿™ä¸ªæ¨¡å—ï¼Œå¾—åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// x.js</span></div><div class="line"><span class="keyword">import</span> &#123;c&#125; <span class="keyword">from</span> <span class="string">'./mod'</span>;</div><div class="line">c.add();</div><div class="line"></div><div class="line"><span class="comment">// y.js</span></div><div class="line"><span class="keyword">import</span> &#123;c&#125; <span class="keyword">from</span> <span class="string">'./mod'</span>;</div><div class="line">c.show();</div><div class="line"></div><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="keyword">import</span> <span class="string">'./x'</span>;</div><div class="line"><span class="keyword">import</span> <span class="string">'./y'</span>;</div></pre></td></tr></table></figure>
<p>ç°åœ¨æ‰§è¡Œ<code>main.js</code>ï¼Œè¾“å‡ºçš„æ˜¯1ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ babel-node main.js</div><div class="line">1</div></pre></td></tr></table></figure>
<p>è¿™å°±è¯æ˜äº†<code>x.js</code>å’Œ<code>y.js</code>åŠ è½½çš„éƒ½æ˜¯<code>C</code>çš„åŒä¸€ä¸ªå®ä¾‹ã€‚</p>
<h2 id="æµè§ˆå™¨çš„æ¨¡å—åŠ è½½"><a href="#æµè§ˆå™¨çš„æ¨¡å—åŠ è½½" class="headerlink" title="æµè§ˆå™¨çš„æ¨¡å—åŠ è½½"></a>æµè§ˆå™¨çš„æ¨¡å—åŠ è½½</h2><p>æµè§ˆå™¨ä½¿ç”¨ ES6 æ¨¡å—çš„è¯­æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span> <span class="attr">src</span>=<span class="string">"foo.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨ç½‘é¡µä¸­æ’å…¥ä¸€ä¸ªæ¨¡å—<code>foo.js</code>ï¼Œç”±äº<code>type</code>å±æ€§è®¾ä¸º<code>module</code>ï¼Œæ‰€ä»¥æµè§ˆå™¨çŸ¥é“è¿™æ˜¯ä¸€ä¸ª ES6 æ¨¡å—ã€‚</p>
<p>æµè§ˆå™¨å¯¹äºå¸¦æœ‰<code>type=&quot;module&quot;</code>çš„<code>&lt;script&gt;</code>ï¼Œéƒ½æ˜¯å¼‚æ­¥åŠ è½½å¤–éƒ¨è„šæœ¬ï¼Œä¸ä¼šé€ æˆå µå¡æµè§ˆå™¨ã€‚</p>
<p>å¯¹äºå¤–éƒ¨çš„æ¨¡å—è„šæœ¬ï¼ˆä¸Šä¾‹æ˜¯<code>foo.js</code>ï¼‰ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚</p>
<ul>
<li>è¯¥è„šæœ¬è‡ªåŠ¨é‡‡ç”¨ä¸¥æ ¼æ¨¡å—ã€‚</li>
<li>è¯¥è„šæœ¬å†…éƒ¨çš„é¡¶å±‚å˜é‡ï¼Œéƒ½åªåœ¨è¯¥è„šæœ¬å†…éƒ¨æœ‰æ•ˆï¼Œå¤–éƒ¨ä¸å¯è§ã€‚</li>
<li>è¯¥è„šæœ¬å†…éƒ¨çš„é¡¶å±‚çš„<code>this</code>å…³é”®å­—ï¼Œè¿”å›<code>undefined</code>ï¼Œè€Œä¸æ˜¯æŒ‡å‘<code>window</code>ã€‚</li>
</ul>
<h2 id="å¾ªç¯åŠ è½½"><a href="#å¾ªç¯åŠ è½½" class="headerlink" title="å¾ªç¯åŠ è½½"></a>å¾ªç¯åŠ è½½</h2><p>â€œå¾ªç¯åŠ è½½â€ï¼ˆcircular dependencyï¼‰æŒ‡çš„æ˜¯ï¼Œ<code>a</code>è„šæœ¬çš„æ‰§è¡Œä¾èµ–<code>b</code>è„šæœ¬ï¼Œè€Œ<code>b</code>è„šæœ¬çš„æ‰§è¡Œåˆä¾èµ–<code>a</code>è„šæœ¬ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// a.js</span></div><div class="line"><span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">'b'</span>);</div><div class="line"></div><div class="line"><span class="comment">// b.js</span></div><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'a'</span>);</div></pre></td></tr></table></figure>
<p>é€šå¸¸ï¼Œâ€œå¾ªç¯åŠ è½½â€è¡¨ç¤ºå­˜åœ¨å¼ºè€¦åˆï¼Œå¦‚æœå¤„ç†ä¸å¥½ï¼Œè¿˜å¯èƒ½å¯¼è‡´é€’å½’åŠ è½½ï¼Œä½¿å¾—ç¨‹åºæ— æ³•æ‰§è¡Œï¼Œå› æ­¤åº”è¯¥é¿å…å‡ºç°ã€‚</p>
<p>ä½†æ˜¯å®é™…ä¸Šï¼Œè¿™æ˜¯å¾ˆéš¾é¿å…çš„ï¼Œå°¤å…¶æ˜¯ä¾èµ–å…³ç³»å¤æ‚çš„å¤§é¡¹ç›®ï¼Œå¾ˆå®¹æ˜“å‡ºç°<code>a</code>ä¾èµ–<code>b</code>ï¼Œ<code>b</code>ä¾èµ–<code>c</code>ï¼Œ<code>c</code>åˆä¾èµ–<code>a</code>è¿™æ ·çš„æƒ…å†µã€‚è¿™æ„å‘³ç€ï¼Œæ¨¡å—åŠ è½½æœºåˆ¶å¿…é¡»è€ƒè™‘â€œå¾ªç¯åŠ è½½â€çš„æƒ…å†µã€‚</p>
<p>å¯¹äºJavaScriptè¯­è¨€æ¥è¯´ï¼Œç›®å‰æœ€å¸¸è§çš„ä¸¤ç§æ¨¡å—æ ¼å¼CommonJSå’ŒES6ï¼Œå¤„ç†â€œå¾ªç¯åŠ è½½â€çš„æ–¹æ³•æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿”å›çš„ç»“æœä¹Ÿä¸ä¸€æ ·ã€‚</p>
<h3 id="CommonJSæ¨¡å—çš„åŠ è½½åŸç†"><a href="#CommonJSæ¨¡å—çš„åŠ è½½åŸç†" class="headerlink" title="CommonJSæ¨¡å—çš„åŠ è½½åŸç†"></a>CommonJSæ¨¡å—çš„åŠ è½½åŸç†</h3><p>ä»‹ç»ES6å¦‚ä½•å¤„ç†â€å¾ªç¯åŠ è½½â€ä¹‹å‰ï¼Œå…ˆä»‹ç»ç›®å‰æœ€æµè¡Œçš„CommonJSæ¨¡å—æ ¼å¼çš„åŠ è½½åŸç†ã€‚</p>
<p>CommonJSçš„ä¸€ä¸ªæ¨¡å—ï¼Œå°±æ˜¯ä¸€ä¸ªè„šæœ¬æ–‡ä»¶ã€‚<code>require</code>å‘½ä»¤ç¬¬ä¸€æ¬¡åŠ è½½è¯¥è„šæœ¬ï¼Œå°±ä¼šæ‰§è¡Œæ•´ä¸ªè„šæœ¬ï¼Œç„¶ååœ¨å†…å­˜ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="attr">id</span>: <span class="string">'...'</span>,</div><div class="line">  <span class="attr">exports</span>: &#123; ... &#125;,</div><div class="line">  <span class="attr">loaded</span>: <span class="literal">true</span>,</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°±æ˜¯Nodeå†…éƒ¨åŠ è½½æ¨¡å—åç”Ÿæˆçš„ä¸€ä¸ªå¯¹è±¡ã€‚è¯¥å¯¹è±¡çš„<code>id</code>å±æ€§æ˜¯æ¨¡å—åï¼Œ<code>exports</code>å±æ€§æ˜¯æ¨¡å—è¾“å‡ºçš„å„ä¸ªæ¥å£ï¼Œ<code>loaded</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥æ¨¡å—çš„è„šæœ¬æ˜¯å¦æ‰§è¡Œå®Œæ¯•ã€‚å…¶ä»–è¿˜æœ‰å¾ˆå¤šå±æ€§ï¼Œè¿™é‡Œéƒ½çœç•¥äº†ã€‚</p>
<p>ä»¥åéœ€è¦ç”¨åˆ°è¿™ä¸ªæ¨¡å—çš„æ—¶å€™ï¼Œå°±ä¼šåˆ°<code>exports</code>å±æ€§ä¸Šé¢å–å€¼ã€‚å³ä½¿å†æ¬¡æ‰§è¡Œ<code>require</code>å‘½ä»¤ï¼Œä¹Ÿä¸ä¼šå†æ¬¡æ‰§è¡Œè¯¥æ¨¡å—ï¼Œè€Œæ˜¯åˆ°ç¼“å­˜ä¹‹ä¸­å–å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒCommonJSæ¨¡å—æ— è®ºåŠ è½½å¤šå°‘æ¬¡ï¼Œéƒ½åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½æ—¶è¿è¡Œä¸€æ¬¡ï¼Œä»¥åå†åŠ è½½ï¼Œå°±è¿”å›ç¬¬ä¸€æ¬¡è¿è¡Œçš„ç»“æœï¼Œé™¤éæ‰‹åŠ¨æ¸…é™¤ç³»ç»Ÿç¼“å­˜ã€‚</p>
<h3 id="CommonJSæ¨¡å—çš„å¾ªç¯åŠ è½½"><a href="#CommonJSæ¨¡å—çš„å¾ªç¯åŠ è½½" class="headerlink" title="CommonJSæ¨¡å—çš„å¾ªç¯åŠ è½½"></a>CommonJSæ¨¡å—çš„å¾ªç¯åŠ è½½</h3><p>CommonJSæ¨¡å—çš„é‡è¦ç‰¹æ€§æ˜¯åŠ è½½æ—¶æ‰§è¡Œï¼Œå³è„šæœ¬ä»£ç åœ¨<code>require</code>çš„æ—¶å€™ï¼Œå°±ä¼šå…¨éƒ¨æ‰§è¡Œã€‚ä¸€æ—¦å‡ºç°æŸä¸ªæ¨¡å—è¢«â€å¾ªç¯åŠ è½½â€ï¼Œå°±åªè¾“å‡ºå·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œè¿˜æœªæ‰§è¡Œçš„éƒ¨åˆ†ä¸ä¼šè¾“å‡ºã€‚</p>
<p>è®©æˆ‘ä»¬æ¥çœ‹ï¼ŒNode<a href="https://nodejs.org/api/modules.html#modules_cycles" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>é‡Œé¢çš„ä¾‹å­ã€‚è„šæœ¬æ–‡ä»¶<code>a.js</code>ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">exports.done = <span class="literal">false</span>;</div><div class="line"><span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">'./b.js'</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'åœ¨ a.js ä¹‹ä¸­ï¼Œb.done = %j'</span>, b.done);</div><div class="line">exports.done = <span class="literal">true</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'a.js æ‰§è¡Œå®Œæ¯•'</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œ<code>a.js</code>è„šæœ¬å…ˆè¾“å‡ºä¸€ä¸ª<code>done</code>å˜é‡ï¼Œç„¶ååŠ è½½å¦ä¸€ä¸ªè„šæœ¬æ–‡ä»¶<code>b.js</code>ã€‚æ³¨æ„ï¼Œæ­¤æ—¶<code>a.js</code>ä»£ç å°±åœåœ¨è¿™é‡Œï¼Œç­‰å¾…<code>b.js</code>æ‰§è¡Œå®Œæ¯•ï¼Œå†å¾€ä¸‹æ‰§è¡Œã€‚</p>
<p>å†çœ‹<code>b.js</code>çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">exports.done = <span class="literal">false</span>;</div><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./a.js'</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'åœ¨ b.js ä¹‹ä¸­ï¼Œa.done = %j'</span>, a.done);</div><div class="line">exports.done = <span class="literal">true</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'b.js æ‰§è¡Œå®Œæ¯•'</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œ<code>b.js</code>æ‰§è¡Œåˆ°ç¬¬äºŒè¡Œï¼Œå°±ä¼šå»åŠ è½½<code>a.js</code>ï¼Œè¿™æ—¶ï¼Œå°±å‘ç”Ÿäº†â€œå¾ªç¯åŠ è½½â€ã€‚ç³»ç»Ÿä¼šå»<code>a.js</code>æ¨¡å—å¯¹åº”å¯¹è±¡çš„<code>exports</code>å±æ€§å–å€¼ï¼Œå¯æ˜¯å› ä¸º<code>a.js</code>è¿˜æ²¡æœ‰æ‰§è¡Œå®Œï¼Œä»<code>exports</code>å±æ€§åªèƒ½å–å›å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œè€Œä¸æ˜¯æœ€åçš„å€¼ã€‚</p>
<p><code>a.js</code>å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼Œåªæœ‰ä¸€è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exports.done = <span class="literal">false</span>;</div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œå¯¹äº<code>b.js</code>æ¥è¯´ï¼Œå®ƒä»<code>a.js</code>åªè¾“å…¥ä¸€ä¸ªå˜é‡<code>done</code>ï¼Œå€¼ä¸º<code>false</code>ã€‚</p>
<p>ç„¶åï¼Œ<code>b.js</code>æ¥ç€å¾€ä¸‹æ‰§è¡Œï¼Œç­‰åˆ°å…¨éƒ¨æ‰§è¡Œå®Œæ¯•ï¼Œå†æŠŠæ‰§è¡Œæƒäº¤è¿˜ç»™<code>a.js</code>ã€‚äºæ˜¯ï¼Œ<code>a.js</code>æ¥ç€å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°æ‰§è¡Œå®Œæ¯•ã€‚æˆ‘ä»¬å†™ä¸€ä¸ªè„šæœ¬<code>main.js</code>ï¼ŒéªŒè¯è¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./a.js'</span>);</div><div class="line"><span class="keyword">var</span> b = <span class="built_in">require</span>(<span class="string">'./b.js'</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'åœ¨ main.js ä¹‹ä¸­, a.done=%j, b.done=%j'</span>, a.done, b.done);</div></pre></td></tr></table></figure>
<p>æ‰§è¡Œ<code>main.js</code>ï¼Œè¿è¡Œç»“æœå¦‚ä¸‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">$ node main.js</div><div class="line"></div><div class="line">åœ¨ b.js ä¹‹ä¸­ï¼Œa.done = <span class="literal">false</span></div><div class="line">b.js æ‰§è¡Œå®Œæ¯•</div><div class="line">åœ¨ a.js ä¹‹ä¸­ï¼Œb.done = <span class="literal">true</span></div><div class="line">a.js æ‰§è¡Œå®Œæ¯•</div><div class="line">åœ¨ main.js ä¹‹ä¸­, a.done=<span class="literal">true</span>, b.done=<span class="literal">true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç è¯æ˜äº†ä¸¤ä»¶äº‹ã€‚ä¸€æ˜¯ï¼Œåœ¨<code>b.js</code>ä¹‹ä¸­ï¼Œ<code>a.js</code>æ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œåªæ‰§è¡Œäº†ç¬¬ä¸€è¡Œã€‚äºŒæ˜¯ï¼Œ<code>main.js</code>æ‰§è¡Œåˆ°ç¬¬äºŒè¡Œæ—¶ï¼Œä¸ä¼šå†æ¬¡æ‰§è¡Œ<code>b.js</code>ï¼Œè€Œæ˜¯è¾“å‡ºç¼“å­˜çš„<code>b.js</code>çš„æ‰§è¡Œç»“æœï¼Œå³å®ƒçš„ç¬¬å››è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">exports.done = <span class="literal">true</span>;</div></pre></td></tr></table></figure>
<p>æ€»ä¹‹ï¼ŒCommonJSè¾“å…¥çš„æ˜¯è¢«è¾“å‡ºå€¼çš„æ‹·è´ï¼Œä¸æ˜¯å¼•ç”¨ã€‚</p>
<p>å¦å¤–ï¼Œç”±äºCommonJSæ¨¡å—é‡åˆ°å¾ªç¯åŠ è½½æ—¶ï¼Œè¿”å›çš„æ˜¯å½“å‰å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†çš„å€¼ï¼Œè€Œä¸æ˜¯ä»£ç å…¨éƒ¨æ‰§è¡Œåçš„å€¼ï¼Œä¸¤è€…å¯èƒ½ä¼šæœ‰å·®å¼‚ã€‚æ‰€ä»¥ï¼Œè¾“å…¥å˜é‡çš„æ—¶å€™ï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'a'</span>); <span class="comment">// å®‰å…¨çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> foo = <span class="built_in">require</span>(<span class="string">'a'</span>).foo; <span class="comment">// å±é™©çš„å†™æ³•</span></div><div class="line"></div><div class="line">exports.good = <span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a.foo(<span class="string">'good'</span>, arg); <span class="comment">// ä½¿ç”¨çš„æ˜¯ a.foo çš„æœ€æ–°å€¼</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">exports.bad = <span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> foo(<span class="string">'bad'</span>, arg); <span class="comment">// ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªéƒ¨åˆ†åŠ è½½æ—¶çš„å€¼</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå‘ç”Ÿå¾ªç¯åŠ è½½ï¼Œ<code>require(&#39;a&#39;).foo</code>çš„å€¼å¾ˆå¯èƒ½åé¢ä¼šè¢«æ”¹å†™ï¼Œæ”¹ç”¨<code>require(&#39;a&#39;)</code>ä¼šæ›´ä¿é™©ä¸€ç‚¹ã€‚</p>
<h3 id="ES6æ¨¡å—çš„å¾ªç¯åŠ è½½"><a href="#ES6æ¨¡å—çš„å¾ªç¯åŠ è½½" class="headerlink" title="ES6æ¨¡å—çš„å¾ªç¯åŠ è½½"></a>ES6æ¨¡å—çš„å¾ªç¯åŠ è½½</h3><p>ES6å¤„ç†â€œå¾ªç¯åŠ è½½â€ä¸CommonJSæœ‰æœ¬è´¨çš„ä¸åŒã€‚ES6æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå¦‚æœä½¿ç”¨<code>import</code>ä»ä¸€ä¸ªæ¨¡å—åŠ è½½å˜é‡ï¼ˆå³<code>import foo from &#39;foo&#39;</code>ï¼‰ï¼Œé‚£äº›å˜é‡ä¸ä¼šè¢«ç¼“å­˜ï¼Œè€Œæ˜¯æˆä¸ºä¸€ä¸ªæŒ‡å‘è¢«åŠ è½½æ¨¡å—çš„å¼•ç”¨ï¼Œéœ€è¦å¼€å‘è€…è‡ªå·±ä¿è¯ï¼ŒçœŸæ­£å–å€¼çš„æ—¶å€™èƒ½å¤Ÿå–åˆ°å€¼ã€‚</p>
<p>è¯·çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// a.jså¦‚ä¸‹</span></div><div class="line"><span class="keyword">import</span> &#123;bar&#125; <span class="keyword">from</span> <span class="string">'./b.js'</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'a.js'</span>);</div><div class="line"><span class="built_in">console</span>.log(bar);</div><div class="line"><span class="keyword">export</span> <span class="keyword">let</span> foo = <span class="string">'foo'</span>;</div><div class="line"></div><div class="line"><span class="comment">// b.js</span></div><div class="line"><span class="keyword">import</span> &#123;foo&#125; <span class="keyword">from</span> <span class="string">'./a.js'</span>;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'b.js'</span>);</div><div class="line"><span class="built_in">console</span>.log(foo);</div><div class="line"><span class="keyword">export</span> <span class="keyword">let</span> bar = <span class="string">'bar'</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>a.js</code>åŠ è½½<code>b.js</code>ï¼Œ<code>b.js</code>åˆåŠ è½½<code>a.js</code>ï¼Œæ„æˆå¾ªç¯åŠ è½½ã€‚æ‰§è¡Œ<code>a.js</code>ï¼Œç»“æœå¦‚ä¸‹ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ babel-node a.js</div><div class="line">b.js</div><div class="line">undefined</div><div class="line">a.js</div><div class="line">bar</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº<code>a.js</code>çš„ç¬¬ä¸€è¡Œæ˜¯åŠ è½½<code>b.js</code>ï¼Œæ‰€ä»¥å…ˆæ‰§è¡Œçš„æ˜¯<code>b.js</code>ã€‚è€Œ<code>b.js</code>çš„ç¬¬ä¸€è¡Œåˆæ˜¯åŠ è½½<code>a.js</code>ï¼Œè¿™æ—¶ç”±äº<code>a.js</code>å·²ç»å¼€å§‹æ‰§è¡Œäº†ï¼Œæ‰€ä»¥ä¸ä¼šé‡å¤æ‰§è¡Œï¼Œè€Œæ˜¯ç»§ç»­å¾€ä¸‹æ‰§è¡Œ<code>b.js</code>ï¼Œæ‰€ä»¥ç¬¬ä¸€è¡Œè¾“å‡ºçš„æ˜¯<code>b.js</code>ã€‚</p>
<p>æ¥ç€ï¼Œ<code>b.js</code>è¦æ‰“å°å˜é‡<code>foo</code>ï¼Œè¿™æ—¶<code>a.js</code>è¿˜æ²¡æ‰§è¡Œå®Œï¼Œå–ä¸åˆ°<code>foo</code>çš„å€¼ï¼Œå¯¼è‡´æ‰“å°å‡ºæ¥æ˜¯<code>undefined</code>ã€‚<code>b.js</code>æ‰§è¡Œå®Œï¼Œå¼€å§‹æ‰§è¡Œ<code>a.js</code>ï¼Œè¿™æ—¶å°±ä¸€åˆ‡æ­£å¸¸äº†ã€‚</p>
<p>å†çœ‹ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­ï¼ˆæ‘˜è‡ª Dr. Axel Rauschmayer çš„<a href="http://exploringjs.com/es6/ch_modules.html" target="_blank" rel="external">ã€ŠExploring ES6ã€‹</a>ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// a.js</span></div><div class="line"><span class="keyword">import</span> &#123;bar&#125; <span class="keyword">from</span> <span class="string">'./b.js'</span>;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>);</div><div class="line">  bar();</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'æ‰§è¡Œå®Œæ¯•'</span>);</div><div class="line">&#125;</div><div class="line">foo();</div><div class="line"></div><div class="line"><span class="comment">// b.js</span></div><div class="line"><span class="keyword">import</span> &#123;foo&#125; <span class="keyword">from</span> <span class="string">'./a.js'</span>;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'bar'</span>);</div><div class="line">  <span class="keyword">if</span> (<span class="built_in">Math</span>.random() &gt; <span class="number">0.5</span>) &#123;</div><div class="line">    foo();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æŒ‰ç…§CommonJSè§„èŒƒï¼Œä¸Šé¢çš„ä»£ç æ˜¯æ²¡æ³•æ‰§è¡Œçš„ã€‚<code>a</code>å…ˆåŠ è½½<code>b</code>ï¼Œç„¶å<code>b</code>åˆåŠ è½½<code>a</code>ï¼Œè¿™æ—¶<code>a</code>è¿˜æ²¡æœ‰ä»»ä½•æ‰§è¡Œç»“æœï¼Œæ‰€ä»¥è¾“å‡ºç»“æœä¸º<code>null</code>ï¼Œå³å¯¹äº<code>b.js</code>æ¥è¯´ï¼Œå˜é‡<code>foo</code>çš„å€¼ç­‰äº<code>null</code>ï¼Œåé¢çš„<code>foo()</code>å°±ä¼šæŠ¥é”™ã€‚</p>
<p>ä½†æ˜¯ï¼ŒES6å¯ä»¥æ‰§è¡Œä¸Šé¢çš„ä»£ç ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">$ babel-node a.js</div><div class="line">foo</div><div class="line">bar</div><div class="line">æ‰§è¡Œå®Œæ¯•</div><div class="line"></div><div class="line">// æ‰§è¡Œç»“æœä¹Ÿæœ‰å¯èƒ½æ˜¯</div><div class="line">foo</div><div class="line">bar</div><div class="line">foo</div><div class="line">bar</div><div class="line">æ‰§è¡Œå®Œæ¯•</div><div class="line">æ‰§è¡Œå®Œæ¯•</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>a.js</code>ä¹‹æ‰€ä»¥èƒ½å¤Ÿæ‰§è¡Œï¼ŒåŸå› å°±åœ¨äºES6åŠ è½½çš„å˜é‡ï¼Œéƒ½æ˜¯åŠ¨æ€å¼•ç”¨å…¶æ‰€åœ¨çš„æ¨¡å—ã€‚åªè¦å¼•ç”¨å­˜åœ¨ï¼Œä»£ç å°±èƒ½æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬è¯¦ç»†åˆ†æè¿™æ®µä»£ç çš„è¿è¡Œè¿‡ç¨‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// a.js</span></div><div class="line"></div><div class="line"><span class="comment">// è¿™ä¸€è¡Œå»ºç«‹ä¸€ä¸ªå¼•ç”¨ï¼Œ</span></div><div class="line"><span class="comment">// ä»`b.js`å¼•ç”¨`bar`</span></div><div class="line"><span class="keyword">import</span> &#123;bar&#125; <span class="keyword">from</span> <span class="string">'./b.js'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// æ‰§è¡Œæ—¶ç¬¬ä¸€è¡Œè¾“å‡º foo</span></div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'foo'</span>);</div><div class="line">  <span class="comment">// åˆ° b.js æ‰§è¡Œ bar</span></div><div class="line">  bar();</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'æ‰§è¡Œå®Œæ¯•'</span>);</div><div class="line">&#125;</div><div class="line">foo();</div><div class="line"></div><div class="line"><span class="comment">// b.js</span></div><div class="line"></div><div class="line"><span class="comment">// å»ºç«‹`a.js`çš„`foo`å¼•ç”¨</span></div><div class="line"><span class="keyword">import</span> &#123;foo&#125; <span class="keyword">from</span> <span class="string">'./a.js'</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// æ‰§è¡Œæ—¶ï¼Œç¬¬äºŒè¡Œè¾“å‡º bar</span></div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'bar'</span>);</div><div class="line">  <span class="comment">// é€’å½’æ‰§è¡Œ fooï¼Œä¸€æ—¦éšæœºæ•°</span></div><div class="line">  <span class="comment">// å°äºç­‰äº0.5ï¼Œå°±åœæ­¢æ‰§è¡Œ</span></div><div class="line">  <span class="keyword">if</span> (<span class="built_in">Math</span>.random() &gt; <span class="number">0.5</span>) &#123;</div><div class="line">    foo();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å†æ¥çœ‹ES6æ¨¡å—åŠ è½½å™¨<a href="https://github.com/ModuleLoader/es6-module-loader/blob/master/docs/circular-references-bindings.md" target="_blank" rel="external">SystemJS</a>ç»™å‡ºçš„ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// even.js</span></div><div class="line"><span class="keyword">import</span> &#123; odd &#125; <span class="keyword">from</span> <span class="string">'./odd'</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">var</span> counter = <span class="number">0</span>;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">even</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  counter++;</div><div class="line">  <span class="keyword">return</span> n == <span class="number">0</span> || odd(n - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// odd.js</span></div><div class="line"><span class="keyword">import</span> &#123; even &#125; <span class="keyword">from</span> <span class="string">'./even'</span>;</div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">odd</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> n != <span class="number">0</span> &amp;&amp; even(n - <span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>even.js</code>é‡Œé¢çš„å‡½æ•°<code>even</code>æœ‰ä¸€ä¸ªå‚æ•°<code>n</code>ï¼Œåªè¦ä¸ç­‰äº0ï¼Œå°±ä¼šå‡å»1ï¼Œä¼ å…¥åŠ è½½çš„<code>odd()</code>ã€‚<code>odd.js</code>ä¹Ÿä¼šåšç±»ä¼¼æ“ä½œã€‚</p>
<p>è¿è¡Œä¸Šé¢è¿™æ®µä»£ç ï¼Œç»“æœå¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">$ babel-node</div><div class="line">&gt; <span class="keyword">import</span> * <span class="keyword">as</span> m <span class="keyword">from</span> <span class="string">'./even.js'</span>;</div><div class="line">&gt; m.even(<span class="number">10</span>);</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; m.counter</div><div class="line"><span class="number">6</span></div><div class="line">&gt; m.even(<span class="number">20</span>)</div><div class="line"><span class="literal">true</span></div><div class="line">&gt; m.counter</div><div class="line"><span class="number">17</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°<code>n</code>ä»10å˜ä¸º0çš„è¿‡ç¨‹ä¸­ï¼Œ<code>even()</code>ä¸€å…±ä¼šæ‰§è¡Œ6æ¬¡ï¼Œæ‰€ä»¥å˜é‡<code>counter</code>ç­‰äº6ã€‚ç¬¬äºŒæ¬¡è°ƒç”¨<code>even()</code>æ—¶ï¼Œå‚æ•°<code>n</code>ä»20å˜ä¸º0ï¼Œ<code>even()</code>ä¸€å…±ä¼šæ‰§è¡Œ11æ¬¡ï¼ŒåŠ ä¸Šå‰é¢çš„6æ¬¡ï¼Œæ‰€ä»¥å˜é‡<code>counter</code>ç­‰äº17ã€‚</p>
<p>è¿™ä¸ªä¾‹å­è¦æ˜¯æ”¹å†™æˆCommonJSï¼Œå°±æ ¹æœ¬æ— æ³•æ‰§è¡Œï¼Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// even.js</span></div><div class="line"><span class="keyword">var</span> odd = <span class="built_in">require</span>(<span class="string">'./odd'</span>);</div><div class="line"><span class="keyword">var</span> counter = <span class="number">0</span>;</div><div class="line">exports.counter = counter;</div><div class="line">exports.even = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  counter++;</div><div class="line">  <span class="keyword">return</span> n == <span class="number">0</span> || odd(n - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// odd.js</span></div><div class="line"><span class="keyword">var</span> even = <span class="built_in">require</span>(<span class="string">'./even'</span>).even;</div><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> n != <span class="number">0</span> &amp;&amp; even(n - <span class="number">1</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>even.js</code>åŠ è½½<code>odd.js</code>ï¼Œè€Œ<code>odd.js</code>åˆå»åŠ è½½<code>even.js</code>ï¼Œå½¢æˆâ€œå¾ªç¯åŠ è½½â€ã€‚è¿™æ—¶ï¼Œæ‰§è¡Œå¼•æ“å°±ä¼šè¾“å‡º<code>even.js</code>å·²ç»æ‰§è¡Œçš„éƒ¨åˆ†ï¼ˆä¸å­˜åœ¨ä»»ä½•ç»“æœï¼‰ï¼Œæ‰€ä»¥åœ¨<code>odd.js</code>ä¹‹ä¸­ï¼Œå˜é‡<code>even</code>ç­‰äº<code>null</code>ï¼Œç­‰åˆ°åé¢è°ƒç”¨<code>even(n-1)</code>å°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">$ node</div><div class="line">&gt; var m = require(<span class="string">'./even'</span>);</div><div class="line">&gt; m.even(10)</div><div class="line">TypeError: even is not a <span class="keyword">function</span></div></pre></td></tr></table></figure>
<h2 id="è·¨æ¨¡å—å¸¸é‡"><a href="#è·¨æ¨¡å—å¸¸é‡" class="headerlink" title="è·¨æ¨¡å—å¸¸é‡"></a>è·¨æ¨¡å—å¸¸é‡</h2><p>æœ¬ä¹¦ä»‹ç»<code>const</code>å‘½ä»¤çš„æ—¶å€™è¯´è¿‡ï¼Œ<code>const</code>å£°æ˜çš„å¸¸é‡åªåœ¨å½“å‰ä»£ç å—æœ‰æ•ˆã€‚å¦‚æœæƒ³è®¾ç½®è·¨æ¨¡å—çš„å¸¸é‡ï¼ˆå³è·¨å¤šä¸ªæ–‡ä»¶ï¼‰ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// constants.js æ¨¡å—</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> A = <span class="number">1</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> B = <span class="number">3</span>;</div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> C = <span class="number">4</span>;</div><div class="line"></div><div class="line"><span class="comment">// test1.js æ¨¡å—</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> constants <span class="keyword">from</span> <span class="string">'./constants'</span>;</div><div class="line"><span class="built_in">console</span>.log(constants.A); <span class="comment">// 1</span></div><div class="line"><span class="built_in">console</span>.log(constants.B); <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="comment">// test2.js æ¨¡å—</span></div><div class="line"><span class="keyword">import</span> &#123;A, B&#125; <span class="keyword">from</span> <span class="string">'./constants'</span>;</div><div class="line"><span class="built_in">console</span>.log(A); <span class="comment">// 1</span></div><div class="line"><span class="built_in">console</span>.log(B); <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè¦ä½¿ç”¨çš„å¸¸é‡éå¸¸å¤šï¼Œå¯ä»¥å»ºä¸€ä¸ªä¸“é—¨çš„<code>constants</code>ç›®å½•ï¼Œå°†å„ç§å¸¸é‡å†™åœ¨ä¸åŒçš„æ–‡ä»¶é‡Œé¢ï¼Œä¿å­˜åœ¨è¯¥ç›®å½•ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// constants/db.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> db = &#123;</div><div class="line">  <span class="attr">url</span>: <span class="string">'http://my.couchdbserver.local:5984'</span>,</div><div class="line">  <span class="attr">admin_username</span>: <span class="string">'admin'</span>,</div><div class="line">  <span class="attr">admin_password</span>: <span class="string">'admin password'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// constants/user.js</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> users = [<span class="string">'root'</span>, <span class="string">'admin'</span>, <span class="string">'staff'</span>, <span class="string">'ceo'</span>, <span class="string">'chief'</span>, <span class="string">'moderator'</span>];</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå°†è¿™äº›æ–‡ä»¶è¾“å‡ºçš„å¸¸é‡ï¼Œåˆå¹¶åœ¨<code>index.js</code>é‡Œé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// constants/index.js</span></div><div class="line"><span class="keyword">export</span> &#123;db&#125; <span class="keyword">from</span> <span class="string">'./db'</span>;</div><div class="line"><span class="keyword">export</span> &#123;users&#125; <span class="keyword">from</span> <span class="string">'./users'</span>;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨çš„æ—¶å€™ï¼Œç›´æ¥åŠ è½½<code>index.js</code>å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// script.js</span></div><div class="line"><span class="keyword">import</span> &#123;db, users&#125; <span class="keyword">from</span> <span class="string">'./constants'</span>;</div></pre></td></tr></table></figure>
<h2 id="import"><a href="#import" class="headerlink" title="import()"></a>import()</h2><p>ä¸Šé¢è¯´è¿‡äº†ï¼Œ<code>import</code>è¯­å¥ä¼šè¢«JavaScriptå¼•æ“é™æ€åˆ†æï¼Œå…ˆäºæ¨¡å—å†…çš„å…¶ä»–æ¨¡å—æ‰§è¡Œï¼ˆå«åšâ€è¿æ¥â€œæ›´åˆé€‚ï¼‰ã€‚æ‰€ä»¥ï¼Œä¸‹é¢çš„ä»£ç ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">if</span> (x === <span class="number">2</span>) &#123;</div><div class="line">  <span class="keyword">import</span> MyModual <span class="keyword">from</span> <span class="string">'./myModual'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¼•æ“å¤„ç†<code>import</code>è¯­å¥æ˜¯åœ¨æ‰§è¡Œä¹‹å‰ï¼Œæ‰€ä»¥<code>import</code>è¯­å¥æ”¾åœ¨<code>if</code>ä»£ç å—ä¹‹ä¸­æ¯«æ— æ„ä¹‰ï¼Œå› æ­¤ä¼šæŠ¥å¥æ³•é”™è¯¯ï¼Œè€Œä¸æ˜¯æ‰§è¡Œæ—¶é”™è¯¯ã€‚</p>
<p>è¿™æ ·çš„è®¾è®¡ï¼Œå›ºç„¶æœ‰åˆ©äºç¼–è¯‘å™¨æé«˜æ•ˆç‡ï¼Œä½†ä¹Ÿå¯¼è‡´æ— æ³•åœ¨è¿è¡Œæ—¶åŠ è½½æ¨¡å—ã€‚ä»é•¿è¿œæ¥çœ‹ï¼Œ<code>import</code>è¯­å¥ä¼šå–ä»£ Node çš„<code>require</code>æ–¹æ³•ï¼Œä½†æ˜¯<code>require</code>æ˜¯è¿è¡Œæ—¶åŠ è½½æ¨¡å—ï¼Œ<code>import</code>è¯­å¥æ˜¾ç„¶æ— æ³•å–ä»£è¿™ç§åŠ¨æ€åŠ è½½åŠŸèƒ½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> path = <span class="string">'./'</span> + fileName;</div><div class="line"><span class="keyword">const</span> myModual = <span class="built_in">require</span>(path);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è¯­å¥å°±æ˜¯åŠ¨æ€åŠ è½½ï¼Œ<code>require</code>åˆ°åº•åŠ è½½å“ªä¸€ä¸ªæ¨¡å—ï¼Œåªæœ‰è¿è¡Œæ—¶æ‰çŸ¥é“ã€‚<code>import</code>è¯­å¥åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p>å› æ­¤ï¼Œæœ‰ä¸€ä¸ª<a href="https://github.com/tc39/proposal-dynamic-import" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œå»ºè®®å¼•å…¥<code>import()</code>å‡½æ•°ï¼Œå®ŒæˆåŠ¨æ€åŠ è½½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span>(specifier)</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>import</code>å‡½æ•°çš„å‚æ•°<code>specifier</code>ï¼ŒæŒ‡å®šæ‰€è¦åŠ è½½çš„æ¨¡å—çš„ä½ç½®ã€‚<code>import</code>è¯­å¥èƒ½å¤Ÿæ¥å—ä»€ä¹ˆå‚æ•°ï¼Œ<code>import()</code>å‡½æ•°å°±èƒ½æ¥å—ä»€ä¹ˆå‚æ•°ï¼Œä¸¤è€…åŒºåˆ«ä¸»è¦æ˜¯åè€…ä¸ºåŠ¨æ€åŠ è½½ã€‚</p>
<p><code>import()</code>è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> main = <span class="built_in">document</span>.querySelector(<span class="string">'main'</span>);</div><div class="line"></div><div class="line"><span class="keyword">import</span>(<span class="string">`./section-modules/<span class="subst">$&#123;someVariable&#125;</span>.js`</span>)</div><div class="line">  .then(<span class="function"><span class="params">module</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">module</span>.loadPageInto(main);</div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">    main.textContent = err.message;</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p><code>import()</code>å‡½æ•°å¯ä»¥ç”¨åœ¨ä»»ä½•åœ°æ–¹ï¼Œä¸ä»…ä»…æ˜¯æ¨¡å—ï¼Œéæ¨¡å—çš„è„šæœ¬ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚å®ƒæ˜¯è¿è¡Œæ—¶æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»€ä¹ˆæ—¶å€™è¿è¡Œåˆ°è¿™ä¸€å¥ï¼Œä¹Ÿä¼šåŠ è½½æŒ‡å®šçš„æ¨¡å—ã€‚å¦å¤–ï¼Œ<code>import()</code>å‡½æ•°ä¸æ‰€åŠ è½½çš„æ¨¡å—æ²¡æœ‰é™æ€è¿æ¥å…³ç³»ï¼Œè¿™ç‚¹ä¹Ÿæ˜¯ä¸<code>import</code>è¯­å¥ä¸ç›¸åŒã€‚</p>
<p><code>import()</code>ç±»ä¼¼äº Node çš„<code>require</code>æ–¹æ³•ï¼ŒåŒºåˆ«ä¸»è¦æ˜¯å‰è€…æ˜¯å¼‚æ­¥åŠ è½½ï¼Œåè€…æ˜¯åŒæ­¥åŠ è½½ã€‚</p>
<h2 id="ES6æ¨¡å—çš„è½¬ç "><a href="#ES6æ¨¡å—çš„è½¬ç " class="headerlink" title="ES6æ¨¡å—çš„è½¬ç "></a>ES6æ¨¡å—çš„è½¬ç </h2><p>æµè§ˆå™¨ç›®å‰è¿˜ä¸æ”¯æŒES6æ¨¡å—ï¼Œä¸ºäº†ç°åœ¨å°±èƒ½ä½¿ç”¨ï¼Œå¯ä»¥å°†è½¬ä¸ºES5çš„å†™æ³•ã€‚é™¤äº†Babelå¯ä»¥ç”¨æ¥è½¬ç ä¹‹å¤–ï¼Œè¿˜æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥è½¬ç ã€‚</p>
<h3 id="ES6-module-transpiler"><a href="#ES6-module-transpiler" class="headerlink" title="ES6 module transpiler"></a>ES6 module transpiler</h3><p><a href="https://github.com/esnext/es6-module-transpiler" target="_blank" rel="external">ES6 module transpiler</a>æ˜¯ square å…¬å¸å¼€æºçš„ä¸€ä¸ªè½¬ç å™¨ï¼Œå¯ä»¥å°† ES6 æ¨¡å—è½¬ä¸º CommonJS æ¨¡å—æˆ– AMD æ¨¡å—çš„å†™æ³•ï¼Œä»è€Œåœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨ã€‚</p>
<p>é¦–å…ˆï¼Œå®‰è£…è¿™ä¸ªè½¬ç›å™¨ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install -g es6-module-transpiler</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œä½¿ç”¨<code>compile-modules convert</code>å‘½ä»¤ï¼Œå°† ES6 æ¨¡å—æ–‡ä»¶è½¬ç ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ compile-modules convert file1.js file2.js</div></pre></td></tr></table></figure>
<p><code>-o</code>å‚æ•°å¯ä»¥æŒ‡å®šè½¬ç åçš„æ–‡ä»¶åã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ compile-modules convert -o out.js file1.js</div></pre></td></tr></table></figure>
<h3 id="SystemJS"><a href="#SystemJS" class="headerlink" title="SystemJS"></a>SystemJS</h3><p>å¦ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ <a href="https://github.com/systemjs/systemjs" target="_blank" rel="external">SystemJS</a>ã€‚å®ƒæ˜¯ä¸€ä¸ªå«ç‰‡åº“ï¼ˆpolyfillï¼‰ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨å†…åŠ è½½ ES6 æ¨¡å—ã€AMD æ¨¡å—å’Œ CommonJS æ¨¡å—ï¼Œå°†å…¶è½¬ä¸º ES5 æ ¼å¼ã€‚å®ƒåœ¨åå°è°ƒç”¨çš„æ˜¯ Google çš„ Traceur è½¬ç å™¨ã€‚</p>
<p>ä½¿ç”¨æ—¶ï¼Œå…ˆåœ¨ç½‘é¡µå†…è½½å…¥<code>system.js</code>æ–‡ä»¶ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"system.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œä½¿ç”¨<code>System.import</code>æ–¹æ³•åŠ è½½æ¨¡å—æ–‡ä»¶ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">  System.import(<span class="string">'./app.js'</span>);</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­çš„<code>./app</code>ï¼ŒæŒ‡çš„æ˜¯å½“å‰ç›®å½•ä¸‹çš„app.jsæ–‡ä»¶ã€‚å®ƒå¯ä»¥æ˜¯ES6æ¨¡å—æ–‡ä»¶ï¼Œ<code>System.import</code>ä¼šè‡ªåŠ¨å°†å…¶è½¬ç ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>System.import</code>ä½¿ç”¨å¼‚æ­¥åŠ è½½ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¯ä»¥é’ˆå¯¹è¿™ä¸ªå¯¹è±¡ç¼–ç¨‹ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ¨¡å—æ–‡ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// app/es6-file.js:</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="class"><span class="keyword">class</span> <span class="title">q</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.es6 = <span class="string">'hello'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œåœ¨ç½‘é¡µå†…åŠ è½½è¿™ä¸ªæ¨¡å—æ–‡ä»¶ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"></div><div class="line">System.import(<span class="string">'app/es6-file'</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">m</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">new</span> m.q().es6); <span class="comment">// hello</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>System.import</code>æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥ç”¨<code>then</code>æ–¹æ³•æŒ‡å®šå›è°ƒå‡½æ•°ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Module&quot;&gt;&lt;a href=&quot;#Module&quot; class=&quot;headerlink&quot; title=&quot;Module&quot;&gt;&lt;/a&gt;Module&lt;/h1&gt;&lt;p&gt;å†å²ä¸Šï¼ŒJavaScript ä¸€ç›´æ²¡æœ‰æ¨¡å—ï¼ˆmoduleï¼‰ä½“ç³»ï¼Œæ— æ³•å°†ä¸€ä¸ªå¤§ç¨‹åºæ‹†åˆ†æˆäº’ç›¸ä¾èµ–çš„å°æ–‡ä»¶ï¼Œå†ç”¨
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Module" scheme="http://microzz.com/tags/Module/"/>
    
  </entry>
  
  <entry>
    <title>ES6ä¸­Decoratorä¿®é¥°å™¨</title>
    <link href="http://microzz.com/2017/01/17/decorator/"/>
    <id>http://microzz.com/2017/01/17/decorator/</id>
    <published>2017-01-17T08:00:53.000Z</published>
    <updated>2017-01-17T08:11:15.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¿®é¥°å™¨"><a href="#ä¿®é¥°å™¨" class="headerlink" title="ä¿®é¥°å™¨"></a>ä¿®é¥°å™¨</h1><h2 id="ç±»çš„ä¿®é¥°"><a href="#ç±»çš„ä¿®é¥°" class="headerlink" title="ç±»çš„ä¿®é¥°"></a>ç±»çš„ä¿®é¥°</h2><p>ä¿®é¥°å™¨ï¼ˆDecoratorï¼‰æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥ä¿®æ”¹ç±»çš„è¡Œä¸ºã€‚è¿™æ˜¯ES7çš„ä¸€ä¸ª<a href="https://github.com/wycats/javascript-decorators" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œç›®å‰Babelè½¬ç å™¨å·²ç»æ”¯æŒã€‚</p>
<p>ä¿®é¥°å™¨å¯¹ç±»çš„è¡Œä¸ºçš„æ”¹å˜ï¼Œæ˜¯ä»£ç ç¼–è¯‘æ—¶å‘ç”Ÿçš„ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶ã€‚è¿™æ„å‘³ç€ï¼Œä¿®é¥°å™¨èƒ½åœ¨ç¼–è¯‘é˜¶æ®µè¿è¡Œä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">  target.isTestable = <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@testable</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestableClass</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(MyTestableClass.isTestable) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>@testable</code>å°±æ˜¯ä¸€ä¸ªä¿®é¥°å™¨ã€‚å®ƒä¿®æ”¹äº†<code>MyTestableClass</code>è¿™ä¸ªç±»çš„è¡Œä¸ºï¼Œä¸ºå®ƒåŠ ä¸Šäº†é™æ€å±æ€§<code>isTestable</code>ã€‚</p>
<p>åŸºæœ¬ä¸Šï¼Œä¿®é¥°å™¨çš„è¡Œä¸ºå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">@decorator</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</div><div class="line">A = decorator(A) || A;</div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¿®é¥°å™¨æœ¬è´¨å°±æ˜¯ç¼–è¯‘æ—¶æ‰§è¡Œçš„å‡½æ•°ã€‚</p>
<p>ä¿®é¥°å™¨å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå°±æ˜¯æ‰€è¦ä¿®é¥°çš„ç›®æ ‡ç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>testable</code>å‡½æ•°çš„å‚æ•°<code>target</code>ï¼Œå°±æ˜¯ä¼šè¢«ä¿®é¥°çš„ç±»ã€‚</p>
<p>å¦‚æœè§‰å¾—ä¸€ä¸ªå‚æ•°ä¸å¤Ÿç”¨ï¼Œå¯ä»¥åœ¨ä¿®é¥°å™¨å¤–é¢å†å°è£…ä¸€å±‚å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">isTestable</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    target.isTestable = isTestable;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@testable(<span class="literal">true</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestableClass</span> </span>&#123;&#125;</div><div class="line">MyTestableClass.isTestable <span class="comment">// true</span></div><div class="line"></div><div class="line">@testable(<span class="literal">false</span>)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</div><div class="line">MyClass.isTestable <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¿®é¥°å™¨<code>testable</code>å¯ä»¥æ¥å—å‚æ•°ï¼Œè¿™å°±ç­‰äºå¯ä»¥ä¿®æ”¹ä¿®é¥°å™¨çš„è¡Œä¸ºã€‚</p>
<p>å‰é¢çš„ä¾‹å­æ˜¯ä¸ºç±»æ·»åŠ ä¸€ä¸ªé™æ€å±æ€§ï¼Œå¦‚æœæƒ³æ·»åŠ å®ä¾‹å±æ€§ï¼Œå¯ä»¥é€šè¿‡ç›®æ ‡ç±»çš„<code>prototype</code>å¯¹è±¡æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">testable</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">  target.prototype.isTestable = <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@testable</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTestableClass</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyTestableClass();</div><div class="line">obj.isTestable <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¿®é¥°å™¨å‡½æ•°<code>testable</code>æ˜¯åœ¨ç›®æ ‡ç±»çš„<code>prototype</code>å¯¹è±¡ä¸Šæ·»åŠ å±æ€§ï¼Œå› æ­¤å°±å¯ä»¥åœ¨å®ä¾‹ä¸Šè°ƒç”¨ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mixins.js</span></div><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">mixins</span>(<span class="params">...list</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="built_in">Object</span>.assign(target.prototype, ...list)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="keyword">import</span> &#123; mixins &#125; <span class="keyword">from</span> <span class="string">'./mixins'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> Foo = &#123;</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">@mixins(Foo)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</div><div class="line">obj.foo() <span class="comment">// 'foo'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç é€šè¿‡ä¿®é¥°å™¨<code>mixins</code>ï¼ŒæŠŠ<code>Foo</code>ç±»çš„æ–¹æ³•æ·»åŠ åˆ°äº†<code>MyClass</code>çš„å®ä¾‹ä¸Šé¢ã€‚å¯ä»¥ç”¨<code>Object.assign()</code>æ¨¡æ‹Ÿè¿™ä¸ªåŠŸèƒ½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Foo = &#123;</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.assign(MyClass.prototype, Foo);</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</div><div class="line">obj.foo() <span class="comment">// 'foo'</span></div></pre></td></tr></table></figure>
<h2 id="æ–¹æ³•çš„ä¿®é¥°"><a href="#æ–¹æ³•çš„ä¿®é¥°" class="headerlink" title="æ–¹æ³•çš„ä¿®é¥°"></a>æ–¹æ³•çš„ä¿®é¥°</h2><p>ä¿®é¥°å™¨ä¸ä»…å¯ä»¥ä¿®é¥°ç±»ï¼Œè¿˜å¯ä»¥ä¿®é¥°ç±»çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  @readonly</div><div class="line">  name() &#123; <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.first&#125;</span> <span class="subst">$&#123;<span class="keyword">this</span>.last&#125;</span>`</span> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¿®é¥°å™¨<code>readonly</code>ç”¨æ¥ä¿®é¥°â€œç±»â€çš„<code>name</code>æ–¹æ³•ã€‚</p>
<p>æ­¤æ—¶ï¼Œä¿®é¥°å™¨å‡½æ•°ä¸€å…±å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰€è¦ä¿®é¥°çš„ç›®æ ‡å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ‰€è¦ä¿®é¥°çš„å±æ€§åï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">readonly</span>(<span class="params">target, name, descriptor</span>)</span>&#123;</div><div class="line">  <span class="comment">// descriptorå¯¹è±¡åŸæ¥çš„å€¼å¦‚ä¸‹</span></div><div class="line">  <span class="comment">// &#123;</span></div><div class="line">  <span class="comment">//   value: specifiedFunction,</span></div><div class="line">  <span class="comment">//   enumerable: false,</span></div><div class="line">  <span class="comment">//   configurable: true,</span></div><div class="line">  <span class="comment">//   writable: true</span></div><div class="line">  <span class="comment">// &#125;;</span></div><div class="line">  descriptor.writable = <span class="literal">false</span>;</div><div class="line">  <span class="keyword">return</span> descriptor;</div><div class="line">&#125;</div><div class="line"></div><div class="line">readonly(Person.prototype, <span class="string">'name'</span>, descriptor);</div><div class="line"><span class="comment">// ç±»ä¼¼äº</span></div><div class="line"><span class="built_in">Object</span>.defineProperty(Person.prototype, <span class="string">'name'</span>, descriptor);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼Œä¿®é¥°å™¨ï¼ˆreadonlyï¼‰ä¼šä¿®æ”¹å±æ€§çš„æè¿°å¯¹è±¡ï¼ˆdescriptorï¼‰ï¼Œç„¶åè¢«ä¿®æ”¹çš„æè¿°å¯¹è±¡å†ç”¨æ¥å®šä¹‰å±æ€§ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œä¿®æ”¹å±æ€§æè¿°å¯¹è±¡çš„<code>enumerable</code>å±æ€§ï¼Œä½¿å¾—è¯¥å±æ€§ä¸å¯éå†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  @nonenumerable</div><div class="line">  get kidCount() &#123; <span class="keyword">return</span> <span class="keyword">this</span>.children.length; &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">nonenumerable</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</div><div class="line">  descriptor.enumerable = <span class="literal">false</span>;</div><div class="line">  <span class="keyword">return</span> descriptor;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„<code>@log</code>ä¿®é¥°å™¨ï¼Œå¯ä»¥èµ·åˆ°è¾“å‡ºæ—¥å¿—çš„ä½œç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Math</span> </span>&#123;</div><div class="line">  @log</div><div class="line">  add(a, b) &#123;</div><div class="line">    <span class="keyword">return</span> a + b;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> oldValue = descriptor.value;</div><div class="line"></div><div class="line">  descriptor.value = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`Calling "<span class="subst">$&#123;name&#125;</span>" with`</span>, <span class="built_in">arguments</span>);</div><div class="line">    <span class="keyword">return</span> oldValue.apply(<span class="literal">null</span>, <span class="built_in">arguments</span>);</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> descriptor;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> math = <span class="keyword">new</span> <span class="built_in">Math</span>();</div><div class="line"></div><div class="line"><span class="comment">// passed parameters should get logged now</span></div><div class="line">math.add(<span class="number">2</span>, <span class="number">4</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>@log</code>ä¿®é¥°å™¨çš„ä½œç”¨å°±æ˜¯åœ¨æ‰§è¡ŒåŸå§‹çš„æ“ä½œä¹‹å‰ï¼Œæ‰§è¡Œä¸€æ¬¡<code>console.log</code>ï¼Œä»è€Œè¾¾åˆ°è¾“å‡ºæ—¥å¿—çš„ç›®çš„ã€‚</p>
<p>ä¿®é¥°å™¨æœ‰æ³¨é‡Šçš„ä½œç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@testable</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  @readonly</div><div class="line">  @nonenumerable</div><div class="line">  name() &#123; <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="keyword">this</span>.first&#125;</span> <span class="subst">$&#123;<span class="keyword">this</span>.last&#125;</span>`</span> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä¸€çœ¼å°±èƒ½çœ‹å‡ºï¼Œ<code>Person</code>ç±»æ˜¯å¯æµ‹è¯•çš„ï¼Œè€Œ<code>name</code>æ–¹æ³•æ˜¯åªè¯»å’Œä¸å¯æšä¸¾çš„ã€‚</p>
<p>å¦‚æœåŒä¸€ä¸ªæ–¹æ³•æœ‰å¤šä¸ªä¿®é¥°å™¨ï¼Œä¼šåƒå‰¥æ´‹è‘±ä¸€æ ·ï¼Œå…ˆä»å¤–åˆ°å†…è¿›å…¥ï¼Œç„¶åç”±å†…å‘å¤–æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dec</span>(<span class="params">id</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'evaluated'</span>, id);</div><div class="line">    <span class="keyword">return</span> <span class="function">(<span class="params">target, property, descriptor</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'executed'</span>, id);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Example</span> </span>&#123;</div><div class="line">    @dec(<span class="number">1</span>)</div><div class="line">    @dec(<span class="number">2</span>)</div><div class="line">    method()&#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// evaluated 1</span></div><div class="line"><span class="comment">// evaluated 2</span></div><div class="line"><span class="comment">// executed 2</span></div><div class="line"><span class="comment">// executed 1</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¤–å±‚ä¿®é¥°å™¨<code>@dec(1)</code>å…ˆè¿›å…¥ï¼Œä½†æ˜¯å†…å±‚ä¿®é¥°å™¨<code>@dec(2)</code>å…ˆæ‰§è¡Œã€‚</p>
<p>é™¤äº†æ³¨é‡Šï¼Œä¿®é¥°å™¨è¿˜èƒ½ç”¨æ¥ç±»å‹æ£€æŸ¥ã€‚æ‰€ä»¥ï¼Œå¯¹äºç±»æ¥è¯´ï¼Œè¿™é¡¹åŠŸèƒ½ç›¸å½“æœ‰ç”¨ã€‚ä»é•¿æœŸæ¥çœ‹ï¼Œå®ƒå°†æ˜¯JavaScriptä»£ç é™æ€åˆ†æçš„é‡è¦å·¥å…·ã€‚</p>
<h2 id="ä¸ºä»€ä¹ˆä¿®é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆä¿®é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆä¿®é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°ï¼Ÿ"></a>ä¸ºä»€ä¹ˆä¿®é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°ï¼Ÿ</h2><p>ä¿®é¥°å™¨åªèƒ½ç”¨äºç±»å’Œç±»çš„æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºå‡½æ•°ï¼Œå› ä¸ºå­˜åœ¨å‡½æ•°æå‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> counter = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  counter++;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">@add</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ï¼Œæ„å›¾æ˜¯æ‰§è¡Œå<code>counter</code>ç­‰äº1ï¼Œä½†æ˜¯å®é™…ä¸Šç»“æœæ˜¯<code>counter</code>ç­‰äº0ã€‚å› ä¸ºå‡½æ•°æå‡ï¼Œä½¿å¾—å®é™…æ‰§è¡Œçš„ä»£ç æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">@add</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> counter;</div><div class="line"><span class="keyword">var</span> add;</div><div class="line"></div><div class="line">counter = <span class="number">0</span>;</div><div class="line"></div><div class="line">add = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  counter++;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> readOnly = <span class="built_in">require</span>(<span class="string">"some-decorator"</span>);</div><div class="line"></div><div class="line">@readOnly</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¹Ÿæœ‰é—®é¢˜ï¼Œå› ä¸ºå®é™…æ‰§è¡Œæ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> readOnly;</div><div class="line"></div><div class="line">@readOnly</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">readOnly = <span class="built_in">require</span>(<span class="string">"some-decorator"</span>);</div></pre></td></tr></table></figure>
<p>æ€»ä¹‹ï¼Œç”±äºå­˜åœ¨å‡½æ•°æå‡ï¼Œä½¿å¾—ä¿®é¥°å™¨ä¸èƒ½ç”¨äºå‡½æ•°ã€‚ç±»æ˜¯ä¸ä¼šæå‡çš„ï¼Œæ‰€ä»¥å°±æ²¡æœ‰è¿™æ–¹é¢çš„é—®é¢˜ã€‚</p>
<h2 id="core-decorators-js"><a href="#core-decorators-js" class="headerlink" title="core-decorators.js"></a>core-decorators.js</h2><p><a href="https://github.com/jayphelps/core-decorators.js" target="_blank" rel="external">core-decorators.js</a>æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œæä¾›äº†å‡ ä¸ªå¸¸è§çš„ä¿®é¥°å™¨ï¼Œé€šè¿‡å®ƒå¯ä»¥æ›´å¥½åœ°ç†è§£ä¿®é¥°å™¨ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰@autobind</strong></p>
<p><code>autobind</code>ä¿®é¥°å™¨ä½¿å¾—æ–¹æ³•ä¸­çš„<code>this</code>å¯¹è±¡ï¼Œç»‘å®šåŸå§‹å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; autobind &#125; <span class="keyword">from</span> <span class="string">'core-decorators'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  @autobind</div><div class="line">  getPerson() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person();</div><div class="line"><span class="keyword">let</span> getPerson = person.getPerson;</div><div class="line"></div><div class="line">getPerson() === person;</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰@readonly</strong></p>
<p><code>readonly</code>ä¿®é¥°å™¨ä½¿å¾—å±æ€§æˆ–æ–¹æ³•ä¸å¯å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; readonly &#125; <span class="keyword">from</span> <span class="string">'core-decorators'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Meal</span> </span>&#123;</div><div class="line">  @readonly</div><div class="line">  entree = <span class="string">'steak'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> dinner = <span class="keyword">new</span> Meal();</div><div class="line">dinner.entree = <span class="string">'salmon'</span>;</div><div class="line"><span class="comment">// Cannot assign to read only property 'entree' of [object Object]</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰@override</strong></p>
<p><code>override</code>ä¿®é¥°å™¨æ£€æŸ¥å­ç±»çš„æ–¹æ³•ï¼Œæ˜¯å¦æ­£ç¡®è¦†ç›–äº†çˆ¶ç±»çš„åŒåæ–¹æ³•ï¼Œå¦‚æœä¸æ­£ç¡®ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; override &#125; <span class="keyword">from</span> <span class="string">'core-decorators'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> </span>&#123;</div><div class="line">  speak(first, second) &#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span> </span>&#123;</div><div class="line">  @override</div><div class="line">  speak() &#123;&#125;</div><div class="line">  <span class="comment">// SyntaxError: Child#speak() does not properly override Parent#speak(first, second)</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// or</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span> </span>&#123;</div><div class="line">  @override</div><div class="line">  speaks() &#123;&#125;</div><div class="line">  <span class="comment">// SyntaxError: No descriptor matching Child#speaks() was found on the prototype chain.</span></div><div class="line">  <span class="comment">//</span></div><div class="line">  <span class="comment">//   Did you mean "speak"?</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰@deprecate (åˆ«å@deprecated)</strong></p>
<p><code>deprecate</code>æˆ–<code>deprecated</code>ä¿®é¥°å™¨åœ¨æ§åˆ¶å°æ˜¾ç¤ºä¸€æ¡è­¦å‘Šï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•å°†åºŸé™¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; deprecate &#125; <span class="keyword">from</span> <span class="string">'core-decorators'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  @deprecate</div><div class="line">  facepalm() &#123;&#125;</div><div class="line"></div><div class="line">  @deprecate(<span class="string">'We stopped facepalming'</span>)</div><div class="line">  facepalmHard() &#123;&#125;</div><div class="line"></div><div class="line">  @deprecate(<span class="string">'We stopped facepalming'</span>, &#123; <span class="attr">url</span>: <span class="string">'http://knowyourmeme.com/memes/facepalm'</span> &#125;)</div><div class="line">  facepalmHarder() &#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person();</div><div class="line"></div><div class="line">person.facepalm();</div><div class="line"><span class="comment">// DEPRECATION Person#facepalm: This function will be removed in future versions.</span></div><div class="line"></div><div class="line">person.facepalmHard();</div><div class="line"><span class="comment">// DEPRECATION Person#facepalmHard: We stopped facepalming</span></div><div class="line"></div><div class="line">person.facepalmHarder();</div><div class="line"><span class="comment">// DEPRECATION Person#facepalmHarder: We stopped facepalming</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//     See http://knowyourmeme.com/memes/facepalm for more details.</span></div><div class="line"><span class="comment">//</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ5ï¼‰@suppressWarnings</strong></p>
<p><code>suppressWarnings</code>ä¿®é¥°å™¨æŠ‘åˆ¶<code>decorated</code>ä¿®é¥°å™¨å¯¼è‡´çš„<code>console.warn()</code>è°ƒç”¨ã€‚ä½†æ˜¯ï¼Œå¼‚æ­¥ä»£ç å‘å‡ºçš„è°ƒç”¨é™¤å¤–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; suppressWarnings &#125; <span class="keyword">from</span> <span class="string">'core-decorators'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  @deprecated</div><div class="line">  facepalm() &#123;&#125;</div><div class="line"></div><div class="line">  @suppressWarnings</div><div class="line">  facepalmWithoutWarning() &#123;</div><div class="line">    <span class="keyword">this</span>.facepalm();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> Person();</div><div class="line"></div><div class="line">person.facepalmWithoutWarning();</div><div class="line"><span class="comment">// no warning is logged</span></div></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨ä¿®é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶"><a href="#ä½¿ç”¨ä¿®é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶" class="headerlink" title="ä½¿ç”¨ä¿®é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶"></a>ä½¿ç”¨ä¿®é¥°å™¨å®ç°è‡ªåŠ¨å‘å¸ƒäº‹ä»¶</h2><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¿®é¥°å™¨ï¼Œä½¿å¾—å¯¹è±¡çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> postal <span class="keyword">from</span> <span class="string">"postal/lib/postal.lodash"</span>;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">publish</span>(<span class="params">topic, channel</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">target, name, descriptor</span>) </span>&#123;</div><div class="line">    <span class="keyword">const</span> fn = descriptor.value;</div><div class="line"></div><div class="line">    descriptor.value = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">let</span> value = fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</div><div class="line">      postal.channel(channel || target.channel || <span class="string">"/"</span>).publish(topic, value);</div><div class="line">    &#125;;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªåä¸º<code>publish</code>çš„ä¿®é¥°å™¨ï¼Œå®ƒé€šè¿‡æ”¹å†™<code>descriptor.value</code>ï¼Œä½¿å¾—åŸæ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚å®ƒä½¿ç”¨çš„äº‹ä»¶â€œå‘å¸ƒ/è®¢é˜…â€åº“æ˜¯<a href="https://github.com/postaljs/postal.js" target="_blank" rel="external">Postal.js</a>ã€‚</p>
<p>å®ƒçš„ç”¨æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> publish <span class="keyword">from</span> <span class="string">"path/to/decorators/publish"</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FooComponent</span> </span>&#123;</div><div class="line">  @publish(<span class="string">"foo.some.message"</span>, <span class="string">"component"</span>)</div><div class="line">  someMethod() &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">my</span>: <span class="string">"data"</span></div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  @publish(<span class="string">"foo.some.other"</span>)</div><div class="line">  anotherMethod() &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»¥åï¼Œåªè¦è°ƒç”¨<code>someMethod</code>æˆ–è€…<code>anotherMethod</code>ï¼Œå°±ä¼šè‡ªåŠ¨å‘å‡ºä¸€ä¸ªäº‹ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> foo = <span class="keyword">new</span> FooComponent();</div><div class="line"></div><div class="line">foo.someMethod() <span class="comment">// åœ¨"component"é¢‘é“å‘å¸ƒ"foo.some.message"äº‹ä»¶ï¼Œé™„å¸¦çš„æ•°æ®æ˜¯&#123; my: "data" &#125;</span></div><div class="line">foo.anotherMethod() <span class="comment">// åœ¨"/"é¢‘é“å‘å¸ƒ"foo.some.other"äº‹ä»¶ï¼Œä¸é™„å¸¦æ•°æ®</span></div></pre></td></tr></table></figure>
<h2 id="Mixin"><a href="#Mixin" class="headerlink" title="Mixin"></a>Mixin</h2><p>åœ¨ä¿®é¥°å™¨çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥å®ç°<code>Mixin</code>æ¨¡å¼ã€‚æ‰€è°“<code>Mixin</code>æ¨¡å¼ï¼Œå°±æ˜¯å¯¹è±¡ç»§æ‰¿çš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆï¼Œä¸­æ–‡è¯‘ä¸ºâ€œæ··å…¥â€ï¼ˆmix inï¼‰ï¼Œæ„ä¸ºåœ¨ä¸€ä¸ªå¯¹è±¡ä¹‹ä¸­æ··å…¥å¦å¤–ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<p>è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> Foo = &#123;</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.assign(MyClass.prototype, Foo);</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</div><div class="line">obj.foo() <span class="comment">// 'foo'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œå¯¹è±¡<code>Foo</code>æœ‰ä¸€ä¸ª<code>foo</code>æ–¹æ³•ï¼Œé€šè¿‡<code>Object.assign</code>æ–¹æ³•ï¼Œå¯ä»¥å°†<code>foo</code>æ–¹æ³•â€œæ··å…¥â€<code>MyClass</code>ç±»ï¼Œå¯¼è‡´<code>MyClass</code>çš„å®ä¾‹<code>obj</code>å¯¹è±¡éƒ½å…·æœ‰<code>foo</code>æ–¹æ³•ã€‚è¿™å°±æ˜¯â€œæ··å…¥â€æ¨¡å¼çš„ä¸€ä¸ªç®€å•å®ç°ã€‚</p>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬éƒ¨ç½²ä¸€ä¸ªé€šç”¨è„šæœ¬<code>mixins.js</code>ï¼Œå°†mixinå†™æˆä¸€ä¸ªä¿®é¥°å™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">mixins</span>(<span class="params">...list</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="built_in">Object</span>.assign(target.prototype, ...list);</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸Šé¢è¿™ä¸ªä¿®é¥°å™¨ï¼Œä¸ºç±»â€œæ··å…¥â€å„ç§æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; mixins &#125; <span class="keyword">from</span> <span class="string">'./mixins'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Foo = &#123;</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">@mixins(Foo)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</div><div class="line">obj.foo() <span class="comment">// "foo"</span></div></pre></td></tr></table></figure>
<p>é€šè¿‡mixinsè¿™ä¸ªä¿®é¥°å™¨ï¼Œå®ç°äº†åœ¨MyClassç±»ä¸Šé¢â€œæ··å…¥â€Fooå¯¹è±¡çš„<code>foo</code>æ–¹æ³•ã€‚</p>
<p>ä¸è¿‡ï¼Œä¸Šé¢çš„æ–¹æ³•ä¼šæ”¹å†™<code>MyClass</code>ç±»çš„<code>prototype</code>å¯¹è±¡ï¼Œå¦‚æœä¸å–œæ¬¢è¿™ä¸€ç‚¹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç±»çš„ç»§æ‰¿å®ç°mixinã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">MyBaseClass</span> </span>&#123;</div><div class="line">  <span class="comment">/* ... */</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>MyClass</code>ç»§æ‰¿äº†<code>MyBaseClass</code>ã€‚å¦‚æœæˆ‘ä»¬æƒ³åœ¨<code>MyClass</code>é‡Œé¢â€œæ··å…¥â€ä¸€ä¸ª<code>foo</code>æ–¹æ³•ï¼Œä¸€ä¸ªåŠæ³•æ˜¯åœ¨<code>MyClass</code>å’Œ<code>MyBaseClass</code>ä¹‹é—´æ’å…¥ä¸€ä¸ªæ··å…¥ç±»ï¼Œè¿™ä¸ªç±»å…·æœ‰<code>foo</code>æ–¹æ³•ï¼Œå¹¶ä¸”ç»§æ‰¿äº†<code>MyBaseClass</code>çš„æ‰€æœ‰æ–¹æ³•ï¼Œç„¶å<code>MyClass</code>å†ç»§æ‰¿è¿™ä¸ªç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> MyMixin = <span class="function">(<span class="params">superclass</span>) =&gt;</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">superclass</span> </span>&#123;</div><div class="line">  foo() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'foo from MyMixin'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>MyMixin</code>æ˜¯ä¸€ä¸ªæ··å…¥ç±»ç”Ÿæˆå™¨ï¼Œæ¥å—<code>superclass</code>ä½œä¸ºå‚æ•°ï¼Œç„¶åè¿”å›ä¸€ä¸ªç»§æ‰¿<code>superclass</code>çš„å­ç±»ï¼Œè¯¥å­ç±»åŒ…å«ä¸€ä¸ª<code>foo</code>æ–¹æ³•ã€‚</p>
<p>æ¥ç€ï¼Œç›®æ ‡ç±»å†å»ç»§æ‰¿è¿™ä¸ªæ··å…¥ç±»ï¼Œå°±è¾¾åˆ°äº†â€œæ··å…¥â€<code>foo</code>æ–¹æ³•çš„ç›®çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">MyMixin</span>(<span class="title">MyBaseClass</span>) </span>&#123;</div><div class="line">  <span class="comment">/* ... */</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> MyClass();</div><div class="line">c.foo(); <span class="comment">// "foo from MyMixin"</span></div></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦â€œæ··å…¥â€å¤šä¸ªæ–¹æ³•ï¼Œå°±ç”Ÿæˆå¤šä¸ªæ··å…¥ç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">Mixin1</span>(<span class="title">Mixin2</span>(<span class="title">MyBaseClass</span>)) </span>&#123;</div><div class="line">  <span class="comment">/* ... */</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ç§å†™æ³•çš„ä¸€ä¸ªå¥½å¤„ï¼Œæ˜¯å¯ä»¥è°ƒç”¨<code>super</code>ï¼Œå› æ­¤å¯ä»¥é¿å…åœ¨â€œæ··å…¥â€è¿‡ç¨‹ä¸­è¦†ç›–çˆ¶ç±»çš„åŒåæ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> Mixin1 = <span class="function">(<span class="params">superclass</span>) =&gt;</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">superclass</span> </span>&#123;</div><div class="line">  foo() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'foo from Mixin1'</span>);</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">super</span>.foo) <span class="keyword">super</span>.foo();</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> Mixin2 = <span class="function">(<span class="params">superclass</span>) =&gt;</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">superclass</span> </span>&#123;</div><div class="line">  foo() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'foo from Mixin2'</span>);</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">super</span>.foo) <span class="keyword">super</span>.foo();</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span> </span>&#123;</div><div class="line">  foo() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'foo from S'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">Mixin1</span>(<span class="title">Mixin2</span>(<span class="title">S</span>)) </span>&#123;</div><div class="line">  foo() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'foo from C'</span>);</div><div class="line">    <span class="keyword">super</span>.foo();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯ä¸€æ¬¡<code>æ··å…¥</code>å‘ç”Ÿæ—¶ï¼Œéƒ½è°ƒç”¨äº†çˆ¶ç±»çš„<code>super.foo</code>æ–¹æ³•ï¼Œå¯¼è‡´çˆ¶ç±»çš„åŒåæ–¹æ³•æ²¡æœ‰è¢«è¦†ç›–ï¼Œè¡Œä¸ºè¢«ä¿ç•™äº†ä¸‹æ¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> C().foo()</div><div class="line"><span class="comment">// foo from C</span></div><div class="line"><span class="comment">// foo from Mixin1</span></div><div class="line"><span class="comment">// foo from Mixin2</span></div><div class="line"><span class="comment">// foo from S</span></div></pre></td></tr></table></figure>
<h2 id="Trait"><a href="#Trait" class="headerlink" title="Trait"></a>Trait</h2><p>Traitä¹Ÿæ˜¯ä¸€ç§ä¿®é¥°å™¨ï¼Œæ•ˆæœä¸Mixinç±»ä¼¼ï¼Œä½†æ˜¯æä¾›æ›´å¤šåŠŸèƒ½ï¼Œæ¯”å¦‚é˜²æ­¢åŒåæ–¹æ³•çš„å†²çªã€æ’é™¤æ··å…¥æŸäº›æ–¹æ³•ã€ä¸ºæ··å…¥çš„æ–¹æ³•èµ·åˆ«åç­‰ç­‰ã€‚</p>
<p>ä¸‹é¢é‡‡ç”¨<a href="https://github.com/CocktailJS/traits-decorator" target="_blank" rel="external">traits-decorator</a>è¿™ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—ä½œä¸ºä¾‹å­ã€‚è¿™ä¸ªæ¨¡å—æä¾›çš„traitsä¿®é¥°å™¨ï¼Œä¸ä»…å¯ä»¥æ¥å—å¯¹è±¡ï¼Œè¿˜å¯ä»¥æ¥å—ES6ç±»ä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; traits &#125; <span class="keyword">from</span> <span class="string">'traits-decorator'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFoo</span> </span>&#123;</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> TBar = &#123;</div><div class="line">  bar() &#123; <span class="built_in">console</span>.log(<span class="string">'bar'</span>) &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">@traits(TFoo, TBar)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123; &#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</div><div class="line">obj.foo() <span class="comment">// foo</span></div><div class="line">obj.bar() <span class="comment">// bar</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œé€šè¿‡traitsä¿®é¥°å™¨ï¼Œåœ¨<code>MyClass</code>ç±»ä¸Šé¢â€œæ··å…¥â€äº†<code>TFoo</code>ç±»çš„<code>foo</code>æ–¹æ³•å’Œ<code>TBar</code>å¯¹è±¡çš„<code>bar</code>æ–¹æ³•ã€‚</p>
<p>Traitä¸å…è®¸â€œæ··å…¥â€åŒåæ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; traits &#125; <span class="keyword">from</span> <span class="string">'traits-decorator'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFoo</span> </span>&#123;</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> TBar = &#123;</div><div class="line">  bar() &#123; <span class="built_in">console</span>.log(<span class="string">'bar'</span>) &#125;,</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">@traits(TFoo, TBar)</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123; &#125;</div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="comment">// throw new Error('Method named: ' + methodName + ' is defined twice.');</span></div><div class="line"><span class="comment">//        ^</span></div><div class="line"><span class="comment">// Error: Method named: foo is defined twice.</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒTFooå’ŒTBaréƒ½æœ‰fooæ–¹æ³•ï¼Œç»“æœtraitsä¿®é¥°å™¨æŠ¥é”™ã€‚</p>
<p>ä¸€ç§è§£å†³æ–¹æ³•æ˜¯æ’é™¤TBarçš„fooæ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; traits, excludes &#125; <span class="keyword">from</span> <span class="string">'traits-decorator'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFoo</span> </span>&#123;</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> TBar = &#123;</div><div class="line">  bar() &#123; <span class="built_in">console</span>.log(<span class="string">'bar'</span>) &#125;,</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">@traits(TFoo, <span class="attr">TBar</span>::excludes(<span class="string">'foo'</span>))</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123; &#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</div><div class="line">obj.foo() <span class="comment">// foo</span></div><div class="line">obj.bar() <span class="comment">// bar</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨ç»‘å®šè¿ç®—ç¬¦ï¼ˆ::ï¼‰åœ¨TBarä¸Šæ’é™¤fooæ–¹æ³•ï¼Œæ··å…¥æ—¶å°±ä¸ä¼šæŠ¥é”™äº†ã€‚</p>
<p>å¦ä¸€ç§æ–¹æ³•æ˜¯ä¸ºTBarçš„fooæ–¹æ³•èµ·ä¸€ä¸ªåˆ«åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; traits, alias &#125; <span class="keyword">from</span> <span class="string">'traits-decorator'</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">TFoo</span> </span>&#123;</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> TBar = &#123;</div><div class="line">  bar() &#123; <span class="built_in">console</span>.log(<span class="string">'bar'</span>) &#125;,</div><div class="line">  foo() &#123; <span class="built_in">console</span>.log(<span class="string">'foo'</span>) &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">@traits(TFoo, <span class="attr">TBar</span>::alias(&#123;<span class="attr">foo</span>: <span class="string">'aliasFoo'</span>&#125;))</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123; &#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="keyword">new</span> MyClass();</div><div class="line">obj.foo() <span class="comment">// foo</span></div><div class="line">obj.aliasFoo() <span class="comment">// foo</span></div><div class="line">obj.bar() <span class="comment">// bar</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸ºTBarçš„fooæ–¹æ³•èµ·äº†åˆ«åaliasFooï¼Œäºæ˜¯MyClassä¹Ÿå¯ä»¥æ··å…¥TBarçš„fooæ–¹æ³•äº†ã€‚</p>
<p>aliaså’Œexcludesæ–¹æ³•ï¼Œå¯ä»¥ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@traits(TExample::excludes(<span class="string">'foo'</span>,<span class="string">'bar'</span>)::alias(&#123;<span class="attr">baz</span>:<span class="string">'exampleBaz'</span>&#125;))</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ’é™¤äº†TExampleçš„fooæ–¹æ³•å’Œbaræ–¹æ³•ï¼Œä¸ºbazæ–¹æ³•èµ·äº†åˆ«åexampleBazã€‚</p>
<p>asæ–¹æ³•åˆ™ä¸ºä¸Šé¢çš„ä»£ç æä¾›äº†å¦ä¸€ç§å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@traits(TExample::<span class="keyword">as</span>(&#123;<span class="attr">excludes</span>:[<span class="string">'foo'</span>, <span class="string">'bar'</span>], <span class="attr">alias</span>: &#123;<span class="attr">baz</span>: <span class="string">'exampleBaz'</span>&#125;&#125;))</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<h2 id="Babelè½¬ç å™¨çš„æ”¯æŒ"><a href="#Babelè½¬ç å™¨çš„æ”¯æŒ" class="headerlink" title="Babelè½¬ç å™¨çš„æ”¯æŒ"></a>Babelè½¬ç å™¨çš„æ”¯æŒ</h2><p>ç›®å‰ï¼ŒBabelè½¬ç å™¨å·²ç»æ”¯æŒDecoratorã€‚</p>
<p>é¦–å…ˆï¼Œå®‰è£…<code>babel-core</code>å’Œ<code>babel-plugin-transform-decorators</code>ã€‚ç”±äºåè€…åŒ…æ‹¬åœ¨<code>babel-preset-stage-0</code>ä¹‹ä¸­ï¼Œæ‰€ä»¥æ”¹ä¸ºå®‰è£…<code>babel-preset-stage-0</code>äº¦å¯ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install babel-core babel-plugin-transform-decorators</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œè®¾ç½®é…ç½®æ–‡ä»¶<code>.babelrc</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="string">"plugins"</span>: [<span class="string">"transform-decorators"</span>]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ—¶ï¼ŒBabelå°±å¯ä»¥å¯¹Decoratorè½¬ç äº†ã€‚</p>
<p>è„šæœ¬ä¸­æ‰“å¼€çš„å‘½ä»¤å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">babel.transform(<span class="string">"code"</span>, &#123;<span class="attr">plugins</span>: [<span class="string">"transform-decorators"</span>]&#125;)</div></pre></td></tr></table></figure>
<p>Babelçš„å®˜æ–¹ç½‘ç«™æä¾›ä¸€ä¸ª<a href="https://babeljs.io/repl/" target="_blank" rel="external">åœ¨çº¿è½¬ç å™¨</a>ï¼Œåªè¦å‹¾é€‰Experimentalï¼Œå°±èƒ½æ”¯æŒDecoratorçš„åœ¨çº¿è½¬ç ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä¿®é¥°å™¨&quot;&gt;&lt;a href=&quot;#ä¿®é¥°å™¨&quot; class=&quot;headerlink&quot; title=&quot;ä¿®é¥°å™¨&quot;&gt;&lt;/a&gt;ä¿®é¥°å™¨&lt;/h1&gt;&lt;h2 id=&quot;ç±»çš„ä¿®é¥°&quot;&gt;&lt;a href=&quot;#ç±»çš„ä¿®é¥°&quot; class=&quot;headerlink&quot; title=&quot;ç±»çš„ä¿®é¥°&quot;&gt;&lt;/a&gt;ç±»çš„ä¿®
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Decorator" scheme="http://microzz.com/tags/Decorator/"/>
    
  </entry>
  
  <entry>
    <title>ES6ä¸­çš„Class</title>
    <link href="http://microzz.com/2017/01/16/class/"/>
    <id>http://microzz.com/2017/01/16/class/</id>
    <published>2017-01-16T08:40:45.000Z</published>
    <updated>2017-01-16T08:43:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h1><h2 id="ClassåŸºæœ¬è¯­æ³•"><a href="#ClassåŸºæœ¬è¯­æ³•" class="headerlink" title="ClassåŸºæœ¬è¯­æ³•"></a>ClassåŸºæœ¬è¯­æ³•</h2><h3 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h3><p>JavaScriptè¯­è¨€çš„ä¼ ç»Ÿæ–¹æ³•æ˜¯é€šè¿‡æ„é€ å‡½æ•°ï¼Œå®šä¹‰å¹¶ç”Ÿæˆæ–°å¯¹è±¡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.x = x;</div><div class="line">  <span class="keyword">this</span>.y = y;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Point.prototype.toString = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.x + <span class="string">', '</span> + <span class="keyword">this</span>.y + <span class="string">')'</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Point(<span class="number">1</span>, <span class="number">2</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ç§å†™æ³•è·Ÿä¼ ç»Ÿçš„é¢å‘å¯¹è±¡è¯­è¨€ï¼ˆæ¯”å¦‚C++å’ŒJavaï¼‰å·®å¼‚å¾ˆå¤§ï¼Œå¾ˆå®¹æ˜“è®©æ–°å­¦ä¹ è¿™é—¨è¯­è¨€çš„ç¨‹åºå‘˜æ„Ÿåˆ°å›°æƒ‘ã€‚</p>
<p>ES6æä¾›äº†æ›´æ¥è¿‘ä¼ ç»Ÿè¯­è¨€çš„å†™æ³•ï¼Œå¼•å…¥äº†Classï¼ˆç±»ï¼‰è¿™ä¸ªæ¦‚å¿µï¼Œä½œä¸ºå¯¹è±¡çš„æ¨¡æ¿ã€‚é€šè¿‡<code>class</code>å…³é”®å­—ï¼Œå¯ä»¥å®šä¹‰ç±»ã€‚åŸºæœ¬ä¸Šï¼ŒES6çš„<code>class</code>å¯ä»¥çœ‹ä½œåªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå®ƒçš„ç»å¤§éƒ¨åˆ†åŠŸèƒ½ï¼ŒES5éƒ½å¯ä»¥åšåˆ°ï¼Œæ–°çš„<code>class</code>å†™æ³•åªæ˜¯è®©å¯¹è±¡åŸå‹çš„å†™æ³•æ›´åŠ æ¸…æ™°ã€æ›´åƒé¢å‘å¯¹è±¡ç¼–ç¨‹çš„è¯­æ³•è€Œå·²ã€‚ä¸Šé¢çš„ä»£ç ç”¨ES6çš„â€œç±»â€æ”¹å†™ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®šä¹‰ç±»</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(x, y) &#123;</div><div class="line">    <span class="keyword">this</span>.x = x;</div><div class="line">    <span class="keyword">this</span>.y = y;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  toString() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.x + <span class="string">', '</span> + <span class="keyword">this</span>.y + <span class="string">')'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªâ€œç±»â€ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ª<code>constructor</code>æ–¹æ³•ï¼Œè¿™å°±æ˜¯æ„é€ æ–¹æ³•ï¼Œè€Œ<code>this</code>å…³é”®å­—åˆ™ä»£è¡¨å®ä¾‹å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒES5çš„æ„é€ å‡½æ•°<code>Point</code>ï¼Œå¯¹åº”ES6çš„<code>Point</code>ç±»çš„æ„é€ æ–¹æ³•ã€‚</p>
<p><code>Point</code>ç±»é™¤äº†æ„é€ æ–¹æ³•ï¼Œè¿˜å®šä¹‰äº†ä¸€ä¸ª<code>toString</code>æ–¹æ³•ã€‚æ³¨æ„ï¼Œå®šä¹‰â€œç±»â€çš„æ–¹æ³•çš„æ—¶å€™ï¼Œå‰é¢ä¸éœ€è¦åŠ ä¸Š<code>function</code>è¿™ä¸ªå…³é”®å­—ï¼Œç›´æ¥æŠŠå‡½æ•°å®šä¹‰æ”¾è¿›å»äº†å°±å¯ä»¥äº†ã€‚å¦å¤–ï¼Œæ–¹æ³•ä¹‹é—´ä¸éœ€è¦é€—å·åˆ†éš”ï¼ŒåŠ äº†ä¼šæŠ¥é”™ã€‚</p>
<p>ES6çš„ç±»ï¼Œå®Œå…¨å¯ä»¥çœ‹ä½œæ„é€ å‡½æ•°çš„å¦ä¸€ç§å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">typeof</span> Point <span class="comment">// "function"</span></div><div class="line">Point === Point.prototype.constructor <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨æ˜ï¼Œç±»çš„æ•°æ®ç±»å‹å°±æ˜¯å‡½æ•°ï¼Œç±»æœ¬èº«å°±æŒ‡å‘æ„é€ å‡½æ•°ã€‚</p>
<p>ä½¿ç”¨çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯ç›´æ¥å¯¹ç±»ä½¿ç”¨<code>new</code>å‘½ä»¤ï¼Œè·Ÿæ„é€ å‡½æ•°çš„ç”¨æ³•å®Œå…¨ä¸€è‡´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span> </span>&#123;</div><div class="line">  doStuff() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'stuff'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> Bar();</div><div class="line">b.doStuff() <span class="comment">// "stuff"</span></div></pre></td></tr></table></figure>
<p>æ„é€ å‡½æ•°çš„<code>prototype</code>å±æ€§ï¼Œåœ¨ES6çš„â€œç±»â€ä¸Šé¢ç»§ç»­å­˜åœ¨ã€‚äº‹å®ä¸Šï¼Œç±»çš„æ‰€æœ‰æ–¹æ³•éƒ½å®šä¹‰åœ¨ç±»çš„<code>prototype</code>å±æ€§ä¸Šé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  toString()&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  toValue()&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line">Point.prototype = &#123;</div><div class="line">  toString()&#123;&#125;,</div><div class="line">  toValue()&#123;&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>åœ¨ç±»çš„å®ä¾‹ä¸Šé¢è°ƒç”¨æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨åŸå‹ä¸Šçš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;&#125;</div><div class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> B();</div><div class="line"></div><div class="line">b.constructor === B.prototype.constructor <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>b</code>æ˜¯Bç±»çš„å®ä¾‹ï¼Œå®ƒçš„<code>constructor</code>æ–¹æ³•å°±æ˜¯Bç±»åŸå‹çš„<code>constructor</code>æ–¹æ³•ã€‚</p>
<p>ç”±äºç±»çš„æ–¹æ³•éƒ½å®šä¹‰åœ¨<code>prototype</code>å¯¹è±¡ä¸Šé¢ï¼Œæ‰€ä»¥ç±»çš„æ–°æ–¹æ³•å¯ä»¥æ·»åŠ åœ¨<code>prototype</code>å¯¹è±¡ä¸Šé¢ã€‚<code>Object.assign</code>æ–¹æ³•å¯ä»¥å¾ˆæ–¹ä¾¿åœ°ä¸€æ¬¡å‘ç±»æ·»åŠ å¤šä¸ªæ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.assign(Point.prototype, &#123;</div><div class="line">  toString()&#123;&#125;,</div><div class="line">  toValue()&#123;&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>prototype</code>å¯¹è±¡çš„<code>constructor</code>å±æ€§ï¼Œç›´æ¥æŒ‡å‘â€œç±»â€çš„æœ¬èº«ï¼Œè¿™ä¸ES5çš„è¡Œä¸ºæ˜¯ä¸€è‡´çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Point.prototype.constructor === Point <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œç±»çš„å†…éƒ¨æ‰€æœ‰å®šä¹‰çš„æ–¹æ³•ï¼Œéƒ½æ˜¯ä¸å¯æšä¸¾çš„ï¼ˆnon-enumerableï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(x, y) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  toString() &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.keys(Point.prototype)</div><div class="line"><span class="comment">// []</span></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(Point.prototype)</div><div class="line"><span class="comment">// ["constructor","toString"]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>toString</code>æ–¹æ³•æ˜¯<code>Point</code>ç±»å†…éƒ¨å®šä¹‰çš„æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸å¯æšä¸¾çš„ã€‚è¿™ä¸€ç‚¹ä¸ES5çš„è¡Œä¸ºä¸ä¸€è‡´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Point = <span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">Point.prototype.toString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.keys(Point.prototype)</div><div class="line"><span class="comment">// ["toString"]</span></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(Point.prototype)</div><div class="line"><span class="comment">// ["constructor","toString"]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç é‡‡ç”¨ES5çš„å†™æ³•ï¼Œ<code>toString</code>æ–¹æ³•å°±æ˜¯å¯æšä¸¾çš„ã€‚</p>
<p>ç±»çš„å±æ€§åï¼Œå¯ä»¥é‡‡ç”¨è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> methodName = <span class="string">"getArea"</span>;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span></span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(length) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  [methodName]() &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Square</code>ç±»çš„æ–¹æ³•å<code>getArea</code>ï¼Œæ˜¯ä»è¡¨è¾¾å¼å¾—åˆ°çš„ã€‚</p>
<h3 id="constructoræ–¹æ³•"><a href="#constructoræ–¹æ³•" class="headerlink" title="constructoræ–¹æ³•"></a>constructoræ–¹æ³•</h3><p><code>constructor</code>æ–¹æ³•æ˜¯ç±»çš„é»˜è®¤æ–¹æ³•ï¼Œé€šè¿‡<code>new</code>å‘½ä»¤ç”Ÿæˆå¯¹è±¡å®ä¾‹æ—¶ï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥æ–¹æ³•ã€‚ä¸€ä¸ªç±»å¿…é¡»æœ‰<code>constructor</code>æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä¸€ä¸ªç©ºçš„<code>constructor</code>æ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">constructor</span>() &#123;&#125;</div></pre></td></tr></table></figure>
<p><code>constructor</code>æ–¹æ³•é»˜è®¤è¿”å›å®ä¾‹å¯¹è±¡ï¼ˆå³<code>this</code>ï¼‰ï¼Œå®Œå…¨å¯ä»¥æŒ‡å®šè¿”å›å¦å¤–ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.create(<span class="literal">null</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">new</span> Foo() <span class="keyword">instanceof</span> Foo</div><div class="line"><span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>constructor</code>å‡½æ•°è¿”å›ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ï¼Œç»“æœå¯¼è‡´å®ä¾‹å¯¹è±¡ä¸æ˜¯<code>Foo</code>ç±»çš„å®ä¾‹ã€‚</p>
<p>ç±»çš„æ„é€ å‡½æ•°ï¼Œä¸ä½¿ç”¨<code>new</code>æ˜¯æ²¡æ³•è°ƒç”¨çš„ï¼Œä¼šæŠ¥é”™ã€‚è¿™æ˜¯å®ƒè·Ÿæ™®é€šæ„é€ å‡½æ•°çš„ä¸€ä¸ªä¸»è¦åŒºåˆ«ï¼Œåè€…ä¸ç”¨<code>new</code>ä¹Ÿå¯ä»¥æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.create(<span class="literal">null</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Foo()</div><div class="line"><span class="comment">// TypeError: Class constructor Foo cannot be invoked without 'new'</span></div></pre></td></tr></table></figure>
<h3 id="ç±»çš„å®ä¾‹å¯¹è±¡"><a href="#ç±»çš„å®ä¾‹å¯¹è±¡" class="headerlink" title="ç±»çš„å®ä¾‹å¯¹è±¡"></a>ç±»çš„å®ä¾‹å¯¹è±¡</h3><p>ç”Ÿæˆç±»çš„å®ä¾‹å¯¹è±¡çš„å†™æ³•ï¼Œä¸ES5å®Œå…¨ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä½¿ç”¨<code>new</code>å‘½ä»¤ã€‚å¦‚æœå¿˜è®°åŠ ä¸Š<code>new</code>ï¼Œåƒå‡½æ•°é‚£æ ·è°ƒç”¨<code>Class</code>ï¼Œå°†ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">var</span> point = Point(<span class="number">2</span>, <span class="number">3</span>);</div><div class="line"></div><div class="line"><span class="comment">// æ­£ç¡®</span></div><div class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> Point(<span class="number">2</span>, <span class="number">3</span>);</div></pre></td></tr></table></figure>
<p>ä¸ES5ä¸€æ ·ï¼Œå®ä¾‹çš„å±æ€§é™¤éæ˜¾å¼å®šä¹‰åœ¨å…¶æœ¬èº«ï¼ˆå³å®šä¹‰åœ¨<code>this</code>å¯¹è±¡ä¸Šï¼‰ï¼Œå¦åˆ™éƒ½æ˜¯å®šä¹‰åœ¨åŸå‹ä¸Šï¼ˆå³å®šä¹‰åœ¨<code>class</code>ä¸Šï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//å®šä¹‰ç±»</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>(x, y) &#123;</div><div class="line">    <span class="keyword">this</span>.x = x;</div><div class="line">    <span class="keyword">this</span>.y = y;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  toString() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'('</span> + <span class="keyword">this</span>.x + <span class="string">', '</span> + <span class="keyword">this</span>.y + <span class="string">')'</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> point = <span class="keyword">new</span> Point(<span class="number">2</span>, <span class="number">3</span>);</div><div class="line"></div><div class="line">point.toString() <span class="comment">// (2, 3)</span></div><div class="line"></div><div class="line">point.hasOwnProperty(<span class="string">'x'</span>) <span class="comment">// true</span></div><div class="line">point.hasOwnProperty(<span class="string">'y'</span>) <span class="comment">// true</span></div><div class="line">point.hasOwnProperty(<span class="string">'toString'</span>) <span class="comment">// false</span></div><div class="line">point.__proto__.hasOwnProperty(<span class="string">'toString'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>x</code>å’Œ<code>y</code>éƒ½æ˜¯å®ä¾‹å¯¹è±¡<code>point</code>è‡ªèº«çš„å±æ€§ï¼ˆå› ä¸ºå®šä¹‰åœ¨<code>this</code>å˜é‡ä¸Šï¼‰ï¼Œæ‰€ä»¥<code>hasOwnProperty</code>æ–¹æ³•è¿”å›<code>true</code>ï¼Œè€Œ<code>toString</code>æ˜¯åŸå‹å¯¹è±¡çš„å±æ€§ï¼ˆå› ä¸ºå®šä¹‰åœ¨<code>Point</code>ç±»ä¸Šï¼‰ï¼Œæ‰€ä»¥<code>hasOwnProperty</code>æ–¹æ³•è¿”å›<code>false</code>ã€‚è¿™äº›éƒ½ä¸ES5çš„è¡Œä¸ºä¿æŒä¸€è‡´ã€‚</p>
<p>ä¸ES5ä¸€æ ·ï¼Œç±»çš„æ‰€æœ‰å®ä¾‹å…±äº«ä¸€ä¸ªåŸå‹å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Point(<span class="number">2</span>,<span class="number">3</span>);</div><div class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> Point(<span class="number">3</span>,<span class="number">2</span>);</div><div class="line"></div><div class="line">p1.__proto__ === p2.__proto__</div><div class="line"><span class="comment">//true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>p1</code>å’Œ<code>p2</code>éƒ½æ˜¯Pointçš„å®ä¾‹ï¼Œå®ƒä»¬çš„åŸå‹éƒ½æ˜¯Point.prototypeï¼Œæ‰€ä»¥<code>__proto__</code>å±æ€§æ˜¯ç›¸ç­‰çš„ã€‚</p>
<p>è¿™ä¹Ÿæ„å‘³ç€ï¼Œå¯ä»¥é€šè¿‡å®ä¾‹çš„<code>__proto__</code>å±æ€§ä¸ºClassæ·»åŠ æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Point(<span class="number">2</span>,<span class="number">3</span>);</div><div class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> Point(<span class="number">3</span>,<span class="number">2</span>);</div><div class="line"></div><div class="line">p1.__proto__.printName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">'Oops'</span> &#125;;</div><div class="line"></div><div class="line">p1.printName() <span class="comment">// "Oops"</span></div><div class="line">p2.printName() <span class="comment">// "Oops"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> p3 = <span class="keyword">new</span> Point(<span class="number">4</span>,<span class="number">2</span>);</div><div class="line">p3.printName() <span class="comment">// "Oops"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨<code>p1</code>çš„åŸå‹ä¸Šæ·»åŠ äº†ä¸€ä¸ª<code>printName</code>æ–¹æ³•ï¼Œç”±äº<code>p1</code>çš„åŸå‹å°±æ˜¯<code>p2</code>çš„åŸå‹ï¼Œå› æ­¤<code>p2</code>ä¹Ÿå¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è€Œä¸”ï¼Œæ­¤åæ–°å»ºçš„å®ä¾‹<code>p3</code>ä¹Ÿå¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è¿™æ„å‘³ç€ï¼Œä½¿ç”¨å®ä¾‹çš„<code>__proto__</code>å±æ€§æ”¹å†™åŸå‹ï¼Œå¿…é¡»ç›¸å½“è°¨æ…ï¼Œä¸æ¨èä½¿ç”¨ï¼Œå› ä¸ºè¿™ä¼šæ”¹å˜Classçš„åŸå§‹å®šä¹‰ï¼Œå½±å“åˆ°æ‰€æœ‰å®ä¾‹ã€‚</p>
<h3 id="ä¸å­˜åœ¨å˜é‡æå‡"><a href="#ä¸å­˜åœ¨å˜é‡æå‡" class="headerlink" title="ä¸å­˜åœ¨å˜é‡æå‡"></a>ä¸å­˜åœ¨å˜é‡æå‡</h3><p>Classä¸å­˜åœ¨å˜é‡æå‡ï¼ˆhoistï¼‰ï¼Œè¿™ä¸€ç‚¹ä¸ES5å®Œå…¨ä¸åŒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Foo(); <span class="comment">// ReferenceError</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Foo</code>ç±»ä½¿ç”¨åœ¨å‰ï¼Œå®šä¹‰åœ¨åï¼Œè¿™æ ·ä¼šæŠ¥é”™ï¼Œå› ä¸ºES6ä¸ä¼šæŠŠç±»çš„å£°æ˜æå‡åˆ°ä»£ç å¤´éƒ¨ã€‚è¿™ç§è§„å®šçš„åŸå› ä¸ä¸‹æ–‡è¦æåˆ°çš„ç»§æ‰¿æœ‰å…³ï¼Œå¿…é¡»ä¿è¯å­ç±»åœ¨çˆ¶ç±»ä¹‹åå®šä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> Foo = <span class="class"><span class="keyword">class</span> </span>&#123;&#125;;</div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Bar</span> <span class="keyword">extends</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸º<code>Bar</code>ç»§æ‰¿<code>Foo</code>çš„æ—¶å€™ï¼Œ<code>Foo</code>å·²ç»æœ‰å®šä¹‰äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœå­˜åœ¨<code>class</code>çš„æå‡ï¼Œä¸Šé¢ä»£ç å°±ä¼šæŠ¥é”™ï¼Œå› ä¸º<code>class</code>ä¼šè¢«æå‡åˆ°ä»£ç å¤´éƒ¨ï¼Œè€Œ<code>let</code>å‘½ä»¤æ˜¯ä¸æå‡çš„ï¼Œæ‰€ä»¥å¯¼è‡´<code>Bar</code>ç»§æ‰¿<code>Foo</code>çš„æ—¶å€™ï¼Œ<code>Foo</code>è¿˜æ²¡æœ‰å®šä¹‰ã€‚</p>
<h3 id="Classè¡¨è¾¾å¼"><a href="#Classè¡¨è¾¾å¼" class="headerlink" title="Classè¡¨è¾¾å¼"></a>Classè¡¨è¾¾å¼</h3><p>ä¸å‡½æ•°ä¸€æ ·ï¼Œç±»ä¹Ÿå¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼çš„å½¢å¼å®šä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> MyClass = <span class="class"><span class="keyword">class</span> <span class="title">Me</span> </span>&#123;</div><div class="line">  getClassName() &#123;</div><div class="line">    <span class="keyword">return</span> Me.name;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨è¡¨è¾¾å¼å®šä¹‰äº†ä¸€ä¸ªç±»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªç±»çš„åå­—æ˜¯<code>MyClass</code>è€Œä¸æ˜¯<code>Me</code>ï¼Œ<code>Me</code>åªåœ¨Classçš„å†…éƒ¨ä»£ç å¯ç”¨ï¼ŒæŒ‡ä»£å½“å‰ç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> inst = <span class="keyword">new</span> MyClass();</div><div class="line">inst.getClassName() <span class="comment">// Me</span></div><div class="line">Me.name <span class="comment">// ReferenceError: Me is not defined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œ<code>Me</code>åªåœ¨Classå†…éƒ¨æœ‰å®šä¹‰ã€‚</p>
<p>å¦‚æœç±»çš„å†…éƒ¨æ²¡ç”¨åˆ°çš„è¯ï¼Œå¯ä»¥çœç•¥<code>Me</code>ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> MyClass = <span class="class"><span class="keyword">class</span> </span>&#123; <span class="comment">/* ... */</span> &#125;;</div></pre></td></tr></table></figure>
<p>é‡‡ç”¨Classè¡¨è¾¾å¼ï¼Œå¯ä»¥å†™å‡ºç«‹å³æ‰§è¡Œçš„Classã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="class"><span class="keyword">class</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(name) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  sayName() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</div><div class="line">  &#125;</div><div class="line">&#125;(<span class="string">'å¼ ä¸‰'</span>);</div><div class="line"></div><div class="line">person.sayName(); <span class="comment">// "å¼ ä¸‰"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>person</code>æ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„ç±»çš„å®ä¾‹ã€‚</p>
<h3 id="ç§æœ‰æ–¹æ³•"><a href="#ç§æœ‰æ–¹æ³•" class="headerlink" title="ç§æœ‰æ–¹æ³•"></a>ç§æœ‰æ–¹æ³•</h3><p>ç§æœ‰æ–¹æ³•æ˜¯å¸¸è§éœ€æ±‚ï¼Œä½†ES6ä¸æä¾›ï¼Œåªèƒ½é€šè¿‡å˜é€šæ–¹æ³•æ¨¡æ‹Ÿå®ç°ã€‚</p>
<p>ä¸€ç§åšæ³•æ˜¯åœ¨å‘½åä¸ŠåŠ ä»¥åŒºåˆ«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// å…¬æœ‰æ–¹æ³•</span></div><div class="line">  foo (baz) &#123;</div><div class="line">    <span class="keyword">this</span>._bar(baz);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// ç§æœ‰æ–¹æ³•</span></div><div class="line">  _bar(baz) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.snaf = baz;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>_bar</code>æ–¹æ³•å‰é¢çš„ä¸‹åˆ’çº¿ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªåªé™äºå†…éƒ¨ä½¿ç”¨çš„ç§æœ‰æ–¹æ³•ã€‚ä½†æ˜¯ï¼Œè¿™ç§å‘½åæ˜¯ä¸ä¿é™©çš„ï¼Œåœ¨ç±»çš„å¤–éƒ¨ï¼Œè¿˜æ˜¯å¯ä»¥è°ƒç”¨åˆ°è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p>å¦ä¸€ç§æ–¹æ³•å°±æ˜¯ç´¢æ€§å°†ç§æœ‰æ–¹æ³•ç§»å‡ºæ¨¡å—ï¼Œå› ä¸ºæ¨¡å—å†…éƒ¨çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¯¹å¤–å¯è§çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Widget</span> </span>&#123;</div><div class="line">  foo (baz) &#123;</div><div class="line">    bar.call(<span class="keyword">this</span>, baz);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">baz</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.snaf = baz;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>foo</code>æ˜¯å…¬æœ‰æ–¹æ³•ï¼Œå†…éƒ¨è°ƒç”¨äº†<code>bar.call(this, baz)</code>ã€‚è¿™ä½¿å¾—<code>bar</code>å®é™…ä¸Šæˆä¸ºäº†å½“å‰æ¨¡å—çš„ç§æœ‰æ–¹æ³•ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯åˆ©ç”¨<code>Symbol</code>å€¼çš„å”¯ä¸€æ€§ï¼Œå°†ç§æœ‰æ–¹æ³•çš„åå­—å‘½åä¸ºä¸€ä¸ª<code>Symbol</code>å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> bar = <span class="built_in">Symbol</span>(<span class="string">'bar'</span>);</div><div class="line"><span class="keyword">const</span> snaf = <span class="built_in">Symbol</span>(<span class="string">'snaf'</span>);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">myClass</span></span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// å…¬æœ‰æ–¹æ³•</span></div><div class="line">  foo(baz) &#123;</div><div class="line">    <span class="keyword">this</span>[bar](baz);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// ç§æœ‰æ–¹æ³•</span></div><div class="line">  [bar](baz) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>[snaf] = baz;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>bar</code>å’Œ<code>snaf</code>éƒ½æ˜¯<code>Symbol</code>å€¼ï¼Œå¯¼è‡´ç¬¬ä¸‰æ–¹æ— æ³•è·å–åˆ°å®ƒä»¬ï¼Œå› æ­¤è¾¾åˆ°äº†ç§æœ‰æ–¹æ³•å’Œç§æœ‰å±æ€§çš„æ•ˆæœã€‚</p>
<h3 id="thisçš„æŒ‡å‘"><a href="#thisçš„æŒ‡å‘" class="headerlink" title="thisçš„æŒ‡å‘"></a>thisçš„æŒ‡å‘</h3><p>ç±»çš„æ–¹æ³•å†…éƒ¨å¦‚æœå«æœ‰<code>this</code>ï¼Œå®ƒé»˜è®¤æŒ‡å‘ç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¿…é¡»éå¸¸å°å¿ƒï¼Œä¸€æ—¦å•ç‹¬ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå¾ˆå¯èƒ½æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</div><div class="line">  printName(name = <span class="string">'there'</span>) &#123;</div><div class="line">    <span class="keyword">this</span>.print(<span class="string">`Hello <span class="subst">$&#123;name&#125;</span>`</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  print(text) &#123;</div><div class="line">    <span class="built_in">console</span>.log(text);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> logger = <span class="keyword">new</span> Logger();</div><div class="line"><span class="keyword">const</span> &#123; printName &#125; = logger;</div><div class="line">printName(); <span class="comment">// TypeError: Cannot read property 'print' of undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>printName</code>æ–¹æ³•ä¸­çš„<code>this</code>ï¼Œé»˜è®¤æŒ‡å‘<code>Logger</code>ç±»çš„å®ä¾‹ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†è¿™ä¸ªæ–¹æ³•æå–å‡ºæ¥å•ç‹¬ä½¿ç”¨ï¼Œ<code>this</code>ä¼šæŒ‡å‘è¯¥æ–¹æ³•è¿è¡Œæ—¶æ‰€åœ¨çš„ç¯å¢ƒï¼Œå› ä¸ºæ‰¾ä¸åˆ°<code>print</code>æ–¹æ³•è€Œå¯¼è‡´æŠ¥é”™ã€‚</p>
<p>ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„è§£å†³æ–¹æ³•æ˜¯ï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­ç»‘å®š<code>this</code>ï¼Œè¿™æ ·å°±ä¸ä¼šæ‰¾ä¸åˆ°<code>print</code>æ–¹æ³•äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.printName = <span class="keyword">this</span>.printName.bind(<span class="keyword">this</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.printName = <span class="function">(<span class="params">name = <span class="string">'there'</span></span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">this</span>.print(<span class="string">`Hello <span class="subst">$&#123;name&#125;</span>`</span>);</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨<code>Proxy</code>ï¼Œè·å–æ–¹æ³•çš„æ—¶å€™ï¼Œè‡ªåŠ¨ç»‘å®š<code>this</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">selfish</span> (<span class="params">target</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> cache = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line">  <span class="keyword">const</span> handler = &#123;</div><div class="line">    get (target, key) &#123;</div><div class="line">      <span class="keyword">const</span> value = <span class="built_in">Reflect</span>.get(target, key);</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> value !== <span class="string">'function'</span>) &#123;</div><div class="line">        <span class="keyword">return</span> value;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span> (!cache.has(value)) &#123;</div><div class="line">        cache.set(value, value.bind(target));</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> cache.get(value);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">  <span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line">  <span class="keyword">return</span> proxy;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> logger = selfish(<span class="keyword">new</span> Logger());</div></pre></td></tr></table></figure>
<h3 id="ä¸¥æ ¼æ¨¡å¼"><a href="#ä¸¥æ ¼æ¨¡å¼" class="headerlink" title="ä¸¥æ ¼æ¨¡å¼"></a>ä¸¥æ ¼æ¨¡å¼</h3><p>ç±»å’Œæ¨¡å—çš„å†…éƒ¨ï¼Œé»˜è®¤å°±æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨<code>use strict</code>æŒ‡å®šè¿è¡Œæ¨¡å¼ã€‚åªè¦ä½ çš„ä»£ç å†™åœ¨ç±»æˆ–æ¨¡å—ä¹‹ä¸­ï¼Œå°±åªæœ‰ä¸¥æ ¼æ¨¡å¼å¯ç”¨ã€‚</p>
<p>è€ƒè™‘åˆ°æœªæ¥æ‰€æœ‰çš„ä»£ç ï¼Œå…¶å®éƒ½æ˜¯è¿è¡Œåœ¨æ¨¡å—ä¹‹ä¸­ï¼Œæ‰€ä»¥ES6å®é™…ä¸ŠæŠŠæ•´ä¸ªè¯­è¨€å‡çº§åˆ°äº†ä¸¥æ ¼æ¨¡å¼ã€‚</p>
<h3 id="nameå±æ€§"><a href="#nameå±æ€§" class="headerlink" title="nameå±æ€§"></a>nameå±æ€§</h3><p>ç”±äºæœ¬è´¨ä¸Šï¼ŒES6çš„ç±»åªæ˜¯ES5çš„æ„é€ å‡½æ•°çš„ä¸€å±‚åŒ…è£…ï¼Œæ‰€ä»¥å‡½æ•°çš„è®¸å¤šç‰¹æ€§éƒ½è¢«<code>Class</code>ç»§æ‰¿ï¼ŒåŒ…æ‹¬<code>name</code>å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;&#125;</div><div class="line">Point.name <span class="comment">// "Point"</span></div></pre></td></tr></table></figure>
<p><code>name</code>å±æ€§æ€»æ˜¯è¿”å›ç´§è·Ÿåœ¨<code>class</code>å…³é”®å­—åé¢çš„ç±»åã€‚</p>
<h2 id="Classçš„ç»§æ‰¿"><a href="#Classçš„ç»§æ‰¿" class="headerlink" title="Classçš„ç»§æ‰¿"></a>Classçš„ç»§æ‰¿</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>Classä¹‹é—´å¯ä»¥é€šè¿‡<code>extends</code>å…³é”®å­—å®ç°ç»§æ‰¿ï¼Œè¿™æ¯”ES5çš„é€šè¿‡ä¿®æ”¹åŸå‹é“¾å®ç°ç»§æ‰¿ï¼Œè¦æ¸…æ™°å’Œæ–¹ä¾¿å¾ˆå¤šã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ColorPoint</span> <span class="keyword">extends</span> <span class="title">Point</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª<code>ColorPoint</code>ç±»ï¼Œè¯¥ç±»é€šè¿‡<code>extends</code>å…³é”®å­—ï¼Œç»§æ‰¿äº†<code>Point</code>ç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ã€‚ä½†æ˜¯ç”±äºæ²¡æœ‰éƒ¨ç½²ä»»ä½•ä»£ç ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ªç±»å®Œå…¨ä¸€æ ·ï¼Œç­‰äºå¤åˆ¶äº†ä¸€ä¸ª<code>Point</code>ç±»ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬åœ¨<code>ColorPoint</code>å†…éƒ¨åŠ ä¸Šä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ColorPoint</span> <span class="keyword">extends</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(x, y, color) &#123;</div><div class="line">    <span class="keyword">super</span>(x, y); <span class="comment">// è°ƒç”¨çˆ¶ç±»çš„constructor(x, y)</span></div><div class="line">    <span class="keyword">this</span>.color = color;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  toString() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.color + <span class="string">' '</span> + <span class="keyword">super</span>.toString(); <span class="comment">// è°ƒç”¨çˆ¶ç±»çš„toString()</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>constructor</code>æ–¹æ³•å’Œ<code>toString</code>æ–¹æ³•ä¹‹ä¸­ï¼Œéƒ½å‡ºç°äº†<code>super</code>å…³é”®å­—ï¼Œå®ƒåœ¨è¿™é‡Œè¡¨ç¤ºçˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œç”¨æ¥æ–°å»ºçˆ¶ç±»çš„<code>this</code>å¯¹è±¡ã€‚</p>
<p>å­ç±»å¿…é¡»åœ¨<code>constructor</code>æ–¹æ³•ä¸­è°ƒç”¨<code>super</code>æ–¹æ³•ï¼Œå¦åˆ™æ–°å»ºå®ä¾‹æ—¶ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»æ²¡æœ‰è‡ªå·±çš„<code>this</code>å¯¹è±¡ï¼Œè€Œæ˜¯ç»§æ‰¿çˆ¶ç±»çš„<code>this</code>å¯¹è±¡ï¼Œç„¶åå¯¹å…¶è¿›è¡ŒåŠ å·¥ã€‚å¦‚æœä¸è°ƒç”¨<code>super</code>æ–¹æ³•ï¼Œå­ç±»å°±å¾—ä¸åˆ°<code>this</code>å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123; <span class="comment">/* ... */</span> &#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ColorPoint</span> <span class="keyword">extends</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> cp = <span class="keyword">new</span> ColorPoint(); <span class="comment">// ReferenceError</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>ColorPoint</code>ç»§æ‰¿äº†çˆ¶ç±»<code>Point</code>ï¼Œä½†æ˜¯å®ƒçš„æ„é€ å‡½æ•°æ²¡æœ‰è°ƒç”¨<code>super</code>æ–¹æ³•ï¼Œå¯¼è‡´æ–°å»ºå®ä¾‹æ—¶æŠ¥é”™ã€‚</p>
<p>ES5çš„ç»§æ‰¿ï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ å­ç±»çš„å®ä¾‹å¯¹è±¡<code>this</code>ï¼Œç„¶åå†å°†çˆ¶ç±»çš„æ–¹æ³•æ·»åŠ åˆ°<code>this</code>ä¸Šé¢ï¼ˆ<code>Parent.apply(this)</code>ï¼‰ã€‚ES6çš„ç»§æ‰¿æœºåˆ¶å®Œå…¨ä¸åŒï¼Œå®è´¨æ˜¯å…ˆåˆ›é€ çˆ¶ç±»çš„å®ä¾‹å¯¹è±¡<code>this</code>ï¼ˆæ‰€ä»¥å¿…é¡»å…ˆè°ƒç”¨<code>super</code>æ–¹æ³•ï¼‰ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®æ”¹<code>this</code>ã€‚</p>
<p>å¦‚æœå­ç±»æ²¡æœ‰å®šä¹‰<code>constructor</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šè¢«é»˜è®¤æ·»åŠ ï¼Œä»£ç å¦‚ä¸‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡æœ‰æ²¡æœ‰æ˜¾å¼å®šä¹‰ï¼Œä»»ä½•ä¸€ä¸ªå­ç±»éƒ½æœ‰<code>constructor</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">constructor</span>(...args) &#123;</div><div class="line">  <span class="keyword">super</span>(...args);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼Œåªæœ‰è°ƒç”¨<code>super</code>ä¹‹åï¼Œæ‰å¯ä»¥ä½¿ç”¨<code>this</code>å…³é”®å­—ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºå­ç±»å®ä¾‹çš„æ„å»ºï¼Œæ˜¯åŸºäºå¯¹çˆ¶ç±»å®ä¾‹åŠ å·¥ï¼Œåªæœ‰<code>super</code>æ–¹æ³•æ‰èƒ½è¿”å›çˆ¶ç±»å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(x, y) &#123;</div><div class="line">    <span class="keyword">this</span>.x = x;</div><div class="line">    <span class="keyword">this</span>.y = y;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ColorPoint</span> <span class="keyword">extends</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(x, y, color) &#123;</div><div class="line">    <span class="keyword">this</span>.color = color; <span class="comment">// ReferenceError</span></div><div class="line">    <span class="keyword">super</span>(x, y);</div><div class="line">    <span class="keyword">this</span>.color = color; <span class="comment">// æ­£ç¡®</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»çš„<code>constructor</code>æ–¹æ³•æ²¡æœ‰è°ƒç”¨<code>super</code>ä¹‹å‰ï¼Œå°±ä½¿ç”¨<code>this</code>å…³é”®å­—ï¼Œç»“æœæŠ¥é”™ï¼Œè€Œæ”¾åœ¨<code>super</code>æ–¹æ³•ä¹‹åå°±æ˜¯æ­£ç¡®çš„ã€‚</p>
<p>ä¸‹é¢æ˜¯ç”Ÿæˆå­ç±»å®ä¾‹çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> cp = <span class="keyword">new</span> ColorPoint(<span class="number">25</span>, <span class="number">8</span>, <span class="string">'green'</span>);</div><div class="line"></div><div class="line">cp <span class="keyword">instanceof</span> ColorPoint <span class="comment">// true</span></div><div class="line">cp <span class="keyword">instanceof</span> Point <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå®ä¾‹å¯¹è±¡<code>cp</code>åŒæ—¶æ˜¯<code>ColorPoint</code>å’Œ<code>Point</code>ä¸¤ä¸ªç±»çš„å®ä¾‹ï¼Œè¿™ä¸ES5çš„è¡Œä¸ºå®Œå…¨ä¸€è‡´ã€‚</p>
<h3 id="ç±»çš„prototypeå±æ€§å’Œ-proto-å±æ€§"><a href="#ç±»çš„prototypeå±æ€§å’Œ-proto-å±æ€§" class="headerlink" title="ç±»çš„prototypeå±æ€§å’Œ__proto__å±æ€§"></a>ç±»çš„prototypeå±æ€§å’Œ__proto__å±æ€§</h3><p>å¤§å¤šæ•°æµè§ˆå™¨çš„ES5å®ç°ä¹‹ä¸­ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æœ‰<code>__proto__</code>å±æ€§ï¼ŒæŒ‡å‘å¯¹åº”çš„æ„é€ å‡½æ•°çš„prototypeå±æ€§ã€‚Classä½œä¸ºæ„é€ å‡½æ•°çš„è¯­æ³•ç³–ï¼ŒåŒæ—¶æœ‰prototypeå±æ€§å’Œ<code>__proto__</code>å±æ€§ï¼Œå› æ­¤åŒæ—¶å­˜åœ¨ä¸¤æ¡ç»§æ‰¿é“¾ã€‚</p>
<p>ï¼ˆ1ï¼‰å­ç±»çš„<code>__proto__</code>å±æ€§ï¼Œè¡¨ç¤ºæ„é€ å‡½æ•°çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»ã€‚</p>
<p>ï¼ˆ2ï¼‰å­ç±»<code>prototype</code>å±æ€§çš„<code>__proto__</code>å±æ€§ï¼Œè¡¨ç¤ºæ–¹æ³•çš„ç»§æ‰¿ï¼Œæ€»æ˜¯æŒ‡å‘çˆ¶ç±»çš„<code>prototype</code>å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">B.__proto__ === A <span class="comment">// true</span></div><div class="line">B.prototype.__proto__ === A.prototype <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»<code>B</code>çš„<code>__proto__</code>å±æ€§æŒ‡å‘çˆ¶ç±»<code>A</code>ï¼Œå­ç±»<code>B</code>çš„<code>prototype</code>å±æ€§çš„<code>__proto__</code>å±æ€§æŒ‡å‘çˆ¶ç±»<code>A</code>çš„<code>prototype</code>å±æ€§ã€‚</p>
<p>è¿™æ ·çš„ç»“æœæ˜¯å› ä¸ºï¼Œç±»çš„ç»§æ‰¿æ˜¯æŒ‰ç…§ä¸‹é¢çš„æ¨¡å¼å®ç°çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Bçš„å®ä¾‹ç»§æ‰¿Açš„å®ä¾‹</span></div><div class="line"><span class="built_in">Object</span>.setPrototypeOf(B.prototype, A.prototype);</div><div class="line"><span class="keyword">const</span> b = <span class="keyword">new</span> B();</div><div class="line"></div><div class="line"><span class="comment">// Bçš„å®ä¾‹ç»§æ‰¿Açš„é™æ€å±æ€§</span></div><div class="line"><span class="built_in">Object</span>.setPrototypeOf(B, A);</div><div class="line"><span class="keyword">const</span> b = <span class="keyword">new</span> B();</div></pre></td></tr></table></figure>
<p>ã€Šå¯¹è±¡çš„æ‰©å±•ã€‹ä¸€ç« ç»™å‡ºè¿‡<code>Object.setPrototypeOf</code>æ–¹æ³•çš„å®ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.setPrototypeOf = <span class="function"><span class="keyword">function</span> (<span class="params">obj, proto</span>) </span>&#123;</div><div class="line">  obj.__proto__ = proto;</div><div class="line">  <span class="keyword">return</span> obj;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œå°±å¾—åˆ°äº†ä¸Šé¢çš„ç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.setPrototypeOf(B.prototype, A.prototype);</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">B.prototype.__proto__ = A.prototype;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.setPrototypeOf(B, A);</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">B.__proto__ = A;</div></pre></td></tr></table></figure>
<p>è¿™ä¸¤æ¡ç»§æ‰¿é“¾ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼šä½œä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå­ç±»ï¼ˆ<code>B</code>ï¼‰çš„åŸå‹ï¼ˆ<code>__proto__</code>å±æ€§ï¼‰æ˜¯çˆ¶ç±»ï¼ˆ<code>A</code>ï¼‰ï¼›ä½œä¸ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå­ç±»ï¼ˆ<code>B</code>ï¼‰çš„åŸå‹ï¼ˆ<code>prototype</code>å±æ€§ï¼‰æ˜¯çˆ¶ç±»çš„å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.create(A.prototype);</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">B.prototype.__proto__ = A.prototype;</div></pre></td></tr></table></figure>
<h3 id="Extends-çš„ç»§æ‰¿ç›®æ ‡"><a href="#Extends-çš„ç»§æ‰¿ç›®æ ‡" class="headerlink" title="Extends çš„ç»§æ‰¿ç›®æ ‡"></a>Extends çš„ç»§æ‰¿ç›®æ ‡</h3><p><code>extends</code>å…³é”®å­—åé¢å¯ä»¥è·Ÿå¤šç§ç±»å‹çš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>A</code>ï¼Œåªè¦æ˜¯ä¸€ä¸ªæœ‰<code>prototype</code>å±æ€§çš„å‡½æ•°ï¼Œå°±èƒ½è¢«<code>B</code>ç»§æ‰¿ã€‚ç”±äºå‡½æ•°éƒ½æœ‰<code>prototype</code>å±æ€§ï¼ˆé™¤äº†<code>Function.prototype</code>å‡½æ•°ï¼‰ï¼Œå› æ­¤<code>A</code>å¯ä»¥æ˜¯ä»»æ„å‡½æ•°ã€‚</p>
<p>ä¸‹é¢ï¼Œè®¨è®ºä¸‰ç§ç‰¹æ®Šæƒ…å†µã€‚</p>
<p>ç¬¬ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå­ç±»ç»§æ‰¿Objectç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">Object</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">A.__proto__ === <span class="built_in">Object</span> <span class="comment">// true</span></div><div class="line">A.prototype.__proto__ === <span class="built_in">Object</span>.prototype <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>A</code>å…¶å®å°±æ˜¯æ„é€ å‡½æ•°<code>Object</code>çš„å¤åˆ¶ï¼Œ<code>A</code>çš„å®ä¾‹å°±æ˜¯<code>Object</code>çš„å®ä¾‹ã€‚</p>
<p>ç¬¬äºŒç§ç‰¹æ®Šæƒ…å†µï¼Œä¸å­˜åœ¨ä»»ä½•ç»§æ‰¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">A.__proto__ === <span class="built_in">Function</span>.prototype <span class="comment">// true</span></div><div class="line">A.prototype.__proto__ === <span class="built_in">Object</span>.prototype <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™ç§æƒ…å†µä¸‹ï¼ŒAä½œä¸ºä¸€ä¸ªåŸºç±»ï¼ˆå³ä¸å­˜åœ¨ä»»ä½•ç»§æ‰¿ï¼‰ï¼Œå°±æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥ç»§æ‰¿<code>Funciton.prototype</code>ã€‚ä½†æ˜¯ï¼Œ<code>A</code>è°ƒç”¨åè¿”å›ä¸€ä¸ªç©ºå¯¹è±¡ï¼ˆå³<code>Object</code>å®ä¾‹ï¼‰ï¼Œæ‰€ä»¥<code>A.prototype.__proto__</code>æŒ‡å‘æ„é€ å‡½æ•°ï¼ˆ<code>Object</code>ï¼‰çš„<code>prototype</code>å±æ€§ã€‚</p>
<p>ç¬¬ä¸‰ç§ç‰¹æ®Šæƒ…å†µï¼Œå­ç±»ç»§æ‰¿<code>null</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> <span class="keyword">extends</span> <span class="title">null</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">A.__proto__ === <span class="built_in">Function</span>.prototype <span class="comment">// true</span></div><div class="line">A.prototype.__proto__ === <span class="literal">undefined</span> <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™ç§æƒ…å†µä¸ç¬¬äºŒç§æƒ…å†µéå¸¸åƒã€‚<code>A</code>ä¹Ÿæ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥ç»§æ‰¿<code>Funciton.prototype</code>ã€‚ä½†æ˜¯ï¼ŒAè°ƒç”¨åè¿”å›çš„å¯¹è±¡ä¸ç»§æ‰¿ä»»ä½•æ–¹æ³•ï¼Œæ‰€ä»¥å®ƒçš„<code>__proto__</code>æŒ‡å‘<code>Function.prototype</code>ï¼Œå³å®è´¨ä¸Šæ‰§è¡Œäº†ä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> <span class="keyword">extends</span> <span class="title">null</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123; <span class="keyword">return</span> <span class="built_in">Object</span>.create(<span class="literal">null</span>); &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Object-getPrototypeOf"><a href="#Object-getPrototypeOf" class="headerlink" title="Object.getPrototypeOf()"></a>Object.getPrototypeOf()</h3><p><code>Object.getPrototypeOf</code>æ–¹æ³•å¯ä»¥ç”¨æ¥ä»å­ç±»ä¸Šè·å–çˆ¶ç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.getPrototypeOf(ColorPoint) === Point</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•åˆ¤æ–­ï¼Œä¸€ä¸ªç±»æ˜¯å¦ç»§æ‰¿äº†å¦ä¸€ä¸ªç±»ã€‚</p>
<h3 id="super-å…³é”®å­—"><a href="#super-å…³é”®å­—" class="headerlink" title="super å…³é”®å­—"></a>super å…³é”®å­—</h3><p><code>super</code>è¿™ä¸ªå…³é”®å­—ï¼Œæ—¢å¯ä»¥å½“ä½œå‡½æ•°ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“ä½œå¯¹è±¡ä½¿ç”¨ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œå®ƒçš„ç”¨æ³•å®Œå…¨ä¸åŒã€‚</p>
<p>ç¬¬ä¸€ç§æƒ…å†µï¼Œ<code>super</code>ä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼Œä»£è¡¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚ES6 è¦æ±‚ï¼Œå­ç±»çš„æ„é€ å‡½æ•°å¿…é¡»æ‰§è¡Œä¸€æ¬¡<code>super</code>å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»<code>B</code>çš„æ„é€ å‡½æ•°ä¹‹ä¸­çš„<code>super()</code>ï¼Œä»£è¡¨è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ã€‚è¿™æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ JavaScript å¼•æ“ä¼šæŠ¥é”™ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>super</code>è™½ç„¶ä»£è¡¨äº†çˆ¶ç±»<code>A</code>çš„æ„é€ å‡½æ•°ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯å­ç±»<code>B</code>çš„å®ä¾‹ï¼Œå³<code>super</code>å†…éƒ¨çš„<code>this</code>æŒ‡çš„æ˜¯<code>B</code>ï¼Œå› æ­¤<code>super()</code>åœ¨è¿™é‡Œç›¸å½“äº<code>A.prototype.constructor.call(this)</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">new</span>.target.name);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">new</span> A() <span class="comment">// A</span></div><div class="line"><span class="keyword">new</span> B() <span class="comment">// B</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>new.target</code>æŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°ã€‚å¯ä»¥çœ‹åˆ°ï¼Œåœ¨<code>super()</code>æ‰§è¡Œæ—¶ï¼Œå®ƒæŒ‡å‘çš„æ˜¯å­ç±»<code>B</code>çš„æ„é€ å‡½æ•°ï¼Œè€Œä¸æ˜¯çˆ¶ç±»<code>A</code>çš„æ„é€ å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>super()</code>å†…éƒ¨çš„<code>this</code>æŒ‡å‘çš„æ˜¯<code>B</code>ã€‚</p>
<p>ä½œä¸ºå‡½æ•°æ—¶ï¼Œ<code>super()</code>åªèƒ½ç”¨åœ¨å­ç±»çš„æ„é€ å‡½æ•°ä¹‹ä¸­ï¼Œç”¨åœ¨å…¶ä»–åœ°æ–¹å°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  m() &#123;</div><div class="line">    <span class="keyword">super</span>(); <span class="comment">// æŠ¥é”™</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>super()</code>ç”¨åœ¨<code>B</code>ç±»çš„<code>m</code>æ–¹æ³•ä¹‹ä¸­ï¼Œå°±ä¼šé€ æˆå¥æ³•é”™è¯¯ã€‚</p>
<p>ç¬¬äºŒç§æƒ…å†µï¼Œ<code>super</code>ä½œä¸ºå¯¹è±¡æ—¶ï¼ŒæŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">  p() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">super</span>.p()); <span class="comment">// 2</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> B();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»<code>B</code>å½“ä¸­çš„<code>super.p()</code>ï¼Œå°±æ˜¯å°†<code>super</code>å½“ä½œä¸€ä¸ªå¯¹è±¡ä½¿ç”¨ã€‚è¿™æ—¶ï¼Œ<code>super</code>æŒ‡å‘<code>A.prototype</code>ï¼Œæ‰€ä»¥<code>super.p()</code>å°±ç›¸å½“äº<code>A.prototype.p()</code>ã€‚</p>
<p>è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œç”±äº<code>super</code>æŒ‡å‘çˆ¶ç±»çš„åŸå‹å¯¹è±¡ï¼Œæ‰€ä»¥å®šä¹‰åœ¨çˆ¶ç±»å®ä¾‹ä¸Šçš„æ–¹æ³•æˆ–å±æ€§ï¼Œæ˜¯æ— æ³•é€šè¿‡<code>super</code>è°ƒç”¨çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.p = <span class="number">2</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  get m() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.p;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> B();</div><div class="line">b.m <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>p</code>æ˜¯çˆ¶ç±»<code>A</code>å®ä¾‹çš„å±æ€§ï¼Œ<code>super.p</code>å°±å¼•ç”¨ä¸åˆ°å®ƒã€‚</p>
<p>å¦‚æœå±æ€§å®šä¹‰åœ¨çˆ¶ç±»çš„åŸå‹å¯¹è±¡ä¸Šï¼Œ<code>super</code>å°±å¯ä»¥å–åˆ°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</div><div class="line">A.prototype.x = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">super</span>.x) <span class="comment">// 2</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> B();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå±æ€§<code>x</code>æ˜¯å®šä¹‰åœ¨<code>A.prototype</code>ä¸Šé¢çš„ï¼Œæ‰€ä»¥<code>super.x</code>å¯ä»¥å–åˆ°å®ƒçš„å€¼ã€‚</p>
<p>ES6 è§„å®šï¼Œé€šè¿‡<code>super</code>è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œ<code>super</code>ä¼šç»‘å®šå­ç±»çš„<code>this</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.x = <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">  print() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.x);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="keyword">this</span>.x = <span class="number">2</span>;</div><div class="line">  &#125;</div><div class="line">  m() &#123;</div><div class="line">    <span class="keyword">super</span>.print();</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> B();</div><div class="line">b.m() <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>super.print()</code>è™½ç„¶è°ƒç”¨çš„æ˜¯<code>A.prototype.print()</code>ï¼Œä½†æ˜¯<code>A.prototype.print()</code>ä¼šç»‘å®šå­ç±»<code>B</code>çš„<code>this</code>ï¼Œå¯¼è‡´è¾“å‡ºçš„æ˜¯<code>2</code>ï¼Œè€Œä¸æ˜¯<code>1</code>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯<code>super.print.call(this)</code>ã€‚</p>
<p>ç”±äºç»‘å®šå­ç±»çš„<code>this</code>ï¼Œæ‰€ä»¥å¦‚æœé€šè¿‡<code>super</code>å¯¹æŸä¸ªå±æ€§èµ‹å€¼ï¼Œè¿™æ—¶<code>super</code>å°±æ˜¯<code>this</code>ï¼Œèµ‹å€¼çš„å±æ€§ä¼šå˜æˆå­ç±»å®ä¾‹çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.x = <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="keyword">this</span>.x = <span class="number">2</span>;</div><div class="line">    <span class="keyword">super</span>.x = <span class="number">3</span>;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">super</span>.x); <span class="comment">// undefined</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.x); <span class="comment">// 3</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> B();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>super.x</code>èµ‹å€¼ä¸º<code>3</code>ï¼Œè¿™æ—¶ç­‰åŒäºå¯¹<code>this.x</code>èµ‹å€¼ä¸º<code>3</code>ã€‚è€Œå½“è¯»å–<code>super.x</code>çš„æ—¶å€™ï¼Œè¯»çš„æ˜¯<code>A.prototype.x</code>ï¼Œæ‰€ä»¥è¿”å›<code>undefined</code>ã€‚</p>
<p>æ³¨æ„ï¼Œä½¿ç”¨<code>super</code>çš„æ—¶å€™ï¼Œå¿…é¡»æ˜¾å¼æŒ‡å®šæ˜¯ä½œä¸ºå‡½æ•°ã€è¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">super</span>); <span class="comment">// æŠ¥é”™</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>console.log(super)</code>å½“ä¸­çš„<code>super</code>ï¼Œæ— æ³•çœ‹å‡ºæ˜¯ä½œä¸ºå‡½æ•°ä½¿ç”¨ï¼Œè¿˜æ˜¯ä½œä¸ºå¯¹è±¡ä½¿ç”¨ï¼Œæ‰€ä»¥ JavaScript å¼•æ“è§£æä»£ç çš„æ—¶å€™å°±ä¼šæŠ¥é”™ã€‚è¿™æ—¶ï¼Œå¦‚æœèƒ½æ¸…æ™°åœ°è¡¨æ˜<code>super</code>çš„æ•°æ®ç±»å‹ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> <span class="keyword">extends</span> <span class="title">A</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">super</span>.valueOf() <span class="keyword">instanceof</span> B); <span class="comment">// true</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> B();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>super.valueOf()</code>è¡¨æ˜<code>super</code>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå› æ­¤å°±ä¸ä¼šæŠ¥é”™ã€‚åŒæ—¶ï¼Œç”±äº<code>super</code>ç»‘å®š<code>B</code>çš„<code>this</code>ï¼Œæ‰€ä»¥<code>super.valueOf()</code>è¿”å›çš„æ˜¯ä¸€ä¸ª<code>B</code>çš„å®ä¾‹ã€‚</p>
<p>æœ€åï¼Œç”±äºå¯¹è±¡æ€»æ˜¯ç»§æ‰¿å…¶ä»–å¯¹è±¡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨ä»»æ„ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œä½¿ç”¨<code>super</code>å…³é”®å­—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  toString() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"MyObject: "</span> + <span class="keyword">super</span>.toString();</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj.toString(); <span class="comment">// MyObject: [object Object]</span></div></pre></td></tr></table></figure>
<h3 id="å®ä¾‹çš„-proto-å±æ€§"><a href="#å®ä¾‹çš„-proto-å±æ€§" class="headerlink" title="å®ä¾‹çš„__proto__å±æ€§"></a>å®ä¾‹çš„__proto__å±æ€§</h3><p>å­ç±»å®ä¾‹çš„__proto__å±æ€§çš„__proto__å±æ€§ï¼ŒæŒ‡å‘çˆ¶ç±»å®ä¾‹çš„__proto__å±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå­ç±»çš„åŸå‹çš„åŸå‹ï¼Œæ˜¯çˆ¶ç±»çš„åŸå‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Point(<span class="number">2</span>, <span class="number">3</span>);</div><div class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> ColorPoint(<span class="number">2</span>, <span class="number">3</span>, <span class="string">'red'</span>);</div><div class="line"></div><div class="line">p2.__proto__ === p1.__proto__ <span class="comment">// false</span></div><div class="line">p2.__proto__.__proto__ === p1.__proto__ <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>ColorPoint</code>ç»§æ‰¿äº†<code>Point</code>ï¼Œå¯¼è‡´å‰è€…åŸå‹çš„åŸå‹æ˜¯åè€…çš„åŸå‹ã€‚</p>
<p>å› æ­¤ï¼Œé€šè¿‡å­ç±»å®ä¾‹çš„<code>__proto__.__proto__</code>å±æ€§ï¼Œå¯ä»¥ä¿®æ”¹çˆ¶ç±»å®ä¾‹çš„è¡Œä¸ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">p2.__proto__.__proto__.printName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Ha'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">p1.printName() <span class="comment">// "Ha"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨<code>ColorPoint</code>çš„å®ä¾‹<code>p2</code>ä¸Šå‘<code>Point</code>ç±»æ·»åŠ æ–¹æ³•ï¼Œç»“æœå½±å“åˆ°äº†<code>Point</code>çš„å®ä¾‹<code>p1</code>ã€‚</p>
<h2 id="åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿"><a href="#åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿" class="headerlink" title="åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿"></a>åŸç”Ÿæ„é€ å‡½æ•°çš„ç»§æ‰¿</h2><p>åŸç”Ÿæ„é€ å‡½æ•°æ˜¯æŒ‡è¯­è¨€å†…ç½®çš„æ„é€ å‡½æ•°ï¼Œé€šå¸¸ç”¨æ¥ç”Ÿæˆæ•°æ®ç»“æ„ã€‚ECMAScriptçš„åŸç”Ÿæ„é€ å‡½æ•°å¤§è‡´æœ‰ä¸‹é¢è¿™äº›ã€‚</p>
<ul>
<li>Boolean()</li>
<li>Number()</li>
<li>String()</li>
<li>Array()</li>
<li>Date()</li>
<li>Function()</li>
<li>RegExp()</li>
<li>Error()</li>
<li>Object()</li>
</ul>
<p>ä»¥å‰ï¼Œè¿™äº›åŸç”Ÿæ„é€ å‡½æ•°æ˜¯æ— æ³•ç»§æ‰¿çš„ï¼Œæ¯”å¦‚ï¼Œä¸èƒ½è‡ªå·±å®šä¹‰ä¸€ä¸ª<code>Array</code>çš„å­ç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyArray</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">Array</span>.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">MyArray.prototype = <span class="built_in">Object</span>.create(<span class="built_in">Array</span>.prototype, &#123;</div><div class="line">  <span class="attr">constructor</span>: &#123;</div><div class="line">    <span class="attr">value</span>: MyArray,</div><div class="line">    <span class="attr">writable</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">enumerable</span>: <span class="literal">true</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªç»§æ‰¿Arrayçš„<code>MyArray</code>ç±»ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªç±»çš„è¡Œä¸ºä¸<code>Array</code>å®Œå…¨ä¸ä¸€è‡´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> colors = <span class="keyword">new</span> MyArray();</div><div class="line">colors[<span class="number">0</span>] = <span class="string">"red"</span>;</div><div class="line">colors.length  <span class="comment">// 0</span></div><div class="line"></div><div class="line">colors.length = <span class="number">0</span>;</div><div class="line">colors[<span class="number">0</span>]  <span class="comment">// "red"</span></div></pre></td></tr></table></figure>
<p>ä¹‹æ‰€ä»¥ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µï¼Œæ˜¯å› ä¸ºå­ç±»æ— æ³•è·å¾—åŸç”Ÿæ„é€ å‡½æ•°çš„å†…éƒ¨å±æ€§ï¼Œé€šè¿‡<code>Array.apply()</code>æˆ–è€…åˆ†é…ç»™åŸå‹å¯¹è±¡éƒ½ä¸è¡Œã€‚åŸç”Ÿæ„é€ å‡½æ•°ä¼šå¿½ç•¥<code>apply</code>æ–¹æ³•ä¼ å…¥çš„<code>this</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸç”Ÿæ„é€ å‡½æ•°çš„<code>this</code>æ— æ³•ç»‘å®šï¼Œå¯¼è‡´æ‹¿ä¸åˆ°å†…éƒ¨å±æ€§ã€‚</p>
<p>ES5æ˜¯å…ˆæ–°å»ºå­ç±»çš„å®ä¾‹å¯¹è±¡<code>this</code>ï¼Œå†å°†çˆ¶ç±»çš„å±æ€§æ·»åŠ åˆ°å­ç±»ä¸Šï¼Œç”±äºçˆ¶ç±»çš„å†…éƒ¨å±æ€§æ— æ³•è·å–ï¼Œå¯¼è‡´æ— æ³•ç»§æ‰¿åŸç”Ÿçš„æ„é€ å‡½æ•°ã€‚æ¯”å¦‚ï¼ŒArrayæ„é€ å‡½æ•°æœ‰ä¸€ä¸ªå†…éƒ¨å±æ€§<code>[[DefineOwnProperty]]</code>ï¼Œç”¨æ¥å®šä¹‰æ–°å±æ€§æ—¶ï¼Œæ›´æ–°<code>length</code>å±æ€§ï¼Œè¿™ä¸ªå†…éƒ¨å±æ€§æ— æ³•åœ¨å­ç±»è·å–ï¼Œå¯¼è‡´å­ç±»çš„<code>length</code>å±æ€§è¡Œä¸ºä¸æ­£å¸¸ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³è®©ä¸€ä¸ªæ™®é€šå¯¹è±¡ç»§æ‰¿<code>Error</code>å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> e = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(<span class="built_in">Error</span>.call(e))</div><div class="line"><span class="comment">// [ 'stack' ]</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(e)</div><div class="line"><span class="comment">// []</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡<code>Error.call(e)</code>è¿™ç§å†™æ³•ï¼Œè®©æ™®é€šå¯¹è±¡<code>e</code>å…·æœ‰<code>Error</code>å¯¹è±¡çš„å®ä¾‹å±æ€§ã€‚ä½†æ˜¯ï¼Œ<code>Error.call()</code>å®Œå…¨å¿½ç•¥ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œ<code>e</code>æœ¬èº«æ²¡æœ‰ä»»ä½•å˜åŒ–ã€‚è¿™è¯æ˜äº†<code>Error.call(e)</code>è¿™ç§å†™æ³•ï¼Œæ— æ³•ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°ã€‚</p>
<p>ES6å…è®¸ç»§æ‰¿åŸç”Ÿæ„é€ å‡½æ•°å®šä¹‰å­ç±»ï¼Œå› ä¸ºES6æ˜¯å…ˆæ–°å»ºçˆ¶ç±»çš„å®ä¾‹å¯¹è±¡<code>this</code>ï¼Œç„¶åå†ç”¨å­ç±»çš„æ„é€ å‡½æ•°ä¿®é¥°<code>this</code>ï¼Œä½¿å¾—çˆ¶ç±»çš„æ‰€æœ‰è¡Œä¸ºéƒ½å¯ä»¥ç»§æ‰¿ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç»§æ‰¿<code>Array</code>çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyArray</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(...args) &#123;</div><div class="line">    <span class="keyword">super</span>(...args);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> arr = <span class="keyword">new</span> MyArray();</div><div class="line">arr[<span class="number">0</span>] = <span class="number">12</span>;</div><div class="line">arr.length <span class="comment">// 1</span></div><div class="line"></div><div class="line">arr.length = <span class="number">0</span>;</div><div class="line">arr[<span class="number">0</span>] <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª<code>MyArray</code>ç±»ï¼Œç»§æ‰¿äº†<code>Array</code>æ„é€ å‡½æ•°ï¼Œå› æ­¤å°±å¯ä»¥ä»<code>MyArray</code>ç”Ÿæˆæ•°ç»„çš„å®ä¾‹ã€‚è¿™æ„å‘³ç€ï¼ŒES6å¯ä»¥è‡ªå®šä¹‰åŸç”Ÿæ•°æ®ç»“æ„ï¼ˆæ¯”å¦‚Arrayã€Stringç­‰ï¼‰çš„å­ç±»ï¼Œè¿™æ˜¯ES5æ— æ³•åšåˆ°çš„ã€‚</p>
<p>ä¸Šé¢è¿™ä¸ªä¾‹å­ä¹Ÿè¯´æ˜ï¼Œ<code>extends</code>å…³é”®å­—ä¸ä»…å¯ä»¥ç”¨æ¥ç»§æ‰¿ç±»ï¼Œè¿˜å¯ä»¥ç”¨æ¥ç»§æ‰¿åŸç”Ÿçš„æ„é€ å‡½æ•°ã€‚å› æ­¤å¯ä»¥åœ¨åŸç”Ÿæ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šï¼Œå®šä¹‰è‡ªå·±çš„æ•°æ®ç»“æ„ã€‚ä¸‹é¢å°±æ˜¯å®šä¹‰äº†ä¸€ä¸ªå¸¦ç‰ˆæœ¬åŠŸèƒ½çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">VersionedArray</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="keyword">this</span>.history = [[]];</div><div class="line">  &#125;</div><div class="line">  commit() &#123;</div><div class="line">    <span class="keyword">this</span>.history.push(<span class="keyword">this</span>.slice());</div><div class="line">  &#125;</div><div class="line">  revert() &#123;</div><div class="line">    <span class="keyword">this</span>.splice(<span class="number">0</span>, <span class="keyword">this</span>.length, ...this.history[<span class="keyword">this</span>.history.length - <span class="number">1</span>]);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> VersionedArray();</div><div class="line"></div><div class="line">x.push(<span class="number">1</span>);</div><div class="line">x.push(<span class="number">2</span>);</div><div class="line">x <span class="comment">// [1, 2]</span></div><div class="line">x.history <span class="comment">// [[]]</span></div><div class="line"></div><div class="line">x.commit();</div><div class="line">x.history <span class="comment">// [[], [1, 2]]</span></div><div class="line">x.push(<span class="number">3</span>);</div><div class="line">x <span class="comment">// [1, 2, 3]</span></div><div class="line"></div><div class="line">x.revert();</div><div class="line">x <span class="comment">// [1, 2]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>VersionedArray</code>ç»“æ„ä¼šé€šè¿‡<code>commit</code>æ–¹æ³•ï¼Œå°†è‡ªå·±çš„å½“å‰çŠ¶æ€å­˜å…¥<code>history</code>å±æ€§ï¼Œç„¶åé€šè¿‡<code>revert</code>æ–¹æ³•ï¼Œå¯ä»¥æ’¤é”€å½“å‰ç‰ˆæœ¬ï¼Œå›åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œ<code>VersionedArray</code>ä¾ç„¶æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€æœ‰åŸç”Ÿçš„æ•°ç»„æ–¹æ³•éƒ½å¯ä»¥åœ¨å®ƒä¸Šé¢è°ƒç”¨ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰<code>Error</code>å­ç±»çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExtendableError</span> <span class="keyword">extends</span> <span class="title">Error</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(message) &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="keyword">this</span>.message = message;</div><div class="line">    <span class="keyword">this</span>.stack = (<span class="keyword">new</span> <span class="built_in">Error</span>()).stack;</div><div class="line">    <span class="keyword">this</span>.name = <span class="keyword">this</span>.constructor.name;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyError</span> <span class="keyword">extends</span> <span class="title">ExtendableError</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(m) &#123;</div><div class="line">    <span class="keyword">super</span>(m);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> myerror = <span class="keyword">new</span> MyError(<span class="string">'ll'</span>);</div><div class="line">myerror.message <span class="comment">// "ll"</span></div><div class="line">myerror <span class="keyword">instanceof</span> <span class="built_in">Error</span> <span class="comment">// true</span></div><div class="line">myerror.name <span class="comment">// "MyError"</span></div><div class="line">myerror.stack</div><div class="line"><span class="comment">// Error</span></div><div class="line"><span class="comment">//     at MyError.ExtendableError</span></div><div class="line"><span class="comment">//     ...</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œç»§æ‰¿<code>Object</code>çš„å­ç±»ï¼Œæœ‰ä¸€ä¸ª<a href="http://stackoverflow.com/questions/36203614/super-does-not-pass-arguments-when-instantiating-a-class-extended-from-object" target="_blank" rel="external">è¡Œä¸ºå·®å¼‚</a>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewObj</span> <span class="keyword">extends</span> <span class="title">Object</span></span>&#123;</div><div class="line">  <span class="keyword">constructor</span>()&#123;</div><div class="line">    <span class="keyword">super</span>(...arguments);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> o = <span class="keyword">new</span> NewObj(&#123;<span class="attr">attr</span>: <span class="literal">true</span>&#125;);</div><div class="line"><span class="built_in">console</span>.log(o.attr === <span class="literal">true</span>);  <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>NewObj</code>ç»§æ‰¿äº†<code>Object</code>ï¼Œä½†æ˜¯æ— æ³•é€šè¿‡<code>super</code>æ–¹æ³•å‘çˆ¶ç±»<code>Object</code>ä¼ å‚ã€‚è¿™æ˜¯å› ä¸ºES6æ”¹å˜äº†<code>Object</code>æ„é€ å‡½æ•°çš„è¡Œä¸ºï¼Œä¸€æ—¦å‘ç°<code>Object</code>æ–¹æ³•ä¸æ˜¯é€šè¿‡<code>new Object()</code>è¿™ç§å½¢å¼è°ƒç”¨ï¼ŒES6è§„å®š<code>Object</code>æ„é€ å‡½æ•°ä¼šå¿½ç•¥å‚æ•°ã€‚</p>
<h2 id="Classçš„å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰"><a href="#Classçš„å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰" class="headerlink" title="Classçš„å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰"></a>Classçš„å–å€¼å‡½æ•°ï¼ˆgetterï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆsetterï¼‰</h2><p>ä¸ES5ä¸€æ ·ï¼Œåœ¨Classå†…éƒ¨å¯ä»¥ä½¿ç”¨<code>get</code>å’Œ<code>set</code>å…³é”®å­—ï¼Œå¯¹æŸä¸ªå±æ€§è®¾ç½®å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œæ‹¦æˆªè¯¥å±æ€§çš„å­˜å–è¡Œä¸ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">  get prop() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'getter'</span>;</div><div class="line">  &#125;</div><div class="line">  set prop(value) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'setter: '</span>+value);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> inst = <span class="keyword">new</span> MyClass();</div><div class="line"></div><div class="line">inst.prop = <span class="number">123</span>;</div><div class="line"><span class="comment">// setter: 123</span></div><div class="line"></div><div class="line">inst.prop</div><div class="line"><span class="comment">// 'getter'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>prop</code>å±æ€§æœ‰å¯¹åº”çš„å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°ï¼Œå› æ­¤èµ‹å€¼å’Œè¯»å–è¡Œä¸ºéƒ½è¢«è‡ªå®šä¹‰äº†ã€‚</p>
<p>å­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°æ˜¯è®¾ç½®åœ¨å±æ€§çš„descriptorå¯¹è±¡ä¸Šçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomHTMLElement</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(element) &#123;</div><div class="line">    <span class="keyword">this</span>.element = element;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  get html() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.element.innerHTML;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  set html(value) &#123;</div><div class="line">    <span class="keyword">this</span>.element.innerHTML = value;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(</div><div class="line">  CustomHTMLElement.prototype, <span class="string">"html"</span>);</div><div class="line"><span class="string">"get"</span> <span class="keyword">in</span> descriptor  <span class="comment">// true</span></div><div class="line"><span class="string">"set"</span> <span class="keyword">in</span> descriptor  <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­˜å€¼å‡½æ•°å’Œå–å€¼å‡½æ•°æ˜¯å®šä¹‰åœ¨<code>html</code>å±æ€§çš„æè¿°å¯¹è±¡ä¸Šé¢ï¼Œè¿™ä¸ES5å®Œå…¨ä¸€è‡´ã€‚</p>
<h2 id="Classçš„Generatoræ–¹æ³•"><a href="#Classçš„Generatoræ–¹æ³•" class="headerlink" title="Classçš„Generatoræ–¹æ³•"></a>Classçš„Generatoræ–¹æ³•</h2><p>å¦‚æœæŸä¸ªæ–¹æ³•ä¹‹å‰åŠ ä¸Šæ˜Ÿå·ï¼ˆ<code>*</code>ï¼‰ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(...args) &#123;</div><div class="line">    <span class="keyword">this</span>.args = args;</div><div class="line">  &#125;</div><div class="line">  * [<span class="built_in">Symbol</span>.iterator]() &#123;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> arg <span class="keyword">of</span> <span class="keyword">this</span>.args) &#123;</div><div class="line">      <span class="keyword">yield</span> arg;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> <span class="keyword">new</span> Foo(<span class="string">'hello'</span>, <span class="string">'world'</span>)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div><div class="line"><span class="comment">// hello</span></div><div class="line"><span class="comment">// world</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒFooç±»çš„Symbol.iteratoræ–¹æ³•å‰æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ã€‚Symbol.iteratoræ–¹æ³•è¿”å›ä¸€ä¸ªFooç±»çš„é»˜è®¤éå†å™¨ï¼Œforâ€¦ofå¾ªç¯ä¼šè‡ªåŠ¨è°ƒç”¨è¿™ä¸ªéå†å™¨ã€‚</p>
<h2 id="Classçš„é™æ€æ–¹æ³•"><a href="#Classçš„é™æ€æ–¹æ³•" class="headerlink" title="Classçš„é™æ€æ–¹æ³•"></a>Classçš„é™æ€æ–¹æ³•</h2><p>ç±»ç›¸å½“äºå®ä¾‹çš„åŸå‹ï¼Œæ‰€æœ‰åœ¨ç±»ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œéƒ½ä¼šè¢«å®ä¾‹ç»§æ‰¿ã€‚å¦‚æœåœ¨ä¸€ä¸ªæ–¹æ³•å‰ï¼ŒåŠ ä¸Š<code>static</code>å…³é”®å­—ï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•ä¸ä¼šè¢«å®ä¾‹ç»§æ‰¿ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡ç±»æ¥è°ƒç”¨ï¼Œè¿™å°±ç§°ä¸ºâ€œé™æ€æ–¹æ³•â€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> classMethod() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'hello'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Foo.classMethod() <span class="comment">// 'hello'</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> foo = <span class="keyword">new</span> Foo();</div><div class="line">foo.classMethod()</div><div class="line"><span class="comment">// TypeError: foo.classMethod is not a function</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Foo</code>ç±»çš„<code>classMethod</code>æ–¹æ³•å‰æœ‰<code>static</code>å…³é”®å­—ï¼Œè¡¨æ˜è¯¥æ–¹æ³•æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥åœ¨<code>Foo</code>ç±»ä¸Šè°ƒç”¨ï¼ˆ<code>Foo.classMethod()</code>ï¼‰ï¼Œè€Œä¸æ˜¯åœ¨<code>Foo</code>ç±»çš„å®ä¾‹ä¸Šè°ƒç”¨ã€‚å¦‚æœåœ¨å®ä¾‹ä¸Šè°ƒç”¨é™æ€æ–¹æ³•ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¡¨ç¤ºä¸å­˜åœ¨è¯¥æ–¹æ³•ã€‚</p>
<p>çˆ¶ç±»çš„é™æ€æ–¹æ³•ï¼Œå¯ä»¥è¢«å­ç±»ç»§æ‰¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> classMethod() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'hello'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span> <span class="keyword">extends</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Bar.classMethod(); <span class="comment">// 'hello'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œçˆ¶ç±»<code>Foo</code>æœ‰ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œå­ç±»<code>Bar</code>å¯ä»¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p>é™æ€æ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥ä»<code>super</code>å¯¹è±¡ä¸Šè°ƒç”¨çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> classMethod() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'hello'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bar</span> <span class="keyword">extends</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> classMethod() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">super</span>.classMethod() + <span class="string">', too'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Bar.classMethod();</div></pre></td></tr></table></figure>
<h2 id="Classçš„é™æ€å±æ€§å’Œå®ä¾‹å±æ€§"><a href="#Classçš„é™æ€å±æ€§å’Œå®ä¾‹å±æ€§" class="headerlink" title="Classçš„é™æ€å±æ€§å’Œå®ä¾‹å±æ€§"></a>Classçš„é™æ€å±æ€§å’Œå®ä¾‹å±æ€§</h2><p>é™æ€å±æ€§æŒ‡çš„æ˜¯Classæœ¬èº«çš„å±æ€§ï¼Œå³<code>Class.propname</code>ï¼Œè€Œä¸æ˜¯å®šä¹‰åœ¨å®ä¾‹å¯¹è±¡ï¼ˆ<code>this</code>ï¼‰ä¸Šçš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Foo.prop = <span class="number">1</span>;</div><div class="line">Foo.prop <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„å†™æ³•ä¸º<code>Foo</code>ç±»å®šä¹‰äº†ä¸€ä¸ªé™æ€å±æ€§<code>prop</code>ã€‚</p>
<p>ç›®å‰ï¼Œåªæœ‰è¿™ç§å†™æ³•å¯è¡Œï¼Œå› ä¸ºES6æ˜ç¡®è§„å®šï¼ŒClasså†…éƒ¨åªæœ‰é™æ€æ–¹æ³•ï¼Œæ²¡æœ‰é™æ€å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä»¥ä¸‹ä¸¤ç§å†™æ³•éƒ½æ— æ•ˆ</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="comment">// å†™æ³•ä¸€</span></div><div class="line">  prop: <span class="number">2</span></div><div class="line"></div><div class="line">  <span class="comment">// å†™æ³•äºŒ</span></div><div class="line">  <span class="keyword">static</span> prop: <span class="number">2</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">Foo.prop <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ES7æœ‰ä¸€ä¸ªé™æ€å±æ€§çš„<a href="https://github.com/jeffmo/es-class-properties" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œç›®å‰Babelè½¬ç å™¨æ”¯æŒã€‚</p>
<p>è¿™ä¸ªææ¡ˆå¯¹å®ä¾‹å±æ€§å’Œé™æ€å±æ€§ï¼Œéƒ½è§„å®šäº†æ–°çš„å†™æ³•ã€‚</p>
<p>ï¼ˆ1ï¼‰ç±»çš„å®ä¾‹å±æ€§</p>
<p>ç±»çš„å®ä¾‹å±æ€§å¯ä»¥ç”¨ç­‰å¼ï¼Œå†™å…¥ç±»çš„å®šä¹‰ä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</div><div class="line">  myProp = <span class="number">42</span>;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.myProp); <span class="comment">// 42</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>myProp</code>å°±æ˜¯<code>MyClass</code>çš„å®ä¾‹å±æ€§ã€‚åœ¨<code>MyClass</code>çš„å®ä¾‹ä¸Šï¼Œå¯ä»¥è¯»å–è¿™ä¸ªå±æ€§ã€‚</p>
<p>ä»¥å‰ï¼Œæˆ‘ä»¬å®šä¹‰å®ä¾‹å±æ€§ï¼Œåªèƒ½å†™åœ¨ç±»çš„<code>constructor</code>æ–¹æ³•é‡Œé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReactCounter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props) &#123;</div><div class="line">    <span class="keyword">super</span>(props);</div><div class="line">    <span class="keyword">this</span>.state = &#123;</div><div class="line">      <span class="attr">count</span>: <span class="number">0</span></div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ„é€ æ–¹æ³•<code>constructor</code>é‡Œé¢ï¼Œå®šä¹‰äº†<code>this.state</code>å±æ€§ã€‚</p>
<p>æœ‰äº†æ–°çš„å†™æ³•ä»¥åï¼Œå¯ä»¥ä¸åœ¨<code>constructor</code>æ–¹æ³•é‡Œé¢å®šä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReactCounter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  state = &#123;</div><div class="line">    <span class="attr">count</span>: <span class="number">0</span></div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ç§å†™æ³•æ¯”ä»¥å‰æ›´æ¸…æ™°ã€‚</p>
<p>ä¸ºäº†å¯è¯»æ€§çš„ç›®çš„ï¼Œå¯¹äºé‚£äº›åœ¨<code>constructor</code>é‡Œé¢å·²ç»å®šä¹‰çš„å®ä¾‹å±æ€§ï¼Œæ–°å†™æ³•å…è®¸ç›´æ¥åˆ—å‡ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReactCounter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(props) &#123;</div><div class="line">    <span class="keyword">super</span>(props);</div><div class="line">    <span class="keyword">this</span>.state = &#123;</div><div class="line">      <span class="attr">count</span>: <span class="number">0</span></div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  state;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰ç±»çš„é™æ€å±æ€§</p>
<p>ç±»çš„é™æ€å±æ€§åªè¦åœ¨ä¸Šé¢çš„å®ä¾‹å±æ€§å†™æ³•å‰é¢ï¼ŒåŠ ä¸Š<code>static</code>å…³é”®å­—å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> myStaticProp = <span class="number">42</span>;</div><div class="line"></div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="built_in">console</span>.log(MyClass.myProp); <span class="comment">// 42</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åŒæ ·çš„ï¼Œè¿™ä¸ªæ–°å†™æ³•å¤§å¤§æ–¹ä¾¿äº†é™æ€å±æ€§çš„è¡¨è¾¾ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è€å†™æ³•</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">&#125;</div><div class="line">Foo.prop = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> prop = <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè€å†™æ³•çš„é™æ€å±æ€§å®šä¹‰åœ¨ç±»çš„å¤–éƒ¨ã€‚æ•´ä¸ªç±»ç”Ÿæˆä»¥åï¼Œå†ç”Ÿæˆé™æ€å±æ€§ã€‚è¿™æ ·è®©äººå¾ˆå®¹æ˜“å¿½ç•¥è¿™ä¸ªé™æ€å±æ€§ï¼Œä¹Ÿä¸ç¬¦åˆç›¸å…³ä»£ç åº”è¯¥æ”¾åœ¨ä¸€èµ·çš„ä»£ç ç»„ç»‡åŸåˆ™ã€‚å¦å¤–ï¼Œæ–°å†™æ³•æ˜¯æ˜¾å¼å£°æ˜ï¼ˆdeclarativeï¼‰ï¼Œè€Œä¸æ˜¯èµ‹å€¼å¤„ç†ï¼Œè¯­ä¹‰æ›´å¥½ã€‚</p>
<h2 id="new-targetå±æ€§"><a href="#new-targetå±æ€§" class="headerlink" title="new.targetå±æ€§"></a>new.targetå±æ€§</h2><p><code>new</code>æ˜¯ä»æ„é€ å‡½æ•°ç”Ÿæˆå®ä¾‹çš„å‘½ä»¤ã€‚ES6ä¸º<code>new</code>å‘½ä»¤å¼•å…¥äº†ä¸€ä¸ª<code>new.target</code>å±æ€§ï¼Œï¼ˆåœ¨æ„é€ å‡½æ•°ä¸­ï¼‰è¿”å›<code>new</code>å‘½ä»¤ä½œç”¨äºçš„é‚£ä¸ªæ„é€ å‡½æ•°ã€‚å¦‚æœæ„é€ å‡½æ•°ä¸æ˜¯é€šè¿‡<code>new</code>å‘½ä»¤è°ƒç”¨çš„ï¼Œ<code>new.target</code>ä¼šè¿”å›<code>undefined</code>ï¼Œå› æ­¤è¿™ä¸ªå±æ€§å¯ä»¥ç”¨æ¥ç¡®å®šæ„é€ å‡½æ•°æ˜¯æ€ä¹ˆè°ƒç”¨çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">new</span>.target !== <span class="literal">undefined</span>) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å¿…é¡»ä½¿ç”¨newç”Ÿæˆå®ä¾‹'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å¦ä¸€ç§å†™æ³•</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">new</span>.target === Person) &#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å¿…é¡»ä½¿ç”¨newç”Ÿæˆå®ä¾‹'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> Person(<span class="string">'å¼ ä¸‰'</span>); <span class="comment">// æ­£ç¡®</span></div><div class="line"><span class="keyword">var</span> notAPerson = Person.call(person, <span class="string">'å¼ ä¸‰'</span>);  <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ç¡®ä¿æ„é€ å‡½æ•°åªèƒ½é€šè¿‡<code>new</code>å‘½ä»¤è°ƒç”¨ã€‚</p>
<p>Classå†…éƒ¨è°ƒç”¨<code>new.target</code>ï¼Œè¿”å›å½“å‰Classã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(length, width) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">new</span>.target === Rectangle);</div><div class="line">    <span class="keyword">this</span>.length = length;</div><div class="line">    <span class="keyword">this</span>.width = width;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Rectangle(<span class="number">3</span>, <span class="number">4</span>); <span class="comment">// è¾“å‡º true</span></div></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­ç±»ç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œ<code>new.target</code>ä¼šè¿”å›å­ç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(length, width) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">new</span>.target === Rectangle);</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">extends</span> <span class="title">Rectangle</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(length) &#123;</div><div class="line">    <span class="keyword">super</span>(length, length);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> Square(<span class="number">3</span>); <span class="comment">// è¾“å‡º false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>new.target</code>ä¼šè¿”å›å­ç±»ã€‚</p>
<p>åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ï¼Œå¯ä»¥å†™å‡ºä¸èƒ½ç‹¬ç«‹ä½¿ç”¨ã€å¿…é¡»ç»§æ‰¿åæ‰èƒ½ä½¿ç”¨çš„ç±»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Shape</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">new</span>.target === Shape) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'æœ¬ç±»ä¸èƒ½å®ä¾‹åŒ–'</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Rectangle</span> <span class="keyword">extends</span> <span class="title">Shape</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(length, width) &#123;</div><div class="line">    <span class="keyword">super</span>();</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> Shape();  <span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">var</span> y = <span class="keyword">new</span> Rectangle(<span class="number">3</span>, <span class="number">4</span>);  <span class="comment">// æ­£ç¡®</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Shape</code>ç±»ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œåªèƒ½ç”¨äºç»§æ‰¿ã€‚</p>
<p>æ³¨æ„ï¼Œåœ¨å‡½æ•°å¤–éƒ¨ï¼Œä½¿ç”¨<code>new.target</code>ä¼šæŠ¥é”™ã€‚</p>
<h2 id="Mixinæ¨¡å¼çš„å®ç°"><a href="#Mixinæ¨¡å¼çš„å®ç°" class="headerlink" title="Mixinæ¨¡å¼çš„å®ç°"></a>Mixinæ¨¡å¼çš„å®ç°</h2><p>Mixinæ¨¡å¼æŒ‡çš„æ˜¯ï¼Œå°†å¤šä¸ªç±»çš„æ¥å£â€œæ··å…¥â€ï¼ˆmix inï¼‰å¦ä¸€ä¸ªç±»ã€‚å®ƒåœ¨ES6çš„å®ç°å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mix</span>(<span class="params">...mixins</span>) </span>&#123;</div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Mix</span> </span>&#123;&#125;</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> mixin <span class="keyword">of</span> mixins) &#123;</div><div class="line">    copyProperties(Mix, mixin);</div><div class="line">    copyProperties(Mix.prototype, mixin.prototype);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> Mix;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">copyProperties</span>(<span class="params">target, source</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Reflect</span>.ownKeys(source)) &#123;</div><div class="line">    <span class="keyword">if</span> ( key !== <span class="string">"constructor"</span></div><div class="line">      &amp;&amp; key !== <span class="string">"prototype"</span></div><div class="line">      &amp;&amp; key !== <span class="string">"name"</span></div><div class="line">    ) &#123;</div><div class="line">      <span class="keyword">let</span> desc = <span class="built_in">Object</span>.getOwnPropertyDescriptor(source, key);</div><div class="line">      <span class="built_in">Object</span>.defineProperty(target, key, desc);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>mix</code>å‡½æ•°ï¼Œå¯ä»¥å°†å¤šä¸ªå¯¹è±¡åˆæˆä¸ºä¸€ä¸ªç±»ã€‚ä½¿ç”¨çš„æ—¶å€™ï¼Œåªè¦ç»§æ‰¿è¿™ä¸ªç±»å³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DistributedEdit</span> <span class="keyword">extends</span> <span class="title">mix</span>(<span class="title">Loggable</span>, <span class="title">Serializable</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Class&quot;&gt;&lt;a href=&quot;#Class&quot; class=&quot;headerlink&quot; title=&quot;Class&quot;&gt;&lt;/a&gt;Class&lt;/h1&gt;&lt;h2 id=&quot;ClassåŸºæœ¬è¯­æ³•&quot;&gt;&lt;a href=&quot;#ClassåŸºæœ¬è¯­æ³•&quot; class=&quot;headerlink&quot; ti
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Class" scheme="http://microzz.com/tags/Class/"/>
    
  </entry>
  
  <entry>
    <title>å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°</title>
    <link href="http://microzz.com/2017/01/15/async/"/>
    <id>http://microzz.com/2017/01/15/async/</id>
    <published>2017-01-15T06:58:52.000Z</published>
    <updated>2017-01-15T07:09:00.870Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°"><a href="#å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°" class="headerlink" title="å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°"></a>å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°</h1><p>å¼‚æ­¥ç¼–ç¨‹å¯¹ JavaScript è¯­è¨€å¤ªé‡è¦ã€‚Javascript è¯­è¨€çš„æ‰§è¡Œç¯å¢ƒæ˜¯â€œå•çº¿ç¨‹â€çš„ï¼Œå¦‚æœæ²¡æœ‰å¼‚æ­¥ç¼–ç¨‹ï¼Œæ ¹æœ¬æ²¡æ³•ç”¨ï¼Œéå¡æ­»ä¸å¯ã€‚æœ¬ç« ä¸»è¦ä»‹ç»å¦‚ä½• Generator å‡½æ•°å®Œæˆå¼‚æ­¥æ“ä½œã€‚</p>
<p>ES6è¯ç”Ÿä»¥å‰ï¼Œå¼‚æ­¥ç¼–ç¨‹çš„æ–¹æ³•ï¼Œå¤§æ¦‚æœ‰ä¸‹é¢å››ç§ã€‚</p>
<ul>
<li>å›è°ƒå‡½æ•°</li>
<li>äº‹ä»¶ç›‘å¬</li>
<li>å‘å¸ƒ/è®¢é˜…</li>
<li>Promise å¯¹è±¡</li>
</ul>
<p>Generator å‡½æ•°å°† JavaScript å¼‚æ­¥ç¼–ç¨‹å¸¦å…¥äº†ä¸€ä¸ªå…¨æ–°çš„é˜¶æ®µã€‚</p>
<h2 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h2><h3 id="å¼‚æ­¥"><a href="#å¼‚æ­¥" class="headerlink" title="å¼‚æ­¥"></a>å¼‚æ­¥</h3><p>æ‰€è°“â€å¼‚æ­¥â€ï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªä»»åŠ¡ä¸æ˜¯è¿ç»­å®Œæˆçš„ï¼Œå¯ä»¥ç†è§£æˆè¯¥ä»»åŠ¡è¢«äººä¸ºåˆ†æˆä¸¤æ®µï¼Œå…ˆæ‰§è¡Œç¬¬ä¸€æ®µï¼Œç„¶åè½¬è€Œæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åšå¥½äº†å‡†å¤‡ï¼Œå†å›è¿‡å¤´æ‰§è¡Œç¬¬äºŒæ®µã€‚</p>
<p>æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªä»»åŠ¡æ˜¯è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œä»»åŠ¡çš„ç¬¬ä¸€æ®µæ˜¯å‘æ“ä½œç³»ç»Ÿå‘å‡ºè¯·æ±‚ï¼Œè¦æ±‚è¯»å–æ–‡ä»¶ã€‚ç„¶åï¼Œç¨‹åºæ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›æ–‡ä»¶ï¼Œå†æ¥ç€æ‰§è¡Œä»»åŠ¡çš„ç¬¬äºŒæ®µï¼ˆå¤„ç†æ–‡ä»¶ï¼‰ã€‚è¿™ç§ä¸è¿ç»­çš„æ‰§è¡Œï¼Œå°±å«åšå¼‚æ­¥ã€‚</p>
<p>ç›¸åº”åœ°ï¼Œè¿ç»­çš„æ‰§è¡Œå°±å«åšåŒæ­¥ã€‚ç”±äºæ˜¯è¿ç»­æ‰§è¡Œï¼Œä¸èƒ½æ’å…¥å…¶ä»–ä»»åŠ¡ï¼Œæ‰€ä»¥æ“ä½œç³»ç»Ÿä»ç¡¬ç›˜è¯»å–æ–‡ä»¶çš„è¿™æ®µæ—¶é—´ï¼Œç¨‹åºåªèƒ½å¹²ç­‰ç€ã€‚</p>
<h3 id="å›è°ƒå‡½æ•°"><a href="#å›è°ƒå‡½æ•°" class="headerlink" title="å›è°ƒå‡½æ•°"></a>å›è°ƒå‡½æ•°</h3><p>JavaScript è¯­è¨€å¯¹å¼‚æ­¥ç¼–ç¨‹çš„å®ç°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ã€‚æ‰€è°“å›è°ƒå‡½æ•°ï¼Œå°±æ˜¯æŠŠä»»åŠ¡çš„ç¬¬äºŒæ®µå•ç‹¬å†™åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œç­‰åˆ°é‡æ–°æ‰§è¡Œè¿™ä¸ªä»»åŠ¡çš„æ—¶å€™ï¼Œå°±ç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å›è°ƒå‡½æ•°çš„è‹±è¯­åå­—<code>callback</code>ï¼Œç›´è¯‘è¿‡æ¥å°±æ˜¯â€é‡æ–°è°ƒç”¨â€ã€‚</p>
<p>è¯»å–æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œæ˜¯è¿™æ ·å†™çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">fs.readFile(<span class="string">'/etc/passwd'</span>, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line">  <span class="built_in">console</span>.log(data);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>readFile</code>å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°±æ˜¯å›è°ƒå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä»»åŠ¡çš„ç¬¬äºŒæ®µã€‚ç­‰åˆ°æ“ä½œç³»ç»Ÿè¿”å›äº†<code>/etc/passwd</code>è¿™ä¸ªæ–‡ä»¶ä»¥åï¼Œå›è°ƒå‡½æ•°æ‰ä¼šæ‰§è¡Œã€‚</p>
<p>ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜æ˜¯ï¼Œä¸ºä»€ä¹ˆ Node çº¦å®šï¼Œå›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå¿…é¡»æ˜¯é”™è¯¯å¯¹è±¡<code>err</code>ï¼ˆå¦‚æœæ²¡æœ‰é”™è¯¯ï¼Œè¯¥å‚æ•°å°±æ˜¯<code>null</code>ï¼‰ï¼Ÿ</p>
<p>åŸå› æ˜¯æ‰§è¡Œåˆ†æˆä¸¤æ®µï¼Œç¬¬ä¸€æ®µæ‰§è¡Œå®Œä»¥åï¼Œä»»åŠ¡æ‰€åœ¨çš„ä¸Šä¸‹æ–‡ç¯å¢ƒå°±å·²ç»ç»“æŸäº†ã€‚åœ¨è¿™ä»¥åæŠ›å‡ºçš„é”™è¯¯ï¼ŒåŸæ¥çš„ä¸Šä¸‹æ–‡ç¯å¢ƒå·²ç»æ— æ³•æ•æ‰ï¼Œåªèƒ½å½“ä½œå‚æ•°ï¼Œä¼ å…¥ç¬¬äºŒæ®µã€‚</p>
<h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><p>å›è°ƒå‡½æ•°æœ¬èº«å¹¶æ²¡æœ‰é—®é¢˜ï¼Œå®ƒçš„é—®é¢˜å‡ºç°åœ¨å¤šä¸ªå›è°ƒå‡½æ•°åµŒå¥—ã€‚å‡å®šè¯»å–<code>A</code>æ–‡ä»¶ä¹‹åï¼Œå†è¯»å–<code>B</code>æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">fs.readFile(fileA, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</div><div class="line">  fs.readFile(fileB, <span class="string">'utf-8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸éš¾æƒ³è±¡ï¼Œå¦‚æœä¾æ¬¡è¯»å–ä¸¤ä¸ªä»¥ä¸Šçš„æ–‡ä»¶ï¼Œå°±ä¼šå‡ºç°å¤šé‡åµŒå¥—ã€‚ä»£ç ä¸æ˜¯çºµå‘å‘å±•ï¼Œè€Œæ˜¯æ¨ªå‘å‘å±•ï¼Œå¾ˆå¿«å°±ä¼šä¹±æˆä¸€å›¢ï¼Œæ— æ³•ç®¡ç†ã€‚å› ä¸ºå¤šä¸ªå¼‚æ­¥æ“ä½œå½¢æˆäº†å¼ºè€¦åˆï¼Œåªè¦æœ‰ä¸€ä¸ªæ“ä½œéœ€è¦ä¿®æ”¹ï¼Œå®ƒçš„ä¸Šå±‚å›è°ƒå‡½æ•°å’Œä¸‹å±‚å›è°ƒå‡½æ•°ï¼Œå¯èƒ½éƒ½è¦è·Ÿç€ä¿®æ”¹ã€‚è¿™ç§æƒ…å†µå°±ç§°ä¸ºâ€å›è°ƒå‡½æ•°åœ°ç‹±â€ï¼ˆcallback hellï¼‰ã€‚</p>
<p>Promise å¯¹è±¡å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜è€Œæå‡ºçš„ã€‚å®ƒä¸æ˜¯æ–°çš„è¯­æ³•åŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€ç§æ–°çš„å†™æ³•ï¼Œå…è®¸å°†å›è°ƒå‡½æ•°çš„åµŒå¥—ï¼Œæ”¹æˆé“¾å¼è°ƒç”¨ã€‚é‡‡ç”¨ Promiseï¼Œè¿ç»­è¯»å–å¤šä¸ªæ–‡ä»¶ï¼Œå†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> readFile = <span class="built_in">require</span>(<span class="string">'fs-readfile-promise'</span>);</div><div class="line"></div><div class="line">readFile(fileA)</div><div class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(data.toString());</div><div class="line">&#125;)</div><div class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> readFile(fileB);</div><div class="line">&#125;)</div><div class="line">.then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(data.toString());</div><div class="line">&#125;)</div><div class="line">.catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(err);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä½¿ç”¨äº†<code>fs-readfile-promise</code>æ¨¡å—ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯è¿”å›ä¸€ä¸ª Promise ç‰ˆæœ¬çš„<code>readFile</code>å‡½æ•°ã€‚Promise æä¾›<code>then</code>æ–¹æ³•åŠ è½½å›è°ƒå‡½æ•°ï¼Œ<code>catch</code>æ–¹æ³•æ•æ‰æ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºçš„é”™è¯¯ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒPromise çš„å†™æ³•åªæ˜¯å›è°ƒå‡½æ•°çš„æ”¹è¿›ï¼Œä½¿ç”¨<code>then</code>æ–¹æ³•ä»¥åï¼Œå¼‚æ­¥ä»»åŠ¡çš„ä¸¤æ®µæ‰§è¡Œçœ‹å¾—æ›´æ¸…æ¥šäº†ï¼Œé™¤æ­¤ä»¥å¤–ï¼Œå¹¶æ— æ–°æ„ã€‚</p>
<p>Promise çš„æœ€å¤§é—®é¢˜æ˜¯ä»£ç å†—ä½™ï¼ŒåŸæ¥çš„ä»»åŠ¡è¢« Promise åŒ…è£…äº†ä¸€ä¸‹ï¼Œä¸ç®¡ä»€ä¹ˆæ“ä½œï¼Œä¸€çœ¼çœ‹å»éƒ½æ˜¯ä¸€å †<code>then</code>ï¼ŒåŸæ¥çš„è¯­ä¹‰å˜å¾—å¾ˆä¸æ¸…æ¥šã€‚</p>
<p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰æ›´å¥½çš„å†™æ³•å‘¢ï¼Ÿ</p>
<h2 id="Generatorå‡½æ•°"><a href="#Generatorå‡½æ•°" class="headerlink" title="Generatorå‡½æ•°"></a>Generatorå‡½æ•°</h2><h3 id="åç¨‹"><a href="#åç¨‹" class="headerlink" title="åç¨‹"></a>åç¨‹</h3><p>ä¼ ç»Ÿçš„ç¼–ç¨‹è¯­è¨€ï¼Œæ—©æœ‰å¼‚æ­¥ç¼–ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼ˆå…¶å®æ˜¯å¤šä»»åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼‰ã€‚å…¶ä¸­æœ‰ä¸€ç§å«åšâ€åç¨‹â€ï¼ˆcoroutineï¼‰ï¼Œæ„æ€æ˜¯å¤šä¸ªçº¿ç¨‹äº’ç›¸åä½œï¼Œå®Œæˆå¼‚æ­¥ä»»åŠ¡ã€‚</p>
<p>åç¨‹æœ‰ç‚¹åƒå‡½æ•°ï¼Œåˆæœ‰ç‚¹åƒçº¿ç¨‹ã€‚å®ƒçš„è¿è¡Œæµç¨‹å¤§è‡´å¦‚ä¸‹ã€‚</p>
<ul>
<li>ç¬¬ä¸€æ­¥ï¼Œåç¨‹<code>A</code>å¼€å§‹æ‰§è¡Œã€‚</li>
<li>ç¬¬äºŒæ­¥ï¼Œåç¨‹<code>A</code>æ‰§è¡Œåˆ°ä¸€åŠï¼Œè¿›å…¥æš‚åœï¼Œæ‰§è¡Œæƒè½¬ç§»åˆ°åç¨‹<code>B</code>ã€‚</li>
<li>ç¬¬ä¸‰æ­¥ï¼Œï¼ˆä¸€æ®µæ—¶é—´åï¼‰åç¨‹<code>B</code>äº¤è¿˜æ‰§è¡Œæƒã€‚</li>
<li>ç¬¬å››æ­¥ï¼Œåç¨‹<code>A</code>æ¢å¤æ‰§è¡Œã€‚</li>
</ul>
<p>ä¸Šé¢æµç¨‹çš„åç¨‹<code>A</code>ï¼Œå°±æ˜¯å¼‚æ­¥ä»»åŠ¡ï¼Œå› ä¸ºå®ƒåˆ†æˆä¸¤æ®µï¼ˆæˆ–å¤šæ®µï¼‰æ‰§è¡Œã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œè¯»å–æ–‡ä»¶çš„åç¨‹å†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">asyncJob</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...å…¶ä»–ä»£ç </span></div><div class="line">  <span class="keyword">var</span> f = <span class="keyword">yield</span> readFile(fileA);</div><div class="line">  <span class="comment">// ...å…¶ä»–ä»£ç </span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„å‡½æ•°<code>asyncJob</code>æ˜¯ä¸€ä¸ªåç¨‹ï¼Œå®ƒçš„å¥¥å¦™å°±åœ¨å…¶ä¸­çš„<code>yield</code>å‘½ä»¤ã€‚å®ƒè¡¨ç¤ºæ‰§è¡Œåˆ°æ­¤å¤„ï¼Œæ‰§è¡Œæƒå°†äº¤ç»™å…¶ä»–åç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>yield</code>å‘½ä»¤æ˜¯å¼‚æ­¥ä¸¤ä¸ªé˜¶æ®µçš„åˆ†ç•Œçº¿ã€‚</p>
<p>åç¨‹é‡åˆ°<code>yield</code>å‘½ä»¤å°±æš‚åœï¼Œç­‰åˆ°æ‰§è¡Œæƒè¿”å›ï¼Œå†ä»æš‚åœçš„åœ°æ–¹ç»§ç»­å¾€åæ‰§è¡Œã€‚å®ƒçš„æœ€å¤§ä¼˜ç‚¹ï¼Œå°±æ˜¯ä»£ç çš„å†™æ³•éå¸¸åƒåŒæ­¥æ“ä½œï¼Œå¦‚æœå»é™¤<code>yield</code>å‘½ä»¤ï¼Œç®€ç›´ä¸€æ¨¡ä¸€æ ·ã€‚</p>
<h3 id="Generator-å‡½æ•°çš„æ¦‚å¿µ"><a href="#Generator-å‡½æ•°çš„æ¦‚å¿µ" class="headerlink" title="Generator å‡½æ•°çš„æ¦‚å¿µ"></a>Generator å‡½æ•°çš„æ¦‚å¿µ</h3><p>Generator å‡½æ•°æ˜¯åç¨‹åœ¨ ES6 çš„å®ç°ï¼Œæœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯ä»¥äº¤å‡ºå‡½æ•°çš„æ‰§è¡Œæƒï¼ˆå³æš‚åœæ‰§è¡Œï¼‰ã€‚</p>
<p>æ•´ä¸ª Generator å‡½æ•°å°±æ˜¯ä¸€ä¸ªå°è£…çš„å¼‚æ­¥ä»»åŠ¡ï¼Œæˆ–è€…è¯´æ˜¯å¼‚æ­¥ä»»åŠ¡çš„å®¹å™¨ã€‚å¼‚æ­¥æ“ä½œéœ€è¦æš‚åœçš„åœ°æ–¹ï¼Œéƒ½ç”¨<code>yield</code>è¯­å¥æ³¨æ˜ã€‚Generator å‡½æ•°çš„æ‰§è¡Œæ–¹æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> y = <span class="keyword">yield</span> x + <span class="number">2</span>;</div><div class="line">  <span class="keyword">return</span> y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen(<span class="number">1</span>);</div><div class="line">g.next() <span class="comment">// &#123; value: 3, done: false &#125;</span></div><div class="line">g.next() <span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨ Generator å‡½æ•°ï¼Œä¼šè¿”å›ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆï¼ˆå³éå†å™¨ï¼‰<code>g</code>ã€‚è¿™æ˜¯ Generator å‡½æ•°ä¸åŒäºæ™®é€šå‡½æ•°çš„å¦ä¸€ä¸ªåœ°æ–¹ï¼Œå³æ‰§è¡Œå®ƒä¸ä¼šè¿”å›ç»“æœï¼Œè¿”å›çš„æ˜¯æŒ‡é’ˆå¯¹è±¡ã€‚è°ƒç”¨æŒ‡é’ˆ<code>g</code>çš„<code>next</code>æ–¹æ³•ï¼Œä¼šç§»åŠ¨å†…éƒ¨æŒ‡é’ˆï¼ˆå³æ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„ç¬¬ä¸€æ®µï¼‰ï¼ŒæŒ‡å‘ç¬¬ä¸€ä¸ªé‡åˆ°çš„<code>yield</code>è¯­å¥ï¼Œä¸Šä¾‹æ˜¯æ‰§è¡Œåˆ°<code>x + 2</code>ä¸ºæ­¢ã€‚</p>
<p>æ¢è¨€ä¹‹ï¼Œ<code>next</code>æ–¹æ³•çš„ä½œç”¨æ˜¯åˆ†é˜¶æ®µæ‰§è¡Œ<code>Generator</code>å‡½æ•°ã€‚æ¯æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„ä¿¡æ¯ï¼ˆ<code>value</code>å±æ€§å’Œ<code>done</code>å±æ€§ï¼‰ã€‚<code>value</code>å±æ€§æ˜¯<code>yield</code>è¯­å¥åé¢è¡¨è¾¾å¼çš„å€¼ï¼Œè¡¨ç¤ºå½“å‰é˜¶æ®µçš„å€¼ï¼›<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤º Generator å‡½æ•°æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼Œå³æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªé˜¶æ®µã€‚</p>
<h3 id="Generator-å‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†"><a href="#Generator-å‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†" class="headerlink" title="Generator å‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†"></a>Generator å‡½æ•°çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†</h3><p>Generatorå‡½æ•°å¯ä»¥æš‚åœæ‰§è¡Œå’Œæ¢å¤æ‰§è¡Œï¼Œè¿™æ˜¯å®ƒèƒ½å°è£…å¼‚æ­¥ä»»åŠ¡çš„æ ¹æœ¬åŸå› ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰ä¸¤ä¸ªç‰¹æ€§ï¼Œä½¿å®ƒå¯ä»¥ä½œä¸ºå¼‚æ­¥ç¼–ç¨‹çš„å®Œæ•´è§£å†³æ–¹æ¡ˆï¼šå‡½æ•°ä½“å†…å¤–çš„æ•°æ®äº¤æ¢å’Œé”™è¯¯å¤„ç†æœºåˆ¶ã€‚</p>
<p>nextæ–¹æ³•è¿”å›å€¼çš„valueå±æ€§ï¼Œæ˜¯Generatorå‡½æ•°å‘å¤–è¾“å‡ºæ•°æ®ï¼›nextæ–¹æ³•è¿˜å¯ä»¥æ¥å—å‚æ•°ï¼Œè¿™æ˜¯å‘Generatorå‡½æ•°ä½“å†…è¾“å…¥æ•°æ®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> y = <span class="keyword">yield</span> x + <span class="number">2</span>;</div><div class="line">  <span class="keyword">return</span> y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen(<span class="number">1</span>);</div><div class="line">g.next() <span class="comment">// &#123; value: 3, done: false &#125;</span></div><div class="line">g.next(<span class="number">2</span>) <span class="comment">// &#123; value: 2, done: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ªnextæ–¹æ³•çš„valueå±æ€§ï¼Œè¿”å›è¡¨è¾¾å¼<code>x + 2</code>çš„å€¼ï¼ˆ3ï¼‰ã€‚ç¬¬äºŒä¸ªnextæ–¹æ³•å¸¦æœ‰å‚æ•°2ï¼Œè¿™ä¸ªå‚æ•°å¯ä»¥ä¼ å…¥ Generator å‡½æ•°ï¼Œä½œä¸ºä¸Šä¸ªé˜¶æ®µå¼‚æ­¥ä»»åŠ¡çš„è¿”å›ç»“æœï¼Œè¢«å‡½æ•°ä½“å†…çš„å˜é‡yæ¥æ”¶ã€‚å› æ­¤ï¼Œè¿™ä¸€æ­¥çš„ value å±æ€§ï¼Œè¿”å›çš„å°±æ˜¯2ï¼ˆå˜é‡yçš„å€¼ï¼‰ã€‚</p>
<p>Generator å‡½æ•°å†…éƒ¨è¿˜å¯ä»¥éƒ¨ç½²é”™è¯¯å¤„ç†ä»£ç ï¼Œæ•è·å‡½æ•°ä½“å¤–æŠ›å‡ºçš„é”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">var</span> y = <span class="keyword">yield</span> x + <span class="number">2</span>;</div><div class="line">  &#125; <span class="keyword">catch</span> (e)&#123;</div><div class="line">    <span class="built_in">console</span>.log(e);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen(<span class="number">1</span>);</div><div class="line">g.next();</div><div class="line">g.throw(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line"><span class="comment">// å‡ºé”™äº†</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„æœ€åä¸€è¡Œï¼ŒGeneratorå‡½æ•°ä½“å¤–ï¼Œä½¿ç”¨æŒ‡é’ˆå¯¹è±¡çš„throwæ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œå¯ä»¥è¢«å‡½æ•°ä½“å†…çš„try â€¦catchä»£ç å—æ•è·ã€‚è¿™æ„å‘³ç€ï¼Œå‡ºé”™çš„ä»£ç ä¸å¤„ç†é”™è¯¯çš„ä»£ç ï¼Œå®ç°äº†æ—¶é—´å’Œç©ºé—´ä¸Šçš„åˆ†ç¦»ï¼Œè¿™å¯¹äºå¼‚æ­¥ç¼–ç¨‹æ— ç–‘æ˜¯å¾ˆé‡è¦çš„ã€‚</p>
<h3 id="å¼‚æ­¥ä»»åŠ¡çš„å°è£…"><a href="#å¼‚æ­¥ä»»åŠ¡çš„å°è£…" class="headerlink" title="å¼‚æ­¥ä»»åŠ¡çš„å°è£…"></a>å¼‚æ­¥ä»»åŠ¡çš„å°è£…</h3><p>ä¸‹é¢çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Generator å‡½æ•°ï¼Œæ‰§è¡Œä¸€ä¸ªçœŸå®çš„å¼‚æ­¥ä»»åŠ¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fetch = <span class="built_in">require</span>(<span class="string">'node-fetch'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> url = <span class="string">'https://api.github.com/users/github'</span>;</div><div class="line">  <span class="keyword">var</span> result = <span class="keyword">yield</span> fetch(url);</div><div class="line">  <span class="built_in">console</span>.log(result.bio);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒGeneratorå‡½æ•°å°è£…äº†ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œè¯¥æ“ä½œå…ˆè¯»å–ä¸€ä¸ªè¿œç¨‹æ¥å£ï¼Œç„¶åä»JSONæ ¼å¼çš„æ•°æ®è§£æä¿¡æ¯ã€‚å°±åƒå‰é¢è¯´è¿‡çš„ï¼Œè¿™æ®µä»£ç éå¸¸åƒåŒæ­¥æ“ä½œï¼Œé™¤äº†åŠ ä¸Šäº†yieldå‘½ä»¤ã€‚</p>
<p>æ‰§è¡Œè¿™æ®µä»£ç çš„æ–¹æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line"><span class="keyword">var</span> result = g.next();</div><div class="line"></div><div class="line">result.value.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> data.json();</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">  g.next(data);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œé¦–å…ˆæ‰§è¡ŒGeneratorå‡½æ•°ï¼Œè·å–éå†å™¨å¯¹è±¡ï¼Œç„¶åä½¿ç”¨next æ–¹æ³•ï¼ˆç¬¬äºŒè¡Œï¼‰ï¼Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„ç¬¬ä¸€é˜¶æ®µã€‚ç”±äºFetchæ¨¡å—è¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå› æ­¤è¦ç”¨thenæ–¹æ³•è°ƒç”¨ä¸‹ä¸€ä¸ªnext æ–¹æ³•ã€‚</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶ Generator å‡½æ•°å°†å¼‚æ­¥æ“ä½œè¡¨ç¤ºå¾—å¾ˆç®€æ´ï¼Œä½†æ˜¯æµç¨‹ç®¡ç†å´ä¸æ–¹ä¾¿ï¼ˆå³ä½•æ—¶æ‰§è¡Œç¬¬ä¸€é˜¶æ®µã€ä½•æ—¶æ‰§è¡Œç¬¬äºŒé˜¶æ®µï¼‰ã€‚</p>
<h2 id="Thunkå‡½æ•°"><a href="#Thunkå‡½æ•°" class="headerlink" title="Thunkå‡½æ•°"></a>Thunkå‡½æ•°</h2><h3 id="å‚æ•°çš„æ±‚å€¼ç­–ç•¥"><a href="#å‚æ•°çš„æ±‚å€¼ç­–ç•¥" class="headerlink" title="å‚æ•°çš„æ±‚å€¼ç­–ç•¥"></a>å‚æ•°çš„æ±‚å€¼ç­–ç•¥</h3><p>Thunkå‡½æ•°æ—©åœ¨ä¸Šä¸ªä¸–çºª60å¹´ä»£å°±è¯ç”Ÿäº†ã€‚</p>
<p>é‚£æ—¶ï¼Œç¼–ç¨‹è¯­è¨€åˆšåˆšèµ·æ­¥ï¼Œè®¡ç®—æœºå­¦å®¶è¿˜åœ¨ç ”ç©¶ï¼Œç¼–è¯‘å™¨æ€ä¹ˆå†™æ¯”è¾ƒå¥½ã€‚ä¸€ä¸ªäº‰è®ºçš„ç„¦ç‚¹æ˜¯â€æ±‚å€¼ç­–ç•¥â€ï¼Œå³å‡½æ•°çš„å‚æ•°åˆ°åº•åº”è¯¥ä½•æ—¶æ±‚å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">m</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> m * <span class="number">2</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">f(x + <span class="number">5</span>)</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å…ˆå®šä¹‰å‡½æ•°fï¼Œç„¶åå‘å®ƒä¼ å…¥è¡¨è¾¾å¼<code>x + 5</code>ã€‚è¯·é—®ï¼Œè¿™ä¸ªè¡¨è¾¾å¼åº”è¯¥ä½•æ—¶æ±‚å€¼ï¼Ÿ</p>
<p>ä¸€ç§æ„è§æ˜¯â€ä¼ å€¼è°ƒç”¨â€ï¼ˆcall by valueï¼‰ï¼Œå³åœ¨è¿›å…¥å‡½æ•°ä½“ä¹‹å‰ï¼Œå°±è®¡ç®—<code>x + 5</code>çš„å€¼ï¼ˆç­‰äº6ï¼‰ï¼Œå†å°†è¿™ä¸ªå€¼ä¼ å…¥å‡½æ•°f ã€‚Cè¯­è¨€å°±é‡‡ç”¨è¿™ç§ç­–ç•¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">f(x + <span class="number">5</span>)</div><div class="line"><span class="comment">// ä¼ å€¼è°ƒç”¨æ—¶ï¼Œç­‰åŒäº</span></div><div class="line">f(<span class="number">6</span>)</div></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æ„è§æ˜¯â€ä¼ åè°ƒç”¨â€ï¼ˆcall by nameï¼‰ï¼Œå³ç›´æ¥å°†è¡¨è¾¾å¼<code>x + 5</code>ä¼ å…¥å‡½æ•°ä½“ï¼Œåªåœ¨ç”¨åˆ°å®ƒçš„æ—¶å€™æ±‚å€¼ã€‚Haskellè¯­è¨€é‡‡ç”¨è¿™ç§ç­–ç•¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">f(x + <span class="number">5</span>)</div><div class="line"><span class="comment">// ä¼ åè°ƒç”¨æ—¶ï¼Œç­‰åŒäº</span></div><div class="line">(x + <span class="number">5</span>) * <span class="number">2</span></div></pre></td></tr></table></figure>
<p>ä¼ å€¼è°ƒç”¨å’Œä¼ åè°ƒç”¨ï¼Œå“ªä¸€ç§æ¯”è¾ƒå¥½ï¼Ÿå›ç­”æ˜¯å„æœ‰åˆ©å¼Šã€‚ä¼ å€¼è°ƒç”¨æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å¯¹å‚æ•°æ±‚å€¼çš„æ—¶å€™ï¼Œå®é™…ä¸Šè¿˜æ²¡ç”¨åˆ°è¿™ä¸ªå‚æ•°ï¼Œæœ‰å¯èƒ½é€ æˆæ€§èƒ½æŸå¤±ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> b;</div><div class="line">&#125;</div><div class="line"></div><div class="line">f(<span class="number">3</span> * x * x - <span class="number">2</span> * x - <span class="number">1</span>, x);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fçš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¤æ‚çš„è¡¨è¾¾å¼ï¼Œä½†æ˜¯å‡½æ•°ä½“å†…æ ¹æœ¬æ²¡ç”¨åˆ°ã€‚å¯¹è¿™ä¸ªå‚æ•°æ±‚å€¼ï¼Œå®é™…ä¸Šæ˜¯ä¸å¿…è¦çš„ã€‚å› æ­¤ï¼Œæœ‰ä¸€äº›è®¡ç®—æœºå­¦å®¶å€¾å‘äºâ€ä¼ åè°ƒç”¨â€ï¼Œå³åªåœ¨æ‰§è¡Œæ—¶æ±‚å€¼ã€‚</p>
<h3 id="Thunkå‡½æ•°çš„å«ä¹‰"><a href="#Thunkå‡½æ•°çš„å«ä¹‰" class="headerlink" title="Thunkå‡½æ•°çš„å«ä¹‰"></a>Thunkå‡½æ•°çš„å«ä¹‰</h3><p>ç¼–è¯‘å™¨çš„â€ä¼ åè°ƒç”¨â€å®ç°ï¼Œå¾€å¾€æ˜¯å°†å‚æ•°æ”¾åˆ°ä¸€ä¸ªä¸´æ—¶å‡½æ•°ä¹‹ä¸­ï¼Œå†å°†è¿™ä¸ªä¸´æ—¶å‡½æ•°ä¼ å…¥å‡½æ•°ä½“ã€‚è¿™ä¸ªä¸´æ—¶å‡½æ•°å°±å«åšThunkå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">m</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> m * <span class="number">2</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">f(x + <span class="number">5</span>);</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> thunk = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x + <span class="number">5</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">thunk</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> thunk() * <span class="number">2</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fçš„å‚æ•°<code>x + 5</code>è¢«ä¸€ä¸ªå‡½æ•°æ›¿æ¢äº†ã€‚å‡¡æ˜¯ç”¨åˆ°åŸå‚æ•°çš„åœ°æ–¹ï¼Œå¯¹<code>Thunk</code>å‡½æ•°æ±‚å€¼å³å¯ã€‚</p>
<p>è¿™å°±æ˜¯Thunkå‡½æ•°çš„å®šä¹‰ï¼Œå®ƒæ˜¯â€ä¼ åè°ƒç”¨â€çš„ä¸€ç§å®ç°ç­–ç•¥ï¼Œç”¨æ¥æ›¿æ¢æŸä¸ªè¡¨è¾¾å¼ã€‚</p>
<h3 id="JavaScriptè¯­è¨€çš„Thunkå‡½æ•°"><a href="#JavaScriptè¯­è¨€çš„Thunkå‡½æ•°" class="headerlink" title="JavaScriptè¯­è¨€çš„Thunkå‡½æ•°"></a>JavaScriptè¯­è¨€çš„Thunkå‡½æ•°</h3><p>JavaScriptè¯­è¨€æ˜¯ä¼ å€¼è°ƒç”¨ï¼Œå®ƒçš„Thunkå‡½æ•°å«ä¹‰æœ‰æ‰€ä¸åŒã€‚åœ¨JavaScriptè¯­è¨€ä¸­ï¼ŒThunkå‡½æ•°æ›¿æ¢çš„ä¸æ˜¯è¡¨è¾¾å¼ï¼Œè€Œæ˜¯å¤šå‚æ•°å‡½æ•°ï¼Œå°†å…¶æ›¿æ¢æˆå•å‚æ•°çš„ç‰ˆæœ¬ï¼Œä¸”åªæ¥å—å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ­£å¸¸ç‰ˆæœ¬çš„readFileï¼ˆå¤šå‚æ•°ç‰ˆæœ¬ï¼‰</span></div><div class="line">fs.readFile(fileName, callback);</div><div class="line"></div><div class="line"><span class="comment">// Thunkç‰ˆæœ¬çš„readFileï¼ˆå•å‚æ•°ç‰ˆæœ¬ï¼‰</span></div><div class="line"><span class="keyword">var</span> Thunk = <span class="function"><span class="keyword">function</span> (<span class="params">fileName</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> fs.readFile(fileName, callback);</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> readFileThunk = Thunk(fileName);</div><div class="line">readFileThunk(callback);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œfsæ¨¡å—çš„readFileæ–¹æ³•æ˜¯ä¸€ä¸ªå¤šå‚æ•°å‡½æ•°ï¼Œä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºæ–‡ä»¶åå’Œå›è°ƒå‡½æ•°ã€‚ç»è¿‡è½¬æ¢å™¨å¤„ç†ï¼Œå®ƒå˜æˆäº†ä¸€ä¸ªå•å‚æ•°å‡½æ•°ï¼Œåªæ¥å—å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªå•å‚æ•°ç‰ˆæœ¬ï¼Œå°±å«åšThunkå‡½æ•°ã€‚</p>
<p>ä»»ä½•å‡½æ•°ï¼Œåªè¦å‚æ•°æœ‰å›è°ƒå‡½æ•°ï¼Œå°±èƒ½å†™æˆThunkå‡½æ•°çš„å½¢å¼ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„Thunkå‡½æ•°è½¬æ¢å™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5ç‰ˆæœ¬</span></div><div class="line"><span class="keyword">var</span> Thunk = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>)</span>&#123;</div><div class="line">      args.push(callback);</div><div class="line">      <span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, args);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ES6ç‰ˆæœ¬</span></div><div class="line"><span class="keyword">var</span> Thunk = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> fn.call(<span class="keyword">this</span>, ...args, callback);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ä¸Šé¢çš„è½¬æ¢å™¨ï¼Œç”Ÿæˆ<code>fs.readFile</code>çš„Thunkå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> readFileThunk = Thunk(fs.readFile);</div><div class="line">readFileThunk(fileA)(callback);</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªå®Œæ•´çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, cb</span>) </span>&#123;</div><div class="line">  cb(a);</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> ft = Thunk(f);</div><div class="line"></div><div class="line"><span class="keyword">let</span> log = <span class="built_in">console</span>.log.bind(<span class="built_in">console</span>);</div><div class="line">ft(<span class="number">1</span>)(log) <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<h3 id="Thunkifyæ¨¡å—"><a href="#Thunkifyæ¨¡å—" class="headerlink" title="Thunkifyæ¨¡å—"></a>Thunkifyæ¨¡å—</h3><p>ç”Ÿäº§ç¯å¢ƒçš„è½¬æ¢å™¨ï¼Œå»ºè®®ä½¿ç”¨Thunkifyæ¨¡å—ã€‚</p>
<p>é¦–å…ˆæ˜¯å®‰è£…ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install thunkify</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> thunkify = <span class="built_in">require</span>(<span class="string">'thunkify'</span>);</div><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> read = thunkify(fs.readFile);</div><div class="line">read(<span class="string">'package.json'</span>)(<span class="function"><span class="keyword">function</span>(<span class="params">err, str</span>)</span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Thunkifyçš„æºç ä¸ä¸Šä¸€èŠ‚é‚£ä¸ªç®€å•çš„è½¬æ¢å™¨éå¸¸åƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">thunkify</span>(<span class="params">fn</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> args = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="built_in">arguments</span>.length);</div><div class="line">    <span class="keyword">var</span> ctx = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; args.length; ++i) &#123;</div><div class="line">      args[i] = <span class="built_in">arguments</span>[i];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">done</span>)</span>&#123;</div><div class="line">      <span class="keyword">var</span> called;</div><div class="line"></div><div class="line">      args.push(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span> (called) <span class="keyword">return</span>;</div><div class="line">        called = <span class="literal">true</span>;</div><div class="line">        done.apply(<span class="literal">null</span>, <span class="built_in">arguments</span>);</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        fn.apply(ctx, args);</div><div class="line">      &#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">        done(err);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å®ƒçš„æºç ä¸»è¦å¤šäº†ä¸€ä¸ªæ£€æŸ¥æœºåˆ¶ï¼Œå˜é‡<code>called</code>ç¡®ä¿å›è°ƒå‡½æ•°åªè¿è¡Œä¸€æ¬¡ã€‚è¿™æ ·çš„è®¾è®¡ä¸ä¸‹æ–‡çš„Generatorå‡½æ•°ç›¸å…³ã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, b, callback</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = a + b;</div><div class="line">  callback(sum);</div><div class="line">  callback(sum);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> ft = thunkify(f);</div><div class="line"><span class="keyword">var</span> print = <span class="built_in">console</span>.log.bind(<span class="built_in">console</span>);</div><div class="line">ft(<span class="number">1</span>, <span class="number">2</span>)(print);</div><div class="line"><span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº<code>thunkify</code>åªå…è®¸å›è°ƒå‡½æ•°æ‰§è¡Œä¸€æ¬¡ï¼Œæ‰€ä»¥åªè¾“å‡ºä¸€è¡Œç»“æœã€‚</p>
<h3 id="Generator-å‡½æ•°çš„æµç¨‹ç®¡ç†"><a href="#Generator-å‡½æ•°çš„æµç¨‹ç®¡ç†" class="headerlink" title="Generator å‡½æ•°çš„æµç¨‹ç®¡ç†"></a>Generator å‡½æ•°çš„æµç¨‹ç®¡ç†</h3><p>ä½ å¯èƒ½ä¼šé—®ï¼Œ Thunkå‡½æ•°æœ‰ä»€ä¹ˆç”¨ï¼Ÿå›ç­”æ˜¯ä»¥å‰ç¡®å®æ²¡ä»€ä¹ˆç”¨ï¼Œä½†æ˜¯ES6æœ‰äº†Generatorå‡½æ•°ï¼ŒThunkå‡½æ•°ç°åœ¨å¯ä»¥ç”¨äºGeneratorå‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç†ã€‚</p>
<p>Generatorå‡½æ•°å¯ä»¥è‡ªåŠ¨æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line"><span class="keyword">var</span> res = g.next();</div><div class="line"></div><div class="line"><span class="keyword">while</span>(!res.done)&#123;</div><div class="line">  <span class="built_in">console</span>.log(res.value);</div><div class="line">  res = g.next();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒGeneratorå‡½æ•°<code>gen</code>ä¼šè‡ªåŠ¨æ‰§è¡Œå®Œæ‰€æœ‰æ­¥éª¤ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™ä¸é€‚åˆå¼‚æ­¥æ“ä½œã€‚å¦‚æœå¿…é¡»ä¿è¯å‰ä¸€æ­¥æ‰§è¡Œå®Œï¼Œæ‰èƒ½æ‰§è¡Œåä¸€æ­¥ï¼Œä¸Šé¢çš„è‡ªåŠ¨æ‰§è¡Œå°±ä¸å¯è¡Œã€‚è¿™æ—¶ï¼ŒThunkå‡½æ•°å°±èƒ½æ´¾ä¸Šç”¨å¤„ã€‚ä»¥è¯»å–æ–‡ä»¶ä¸ºä¾‹ã€‚ä¸‹é¢çš„Generatorå‡½æ•°å°è£…äº†ä¸¤ä¸ªå¼‚æ­¥æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">var</span> thunkify = <span class="built_in">require</span>(<span class="string">'thunkify'</span>);</div><div class="line"><span class="keyword">var</span> readFile = thunkify(fs.readFile);</div><div class="line"></div><div class="line"><span class="keyword">var</span> gen = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> r1 = <span class="keyword">yield</span> readFile(<span class="string">'/etc/fstab'</span>);</div><div class="line">  <span class="built_in">console</span>.log(r1.toString());</div><div class="line">  <span class="keyword">var</span> r2 = <span class="keyword">yield</span> readFile(<span class="string">'/etc/shells'</span>);</div><div class="line">  <span class="built_in">console</span>.log(r2.toString());</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œyieldå‘½ä»¤ç”¨äºå°†ç¨‹åºçš„æ‰§è¡Œæƒç§»å‡ºGeneratorå‡½æ•°ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸€ç§æ–¹æ³•ï¼Œå°†æ‰§è¡Œæƒå†äº¤è¿˜ç»™Generatorå‡½æ•°ã€‚</p>
<p>è¿™ç§æ–¹æ³•å°±æ˜¯Thunkå‡½æ•°ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨å›è°ƒå‡½æ•°é‡Œï¼Œå°†æ‰§è¡Œæƒäº¤è¿˜ç»™Generatorå‡½æ•°ã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œæˆ‘ä»¬å…ˆçœ‹å¦‚ä½•æ‰‹åŠ¨æ‰§è¡Œä¸Šé¢è¿™ä¸ªGeneratorå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line"></div><div class="line"><span class="keyword">var</span> r1 = g.next();</div><div class="line">r1.value(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>)</span>&#123;</div><div class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line">  <span class="keyword">var</span> r2 = g.next(data);</div><div class="line">  r2.value(<span class="function"><span class="keyword">function</span>(<span class="params">err, data</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</div><div class="line">    g.next(data);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡gæ˜¯Generatorå‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆï¼Œè¡¨ç¤ºç›®å‰æ‰§è¡Œåˆ°å“ªä¸€æ­¥ã€‚nextæ–¹æ³•è´Ÿè´£å°†æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€æ­¥ï¼Œå¹¶è¿”å›è¯¥æ­¥çš„ä¿¡æ¯ï¼ˆvalueå±æ€§å’Œdoneå±æ€§ï¼‰ã€‚</p>
<p>ä»”ç»†æŸ¥çœ‹ä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥å‘ç°Generatorå‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå…¶å®æ˜¯å°†åŒä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåå¤ä¼ å…¥nextæ–¹æ³•çš„valueå±æ€§ã€‚è¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨é€’å½’æ¥è‡ªåŠ¨å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<h3 id="Thunkå‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç†"><a href="#Thunkå‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç†" class="headerlink" title="Thunkå‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç†"></a>Thunkå‡½æ•°çš„è‡ªåŠ¨æµç¨‹ç®¡ç†</h3><p>Thunkå‡½æ•°çœŸæ­£çš„å¨åŠ›ï¼Œåœ¨äºå¯ä»¥è‡ªåŠ¨æ‰§è¡ŒGeneratorå‡½æ•°ã€‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªåŸºäºThunkå‡½æ•°çš„Generatoræ‰§è¡Œå™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">fn</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> gen = fn();</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params">err, data</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> result = gen.next(data);</div><div class="line">    <span class="keyword">if</span> (result.done) <span class="keyword">return</span>;</div><div class="line">    result.value(next);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  next();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">g</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">run(g);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>run</code>å‡½æ•°ï¼Œå°±æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚å†…éƒ¨çš„<code>next</code>å‡½æ•°å°±æ˜¯Thunkçš„å›è°ƒå‡½æ•°ã€‚<code>next</code>å‡½æ•°å…ˆå°†æŒ‡é’ˆç§»åˆ°Generatorå‡½æ•°çš„ä¸‹ä¸€æ­¥ï¼ˆ<code>gen.next</code>æ–¹æ³•ï¼‰ï¼Œç„¶ååˆ¤æ–­Generatorå‡½æ•°æ˜¯å¦ç»“æŸï¼ˆ<code>result.done</code>å±æ€§ï¼‰ï¼Œå¦‚æœæ²¡ç»“æŸï¼Œå°±å°†<code>next</code>å‡½æ•°å†ä¼ å…¥Thunkå‡½æ•°ï¼ˆ<code>result.value</code>å±æ€§ï¼‰ï¼Œå¦åˆ™å°±ç›´æ¥é€€å‡ºã€‚</p>
<p>æœ‰äº†è¿™ä¸ªæ‰§è¡Œå™¨ï¼Œæ‰§è¡ŒGeneratorå‡½æ•°æ–¹ä¾¿å¤šäº†ã€‚ä¸ç®¡å†…éƒ¨æœ‰å¤šå°‘ä¸ªå¼‚æ­¥æ“ä½œï¼Œç›´æ¥æŠŠGeneratorå‡½æ•°ä¼ å…¥<code>run</code>å‡½æ•°å³å¯ã€‚å½“ç„¶ï¼Œå‰ææ˜¯æ¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œéƒ½è¦æ˜¯Thunkå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè·Ÿåœ¨<code>yield</code>å‘½ä»¤åé¢çš„å¿…é¡»æ˜¯Thunkå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> f1 = <span class="keyword">yield</span> readFile(<span class="string">'fileA'</span>);</div><div class="line">  <span class="keyword">var</span> f2 = <span class="keyword">yield</span> readFile(<span class="string">'fileB'</span>);</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  <span class="keyword">var</span> fn = <span class="keyword">yield</span> readFile(<span class="string">'fileN'</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">run(g);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>g</code>å°è£…äº†<code>n</code>ä¸ªå¼‚æ­¥çš„è¯»å–æ–‡ä»¶æ“ä½œï¼Œåªè¦æ‰§è¡Œ<code>run</code>å‡½æ•°ï¼Œè¿™äº›æ“ä½œå°±ä¼šè‡ªåŠ¨å®Œæˆã€‚è¿™æ ·ä¸€æ¥ï¼Œå¼‚æ­¥æ“ä½œä¸ä»…å¯ä»¥å†™å¾—åƒåŒæ­¥æ“ä½œï¼Œè€Œä¸”ä¸€è¡Œä»£ç å°±å¯ä»¥æ‰§è¡Œã€‚</p>
<p>Thunkå‡½æ•°å¹¶ä¸æ˜¯Generatorå‡½æ•°è‡ªåŠ¨æ‰§è¡Œçš„å”¯ä¸€æ–¹æ¡ˆã€‚å› ä¸ºè‡ªåŠ¨æ‰§è¡Œçš„å…³é”®æ˜¯ï¼Œå¿…é¡»æœ‰ä¸€ç§æœºåˆ¶ï¼Œè‡ªåŠ¨æ§åˆ¶Generatorå‡½æ•°çš„æµç¨‹ï¼Œæ¥æ”¶å’Œäº¤è¿˜ç¨‹åºçš„æ‰§è¡Œæƒã€‚å›è°ƒå‡½æ•°å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼ŒPromise å¯¹è±¡ä¹Ÿå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<h2 id="coæ¨¡å—"><a href="#coæ¨¡å—" class="headerlink" title="coæ¨¡å—"></a>coæ¨¡å—</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p><a href="https://github.com/tj/co" target="_blank" rel="external">coæ¨¡å—</a>æ˜¯è‘—åç¨‹åºå‘˜TJ Holowaychukäº2013å¹´6æœˆå‘å¸ƒçš„ä¸€ä¸ªå°å·¥å…·ï¼Œç”¨äºGeneratorå‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œã€‚</p>
<p>æ¯”å¦‚ï¼Œæœ‰ä¸€ä¸ªGeneratorå‡½æ•°ï¼Œç”¨äºä¾æ¬¡è¯»å–ä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gen = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> f1 = <span class="keyword">yield</span> readFile(<span class="string">'/etc/fstab'</span>);</div><div class="line">  <span class="keyword">var</span> f2 = <span class="keyword">yield</span> readFile(<span class="string">'/etc/shells'</span>);</div><div class="line">  <span class="built_in">console</span>.log(f1.toString());</div><div class="line">  <span class="built_in">console</span>.log(f2.toString());</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>coæ¨¡å—å¯ä»¥è®©ä½ ä¸ç”¨ç¼–å†™Generatorå‡½æ•°çš„æ‰§è¡Œå™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> co = <span class="built_in">require</span>(<span class="string">'co'</span>);</div><div class="line">co(gen);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒGeneratorå‡½æ•°åªè¦ä¼ å…¥coå‡½æ•°ï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚</p>
<p>coå‡½æ•°è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥ç”¨thenæ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">co(gen).then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Generator å‡½æ•°æ‰§è¡Œå®Œæˆ'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç­‰åˆ°Generatorå‡½æ•°æ‰§è¡Œç»“æŸï¼Œå°±ä¼šè¾“å‡ºä¸€è¡Œæç¤ºã€‚</p>
<h3 id="coæ¨¡å—çš„åŸç†"><a href="#coæ¨¡å—çš„åŸç†" class="headerlink" title="coæ¨¡å—çš„åŸç†"></a>coæ¨¡å—çš„åŸç†</h3><p>ä¸ºä»€ä¹ˆ co å¯ä»¥è‡ªåŠ¨æ‰§è¡Œ Generator å‡½æ•°ï¼Ÿ</p>
<p>å‰é¢è¯´è¿‡ï¼ŒGenerator å°±æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„å®¹å™¨ã€‚å®ƒçš„è‡ªåŠ¨æ‰§è¡Œéœ€è¦ä¸€ç§æœºåˆ¶ï¼Œå½“å¼‚æ­¥æ“ä½œæœ‰äº†ç»“æœï¼Œèƒ½å¤Ÿè‡ªåŠ¨äº¤å›æ‰§è¡Œæƒã€‚</p>
<p>ä¸¤ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
<p>ï¼ˆ1ï¼‰å›è°ƒå‡½æ•°ã€‚å°†å¼‚æ­¥æ“ä½œåŒ…è£…æˆ Thunk å‡½æ•°ï¼Œåœ¨å›è°ƒå‡½æ•°é‡Œé¢äº¤å›æ‰§è¡Œæƒã€‚</p>
<p>ï¼ˆ2ï¼‰Promise å¯¹è±¡ã€‚å°†å¼‚æ­¥æ“ä½œåŒ…è£…æˆ Promise å¯¹è±¡ï¼Œç”¨<code>then</code>æ–¹æ³•äº¤å›æ‰§è¡Œæƒã€‚</p>
<p>co æ¨¡å—å…¶å®å°±æ˜¯å°†ä¸¤ç§è‡ªåŠ¨æ‰§è¡Œå™¨ï¼ˆThunk å‡½æ•°å’Œ Promise å¯¹è±¡ï¼‰ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ¨¡å—ã€‚ä½¿ç”¨ co çš„å‰ææ¡ä»¶æ˜¯ï¼ŒGenerator å‡½æ•°çš„<code>yield</code>å‘½ä»¤åé¢ï¼Œåªèƒ½æ˜¯ Thunk å‡½æ•°æˆ– Promise å¯¹è±¡ã€‚</p>
<p>ä¸Šä¸€èŠ‚å·²ç»ä»‹ç»äº†åŸºäº Thunk å‡½æ•°çš„è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚ä¸‹é¢æ¥çœ‹ï¼ŒåŸºäº Promise å¯¹è±¡çš„è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚è¿™æ˜¯ç†è§£ co æ¨¡å—å¿…é¡»çš„ã€‚</p>
<h3 id="åŸºäº-Promise-å¯¹è±¡çš„è‡ªåŠ¨æ‰§è¡Œ"><a href="#åŸºäº-Promise-å¯¹è±¡çš„è‡ªåŠ¨æ‰§è¡Œ" class="headerlink" title="åŸºäº Promise å¯¹è±¡çš„è‡ªåŠ¨æ‰§è¡Œ"></a>åŸºäº Promise å¯¹è±¡çš„è‡ªåŠ¨æ‰§è¡Œ</h3><p>è¿˜æ˜¯æ²¿ç”¨ä¸Šé¢çš„ä¾‹å­ã€‚é¦–å…ˆï¼ŒæŠŠ<code>fs</code>æ¨¡å—çš„<code>readFile</code>æ–¹æ³•åŒ…è£…æˆä¸€ä¸ª Promise å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> readFile = <span class="function"><span class="keyword">function</span> (<span class="params">fileName</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">    fs.readFile(fileName, <span class="function"><span class="keyword">function</span>(<span class="params">error, data</span>)</span>&#123;</div><div class="line">      <span class="keyword">if</span> (error) <span class="keyword">return</span> reject(error);</div><div class="line">      resolve(data);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> gen = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> f1 = <span class="keyword">yield</span> readFile(<span class="string">'/etc/fstab'</span>);</div><div class="line">  <span class="keyword">var</span> f2 = <span class="keyword">yield</span> readFile(<span class="string">'/etc/shells'</span>);</div><div class="line">  <span class="built_in">console</span>.log(f1.toString());</div><div class="line">  <span class="built_in">console</span>.log(f2.toString());</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œæ‰‹åŠ¨æ‰§è¡Œä¸Šé¢çš„ Generator å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line"></div><div class="line">g.next().value.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">  g.next(data).value.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">    g.next(data);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ‰‹åŠ¨æ‰§è¡Œå…¶å®å°±æ˜¯ç”¨<code>then</code>æ–¹æ³•ï¼Œå±‚å±‚æ·»åŠ å›è°ƒå‡½æ•°ã€‚ç†è§£äº†è¿™ä¸€ç‚¹ï¼Œå°±å¯ä»¥å†™å‡ºä¸€ä¸ªè‡ªåŠ¨æ‰§è¡Œå™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params">gen</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> g = gen();</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> result = g.next(data);</div><div class="line">    <span class="keyword">if</span> (result.done) <span class="keyword">return</span> result.value;</div><div class="line">    result.value.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">      next(data);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  next();</div><div class="line">&#125;</div><div class="line"></div><div class="line">run(gen);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ Generator å‡½æ•°è¿˜æ²¡æ‰§è¡Œåˆ°æœ€åä¸€æ­¥ï¼Œ<code>next</code>å‡½æ•°å°±è°ƒç”¨è‡ªèº«ï¼Œä»¥æ­¤å®ç°è‡ªåŠ¨æ‰§è¡Œã€‚</p>
<h3 id="co-æ¨¡å—çš„æºç "><a href="#co-æ¨¡å—çš„æºç " class="headerlink" title="co æ¨¡å—çš„æºç "></a>co æ¨¡å—çš„æºç </h3><p>co å°±æ˜¯ä¸Šé¢é‚£ä¸ªè‡ªåŠ¨æ‰§è¡Œå™¨çš„æ‰©å±•ï¼Œå®ƒçš„æºç åªæœ‰å‡ åè¡Œï¼Œéå¸¸ç®€å•ã€‚</p>
<p>é¦–å…ˆï¼Œco å‡½æ•°æ¥å— Generator å‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">co</span>(<span class="params">gen</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> ctx = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨è¿”å›çš„ Promise å¯¹è±¡é‡Œé¢ï¼Œco å…ˆæ£€æŸ¥å‚æ•°<code>gen</code>æ˜¯å¦ä¸º Generator å‡½æ•°ã€‚å¦‚æœæ˜¯ï¼Œå°±æ‰§è¡Œè¯¥å‡½æ•°ï¼Œå¾—åˆ°ä¸€ä¸ªå†…éƒ¨æŒ‡é’ˆå¯¹è±¡ï¼›å¦‚æœä¸æ˜¯å°±è¿”å›ï¼Œå¹¶å°† Promise å¯¹è±¡çš„çŠ¶æ€æ”¹ä¸º<code>resolved</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">co</span>(<span class="params">gen</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> ctx = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> gen === <span class="string">'function'</span>) gen = gen.call(ctx);</div><div class="line">    <span class="keyword">if</span> (!gen || <span class="keyword">typeof</span> gen.next !== <span class="string">'function'</span>) <span class="keyword">return</span> resolve(gen);</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ¥ç€ï¼Œco å°† Generator å‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼ŒåŒ…è£…æˆ<code>onFulfilled</code>å‡½æ•°ã€‚è¿™ä¸»è¦æ˜¯ä¸ºäº†èƒ½å¤Ÿæ•æ‰æŠ›å‡ºçš„é”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">co</span>(<span class="params">gen</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> ctx = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> gen === <span class="string">'function'</span>) gen = gen.call(ctx);</div><div class="line">    <span class="keyword">if</span> (!gen || <span class="keyword">typeof</span> gen.next !== <span class="string">'function'</span>) <span class="keyword">return</span> resolve(gen);</div><div class="line"></div><div class="line">    onFulfilled();</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">onFulfilled</span>(<span class="params">res</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> ret;</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        ret = gen.next(res);</div><div class="line">      &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">        <span class="keyword">return</span> reject(e);</div><div class="line">      &#125;</div><div class="line">      next(ret);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æœ€åï¼Œå°±æ˜¯å…³é”®çš„<code>next</code>å‡½æ•°ï¼Œå®ƒä¼šåå¤è°ƒç”¨è‡ªèº«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params">ret</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (ret.done) <span class="keyword">return</span> resolve(ret.value);</div><div class="line">  <span class="keyword">var</span> value = toPromise.call(ctx, ret.value);</div><div class="line">  <span class="keyword">if</span> (value &amp;&amp; isPromise(value)) <span class="keyword">return</span> value.then(onFulfilled, onRejected);</div><div class="line">  <span class="keyword">return</span> onRejected(</div><div class="line">    <span class="keyword">new</span> <span class="built_in">TypeError</span>(</div><div class="line">      <span class="string">'You may only yield a function, promise, generator, array, or object, '</span></div><div class="line">      + <span class="string">'but the following object was passed: "'</span></div><div class="line">      + <span class="built_in">String</span>(ret.value)</div><div class="line">      + <span class="string">'"'</span></div><div class="line">    )</div><div class="line">  );</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>next</code>å‡½æ•°çš„å†…éƒ¨ä»£ç ï¼Œä¸€å…±åªæœ‰å››è¡Œå‘½ä»¤ã€‚</p>
<p>ç¬¬ä¸€è¡Œï¼Œæ£€æŸ¥å½“å‰æ˜¯å¦ä¸º Generator å‡½æ•°çš„æœ€åä¸€æ­¥ï¼Œå¦‚æœæ˜¯å°±è¿”å›ã€‚</p>
<p>ç¬¬äºŒè¡Œï¼Œç¡®ä¿æ¯ä¸€æ­¥çš„è¿”å›å€¼ï¼Œæ˜¯ Promise å¯¹è±¡ã€‚</p>
<p>ç¬¬ä¸‰è¡Œï¼Œä½¿ç”¨<code>then</code>æ–¹æ³•ï¼Œä¸ºè¿”å›å€¼åŠ ä¸Šå›è°ƒå‡½æ•°ï¼Œç„¶åé€šè¿‡<code>onFulfilled</code>å‡½æ•°å†æ¬¡è°ƒç”¨<code>next</code>å‡½æ•°ã€‚</p>
<p>ç¬¬å››è¡Œï¼Œåœ¨å‚æ•°ä¸ç¬¦åˆè¦æ±‚çš„æƒ…å†µä¸‹ï¼ˆå‚æ•°é Thunk å‡½æ•°å’Œ Promise å¯¹è±¡ï¼‰ï¼Œå°† Promise å¯¹è±¡çš„çŠ¶æ€æ”¹ä¸º<code>rejected</code>ï¼Œä»è€Œç»ˆæ­¢æ‰§è¡Œã€‚</p>
<h3 id="å¤„ç†å¹¶å‘çš„å¼‚æ­¥æ“ä½œ"><a href="#å¤„ç†å¹¶å‘çš„å¼‚æ­¥æ“ä½œ" class="headerlink" title="å¤„ç†å¹¶å‘çš„å¼‚æ­¥æ“ä½œ"></a>å¤„ç†å¹¶å‘çš„å¼‚æ­¥æ“ä½œ</h3><p>co æ”¯æŒå¹¶å‘çš„å¼‚æ­¥æ“ä½œï¼Œå³å…è®¸æŸäº›æ“ä½œåŒæ—¶è¿›è¡Œï¼Œç­‰åˆ°å®ƒä»¬å…¨éƒ¨å®Œæˆï¼Œæ‰è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p>
<p>è¿™æ—¶ï¼Œè¦æŠŠå¹¶å‘çš„æ“ä½œéƒ½æ”¾åœ¨æ•°ç»„æˆ–å¯¹è±¡é‡Œé¢ï¼Œè·Ÿåœ¨<code>yield</code>è¯­å¥åé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ•°ç»„çš„å†™æ³•</span></div><div class="line">co(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> res = <span class="keyword">yield</span> [</div><div class="line">    <span class="built_in">Promise</span>.resolve(<span class="number">1</span>),</div><div class="line">    <span class="built_in">Promise</span>.resolve(<span class="number">2</span>)</div><div class="line">  ];</div><div class="line">  <span class="built_in">console</span>.log(res);</div><div class="line">&#125;).catch(onerror);</div><div class="line"></div><div class="line"><span class="comment">// å¯¹è±¡çš„å†™æ³•</span></div><div class="line">co(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> res = <span class="keyword">yield</span> &#123;</div><div class="line">    <span class="number">1</span>: <span class="built_in">Promise</span>.resolve(<span class="number">1</span>),</div><div class="line">    <span class="number">2</span>: <span class="built_in">Promise</span>.resolve(<span class="number">2</span>),</div><div class="line">  &#125;;</div><div class="line">  <span class="built_in">console</span>.log(res);</div><div class="line">&#125;).catch(onerror);</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">co(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> values = [n1, n2, n3];</div><div class="line">  <span class="keyword">yield</span> values.map(somethingAsync);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">somethingAsync</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="comment">// do something async</span></div><div class="line">  <span class="keyword">return</span> y</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç å…è®¸å¹¶å‘ä¸‰ä¸ª<code>somethingAsync</code>å¼‚æ­¥æ“ä½œï¼Œç­‰åˆ°å®ƒä»¬å…¨éƒ¨å®Œæˆï¼Œæ‰ä¼šè¿›è¡Œä¸‹ä¸€æ­¥ã€‚<br>ITæŠ€æœ¯åˆ†äº«å°½åœ¨ğŸ”— <a href="http://microzz.com">æ¶µæœˆå¤©-microzz.com</a><br><a href="https://microzz.com">https://microzz.com</a></p>
<h2 id="asyncå‡½æ•°"><a href="#asyncå‡½æ•°" class="headerlink" title="asyncå‡½æ•°"></a>asyncå‡½æ•°</h2><h3 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h3><p>ES2017 æ ‡å‡†æä¾›äº†<code>async</code>å‡½æ•°ï¼Œä½¿å¾—å¼‚æ­¥æ“ä½œå˜å¾—æ›´åŠ æ–¹ä¾¿ã€‚</p>
<p><code>async</code>å‡½æ•°æ˜¯ä»€ä¹ˆï¼Ÿä¸€å¥è¯ï¼Œ<code>async</code>å‡½æ•°å°±æ˜¯ Generator å‡½æ•°çš„è¯­æ³•ç³–ã€‚å‰æ–‡æœ‰ä¸€ä¸ª Generator å‡½æ•°ï¼Œä¾æ¬¡è¯»å–ä¸¤ä¸ªæ–‡ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> readFile = <span class="function"><span class="keyword">function</span> (<span class="params">fileName</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    fs.readFile(fileName, <span class="function"><span class="keyword">function</span>(<span class="params">error, data</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (error) reject(error);</div><div class="line">      resolve(data);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> gen = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> f1 = <span class="keyword">yield</span> readFile(<span class="string">'/etc/fstab'</span>);</div><div class="line">  <span class="keyword">var</span> f2 = <span class="keyword">yield</span> readFile(<span class="string">'/etc/shells'</span>);</div><div class="line">  <span class="built_in">console</span>.log(f1.toString());</div><div class="line">  <span class="built_in">console</span>.log(f2.toString());</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å†™æˆ<code>async</code>å‡½æ•°ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> asyncReadFile = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> f1 = <span class="keyword">await</span> readFile(<span class="string">'/etc/fstab'</span>);</div><div class="line">  <span class="keyword">var</span> f2 = <span class="keyword">await</span> readFile(<span class="string">'/etc/shells'</span>);</div><div class="line">  <span class="built_in">console</span>.log(f1.toString());</div><div class="line">  <span class="built_in">console</span>.log(f2.toString());</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸€æ¯”è¾ƒå°±ä¼šå‘ç°ï¼Œ<code>async</code>å‡½æ•°å°±æ˜¯å°† Generator å‡½æ•°çš„æ˜Ÿå·ï¼ˆ<code>*</code>ï¼‰æ›¿æ¢æˆ<code>async</code>ï¼Œå°†<code>yield</code>æ›¿æ¢æˆ<code>await</code>ï¼Œä»…æ­¤è€Œå·²ã€‚</p>
<p><code>async</code>å‡½æ•°å¯¹ Generator å‡½æ•°çš„æ”¹è¿›ï¼Œä½“ç°åœ¨ä»¥ä¸‹å››ç‚¹ã€‚</p>
<p>ï¼ˆ1ï¼‰å†…ç½®æ‰§è¡Œå™¨ã€‚Generator å‡½æ•°çš„æ‰§è¡Œå¿…é¡»é æ‰§è¡Œå™¨ï¼Œæ‰€ä»¥æ‰æœ‰äº†<code>co</code>æ¨¡å—ï¼Œè€Œ<code>async</code>å‡½æ•°è‡ªå¸¦æ‰§è¡Œå™¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>async</code>å‡½æ•°çš„æ‰§è¡Œï¼Œä¸æ™®é€šå‡½æ•°ä¸€æ¨¡ä¸€æ ·ï¼Œåªè¦ä¸€è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> result = asyncReadFile();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç è°ƒç”¨äº†<code>asyncReadFile</code>å‡½æ•°ï¼Œç„¶åå®ƒå°±ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œè¾“å‡ºæœ€åç»“æœã€‚è¿™å®Œå…¨ä¸åƒ Generator å‡½æ•°ï¼Œéœ€è¦è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œæˆ–è€…ç”¨<code>co</code>æ¨¡å—ï¼Œæ‰èƒ½å¾—åˆ°çœŸæ­£æ‰§è¡Œï¼Œå¾—åˆ°æœ€åç»“æœã€‚</p>
<p>ï¼ˆ2ï¼‰æ›´å¥½çš„è¯­ä¹‰ã€‚<code>async</code>å’Œ<code>await</code>ï¼Œæ¯”èµ·æ˜Ÿå·å’Œ<code>yield</code>ï¼Œè¯­ä¹‰æ›´æ¸…æ¥šäº†ã€‚<code>async</code>è¡¨ç¤ºå‡½æ•°é‡Œæœ‰å¼‚æ­¥æ“ä½œï¼Œ<code>await</code>è¡¨ç¤ºç´§è·Ÿåœ¨åé¢çš„è¡¨è¾¾å¼éœ€è¦ç­‰å¾…ç»“æœã€‚</p>
<p>ï¼ˆ3ï¼‰æ›´å¹¿çš„é€‚ç”¨æ€§ã€‚ <code>co</code>æ¨¡å—çº¦å®šï¼Œ<code>yield</code>å‘½ä»¤åé¢åªèƒ½æ˜¯ Thunk å‡½æ•°æˆ– Promise å¯¹è±¡ï¼Œè€Œ<code>async</code>å‡½æ•°çš„<code>await</code>å‘½ä»¤åé¢ï¼Œå¯ä»¥æ˜¯Promise å¯¹è±¡å’ŒåŸå§‹ç±»å‹çš„å€¼ï¼ˆæ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼Œä½†è¿™æ—¶ç­‰åŒäºåŒæ­¥æ“ä½œï¼‰ã€‚</p>
<p>ï¼ˆ4ï¼‰è¿”å›å€¼æ˜¯ Promiseã€‚<code>async</code>å‡½æ•°çš„è¿”å›å€¼æ˜¯ Promise å¯¹è±¡ï¼Œè¿™æ¯” Generator å‡½æ•°çš„è¿”å›å€¼æ˜¯ Iterator å¯¹è±¡æ–¹ä¾¿å¤šäº†ã€‚ä½ å¯ä»¥ç”¨<code>then</code>æ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥çš„æ“ä½œã€‚</p>
<p>è¿›ä¸€æ­¥è¯´ï¼Œ<code>async</code>å‡½æ•°å®Œå…¨å¯ä»¥çœ‹ä½œå¤šä¸ªå¼‚æ­¥æ“ä½œï¼ŒåŒ…è£…æˆçš„ä¸€ä¸ª Promise å¯¹è±¡ï¼Œè€Œ<code>await</code>å‘½ä»¤å°±æ˜¯å†…éƒ¨<code>then</code>å‘½ä»¤çš„è¯­æ³•ç³–ã€‚</p>
<h3 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h3><p><code>async</code>å‡½æ•°çš„è¯­æ³•è§„åˆ™æ€»ä½“ä¸Šæ¯”è¾ƒç®€å•ï¼Œéš¾ç‚¹æ˜¯é”™è¯¯å¤„ç†æœºåˆ¶ã€‚</p>
<p>ï¼ˆ1ï¼‰<code>async</code>å‡½æ•°è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚</p>
<p><code>async</code>å‡½æ•°å†…éƒ¨<code>return</code>è¯­å¥è¿”å›çš„å€¼ï¼Œä¼šæˆä¸º<code>then</code>æ–¹æ³•å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">'hello world'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">f().then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</div><div class="line"><span class="comment">// "hello world"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>f</code>å†…éƒ¨<code>return</code>å‘½ä»¤è¿”å›çš„å€¼ï¼Œä¼šè¢«<code>then</code>æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚</p>
<p><code>async</code>å‡½æ•°å†…éƒ¨æŠ›å‡ºé”™è¯¯ï¼Œä¼šå¯¼è‡´è¿”å›çš„ Promise å¯¹è±¡å˜ä¸º<code>reject</code>çŠ¶æ€ã€‚æŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ä¼šè¢«<code>catch</code>æ–¹æ³•å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f().then(</div><div class="line">  <span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v),</div><div class="line">  e =&gt; <span class="built_in">console</span>.log(e)</div><div class="line">)</div><div class="line"><span class="comment">// Error: å‡ºé”™äº†</span></div></pre></td></tr></table></figure>
<p>ï¼ˆ2ï¼‰<code>async</code>å‡½æ•°è¿”å›çš„ Promise å¯¹è±¡ï¼Œå¿…é¡»ç­‰åˆ°å†…éƒ¨æ‰€æœ‰<code>await</code>å‘½ä»¤çš„ Promise å¯¹è±¡æ‰§è¡Œå®Œï¼Œæ‰ä¼šå‘ç”ŸçŠ¶æ€æ”¹å˜ï¼Œé™¤éé‡åˆ°<code>return</code>è¯­å¥æˆ–è€…æŠ›å‡ºé”™è¯¯ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰<code>async</code>å‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œï¼Œæ‰ä¼šæ‰§è¡Œ<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getTitle</span>(<span class="params">url</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> response = <span class="keyword">await</span> fetch(url);</div><div class="line">  <span class="keyword">let</span> html = <span class="keyword">await</span> response.text();</div><div class="line">  <span class="keyword">return</span> html.match(<span class="regexp">/&lt;title&gt;([\s\S]+)&lt;\/title&gt;/i</span>)[<span class="number">1</span>];</div><div class="line">&#125;</div><div class="line">getTitle(<span class="string">'https://tc39.github.io/ecma262/'</span>).then(<span class="built_in">console</span>.log)</div><div class="line"><span class="comment">// "ECMAScript 2017 Language Specification"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>getTitle</code>å†…éƒ¨æœ‰ä¸‰ä¸ªæ“ä½œï¼šæŠ“å–ç½‘é¡µã€å–å‡ºæ–‡æœ¬ã€åŒ¹é…é¡µé¢æ ‡é¢˜ã€‚åªæœ‰è¿™ä¸‰ä¸ªæ“ä½œå…¨éƒ¨å®Œæˆï¼Œæ‰ä¼šæ‰§è¡Œ<code>then</code>æ–¹æ³•é‡Œé¢çš„<code>console.log</code>ã€‚</p>
<p>ï¼ˆ3ï¼‰æ­£å¸¸æƒ…å†µä¸‹ï¼Œ<code>await</code>å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚å¦‚æœä¸æ˜¯ï¼Œä¼šè¢«è½¬æˆä¸€ä¸ªç«‹å³<code>resolve</code>çš„ Promise å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="number">123</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">f().then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</div><div class="line"><span class="comment">// 123</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>await</code>å‘½ä»¤çš„å‚æ•°æ˜¯æ•°å€¼<code>123</code>ï¼Œå®ƒè¢«è½¬æˆPromiseå¯¹è±¡ï¼Œå¹¶ç«‹å³<code>resolve</code>ã€‚</p>
<p><code>await</code>å‘½ä»¤åé¢çš„Promiseå¯¹è±¡å¦‚æœå˜ä¸º<code>reject</code>çŠ¶æ€ï¼Œåˆ™<code>reject</code>çš„å‚æ•°ä¼šè¢«<code>catch</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°æ¥æ”¶åˆ°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.reject(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f()</div><div class="line">.then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</div><div class="line">.catch(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(e))</div><div class="line"><span class="comment">// å‡ºé”™äº†</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œ<code>await</code>è¯­å¥å‰é¢æ²¡æœ‰<code>return</code>ï¼Œä½†æ˜¯<code>reject</code>æ–¹æ³•çš„å‚æ•°ä¾ç„¶ä¼ å…¥äº†<code>catch</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°ã€‚è¿™é‡Œå¦‚æœåœ¨<code>await</code>å‰é¢åŠ ä¸Š<code>return</code>ï¼Œæ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚</p>
<p>åªè¦ä¸€ä¸ª<code>await</code>è¯­å¥åé¢çš„Promiseå˜ä¸º<code>reject</code>ï¼Œé‚£ä¹ˆæ•´ä¸ª<code>async</code>å‡½æ•°éƒ½ä¼šä¸­æ–­æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.reject(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="string">'hello world'</span>); <span class="comment">// ä¸ä¼šæ‰§è¡Œ</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒä¸ª<code>await</code>è¯­å¥æ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œå› ä¸ºç¬¬ä¸€ä¸ª<code>await</code>è¯­å¥çŠ¶æ€å˜æˆäº†<code>reject</code>ã€‚</p>
<p>ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å°†ç¬¬ä¸€ä¸ª<code>await</code>æ”¾åœ¨<code>try...catch</code>ç»“æ„é‡Œé¢ï¼Œè¿™æ ·ç¬¬äºŒä¸ª<code>await</code>å°±ä¼šæ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">await</span> <span class="built_in">Promise</span>.reject(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="string">'hello world'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f()</div><div class="line">.then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</div><div class="line"><span class="comment">// hello world</span></div></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æ–¹æ³•æ˜¯<code>await</code>åé¢çš„Promiseå¯¹è±¡å†è·Ÿä¸€ä¸ª<code>catch</code>æ–¹æ³•ï¼Œå¤„ç†å‰é¢å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">await</span> <span class="built_in">Promise</span>.reject(<span class="string">'å‡ºé”™äº†'</span>)</div><div class="line">    .catch(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(e));</div><div class="line">  <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.resolve(<span class="string">'hello world'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f()</div><div class="line">.then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</div><div class="line"><span class="comment">// å‡ºé”™äº†</span></div><div class="line"><span class="comment">// hello world</span></div></pre></td></tr></table></figure>
<p>å¦‚æœæœ‰å¤šä¸ª<code>await</code>å‘½ä»¤ï¼Œå¯ä»¥ç»Ÿä¸€æ”¾åœ¨<code>try...catch</code>ç»“æ„ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">var</span> val1 = <span class="keyword">await</span> firstStep();</div><div class="line">    <span class="keyword">var</span> val2 = <span class="keyword">await</span> secondStep(val1);</div><div class="line">    <span class="keyword">var</span> val3 = <span class="keyword">await</span> thirdStep(val1, val2);</div><div class="line"></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Final: '</span>, val3);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">catch</span> (err) &#123;</div><div class="line">    <span class="built_in">console</span>.error(err);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ï¼ˆ4ï¼‰å¦‚æœ<code>await</code>åé¢çš„å¼‚æ­¥æ“ä½œå‡ºé”™ï¼Œé‚£ä¹ˆç­‰åŒäº<code>async</code>å‡½æ•°è¿”å›çš„Promiseå¯¹è±¡è¢«<code>reject</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f()</div><div class="line">.then(<span class="function"><span class="params">v</span> =&gt;</span> <span class="built_in">console</span>.log(v))</div><div class="line">.catch(<span class="function"><span class="params">e</span> =&gt;</span> <span class="built_in">console</span>.log(e))</div><div class="line"><span class="comment">// Errorï¼šå‡ºé”™äº†</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>async</code>å‡½æ•°<code>f</code>æ‰§è¡Œåï¼Œ<code>await</code>åé¢çš„Promiseå¯¹è±¡ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯å¯¹è±¡ï¼Œå¯¼è‡´<code>catch</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°è¢«è°ƒç”¨ï¼Œå®ƒçš„å‚æ•°å°±æ˜¯æŠ›å‡ºçš„é”™è¯¯å¯¹è±¡ã€‚å…·ä½“çš„æ‰§è¡Œæœºåˆ¶ï¼Œå¯ä»¥å‚è€ƒåæ–‡çš„â€œasyncå‡½æ•°çš„å®ç°â€ã€‚</p>
<p>é˜²æ­¢å‡ºé”™çš„æ–¹æ³•ï¼Œä¹Ÿæ˜¯å°†å…¶æ”¾åœ¨<code>try...catch</code>ä»£ç å—ä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line">    &#125;);</div><div class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">await</span>(<span class="string">'hello world'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="asyncå‡½æ•°çš„å®ç°"><a href="#asyncå‡½æ•°çš„å®ç°" class="headerlink" title="asyncå‡½æ•°çš„å®ç°"></a>asyncå‡½æ•°çš„å®ç°</h3><p>async å‡½æ•°çš„å®ç°ï¼Œå°±æ˜¯å°† Generator å‡½æ•°å’Œè‡ªåŠ¨æ‰§è¡Œå™¨ï¼ŒåŒ…è£…åœ¨ä¸€ä¸ªå‡½æ•°é‡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">args</span>)</span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">args</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> spawn(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ‰€æœ‰çš„<code>async</code>å‡½æ•°éƒ½å¯ä»¥å†™æˆä¸Šé¢çš„ç¬¬äºŒç§å½¢å¼ï¼Œå…¶ä¸­çš„ spawn å‡½æ•°å°±æ˜¯è‡ªåŠ¨æ‰§è¡Œå™¨ã€‚</p>
<p>ä¸‹é¢ç»™å‡º<code>spawn</code>å‡½æ•°çš„å®ç°ï¼ŒåŸºæœ¬å°±æ˜¯å‰æ–‡è‡ªåŠ¨æ‰§è¡Œå™¨çš„ç¿»ç‰ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">spawn</span>(<span class="params">genF</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> gen = genF();</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">step</span>(<span class="params">nextF</span>) </span>&#123;</div><div class="line">      <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">var</span> next = nextF();</div><div class="line">      &#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">        <span class="keyword">return</span> reject(e);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span>(next.done) &#123;</div><div class="line">        <span class="keyword">return</span> resolve(next.value);</div><div class="line">      &#125;</div><div class="line">      <span class="built_in">Promise</span>.resolve(next.value).then(<span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123;</div><div class="line">        step(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> gen.next(v); &#125;);</div><div class="line">      &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">        step(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> gen.throw(e); &#125;);</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">    step(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">return</span> gen.next(<span class="literal">undefined</span>); &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="async-å‡½æ•°çš„ç”¨æ³•"><a href="#async-å‡½æ•°çš„ç”¨æ³•" class="headerlink" title="async å‡½æ•°çš„ç”¨æ³•"></a>async å‡½æ•°çš„ç”¨æ³•</h3><p><code>async</code>å‡½æ•°è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨<code>then</code>æ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•°ã€‚å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸€æ—¦é‡åˆ°<code>await</code>å°±ä¼šå…ˆè¿”å›ï¼Œç­‰åˆ°è§¦å‘çš„å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getStockPriceByName</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> symbol = <span class="keyword">await</span> getStockSymbol(name);</div><div class="line">  <span class="keyword">var</span> stockPrice = <span class="keyword">await</span> getStockPrice(symbol);</div><div class="line">  <span class="keyword">return</span> stockPrice;</div><div class="line">&#125;</div><div class="line"></div><div class="line">getStockPriceByName(<span class="string">'goog'</span>).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(result);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªè·å–è‚¡ç¥¨æŠ¥ä»·çš„å‡½æ•°ï¼Œå‡½æ•°å‰é¢çš„<code>async</code>å…³é”®å­—ï¼Œè¡¨æ˜è¯¥å‡½æ•°å†…éƒ¨æœ‰å¼‚æ­¥æ“ä½œã€‚è°ƒç”¨è¯¥å‡½æ•°æ—¶ï¼Œä¼šç«‹å³è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­ï¼ŒæŒ‡å®šå¤šå°‘æ¯«ç§’åè¾“å‡ºä¸€ä¸ªå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params">ms</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">    setTimeout(resolve, ms);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">asyncPrint</span>(<span class="params">value, ms</span>) </span>&#123;</div><div class="line">  <span class="keyword">await</span> timeout(ms);</div><div class="line">  <span class="built_in">console</span>.log(value)</div><div class="line">&#125;</div><div class="line"></div><div class="line">asyncPrint(<span class="string">'hello world'</span>, <span class="number">50</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æŒ‡å®š50æ¯«ç§’ä»¥åï¼Œè¾“å‡º<code>hello world</code>ã€‚</p>
<p>Asyncå‡½æ•°æœ‰å¤šç§ä½¿ç”¨å½¢å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‡½æ•°å£°æ˜</span></div><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"></div><div class="line"><span class="comment">// å‡½æ•°è¡¨è¾¾å¼</span></div><div class="line"><span class="keyword">const</span> foo = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// å¯¹è±¡çš„æ–¹æ³•</span></div><div class="line"><span class="keyword">let</span> obj = &#123; <span class="keyword">async</span> foo() &#123;&#125; &#125;;</div><div class="line">obj.foo().then(...)</div><div class="line"></div><div class="line"><span class="comment">// Class çš„æ–¹æ³•</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Storage</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>.cachePromise = caches.open(<span class="string">'avatars'</span>);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">async</span> getAvatar(name) &#123;</div><div class="line">    <span class="keyword">const</span> cache = <span class="keyword">await</span> <span class="keyword">this</span>.cachePromise;</div><div class="line">    <span class="keyword">return</span> cache.match(<span class="string">`/avatars/<span class="subst">$&#123;name&#125;</span>.jpg`</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> storage = <span class="keyword">new</span> Storage();</div><div class="line">storage.getAvatar(<span class="string">'jake'</span>).then(â€¦);</div><div class="line"></div><div class="line"><span class="comment">// ç®­å¤´å‡½æ•°</span></div><div class="line"><span class="keyword">const</span> foo = <span class="keyword">async</span> () =&gt; &#123;&#125;;</div></pre></td></tr></table></figure>
<h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><p>ç¬¬ä¸€ç‚¹ï¼Œ<code>await</code>å‘½ä»¤åé¢çš„<code>Promise</code>å¯¹è±¡ï¼Œè¿è¡Œç»“æœå¯èƒ½æ˜¯<code>rejected</code>ï¼Œæ‰€ä»¥æœ€å¥½æŠŠ<code>await</code>å‘½ä»¤æ”¾åœ¨<code>try...catch</code>ä»£ç å—ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">await</span> somethingThatReturnsAPromise();</div><div class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">    <span class="built_in">console</span>.log(err);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å¦ä¸€ç§å†™æ³•</span></div><div class="line"></div><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">myFunction</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">await</span> somethingThatReturnsAPromise()</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(err);</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒç‚¹ï¼Œå¤šä¸ª<code>await</code>å‘½ä»¤åé¢çš„å¼‚æ­¥æ“ä½œï¼Œå¦‚æœä¸å­˜åœ¨ç»§å‘å…³ç³»ï¼Œæœ€å¥½è®©å®ƒä»¬åŒæ—¶è§¦å‘ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> foo = <span class="keyword">await</span> getFoo();</div><div class="line"><span class="keyword">let</span> bar = <span class="keyword">await</span> getBar();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>getFoo</code>å’Œ<code>getBar</code>æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„å¼‚æ­¥æ“ä½œï¼ˆå³äº’ä¸ä¾èµ–ï¼‰ï¼Œè¢«å†™æˆç»§å‘å…³ç³»ã€‚è¿™æ ·æ¯”è¾ƒè€—æ—¶ï¼Œå› ä¸ºåªæœ‰<code>getFoo</code>å®Œæˆä»¥åï¼Œæ‰ä¼šæ‰§è¡Œ<code>getBar</code>ï¼Œå®Œå…¨å¯ä»¥è®©å®ƒä»¬åŒæ—¶è§¦å‘ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å†™æ³•ä¸€</span></div><div class="line"><span class="keyword">let</span> [foo, bar] = <span class="keyword">await</span> <span class="built_in">Promise</span>.all([getFoo(), getBar()]);</div><div class="line"></div><div class="line"><span class="comment">// å†™æ³•äºŒ</span></div><div class="line"><span class="keyword">let</span> fooPromise = getFoo();</div><div class="line"><span class="keyword">let</span> barPromise = getBar();</div><div class="line"><span class="keyword">let</span> foo = <span class="keyword">await</span> fooPromise;</div><div class="line"><span class="keyword">let</span> bar = <span class="keyword">await</span> barPromise;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ç§å†™æ³•ï¼Œ<code>getFoo</code>å’Œ<code>getBar</code>éƒ½æ˜¯åŒæ—¶è§¦å‘ï¼Œè¿™æ ·å°±ä¼šç¼©çŸ­ç¨‹åºçš„æ‰§è¡Œæ—¶é—´ã€‚</p>
<p>ç¬¬ä¸‰ç‚¹ï¼Œ<code>await</code>å‘½ä»¤åªèƒ½ç”¨åœ¨<code>async</code>å‡½æ•°ä¹‹ä¸­ï¼Œå¦‚æœç”¨åœ¨æ™®é€šå‡½æ•°ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">dbFuc</span>(<span class="params">db</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</div><div class="line"></div><div class="line">  <span class="comment">// æŠ¥é”™</span></div><div class="line">  docs.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">doc</span>) </span>&#123;</div><div class="line">    <span class="keyword">await</span> db.post(doc);</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¼šæŠ¥é”™ï¼Œå› ä¸ºawaitç”¨åœ¨æ™®é€šå‡½æ•°ä¹‹ä¸­äº†ã€‚ä½†æ˜¯ï¼Œå¦‚æœå°†<code>forEach</code>æ–¹æ³•çš„å‚æ•°æ”¹æˆ<code>async</code>å‡½æ•°ï¼Œä¹Ÿæœ‰é—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">dbFuc</span>(<span class="params">db</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</div><div class="line"></div><div class="line">  <span class="comment">// å¯èƒ½å¾—åˆ°é”™è¯¯ç»“æœ</span></div><div class="line">  docs.forEach(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params">doc</span>) </span>&#123;</div><div class="line">    <span class="keyword">await</span> db.post(doc);</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯èƒ½ä¸ä¼šæ­£å¸¸å·¥ä½œï¼ŒåŸå› æ˜¯è¿™æ—¶ä¸‰ä¸ª<code>db.post</code>æ“ä½œå°†æ˜¯å¹¶å‘æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯åŒæ—¶æ‰§è¡Œï¼Œè€Œä¸æ˜¯ç»§å‘æ‰§è¡Œã€‚æ­£ç¡®çš„å†™æ³•æ˜¯é‡‡ç”¨<code>for</code>å¾ªç¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">dbFuc</span>(<span class="params">db</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> doc <span class="keyword">of</span> docs) &#123;</div><div class="line">    <span class="keyword">await</span> db.post(doc);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœç¡®å®å¸Œæœ›å¤šä¸ªè¯·æ±‚å¹¶å‘æ‰§è¡Œï¼Œå¯ä»¥ä½¿ç”¨<code>Promise.all</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">dbFuc</span>(<span class="params">db</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</div><div class="line">  <span class="keyword">let</span> promises = docs.map(<span class="function">(<span class="params">doc</span>) =&gt;</span> db.post(doc));</div><div class="line"></div><div class="line">  <span class="keyword">let</span> results = <span class="keyword">await</span> <span class="built_in">Promise</span>.all(promises);</div><div class="line">  <span class="built_in">console</span>.log(results);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æˆ–è€…ä½¿ç”¨ä¸‹é¢çš„å†™æ³•</span></div><div class="line"></div><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">dbFuc</span>(<span class="params">db</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> docs = [&#123;&#125;, &#123;&#125;, &#123;&#125;];</div><div class="line">  <span class="keyword">let</span> promises = docs.map(<span class="function">(<span class="params">doc</span>) =&gt;</span> db.post(doc));</div><div class="line"></div><div class="line">  <span class="keyword">let</span> results = [];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> promise <span class="keyword">of</span> promises) &#123;</div><div class="line">    results.push(<span class="keyword">await</span> promise);</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(results);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ES6å°†<code>await</code>å¢åŠ ä¸ºä¿ç•™å­—ã€‚ä½¿ç”¨è¿™ä¸ªè¯ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œåœ¨ES5æ˜¯åˆæ³•çš„ï¼Œåœ¨ES6å°†æŠ›å‡ºSyntaxErrorã€‚</p>
<h3 id="ä¸Promiseã€Generatorçš„æ¯”è¾ƒ"><a href="#ä¸Promiseã€Generatorçš„æ¯”è¾ƒ" class="headerlink" title="ä¸Promiseã€Generatorçš„æ¯”è¾ƒ"></a>ä¸Promiseã€Generatorçš„æ¯”è¾ƒ</h3><p>æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œæ¥çœ‹Asyncå‡½æ•°ä¸Promiseã€Generatorå‡½æ•°çš„åŒºåˆ«ã€‚</p>
<p>å‡å®šæŸä¸ªDOMå…ƒç´ ä¸Šé¢ï¼Œéƒ¨ç½²äº†ä¸€ç³»åˆ—çš„åŠ¨ç”»ï¼Œå‰ä¸€ä¸ªåŠ¨ç”»ç»“æŸï¼Œæ‰èƒ½å¼€å§‹åä¸€ä¸ªã€‚å¦‚æœå½“ä¸­æœ‰ä¸€ä¸ªåŠ¨ç”»å‡ºé”™ï¼Œå°±ä¸å†å¾€ä¸‹æ‰§è¡Œï¼Œè¿”å›ä¸Šä¸€ä¸ªæˆåŠŸæ‰§è¡Œçš„åŠ¨ç”»çš„è¿”å›å€¼ã€‚</p>
<p>é¦–å…ˆæ˜¯Promiseçš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">chainAnimationsPromise</span>(<span class="params">elem, animations</span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="comment">// å˜é‡retç”¨æ¥ä¿å­˜ä¸Šä¸€ä¸ªåŠ¨ç”»çš„è¿”å›å€¼</span></div><div class="line">  <span class="keyword">var</span> ret = <span class="literal">null</span>;</div><div class="line"></div><div class="line">  <span class="comment">// æ–°å»ºä¸€ä¸ªç©ºçš„Promise</span></div><div class="line">  <span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve();</div><div class="line"></div><div class="line">  <span class="comment">// ä½¿ç”¨thenæ–¹æ³•ï¼Œæ·»åŠ æ‰€æœ‰åŠ¨ç”»</span></div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> anim <span class="keyword">of</span> animations) &#123;</div><div class="line">    p = p.then(<span class="function"><span class="keyword">function</span>(<span class="params">val</span>) </span>&#123;</div><div class="line">      ret = val;</div><div class="line">      <span class="keyword">return</span> anim(elem);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// è¿”å›ä¸€ä¸ªéƒ¨ç½²äº†é”™è¯¯æ•æ‰æœºåˆ¶çš„Promise</span></div><div class="line">  <span class="keyword">return</span> p.catch(<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</div><div class="line">    <span class="comment">/* å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ */</span></div><div class="line">  &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è™½ç„¶Promiseçš„å†™æ³•æ¯”å›è°ƒå‡½æ•°çš„å†™æ³•å¤§å¤§æ”¹è¿›ï¼Œä½†æ˜¯ä¸€çœ¼çœ‹ä¸Šå»ï¼Œä»£ç å®Œå…¨éƒ½æ˜¯Promiseçš„APIï¼ˆthenã€catchç­‰ç­‰ï¼‰ï¼Œæ“ä½œæœ¬èº«çš„è¯­ä¹‰åè€Œä¸å®¹æ˜“çœ‹å‡ºæ¥ã€‚</p>
<p>æ¥ç€æ˜¯Generatorå‡½æ•°çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">chainAnimationsGenerator</span>(<span class="params">elem, animations</span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> spawn(<span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> ret = <span class="literal">null</span>;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> anim <span class="keyword">of</span> animations) &#123;</div><div class="line">        ret = <span class="keyword">yield</span> anim(elem);</div><div class="line">      &#125;</div><div class="line">    &#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">      <span class="comment">/* å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ */</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨Generatorå‡½æ•°éå†äº†æ¯ä¸ªåŠ¨ç”»ï¼Œè¯­ä¹‰æ¯”Promiseå†™æ³•æ›´æ¸…æ™°ï¼Œç”¨æˆ·å®šä¹‰çš„æ“ä½œå…¨éƒ¨éƒ½å‡ºç°åœ¨spawnå‡½æ•°çš„å†…éƒ¨ã€‚è¿™ä¸ªå†™æ³•çš„é—®é¢˜åœ¨äºï¼Œå¿…é¡»æœ‰ä¸€ä¸ªä»»åŠ¡è¿è¡Œå™¨ï¼Œè‡ªåŠ¨æ‰§è¡ŒGeneratorå‡½æ•°ï¼Œä¸Šé¢ä»£ç çš„spawnå‡½æ•°å°±æ˜¯è‡ªåŠ¨æ‰§è¡Œå™¨ï¼Œå®ƒè¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œè€Œä¸”å¿…é¡»ä¿è¯yieldè¯­å¥åé¢çš„è¡¨è¾¾å¼ï¼Œå¿…é¡»è¿”å›ä¸€ä¸ªPromiseã€‚</p>
<p>æœ€åæ˜¯Asyncå‡½æ•°çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">chainAnimationsAsync</span>(<span class="params">elem, animations</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> ret = <span class="literal">null</span>;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> anim <span class="keyword">of</span> animations) &#123;</div><div class="line">      ret = <span class="keyword">await</span> anim(elem);</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">    <span class="comment">/* å¿½ç•¥é”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œ */</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> ret;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°Asyncå‡½æ•°çš„å®ç°æœ€ç®€æ´ï¼Œæœ€ç¬¦åˆè¯­ä¹‰ï¼Œå‡ ä¹æ²¡æœ‰è¯­ä¹‰ä¸ç›¸å…³çš„ä»£ç ã€‚å®ƒå°†Generatorå†™æ³•ä¸­çš„è‡ªåŠ¨æ‰§è¡Œå™¨ï¼Œæ”¹åœ¨è¯­è¨€å±‚é¢æä¾›ï¼Œä¸æš´éœ²ç»™ç”¨æˆ·ï¼Œå› æ­¤ä»£ç é‡æœ€å°‘ã€‚å¦‚æœä½¿ç”¨Generatorå†™æ³•ï¼Œè‡ªåŠ¨æ‰§è¡Œå™¨éœ€è¦ç”¨æˆ·è‡ªå·±æä¾›ã€‚</p>
<h3 id="å®ä¾‹ï¼šæŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ"><a href="#å®ä¾‹ï¼šæŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ" class="headerlink" title="å®ä¾‹ï¼šæŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ"></a>å®ä¾‹ï¼šæŒ‰é¡ºåºå®Œæˆå¼‚æ­¥æ“ä½œ</h3><p>å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸é‡åˆ°ä¸€ç»„å¼‚æ­¥æ“ä½œï¼Œéœ€è¦æŒ‰ç…§é¡ºåºå®Œæˆã€‚æ¯”å¦‚ï¼Œä¾æ¬¡è¿œç¨‹è¯»å–ä¸€ç»„URLï¼Œç„¶åæŒ‰ç…§è¯»å–çš„é¡ºåºè¾“å‡ºç»“æœã€‚</p>
<p>Promise çš„å†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">logInOrder</span>(<span class="params">urls</span>) </span>&#123;</div><div class="line">  <span class="comment">// è¿œç¨‹è¯»å–æ‰€æœ‰URL</span></div><div class="line">  <span class="keyword">const</span> textPromises = urls.map(<span class="function"><span class="params">url</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> fetch(url).then(<span class="function"><span class="params">response</span> =&gt;</span> response.text());</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="comment">// æŒ‰æ¬¡åºè¾“å‡º</span></div><div class="line">  textPromises.reduce(<span class="function">(<span class="params">chain, textPromise</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> chain.then(<span class="function"><span class="params">()</span> =&gt;</span> textPromise)</div><div class="line">      .then(<span class="function"><span class="params">text</span> =&gt;</span> <span class="built_in">console</span>.log(text));</div><div class="line">  &#125;, <span class="built_in">Promise</span>.resolve());</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨<code>fetch</code>æ–¹æ³•ï¼ŒåŒæ—¶è¿œç¨‹è¯»å–ä¸€ç»„URLã€‚æ¯ä¸ª<code>fetch</code>æ“ä½œéƒ½è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œæ”¾å…¥<code>textPromises</code>æ•°ç»„ã€‚ç„¶åï¼Œ<code>reduce</code>æ–¹æ³•ä¾æ¬¡å¤„ç†æ¯ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œç„¶åä½¿ç”¨<code>then</code>ï¼Œå°†æ‰€æœ‰<code>Promise</code>å¯¹è±¡è¿èµ·æ¥ï¼Œå› æ­¤å°±å¯ä»¥ä¾æ¬¡è¾“å‡ºç»“æœã€‚</p>
<p>è¿™ç§å†™æ³•ä¸å¤ªç›´è§‚ï¼Œå¯è¯»æ€§æ¯”è¾ƒå·®ã€‚ä¸‹é¢æ˜¯<code>async</code>å‡½æ•°å®ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">logInOrder</span>(<span class="params">urls</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> url <span class="keyword">of</span> urls) &#123;</div><div class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(url);</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">await</span> response.text());</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ç¡®å®å¤§å¤§ç®€åŒ–ï¼Œé—®é¢˜æ˜¯æ‰€æœ‰è¿œç¨‹æ“ä½œéƒ½æ˜¯ç»§å‘ã€‚åªæœ‰å‰ä¸€ä¸ªURLè¿”å›ç»“æœï¼Œæ‰ä¼šå»è¯»å–ä¸‹ä¸€ä¸ªURLï¼Œè¿™æ ·åšæ•ˆç‡å¾ˆå·®ï¼Œéå¸¸æµªè´¹æ—¶é—´ã€‚æˆ‘ä»¬éœ€è¦çš„æ˜¯å¹¶å‘å‘å‡ºè¿œç¨‹è¯·æ±‚ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">logInOrder</span>(<span class="params">urls</span>) </span>&#123;</div><div class="line">  <span class="comment">// å¹¶å‘è¯»å–è¿œç¨‹URL</span></div><div class="line">  <span class="keyword">const</span> textPromises = urls.map(<span class="keyword">async</span> url =&gt; &#123;</div><div class="line">    <span class="keyword">const</span> response = <span class="keyword">await</span> fetch(url);</div><div class="line">    <span class="keyword">return</span> response.text();</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="comment">// æŒ‰æ¬¡åºè¾“å‡º</span></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> textPromise <span class="keyword">of</span> textPromises) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">await</span> textPromise);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè™½ç„¶<code>map</code>æ–¹æ³•çš„å‚æ•°æ˜¯<code>async</code>å‡½æ•°ï¼Œä½†å®ƒæ˜¯å¹¶å‘æ‰§è¡Œçš„ï¼Œå› ä¸ºåªæœ‰<code>async</code>å‡½æ•°å†…éƒ¨æ˜¯ç»§å‘æ‰§è¡Œï¼Œå¤–éƒ¨ä¸å—å½±å“ã€‚åé¢çš„<code>for..of</code>å¾ªç¯å†…éƒ¨ä½¿ç”¨äº†<code>await</code>ï¼Œå› æ­¤å®ç°äº†æŒ‰é¡ºåºè¾“å‡ºã€‚</p>
<h2 id="å¼‚æ­¥éå†å™¨"><a href="#å¼‚æ­¥éå†å™¨" class="headerlink" title="å¼‚æ­¥éå†å™¨"></a>å¼‚æ­¥éå†å™¨</h2><p>ã€Šéå†å™¨ã€‹ä¸€ç« è¯´è¿‡ï¼ŒIterator æ¥å£æ˜¯ä¸€ç§æ•°æ®éå†çš„åè®®ï¼Œåªè¦è°ƒç”¨éå†å™¨å¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰éå†æŒ‡é’ˆæ‰€åœ¨çš„é‚£ä¸ªä½ç½®çš„ä¿¡æ¯ã€‚<code>next</code>æ–¹æ³•è¿”å›çš„å¯¹è±¡çš„ç»“æ„æ˜¯<code>{value, done}</code>ï¼Œå…¶ä¸­<code>value</code>è¡¨ç¤ºå½“å‰çš„æ•°æ®çš„å€¼ï¼Œ<code>done</code>æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸã€‚</p>
<p>è¿™é‡Œéšå«ç€ä¸€ä¸ªè§„å®šï¼Œ<code>next</code>æ–¹æ³•å¿…é¡»æ˜¯åŒæ­¥çš„ï¼Œåªè¦è°ƒç”¨å°±å¿…é¡»ç«‹åˆ»è¿”å›å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦æ‰§è¡Œ<code>next</code>æ–¹æ³•ï¼Œå°±å¿…é¡»åŒæ­¥åœ°å¾—åˆ°<code>value</code>å’Œ<code>done</code>è¿™ä¸¤ä¸ªå±æ€§ã€‚å¦‚æœéå†æŒ‡é’ˆæ­£å¥½æŒ‡å‘åŒæ­¥æ“ä½œï¼Œå½“ç„¶æ²¡æœ‰é—®é¢˜ï¼Œä½†å¯¹äºå¼‚æ­¥æ“ä½œï¼Œå°±ä¸å¤ªåˆé€‚äº†ã€‚ç›®å‰çš„è§£å†³æ–¹æ³•æ˜¯ï¼ŒGenerator å‡½æ•°é‡Œé¢çš„å¼‚æ­¥æ“ä½œï¼Œè¿”å›ä¸€ä¸ª Thunk å‡½æ•°æˆ–è€… Promise å¯¹è±¡ï¼Œå³<code>value</code>å±æ€§æ˜¯ä¸€ä¸ª Thunk å‡½æ•°æˆ–è€… Promise å¯¹è±¡ï¼Œç­‰å¾…ä»¥åè¿”å›çœŸæ­£çš„å€¼ï¼Œè€Œ<code>done</code>å±æ€§åˆ™è¿˜æ˜¯åŒæ­¥äº§ç”Ÿçš„ã€‚</p>
<p>ç›®å‰ï¼Œæœ‰ä¸€ä¸ª<a href="https://github.com/tc39/proposal-async-iteration" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œä¸ºå¼‚æ­¥æ“ä½œæä¾›åŸç”Ÿçš„éå†å™¨æ¥å£ï¼Œå³<code>value</code>å’Œ<code>done</code>è¿™ä¸¤ä¸ªå±æ€§éƒ½æ˜¯å¼‚æ­¥äº§ç”Ÿï¼Œè¿™ç§°ä¸ºâ€å¼‚æ­¥éå†å™¨â€œï¼ˆAsync Iteratorï¼‰ã€‚</p>
<h3 id="å¼‚æ­¥éå†çš„æ¥å£"><a href="#å¼‚æ­¥éå†çš„æ¥å£" class="headerlink" title="å¼‚æ­¥éå†çš„æ¥å£"></a>å¼‚æ­¥éå†çš„æ¥å£</h3><p>å¼‚æ­¥éå†å™¨çš„æœ€å¤§çš„è¯­æ³•ç‰¹ç‚¹ï¼Œå°±æ˜¯è°ƒç”¨éå†å™¨çš„<code>next</code>æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">asyncIterator</div><div class="line">  .next()</div><div class="line">  .then(</div><div class="line">    <span class="function">(<span class="params">&#123; value, done &#125;</span>) =&gt;</span> <span class="comment">/* ... */</span></div><div class="line">  );</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>asyncIterator</code>æ˜¯ä¸€ä¸ªå¼‚æ­¥éå†å™¨ï¼Œè°ƒç”¨<code>next</code>æ–¹æ³•ä»¥åï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ã€‚å› æ­¤ï¼Œå¯ä»¥ä½¿ç”¨<code>then</code>æ–¹æ³•æŒ‡å®šï¼Œè¿™ä¸ª Promise å¯¹è±¡çš„çŠ¶æ€å˜ä¸º<code>resolve</code>ä»¥åçš„å›è°ƒå‡½æ•°ã€‚å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œåˆ™æ˜¯ä¸€ä¸ªå…·æœ‰<code>value</code>å’Œ<code>done</code>ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ï¼Œè¿™ä¸ªè·ŸåŒæ­¥éå†å™¨æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªå¯¹è±¡çš„åŒæ­¥éå†å™¨çš„æ¥å£ï¼Œéƒ¨ç½²åœ¨<code>Symbol.iterator</code>å±æ€§ä¸Šé¢ã€‚åŒæ ·åœ°ï¼Œå¯¹è±¡çš„å¼‚æ­¥éå†å™¨æ¥å£ï¼Œéƒ¨ç½²åœ¨<code>Symbol.asyncIterator</code>å±æ€§ä¸Šé¢ã€‚ä¸ç®¡æ˜¯ä»€ä¹ˆæ ·çš„å¯¹è±¡ï¼Œåªè¦å®ƒçš„<code>Symbol.asyncIterator</code>å±æ€§æœ‰å€¼ï¼Œå°±è¡¨ç¤ºåº”è¯¥å¯¹å®ƒè¿›è¡Œå¼‚æ­¥éå†ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¼‚æ­¥éå†å™¨çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> asyncIterable = createAsyncIterable([<span class="string">'a'</span>, <span class="string">'b'</span>]);</div><div class="line"><span class="keyword">const</span> asyncIterator = asyncIterable[<span class="built_in">Symbol</span>.asyncIterator]();</div><div class="line"></div><div class="line">asyncIterator</div><div class="line">.next()</div><div class="line">.then(<span class="function"><span class="params">iterResult1</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(iterResult1); <span class="comment">// &#123; value: 'a', done: false &#125;</span></div><div class="line">  <span class="keyword">return</span> asyncIterator.next();</div><div class="line">&#125;)</div><div class="line">.then(<span class="function"><span class="params">iterResult2</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(iterResult2); <span class="comment">// &#123; value: 'b', done: false &#125;</span></div><div class="line">  <span class="keyword">return</span> asyncIterator.next();</div><div class="line">&#125;)</div><div class="line">.then(<span class="function"><span class="params">iterResult3</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(iterResult3); <span class="comment">// &#123; value: undefined, done: true &#125;</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¼‚æ­¥éå†å™¨å…¶å®è¿”å›äº†ä¸¤æ¬¡å€¼ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨çš„æ—¶å€™ï¼Œè¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼›ç­‰åˆ° Promise å¯¹è±¡<code>resolve</code>äº†ï¼Œå†è¿”å›ä¸€ä¸ªè¡¨ç¤ºå½“å‰æ•°æ®æˆå‘˜ä¿¡æ¯çš„å¯¹è±¡ã€‚è¿™å°±æ˜¯è¯´ï¼Œå¼‚æ­¥éå†å™¨ä¸åŒæ­¥éå†å™¨æœ€ç»ˆè¡Œä¸ºæ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯ä¼šå…ˆè¿”å› Promise å¯¹è±¡ï¼Œä½œä¸ºä¸­ä»‹ã€‚</p>
<p>ç”±äºå¼‚æ­¥éå†å™¨çš„<code>next</code>æ–¹æ³•ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ã€‚å› æ­¤ï¼Œå¯ä»¥æŠŠå®ƒæ”¾åœ¨<code>await</code>å‘½ä»¤åé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> asyncIterable = createAsyncIterable([<span class="string">'a'</span>, <span class="string">'b'</span>]);</div><div class="line">  <span class="keyword">const</span> asyncIterator = asyncIterable[<span class="built_in">Symbol</span>.asyncIterator]();</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">await</span> asyncIterator.next());</div><div class="line">  <span class="comment">// &#123; value: 'a', done: false &#125;</span></div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">await</span> asyncIterator.next());</div><div class="line">  <span class="comment">// &#123; value: 'b', done: false &#125;</span></div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">await</span> asyncIterator.next());</div><div class="line">  <span class="comment">// &#123; value: undefined, done: true &#125;</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>next</code>æ–¹æ³•ç”¨<code>await</code>å¤„ç†ä»¥åï¼Œå°±ä¸å¿…ä½¿ç”¨<code>then</code>æ–¹æ³•äº†ã€‚æ•´ä¸ªæµç¨‹å·²ç»å¾ˆæ¥è¿‘åŒæ­¥å¤„ç†äº†ã€‚</p>
<p>æ³¨æ„ï¼Œå¼‚æ­¥éå†å™¨çš„<code>next</code>æ–¹æ³•æ˜¯å¯ä»¥è¿ç»­è°ƒç”¨çš„ï¼Œä¸å¿…ç­‰åˆ°ä¸Šä¸€æ­¥äº§ç”Ÿçš„Promiseå¯¹è±¡<code>resolve</code>ä»¥åå†è°ƒç”¨ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>next</code>æ–¹æ³•ä¼šç´¯ç§¯èµ·æ¥ï¼Œè‡ªåŠ¨æŒ‰ç…§æ¯ä¸€æ­¥çš„é¡ºåºè¿è¡Œä¸‹å»ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ŒæŠŠæ‰€æœ‰çš„<code>next</code>æ–¹æ³•æ”¾åœ¨<code>Promise.all</code>æ–¹æ³•é‡Œé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> asyncGenObj = createAsyncIterable([<span class="string">'a'</span>, <span class="string">'b'</span>]);</div><div class="line"><span class="keyword">const</span> [&#123;<span class="attr">value</span>: v1&#125;, &#123;<span class="attr">value</span>: v2&#125;] = <span class="keyword">await</span> <span class="built_in">Promise</span>.all([</div><div class="line">  asyncGenObj.next(), asyncGenObj.next()</div><div class="line">]);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(v1, v2); <span class="comment">// a b</span></div></pre></td></tr></table></figure>
<p>å¦ä¸€ç§ç”¨æ³•æ˜¯ä¸€æ¬¡æ€§è°ƒç”¨æ‰€æœ‰çš„<code>next</code>æ–¹æ³•ï¼Œç„¶å<code>await</code>æœ€åä¸€æ­¥æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> writer = openFile(<span class="string">'someFile.txt'</span>);</div><div class="line">writer.next(<span class="string">'hello'</span>);</div><div class="line">writer.next(<span class="string">'world'</span>);</div><div class="line"><span class="keyword">await</span> writer.return();</div></pre></td></tr></table></figure>
<h3 id="for-awaitâ€¦of"><a href="#for-awaitâ€¦of" class="headerlink" title="for awaitâ€¦of"></a>for awaitâ€¦of</h3><p>å‰é¢ä»‹ç»è¿‡ï¼Œ<code>for...of</code>å¾ªç¯ç”¨äºéå†åŒæ­¥çš„ Iterator æ¥å£ã€‚æ–°å¼•å…¥çš„<code>for await...of</code>å¾ªç¯ï¼Œåˆ™æ˜¯ç”¨äºéå†å¼‚æ­¥çš„ Iterator æ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> x <span class="keyword">of</span> createAsyncIterable([<span class="string">'a'</span>, <span class="string">'b'</span>])) &#123;</div><div class="line">    <span class="built_in">console</span>.log(x);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// a</span></div><div class="line"><span class="comment">// b</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>createAsyncIterable()</code>è¿”å›ä¸€ä¸ªå¼‚æ­¥éå†å™¨ï¼Œ<code>for...of</code>å¾ªç¯è‡ªåŠ¨è°ƒç”¨è¿™ä¸ªéå†å™¨çš„<code>next</code>æ–¹æ³•ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªPromiseå¯¹è±¡ã€‚<code>await</code>ç”¨æ¥å¤„ç†è¿™ä¸ªPromiseå¯¹è±¡ï¼Œä¸€æ—¦<code>resolve</code>ï¼Œå°±æŠŠå¾—åˆ°çš„å€¼ï¼ˆ<code>x</code>ï¼‰ä¼ å…¥<code>for...of</code>çš„å¾ªç¯ä½“ã€‚</p>
<p><code>for await...of</code>å¾ªç¯çš„ä¸€ä¸ªç”¨é€”ï¼Œæ˜¯éƒ¨ç½²äº† asyncIterable æ“ä½œçš„å¼‚æ­¥æ¥å£ï¼Œå¯ä»¥ç›´æ¥æ”¾å…¥è¿™ä¸ªå¾ªç¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> body = <span class="string">''</span>;</div><div class="line"><span class="keyword">for</span> <span class="keyword">await</span>(<span class="keyword">const</span> data <span class="keyword">of</span> req) body += data;</div><div class="line"><span class="keyword">const</span> parsed = <span class="built_in">JSON</span>.parse(body);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'got'</span>, parsed);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>req</code>æ˜¯ä¸€ä¸ª asyncIterable å¯¹è±¡ï¼Œç”¨æ¥å¼‚æ­¥è¯»å–æ•°æ®ã€‚å¯ä»¥çœ‹åˆ°ï¼Œä½¿ç”¨<code>for await...of</code>å¾ªç¯ä»¥åï¼Œä»£ç ä¼šéå¸¸ç®€æ´ã€‚</p>
<p>å¦‚æœ<code>next</code>æ–¹æ³•è¿”å›çš„Promiseå¯¹è±¡è¢«<code>reject</code>ï¼Œé‚£ä¹ˆå°±è¦ç”¨<code>try...catch</code>æ•æ‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> x <span class="keyword">of</span> createRejectingIterable()) &#123;</div><div class="line">      <span class="built_in">console</span>.log(x);</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="built_in">console</span>.error(e);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œ<code>for await...of</code>å¾ªç¯ä¹Ÿå¯ä»¥ç”¨äºåŒæ­¥éå†å™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> x <span class="keyword">of</span> [<span class="string">'a'</span>, <span class="string">'b'</span>]) &#123;</div><div class="line">    <span class="built_in">console</span>.log(x);</div><div class="line">  &#125;</div><div class="line">&#125;)();</div><div class="line"><span class="comment">// a</span></div><div class="line"><span class="comment">// b</span></div></pre></td></tr></table></figure>
<h3 id="å¼‚æ­¥Generatorå‡½æ•°"><a href="#å¼‚æ­¥Generatorå‡½æ•°" class="headerlink" title="å¼‚æ­¥Generatorå‡½æ•°"></a>å¼‚æ­¥Generatorå‡½æ•°</h3><p>å°±åƒ Generator å‡½æ•°è¿”å›ä¸€ä¸ªåŒæ­¥éå†å™¨å¯¹è±¡ä¸€æ ·ï¼Œå¼‚æ­¥ Generator å‡½æ•°çš„ä½œç”¨ï¼Œæ˜¯è¿”å›ä¸€ä¸ªå¼‚æ­¥éå†å™¨å¯¹è±¡ã€‚</p>
<p>åœ¨è¯­æ³•ä¸Šï¼Œå¼‚æ­¥ Generator å‡½æ•°å°±æ˜¯<code>async</code>å‡½æ•°ä¸ Generator å‡½æ•°çš„ç»“åˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">readLines</span>(<span class="params">path</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> file = <span class="keyword">await</span> fileOpen(path);</div><div class="line"></div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">while</span> (!file.EOF) &#123;</div><div class="line">      <span class="keyword">yield</span> <span class="keyword">await</span> file.readLine();</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">finally</span> &#123;</div><div class="line">    <span class="keyword">await</span> file.close();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¼‚æ­¥æ“ä½œå‰é¢ä½¿ç”¨<code>await</code>å…³é”®å­—æ ‡æ˜ï¼Œå³<code>await</code>åé¢çš„æ“ä½œï¼Œåº”è¯¥è¿”å›Promiseå¯¹è±¡ã€‚å‡¡æ˜¯ä½¿ç”¨<code>yield</code>å…³é”®å­—çš„åœ°æ–¹ï¼Œå°±æ˜¯<code>next</code>æ–¹æ³•çš„åœä¸‹æ¥çš„åœ°æ–¹ï¼Œå®ƒåé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼ˆå³<code>await file.readLine()</code>çš„å€¼ï¼‰ï¼Œä¼šä½œä¸º<code>next()</code>è¿”å›å¯¹è±¡çš„<code>value</code>å±æ€§ï¼Œè¿™ä¸€ç‚¹æ˜¯äºåŒæ­¥Generatorå‡½æ•°ä¸€è‡´çš„ã€‚</p>
<p>å¯ä»¥åƒä¸‹é¢è¿™æ ·ï¼Œä½¿ç”¨ä¸Šé¢ä»£ç å®šä¹‰çš„å¼‚æ­¥Generatorå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> line <span class="keyword">of</span> readLines(filePath)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(line);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¼‚æ­¥Generatorå‡½æ•°å¯ä»¥ä¸<code>for await...of</code>å¾ªç¯ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">prefixLines</span>(<span class="params">asyncIterable</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> line <span class="keyword">of</span> asyncIterable) &#123;</div><div class="line">    <span class="keyword">yield</span> <span class="string">'&gt; '</span> + line;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>yield</code>å‘½ä»¤ä¾ç„¶æ˜¯ç«‹åˆ»è¿”å›çš„ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">asyncGenerator</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Start'</span>);</div><div class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> doSomethingAsync(); <span class="comment">// (A)</span></div><div class="line">  <span class="keyword">yield</span> <span class="string">'Result: '</span>+ result; <span class="comment">// (B)</span></div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Done'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨<code>next</code>æ–¹æ³•ä»¥åï¼Œä¼šåœ¨<code>B</code>å¤„æš‚åœæ‰§è¡Œï¼Œ<code>yield</code>å‘½ä»¤ç«‹åˆ»è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚è¿™ä¸ªPromiseå¯¹è±¡ä¸åŒäº<code>A</code>å¤„<code>await</code>å‘½ä»¤åé¢çš„é‚£ä¸ªPromiseå¯¹è±¡ã€‚ä¸»è¦æœ‰ä¸¤ç‚¹ä¸åŒï¼Œä¸€æ˜¯<code>A</code>å¤„çš„Promiseå¯¹è±¡<code>resolve</code>ä»¥åäº§ç”Ÿçš„å€¼ï¼Œä¼šæ”¾å…¥<code>result</code>å˜é‡ï¼›äºŒæ˜¯<code>B</code>å¤„çš„Promiseå¯¹è±¡<code>resolve</code>ä»¥åäº§ç”Ÿçš„å€¼ï¼Œæ˜¯è¡¨è¾¾å¼<code>&#39;Resultï¼š &#39; + result</code>çš„å€¼ï¼›äºŒæ˜¯<code>A</code>å¤„çš„Promiseå¯¹è±¡ä¸€å®šå…ˆäº<code>B</code>å¤„çš„Promiseå¯¹è±¡<code>resolve</code>ã€‚</p>
<p>å¦‚æœå¼‚æ­¥Generatorå‡½æ•°æŠ›å‡ºé”™è¯¯ï¼Œä¼šè¢«Promiseå¯¹è±¡<code>reject</code>ï¼Œç„¶åæŠ›å‡ºçš„é”™è¯¯è¢«<code>catch</code>æ–¹æ³•æ•è·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">asyncGenerator</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Problem!'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">asyncGenerator()</div><div class="line">.next()</div><div class="line">.catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.log(err)); <span class="comment">// Error: Problem!</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œæ™®é€šçš„<code>async</code>å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œè€Œå¼‚æ­¥Generatorå‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªå¼‚æ­¥Iteratorå¯¹è±¡ã€‚åŸºæœ¬ä¸Šï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼Œ<code>async</code>å‡½æ•°å’Œå¼‚æ­¥Generatorå‡½æ•°ï¼Œæ˜¯å°è£…å¼‚æ­¥æ“ä½œçš„ä¸¤ç§æ–¹æ³•ï¼Œéƒ½ç”¨æ¥è¾¾åˆ°åŒä¸€ç§ç›®çš„ã€‚åŒºåˆ«åœ¨äºï¼Œå‰è€…è‡ªå¸¦æ‰§è¡Œå™¨ï¼Œåè€…é€šè¿‡<code>for await...of</code>æ‰§è¡Œï¼Œæˆ–è€…è‡ªå·±ç¼–å†™æ‰§è¡Œå™¨ã€‚ä¸‹é¢å°±æ˜¯ä¸€ä¸ªå¼‚æ­¥Generatorå‡½æ•°çš„æ‰§è¡Œå™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">takeAsync</span>(<span class="params">asyncIterable, count=Infinity</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> result = [];</div><div class="line">  <span class="keyword">const</span> iterator = asyncIterable[<span class="built_in">Symbol</span>.asyncIterator]();</div><div class="line">  <span class="keyword">while</span> (result.length &lt; count) &#123;</div><div class="line">    <span class="keyword">const</span> &#123;value,done&#125; = <span class="keyword">await</span> iterator.next();</div><div class="line">    <span class="keyword">if</span> (done) <span class="keyword">break</span>;</div><div class="line">    result.push(value);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¼‚æ­¥Generatorå‡½æ•°äº§ç”Ÿçš„å¼‚æ­¥éå†å™¨ï¼Œä¼šé€šè¿‡<code>while</code>å¾ªç¯è‡ªåŠ¨æ‰§è¡Œï¼Œæ¯å½“<code>await iterator.next()</code>å®Œæˆï¼Œå°±ä¼šè¿›å…¥ä¸‹ä¸€è½®å¾ªç¯ã€‚</p>
<p>ä¸‹é¢æ˜¯è¿™ä¸ªè‡ªåŠ¨æ‰§è¡Œå™¨çš„ä¸€ä¸ªä½¿ç”¨å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">yield</span> <span class="string">'a'</span>;</div><div class="line">    <span class="keyword">yield</span> <span class="string">'b'</span>;</div><div class="line">    <span class="keyword">yield</span> <span class="string">'c'</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="keyword">await</span> takeAsync(gen());</div><div class="line">&#125;</div><div class="line"></div><div class="line">f().then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(result); <span class="comment">// ['a', 'b', 'c']</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>å¼‚æ­¥Generatorå‡½æ•°å‡ºç°ä»¥åï¼ŒJavaScriptå°±æœ‰äº†å››ç§å‡½æ•°å½¢å¼ï¼šæ™®é€šå‡½æ•°ã€<code>async</code>å‡½æ•°ã€Generatorå‡½æ•°å’Œå¼‚æ­¥Generatorå‡½æ•°ã€‚è¯·æ³¨æ„åŒºåˆ†æ¯ç§å‡½æ•°çš„ä¸åŒä¹‹å¤„ã€‚</p>
<p>æœ€åï¼ŒåŒæ­¥çš„æ•°æ®ç»“æ„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å¼‚æ­¥Generatorå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">createAsyncIterable</span>(<span class="params">syncIterable</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> elem <span class="keyword">of</span> syncIterable) &#123;</div><div class="line">    <span class="keyword">yield</span> elem;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºæ²¡æœ‰å¼‚æ­¥æ“ä½œï¼Œæ‰€ä»¥ä¹Ÿå°±æ²¡æœ‰ä½¿ç”¨<code>await</code>å…³é”®å­—ã€‚</p>
<h3 id="yield-è¯­å¥"><a href="#yield-è¯­å¥" class="headerlink" title="yield* è¯­å¥"></a>yield* è¯­å¥</h3><p><code>yield*</code>è¯­å¥ä¹Ÿå¯ä»¥è·Ÿä¸€ä¸ªå¼‚æ­¥éå†å™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">gen1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'a'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'b'</span>;</div><div class="line">  <span class="keyword">return</span> <span class="number">2</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span>* <span class="title">gen2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> result = <span class="keyword">yield</span>* gen1();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>gen2</code>å‡½æ•°é‡Œé¢çš„<code>result</code>å˜é‡ï¼Œæœ€åçš„å€¼æ˜¯<code>2</code>ã€‚</p>
<p>ä¸åŒæ­¥Generatorå‡½æ•°ä¸€æ ·ï¼Œ<code>for await...of</code>å¾ªç¯ä¼šå±•å¼€<code>yield*</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> <span class="keyword">await</span> (<span class="keyword">const</span> x <span class="keyword">of</span> gen2()) &#123;</div><div class="line">    <span class="built_in">console</span>.log(x);</div><div class="line">  &#125;</div><div class="line">&#125;)();</div><div class="line"><span class="comment">// a</span></div><div class="line"><span class="comment">// b</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°&quot;&gt;&lt;a href=&quot;#å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°&quot;&gt;&lt;/a&gt;å¼‚æ­¥æ“ä½œå’ŒAsyncå‡½æ•°&lt;/h1&gt;&lt;p&gt;å¼‚æ­¥ç¼–ç¨‹å¯¹ JavaScript è¯­è¨€å¤ªé‡è¦ã€‚Javascr
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Async" scheme="http://microzz.com/tags/Async/"/>
    
  </entry>
  
  <entry>
    <title>Promiseå¯¹è±¡</title>
    <link href="http://microzz.com/2017/01/14/promise/"/>
    <id>http://microzz.com/2017/01/14/promise/</id>
    <published>2017-01-14T06:11:38.000Z</published>
    <updated>2017-01-15T07:06:34.860Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Promiseå¯¹è±¡"><a href="#Promiseå¯¹è±¡" class="headerlink" title="Promiseå¯¹è±¡"></a>Promiseå¯¹è±¡</h1><h2 id="Promiseçš„å«ä¹‰"><a href="#Promiseçš„å«ä¹‰" class="headerlink" title="Promiseçš„å«ä¹‰"></a>Promiseçš„å«ä¹‰</h2><p>Promiseæ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼Œæ¯”ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆâ€”â€”å›è°ƒå‡½æ•°å’Œäº‹ä»¶â€”â€”æ›´åˆç†å’Œæ›´å¼ºå¤§ã€‚å®ƒç”±ç¤¾åŒºæœ€æ—©æå‡ºå’Œå®ç°ï¼ŒES6å°†å…¶å†™è¿›äº†è¯­è¨€æ ‡å‡†ï¼Œç»Ÿä¸€äº†ç”¨æ³•ï¼ŒåŸç”Ÿæä¾›äº†<code>Promise</code>å¯¹è±¡ã€‚</p>
<p>æ‰€è°“<code>Promise</code>ï¼Œç®€å•è¯´å°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œé‡Œé¢ä¿å­˜ç€æŸä¸ªæœªæ¥æ‰ä¼šç»“æŸçš„äº‹ä»¶ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼‰çš„ç»“æœã€‚ä»è¯­æ³•ä¸Šè¯´ï¼ŒPromiseæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»å®ƒå¯ä»¥è·å–å¼‚æ­¥æ“ä½œçš„æ¶ˆæ¯ã€‚Promiseæä¾›ç»Ÿä¸€çš„APIï¼Œå„ç§å¼‚æ­¥æ“ä½œéƒ½å¯ä»¥ç”¨åŒæ ·çš„æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚</p>
<p><code>Promise</code>å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹ã€‚</p>
<p>ï¼ˆ1ï¼‰å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“ã€‚<code>Promise</code>å¯¹è±¡ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæœ‰ä¸‰ç§çŠ¶æ€ï¼š<code>Pending</code>ï¼ˆè¿›è¡Œä¸­ï¼‰ã€<code>Resolved</code>ï¼ˆå·²å®Œæˆï¼Œåˆç§°Fulfilledï¼‰å’Œ<code>Rejected</code>ï¼ˆå·²å¤±è´¥ï¼‰ã€‚åªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œå¯ä»¥å†³å®šå½“å‰æ˜¯å“ªä¸€ç§çŠ¶æ€ï¼Œä»»ä½•å…¶ä»–æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™ä¹Ÿæ˜¯<code>Promise</code>è¿™ä¸ªåå­—çš„ç”±æ¥ï¼Œå®ƒçš„è‹±è¯­æ„æ€å°±æ˜¯â€œæ‰¿è¯ºâ€ï¼Œè¡¨ç¤ºå…¶ä»–æ‰‹æ®µæ— æ³•æ”¹å˜ã€‚</p>
<p>ï¼ˆ2ï¼‰ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æœã€‚<code>Promise</code>å¯¹è±¡çš„çŠ¶æ€æ”¹å˜ï¼Œåªæœ‰ä¸¤ç§å¯èƒ½ï¼šä»<code>Pending</code>å˜ä¸º<code>Resolved</code>å’Œä»<code>Pending</code>å˜ä¸º<code>Rejected</code>ã€‚åªè¦è¿™ä¸¤ç§æƒ…å†µå‘ç”Ÿï¼ŒçŠ¶æ€å°±å‡å›ºäº†ï¼Œä¸ä¼šå†å˜äº†ï¼Œä¼šä¸€ç›´ä¿æŒè¿™ä¸ªç»“æœã€‚å°±ç®—æ”¹å˜å·²ç»å‘ç”Ÿäº†ï¼Œä½ å†å¯¹<code>Promise</code>å¯¹è±¡æ·»åŠ å›è°ƒå‡½æ•°ï¼Œä¹Ÿä¼šç«‹å³å¾—åˆ°è¿™ä¸ªç»“æœã€‚è¿™ä¸äº‹ä»¶ï¼ˆEventï¼‰å®Œå…¨ä¸åŒï¼Œäº‹ä»¶çš„ç‰¹ç‚¹æ˜¯ï¼Œå¦‚æœä½ é”™è¿‡äº†å®ƒï¼Œå†å»ç›‘å¬ï¼Œæ˜¯å¾—ä¸åˆ°ç»“æœçš„ã€‚</p>
<p>æœ‰äº†<code>Promise</code>å¯¹è±¡ï¼Œå°±å¯ä»¥å°†å¼‚æ­¥æ“ä½œä»¥åŒæ­¥æ“ä½œçš„æµç¨‹è¡¨è¾¾å‡ºæ¥ï¼Œé¿å…äº†å±‚å±‚åµŒå¥—çš„å›è°ƒå‡½æ•°ã€‚æ­¤å¤–ï¼Œ<code>Promise</code>å¯¹è±¡æä¾›ç»Ÿä¸€çš„æ¥å£ï¼Œä½¿å¾—æ§åˆ¶å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“ã€‚</p>
<p><code>Promise</code>ä¹Ÿæœ‰ä¸€äº›ç¼ºç‚¹ã€‚é¦–å…ˆï¼Œæ— æ³•å–æ¶ˆ<code>Promise</code>ï¼Œä¸€æ—¦æ–°å»ºå®ƒå°±ä¼šç«‹å³æ‰§è¡Œï¼Œæ— æ³•ä¸­é€”å–æ¶ˆã€‚å…¶æ¬¡ï¼Œå¦‚æœä¸è®¾ç½®å›è°ƒå‡½æ•°ï¼Œ<code>Promise</code>å†…éƒ¨æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸ä¼šååº”åˆ°å¤–éƒ¨ã€‚ç¬¬ä¸‰ï¼Œå½“å¤„äº<code>Pending</code>çŠ¶æ€æ—¶ï¼Œæ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼ˆåˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆï¼‰ã€‚</p>
<p>å¦‚æœæŸäº›äº‹ä»¶ä¸æ–­åœ°åå¤å‘ç”Ÿï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨streamæ¨¡å¼æ˜¯æ¯”éƒ¨ç½²<code>Promise</code>æ›´å¥½çš„é€‰æ‹©ã€‚</p>
<h2 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h2><p>ES6è§„å®šï¼ŒPromiseå¯¹è±¡æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”ŸæˆPromiseå®ä¾‹ã€‚</p>
<p>ä¸‹é¢ä»£ç åˆ›é€ äº†ä¸€ä¸ªPromiseå®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  <span class="comment">// ... some code</span></div><div class="line"></div><div class="line">  <span class="keyword">if</span> (<span class="comment">/* å¼‚æ­¥æ“ä½œæˆåŠŸ */</span>)&#123;</div><div class="line">    resolve(value);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    reject(error);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>Promiseæ„é€ å‡½æ•°æ¥å—ä¸€ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯<code>resolve</code>å’Œ<code>reject</code>ã€‚å®ƒä»¬æ˜¯ä¸¤ä¸ªå‡½æ•°ï¼Œç”±JavaScriptå¼•æ“æä¾›ï¼Œä¸ç”¨è‡ªå·±éƒ¨ç½²ã€‚</p>
<p><code>resolve</code>å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°†Promiseå¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œæˆåŠŸâ€ï¼ˆå³ä»Pendingå˜ä¸ºResolvedï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ï¼›<code>reject</code>å‡½æ•°çš„ä½œç”¨æ˜¯ï¼Œå°†Promiseå¯¹è±¡çš„çŠ¶æ€ä»â€œæœªå®Œæˆâ€å˜ä¸ºâ€œå¤±è´¥â€ï¼ˆå³ä»Pendingå˜ä¸ºRejectedï¼‰ï¼Œåœ¨å¼‚æ­¥æ“ä½œå¤±è´¥æ—¶è°ƒç”¨ï¼Œå¹¶å°†å¼‚æ­¥æ“ä½œæŠ¥å‡ºçš„é”™è¯¯ï¼Œä½œä¸ºå‚æ•°ä¼ é€’å‡ºå»ã€‚</p>
<p>Promiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨<code>then</code>æ–¹æ³•åˆ†åˆ«æŒ‡å®š<code>Resolved</code>çŠ¶æ€å’Œ<code>Reject</code>çŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">  <span class="comment">// success</span></div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="comment">// failure</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>then</code>æ–¹æ³•å¯ä»¥æ¥å—ä¸¤ä¸ªå›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°æ˜¯Promiseå¯¹è±¡çš„çŠ¶æ€å˜ä¸ºResolvedæ—¶è°ƒç”¨ï¼Œç¬¬äºŒä¸ªå›è°ƒå‡½æ•°æ˜¯Promiseå¯¹è±¡çš„çŠ¶æ€å˜ä¸ºRejectæ—¶è°ƒç”¨ã€‚å…¶ä¸­ï¼Œç¬¬äºŒä¸ªå‡½æ•°æ˜¯å¯é€‰çš„ï¼Œä¸ä¸€å®šè¦æä¾›ã€‚è¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ¥å—Promiseå¯¹è±¡ä¼ å‡ºçš„å€¼ä½œä¸ºå‚æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡çš„ç®€å•ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params">ms</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">    setTimeout(resolve, ms, <span class="string">'done'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">timeout(<span class="number">100</span>).then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>timeout</code>æ–¹æ³•è¿”å›ä¸€ä¸ªPromiseå®ä¾‹ï¼Œè¡¨ç¤ºä¸€æ®µæ—¶é—´ä»¥åæ‰ä¼šå‘ç”Ÿçš„ç»“æœã€‚è¿‡äº†æŒ‡å®šçš„æ—¶é—´ï¼ˆ<code>ms</code>å‚æ•°ï¼‰ä»¥åï¼ŒPromiseå®ä¾‹çš„çŠ¶æ€å˜ä¸ºResolvedï¼Œå°±ä¼šè§¦å‘<code>then</code>æ–¹æ³•ç»‘å®šçš„å›è°ƒå‡½æ•°ã€‚</p>
<p>Promiseæ–°å»ºåå°±ä¼šç«‹å³æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Promise'</span>);</div><div class="line">  resolve();</div><div class="line">&#125;);</div><div class="line"></div><div class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Resolved.'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Hi!'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Promise</span></div><div class="line"><span class="comment">// Hi!</span></div><div class="line"><span class="comment">// Resolved</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒPromiseæ–°å»ºåç«‹å³æ‰§è¡Œï¼Œæ‰€ä»¥é¦–å…ˆè¾“å‡ºçš„æ˜¯â€œPromiseâ€ã€‚ç„¶åï¼Œ<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå°†åœ¨å½“å‰è„šæœ¬æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œæ‰ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥â€œResolvedâ€æœ€åè¾“å‡ºã€‚</p>
<p>ä¸‹é¢æ˜¯å¼‚æ­¥åŠ è½½å›¾ç‰‡çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImageAsync</span>(<span class="params">url</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> image = <span class="keyword">new</span> Image();</div><div class="line"></div><div class="line">    image.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      resolve(image);</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    image.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Could not load image at '</span> + url));</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    image.src = url;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä½¿ç”¨PromiseåŒ…è£…äº†ä¸€ä¸ªå›¾ç‰‡åŠ è½½çš„å¼‚æ­¥æ“ä½œã€‚å¦‚æœåŠ è½½æˆåŠŸï¼Œå°±è°ƒç”¨<code>resolve</code>æ–¹æ³•ï¼Œå¦åˆ™å°±è°ƒç”¨<code>reject</code>æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç”¨Promiseå¯¹è±¡å®ç°çš„Ajaxæ“ä½œçš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> getJSON = <span class="function"><span class="keyword">function</span>(<span class="params">url</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> client = <span class="keyword">new</span> XMLHttpRequest();</div><div class="line">    client.open(<span class="string">"GET"</span>, url);</div><div class="line">    client.onreadystatechange = handler;</div><div class="line">    client.responseType = <span class="string">"json"</span>;</div><div class="line">    client.setRequestHeader(<span class="string">"Accept"</span>, <span class="string">"application/json"</span>);</div><div class="line">    client.send();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">handler</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.readyState !== <span class="number">4</span>) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.status === <span class="number">200</span>) &#123;</div><div class="line">        resolve(<span class="keyword">this</span>.response);</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="keyword">this</span>.statusText));</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> promise;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">getJSON(<span class="string">"/posts.json"</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">json</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Contents: '</span> + json);</div><div class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.error(<span class="string">'å‡ºé”™äº†'</span>, error);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>getJSON</code>æ˜¯å¯¹XMLHttpRequestå¯¹è±¡çš„å°è£…ï¼Œç”¨äºå‘å‡ºä¸€ä¸ªé’ˆå¯¹JSONæ•°æ®çš„HTTPè¯·æ±‚ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨<code>getJSON</code>å†…éƒ¨ï¼Œ<code>resolve</code>å‡½æ•°å’Œ<code>reject</code>å‡½æ•°è°ƒç”¨æ—¶ï¼Œéƒ½å¸¦æœ‰å‚æ•°ã€‚</p>
<p>å¦‚æœè°ƒç”¨<code>resolve</code>å‡½æ•°å’Œ<code>reject</code>å‡½æ•°æ—¶å¸¦æœ‰å‚æ•°ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å‚æ•°ä¼šè¢«ä¼ é€’ç»™å›è°ƒå‡½æ•°ã€‚<code>reject</code>å‡½æ•°çš„å‚æ•°é€šå¸¸æ˜¯Errorå¯¹è±¡çš„å®ä¾‹ï¼Œè¡¨ç¤ºæŠ›å‡ºçš„é”™è¯¯ï¼›<code>resolve</code>å‡½æ•°çš„å‚æ•°é™¤äº†æ­£å¸¸çš„å€¼ä»¥å¤–ï¼Œè¿˜å¯èƒ½æ˜¯å¦ä¸€ä¸ªPromiseå®ä¾‹ï¼Œè¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„ç»“æœæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å¦ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæ¯”å¦‚åƒä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  resolve(p1);</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>p1</code>å’Œ<code>p2</code>éƒ½æ˜¯Promiseçš„å®ä¾‹ï¼Œä½†æ˜¯<code>p2</code>çš„<code>resolve</code>æ–¹æ³•å°†<code>p1</code>ä½œä¸ºå‚æ•°ï¼Œå³ä¸€ä¸ªå¼‚æ­¥æ“ä½œçš„ç»“æœæ˜¯è¿”å›å¦ä¸€ä¸ªå¼‚æ­¥æ“ä½œã€‚</p>
<p>æ³¨æ„ï¼Œè¿™æ—¶<code>p1</code>çš„çŠ¶æ€å°±ä¼šä¼ é€’ç»™<code>p2</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>p1</code>çš„çŠ¶æ€å†³å®šäº†<code>p2</code>çš„çŠ¶æ€ã€‚å¦‚æœ<code>p1</code>çš„çŠ¶æ€æ˜¯<code>Pending</code>ï¼Œé‚£ä¹ˆ<code>p2</code>çš„å›è°ƒå‡½æ•°å°±ä¼šç­‰å¾…<code>p1</code>çš„çŠ¶æ€æ”¹å˜ï¼›å¦‚æœ<code>p1</code>çš„çŠ¶æ€å·²ç»æ˜¯<code>Resolved</code>æˆ–è€…<code>Rejected</code>ï¼Œé‚£ä¹ˆ<code>p2</code>çš„å›è°ƒå‡½æ•°å°†ä¼šç«‹åˆ»æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'fail'</span>)), <span class="number">3000</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(p1), <span class="number">1000</span>)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">p2</div><div class="line">  .then(<span class="function"><span class="params">result</span> =&gt;</span> <span class="built_in">console</span>.log(result))</div><div class="line">  .catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.log(error))</div><div class="line"><span class="comment">// Error: fail</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>p1</code>æ˜¯ä¸€ä¸ªPromiseï¼Œ3ç§’ä¹‹åå˜ä¸º<code>rejected</code>ã€‚<code>p2</code>çš„çŠ¶æ€åœ¨1ç§’ä¹‹åæ”¹å˜ï¼Œ<code>resolve</code>æ–¹æ³•è¿”å›çš„æ˜¯<code>p1</code>ã€‚æ­¤æ—¶ï¼Œç”±äº<code>p2</code>è¿”å›çš„æ˜¯å¦ä¸€ä¸ªPromiseï¼Œæ‰€ä»¥åé¢çš„<code>then</code>è¯­å¥éƒ½å˜æˆé’ˆå¯¹åè€…ï¼ˆ<code>p1</code>ï¼‰ã€‚åˆè¿‡äº†2ç§’ï¼Œ<code>p1</code>å˜ä¸º<code>rejected</code>ï¼Œå¯¼è‡´è§¦å‘<code>catch</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p>
<h2 id="Promise-prototype-then"><a href="#Promise-prototype-then" class="headerlink" title="Promise.prototype.then()"></a>Promise.prototype.then()</h2><p>Promiseå®ä¾‹å…·æœ‰<code>then</code>æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>then</code>æ–¹æ³•æ˜¯å®šä¹‰åœ¨åŸå‹å¯¹è±¡Promise.prototypeä¸Šçš„ã€‚å®ƒçš„ä½œç”¨æ˜¯ä¸ºPromiseå®ä¾‹æ·»åŠ çŠ¶æ€æ”¹å˜æ—¶çš„å›è°ƒå‡½æ•°ã€‚å‰é¢è¯´è¿‡ï¼Œ<code>then</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ResolvedçŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼ˆå¯é€‰ï¼‰æ˜¯RejectedçŠ¶æ€çš„å›è°ƒå‡½æ•°ã€‚</p>
<p><code>then</code>æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ï¼ˆæ³¨æ„ï¼Œä¸æ˜¯åŸæ¥é‚£ä¸ªPromiseå®ä¾‹ï¼‰ã€‚å› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ï¼Œå³<code>then</code>æ–¹æ³•åé¢å†è°ƒç”¨å¦ä¸€ä¸ª<code>then</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">getJSON(<span class="string">"/posts.json"</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">json</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> json.post;</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">post</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä½¿ç”¨<code>then</code>æ–¹æ³•ï¼Œä¾æ¬¡æŒ‡å®šäº†ä¸¤ä¸ªå›è°ƒå‡½æ•°ã€‚ç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°å®Œæˆä»¥åï¼Œä¼šå°†è¿”å›ç»“æœä½œä¸ºå‚æ•°ï¼Œä¼ å…¥ç¬¬äºŒä¸ªå›è°ƒå‡½æ•°ã€‚</p>
<p>é‡‡ç”¨é“¾å¼çš„<code>then</code>ï¼Œå¯ä»¥æŒ‡å®šä¸€ç»„æŒ‰ç…§æ¬¡åºè°ƒç”¨çš„å›è°ƒå‡½æ•°ã€‚è¿™æ—¶ï¼Œå‰ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæœ‰å¯èƒ½è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ï¼ˆå³æœ‰å¼‚æ­¥æ“ä½œï¼‰ï¼Œè¿™æ—¶åä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå°±ä¼šç­‰å¾…è¯¥Promiseå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œæ‰ä¼šè¢«è°ƒç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">getJSON(<span class="string">"/post/1.json"</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">post</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> getJSON(post.commentURL);</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span> <span class="title">funcA</span>(<span class="params">comments</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Resolved: "</span>, comments);</div><div class="line">&#125;, <span class="function"><span class="keyword">function</span> <span class="title">funcB</span>(<span class="params">err</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Rejected: "</span>, err);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬ä¸€ä¸ª<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œè¿”å›çš„æ˜¯å¦ä¸€ä¸ªPromiseå¯¹è±¡ã€‚è¿™æ—¶ï¼Œç¬¬äºŒä¸ª<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå°±ä¼šç­‰å¾…è¿™ä¸ªæ–°çš„Promiseå¯¹è±¡çŠ¶æ€å‘ç”Ÿå˜åŒ–ã€‚å¦‚æœå˜ä¸ºResolvedï¼Œå°±è°ƒç”¨<code>funcA</code>ï¼Œå¦‚æœçŠ¶æ€å˜ä¸ºRejectedï¼Œå°±è°ƒç”¨<code>funcB</code>ã€‚</p>
<p>å¦‚æœé‡‡ç”¨ç®­å¤´å‡½æ•°ï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥å†™å¾—æ›´ç®€æ´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">getJSON(<span class="string">"/post/1.json"</span>).then(</div><div class="line">  <span class="function"><span class="params">post</span> =&gt;</span> getJSON(post.commentURL)</div><div class="line">).then(</div><div class="line">  <span class="function"><span class="params">comments</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"Resolved: "</span>, comments),</div><div class="line">  err =&gt; <span class="built_in">console</span>.log(<span class="string">"Rejected: "</span>, err)</div><div class="line">);</div></pre></td></tr></table></figure>
<h2 id="Promise-prototype-catch"><a href="#Promise-prototype-catch" class="headerlink" title="Promise.prototype.catch()"></a>Promise.prototype.catch()</h2><p><code>Promise.prototype.catch</code>æ–¹æ³•æ˜¯<code>.then(null, rejection)</code>çš„åˆ«åï¼Œç”¨äºæŒ‡å®šå‘ç”Ÿé”™è¯¯æ—¶çš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">getJSON(<span class="string">"/posts.json"</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">posts</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="comment">// å¤„ç† getJSON å’Œ å‰ä¸€ä¸ªå›è°ƒå‡½æ•°è¿è¡Œæ—¶å‘ç”Ÿçš„é”™è¯¯</span></div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'å‘ç”Ÿé”™è¯¯ï¼'</span>, error);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>getJSON</code>æ–¹æ³•è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œå¦‚æœè¯¥å¯¹è±¡çŠ¶æ€å˜ä¸º<code>Resolved</code>ï¼Œåˆ™ä¼šè°ƒç”¨<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼›å¦‚æœå¼‚æ­¥æ“ä½œæŠ›å‡ºé”™è¯¯ï¼ŒçŠ¶æ€å°±ä¼šå˜ä¸º<code>Rejected</code>ï¼Œå°±ä¼šè°ƒç”¨<code>catch</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¤„ç†è¿™ä¸ªé”™è¯¯ã€‚å¦å¤–ï¼Œ<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œå¦‚æœè¿è¡Œä¸­æŠ›å‡ºé”™è¯¯ï¼Œä¹Ÿä¼šè¢«<code>catch</code>æ–¹æ³•æ•è·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">p.then(<span class="function">(<span class="params">val</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"fulfilled:"</span>, val))</div><div class="line">  .catch(<span class="function">(<span class="params">err</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"rejected:"</span>, err));</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">p.then(<span class="function">(<span class="params">val</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"fulfilled:"</span>, val))</div><div class="line">  .then(<span class="literal">null</span>, (err) =&gt; <span class="built_in">console</span>.log(<span class="string">"rejected:"</span>, err));</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'test'</span>);</div><div class="line">&#125;);</div><div class="line">promise.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(error);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// Error: test</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>promise</code>æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå°±è¢«<code>catch</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°æ•è·ã€‚æ³¨æ„ï¼Œä¸Šé¢çš„å†™æ³•ä¸ä¸‹é¢ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å†™æ³•ä¸€</span></div><div class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'test'</span>);</div><div class="line">  &#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">    reject(e);</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">promise.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(error);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// å†™æ³•äºŒ</span></div><div class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'test'</span>));</div><div class="line">&#125;);</div><div class="line">promise.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(error);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ¯”è¾ƒä¸Šé¢ä¸¤ç§å†™æ³•ï¼Œå¯ä»¥å‘ç°<code>reject</code>æ–¹æ³•çš„ä½œç”¨ï¼Œç­‰åŒäºæŠ›å‡ºé”™è¯¯ã€‚</p>
<p>å¦‚æœPromiseçŠ¶æ€å·²ç»å˜æˆ<code>Resolved</code>ï¼Œå†æŠ›å‡ºé”™è¯¯æ˜¯æ— æ•ˆçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  resolve(<span class="string">'ok'</span>);</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'test'</span>);</div><div class="line">&#125;);</div><div class="line">promise</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123; <span class="built_in">console</span>.log(value) &#125;)</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123; <span class="built_in">console</span>.log(error) &#125;);</div><div class="line"><span class="comment">// ok</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒPromiseåœ¨<code>resolve</code>è¯­å¥åé¢ï¼Œå†æŠ›å‡ºé”™è¯¯ï¼Œä¸ä¼šè¢«æ•è·ï¼Œç­‰äºæ²¡æœ‰æŠ›å‡ºã€‚</p>
<p>Promiseå¯¹è±¡çš„é”™è¯¯å…·æœ‰â€œå†’æ³¡â€æ€§è´¨ï¼Œä¼šä¸€ç›´å‘åä¼ é€’ï¼Œç›´åˆ°è¢«æ•è·ä¸ºæ­¢ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé”™è¯¯æ€»æ˜¯ä¼šè¢«ä¸‹ä¸€ä¸ª<code>catch</code>è¯­å¥æ•è·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">getJSON(<span class="string">"/post/1.json"</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">post</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> getJSON(post.commentURL);</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">comments</span>) </span>&#123;</div><div class="line">  <span class="comment">// some code</span></div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="comment">// å¤„ç†å‰é¢ä¸‰ä¸ªPromiseäº§ç”Ÿçš„é”™è¯¯</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€å…±æœ‰ä¸‰ä¸ªPromiseå¯¹è±¡ï¼šä¸€ä¸ªç”±<code>getJSON</code>äº§ç”Ÿï¼Œä¸¤ä¸ªç”±<code>then</code>äº§ç”Ÿã€‚å®ƒä»¬ä¹‹ä¸­ä»»ä½•ä¸€ä¸ªæŠ›å‡ºçš„é”™è¯¯ï¼Œéƒ½ä¼šè¢«æœ€åä¸€ä¸ª<code>catch</code>æ•è·ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œä¸è¦åœ¨<code>then</code>æ–¹æ³•é‡Œé¢å®šä¹‰RejectçŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼ˆå³<code>then</code>çš„ç¬¬äºŒä¸ªå‚æ•°ï¼‰ï¼Œæ€»æ˜¯ä½¿ç”¨<code>catch</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// bad</span></div><div class="line">promise</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="comment">// success</span></div><div class="line">  &#125;, <span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="comment">// error</span></div><div class="line">  &#125;);</div><div class="line"></div><div class="line"><span class="comment">// good</span></div><div class="line">promise</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>) </span>&#123; <span class="comment">//cb</span></div><div class="line">    <span class="comment">// success</span></div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span>(<span class="params">err</span>) </span>&#123;</div><div class="line">    <span class="comment">// error</span></div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒç§å†™æ³•è¦å¥½äºç¬¬ä¸€ç§å†™æ³•ï¼Œç†ç”±æ˜¯ç¬¬äºŒç§å†™æ³•å¯ä»¥æ•è·å‰é¢<code>then</code>æ–¹æ³•æ‰§è¡Œä¸­çš„é”™è¯¯ï¼Œä¹Ÿæ›´æ¥è¿‘åŒæ­¥çš„å†™æ³•ï¼ˆ<code>try/catch</code>ï¼‰ã€‚å› æ­¤ï¼Œå»ºè®®æ€»æ˜¯ä½¿ç”¨<code>catch</code>æ–¹æ³•ï¼Œè€Œä¸ä½¿ç”¨<code>then</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚</p>
<p>è·Ÿä¼ ç»Ÿçš„<code>try/catch</code>ä»£ç å—ä¸åŒçš„æ˜¯ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨<code>catch</code>æ–¹æ³•æŒ‡å®šé”™è¯¯å¤„ç†çš„å›è°ƒå‡½æ•°ï¼ŒPromiseå¯¹è±¡æŠ›å‡ºçš„é”™è¯¯ä¸ä¼šä¼ é€’åˆ°å¤–å±‚ä»£ç ï¼Œå³ä¸ä¼šæœ‰ä»»ä½•ååº”ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> someAsyncThing = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="comment">// ä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºxæ²¡æœ‰å£°æ˜</span></div><div class="line">    resolve(x + <span class="number">2</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">someAsyncThing().then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'everything is great'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>someAsyncThing</code>å‡½æ•°äº§ç”Ÿçš„Promiseå¯¹è±¡ä¼šæŠ¥é”™ï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰æŒ‡å®š<code>catch</code>æ–¹æ³•ï¼Œè¿™ä¸ªé”™è¯¯ä¸ä¼šè¢«æ•è·ï¼Œä¹Ÿä¸ä¼šä¼ é€’åˆ°å¤–å±‚ä»£ç ï¼Œå¯¼è‡´è¿è¡Œåæ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚æ³¨æ„ï¼ŒChromeæµè§ˆå™¨ä¸éµå®ˆè¿™æ¡è§„å®šï¼Œå®ƒä¼šæŠ›å‡ºé”™è¯¯â€œReferenceError: x is not definedâ€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">  resolve(<span class="string">'ok'</span>);</div><div class="line">  setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'test'</span>) &#125;, <span class="number">0</span>)</div><div class="line">&#125;);</div><div class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123; <span class="built_in">console</span>.log(value) &#125;);</div><div class="line"><span class="comment">// ok</span></div><div class="line"><span class="comment">// Uncaught Error: test</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒPromise æŒ‡å®šåœ¨ä¸‹ä¸€è½®â€œäº‹ä»¶å¾ªç¯â€å†æŠ›å‡ºé”™è¯¯ï¼Œç»“æœç”±äºæ²¡æœ‰æŒ‡å®šä½¿ç”¨<code>try...catch</code>è¯­å¥ï¼Œå°±å†’æ³¡åˆ°æœ€å¤–å±‚ï¼Œæˆäº†æœªæ•è·çš„é”™è¯¯ã€‚å› ä¸ºæ­¤æ—¶ï¼ŒPromiseçš„å‡½æ•°ä½“å·²ç»è¿è¡Œç»“æŸäº†ï¼Œæ‰€ä»¥è¿™ä¸ªé”™è¯¯æ˜¯åœ¨Promiseå‡½æ•°ä½“å¤–æŠ›å‡ºçš„ã€‚</p>
<p>Node æœ‰ä¸€ä¸ª<code>unhandledRejection</code>äº‹ä»¶ï¼Œä¸“é—¨ç›‘å¬æœªæ•è·çš„<code>reject</code>é”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">process.on(<span class="string">'unhandledRejection'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, p</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.error(err.stack)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>unhandledRejection</code>äº‹ä»¶çš„ç›‘å¬å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯é”™è¯¯å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯æŠ¥é”™çš„Promiseå®ä¾‹ï¼Œå®ƒå¯ä»¥ç”¨æ¥äº†è§£å‘ç”Ÿé”™è¯¯çš„ç¯å¢ƒä¿¡æ¯ã€‚ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>catch</code>æ–¹æ³•è¿”å›çš„è¿˜æ˜¯ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå› æ­¤åé¢è¿˜å¯ä»¥æ¥ç€è°ƒç”¨<code>then</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> someAsyncThing = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="comment">// ä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºxæ²¡æœ‰å£°æ˜</span></div><div class="line">    resolve(x + <span class="number">2</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">someAsyncThing()</div><div class="line">.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'oh no'</span>, error);</div><div class="line">&#125;)</div><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'carry on'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// oh no [ReferenceError: x is not defined]</span></div><div class="line"><span class="comment">// carry on</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¿è¡Œå®Œ<code>catch</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œä¼šæ¥ç€è¿è¡Œåé¢é‚£ä¸ª<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚å¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œåˆ™ä¼šè·³è¿‡<code>catch</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.resolve()</div><div class="line">.catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'oh no'</span>, error);</div><div class="line">&#125;)</div><div class="line">.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'carry on'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// carry on</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç å› ä¸ºæ²¡æœ‰æŠ¥é”™ï¼Œè·³è¿‡äº†<code>catch</code>æ–¹æ³•ï¼Œç›´æ¥æ‰§è¡Œåé¢çš„<code>then</code>æ–¹æ³•ã€‚æ­¤æ—¶ï¼Œè¦æ˜¯<code>then</code>æ–¹æ³•é‡Œé¢æŠ¥é”™ï¼Œå°±ä¸å‰é¢çš„<code>catch</code>æ— å…³äº†ã€‚</p>
<p><code>catch</code>æ–¹æ³•ä¹‹ä¸­ï¼Œè¿˜èƒ½å†æŠ›å‡ºé”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> someAsyncThing = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="comment">// ä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºxæ²¡æœ‰å£°æ˜</span></div><div class="line">    resolve(x + <span class="number">2</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">someAsyncThing().then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> someOtherAsyncThing();</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'oh no'</span>, error);</div><div class="line">  <span class="comment">// ä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºyæ²¡æœ‰å£°æ˜</span></div><div class="line">  y + <span class="number">2</span>;</div><div class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'carry on'</span>);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// oh no [ReferenceError: x is not defined]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>catch</code>æ–¹æ³•æŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸ºåé¢æ²¡æœ‰åˆ«çš„<code>catch</code>æ–¹æ³•äº†ï¼Œå¯¼è‡´è¿™ä¸ªé”™è¯¯ä¸ä¼šè¢«æ•è·ï¼Œä¹Ÿä¸ä¼šä¼ é€’åˆ°å¤–å±‚ã€‚å¦‚æœæ”¹å†™ä¸€ä¸‹ï¼Œç»“æœå°±ä¸ä¸€æ ·äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">someAsyncThing().then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> someOtherAsyncThing();</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'oh no'</span>, error);</div><div class="line">  <span class="comment">// ä¸‹é¢ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºyæ²¡æœ‰å£°æ˜</span></div><div class="line">  y + <span class="number">2</span>;</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'carry on'</span>, error);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// oh no [ReferenceError: x is not defined]</span></div><div class="line"><span class="comment">// carry on [ReferenceError: y is not defined]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒä¸ª<code>catch</code>æ–¹æ³•ç”¨æ¥æ•è·ï¼Œå‰ä¸€ä¸ª<code>catch</code>æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ã€‚</p>
<h2 id="Promise-all"><a href="#Promise-all" class="headerlink" title="Promise.all()"></a>Promise.all()</h2><p><code>Promise.all</code>æ–¹æ³•ç”¨äºå°†å¤šä¸ªPromiseå®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.all([p1, p2, p3]);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Promise.all</code>æ–¹æ³•æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œ<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>éƒ½æ˜¯Promiseå¯¹è±¡çš„å®ä¾‹ï¼Œå¦‚æœä¸æ˜¯ï¼Œå°±ä¼šå…ˆè°ƒç”¨ä¸‹é¢è®²åˆ°çš„<code>Promise.resolve</code>æ–¹æ³•ï¼Œå°†å‚æ•°è½¬ä¸ºPromiseå®ä¾‹ï¼Œå†è¿›ä¸€æ­¥å¤„ç†ã€‚ï¼ˆ<code>Promise.all</code>æ–¹æ³•çš„å‚æ•°å¯ä»¥ä¸æ˜¯æ•°ç»„ï¼Œä½†å¿…é¡»å…·æœ‰Iteratoræ¥å£ï¼Œä¸”è¿”å›çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯Promiseå®ä¾‹ã€‚ï¼‰</p>
<p><code>p</code>çš„çŠ¶æ€ç”±<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>å†³å®šï¼Œåˆ†æˆä¸¤ç§æƒ…å†µã€‚</p>
<p>ï¼ˆ1ï¼‰åªæœ‰<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>çš„çŠ¶æ€éƒ½å˜æˆ<code>fulfilled</code>ï¼Œ<code>p</code>çš„çŠ¶æ€æ‰ä¼šå˜æˆ<code>fulfilled</code>ï¼Œæ­¤æ—¶<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>çš„è¿”å›å€¼ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°ã€‚</p>
<p>ï¼ˆ2ï¼‰åªè¦<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>ä¹‹ä¸­æœ‰ä¸€ä¸ªè¢«<code>rejected</code>ï¼Œ<code>p</code>çš„çŠ¶æ€å°±å˜æˆ<code>rejected</code>ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªè¢«<code>reject</code>çš„å®ä¾‹çš„è¿”å›å€¼ï¼Œä¼šä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ç”Ÿæˆä¸€ä¸ªPromiseå¯¹è±¡çš„æ•°ç»„</span></div><div class="line"><span class="keyword">var</span> promises = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> getJSON(<span class="string">"/post/"</span> + id + <span class="string">".json"</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Promise</span>.all(promises).then(<span class="function"><span class="keyword">function</span> (<span class="params">posts</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">reason</span>)</span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>promises</code>æ˜¯åŒ…å«6ä¸ªPromiseå®ä¾‹çš„æ•°ç»„ï¼Œåªæœ‰è¿™6ä¸ªå®ä¾‹çš„çŠ¶æ€éƒ½å˜æˆ<code>fulfilled</code>ï¼Œæˆ–è€…å…¶ä¸­æœ‰ä¸€ä¸ªå˜ä¸º<code>rejected</code>ï¼Œæ‰ä¼šè°ƒç”¨<code>Promise.all</code>æ–¹æ³•åé¢çš„å›è°ƒå‡½æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> databasePromise = connectDatabase();</div><div class="line"></div><div class="line"><span class="keyword">const</span> booksPromise = databaseProimse</div><div class="line">  .then(findAllBooks);</div><div class="line"></div><div class="line"><span class="keyword">const</span> userPromise = databasePromise</div><div class="line">  .then(getCurrentUser);</div><div class="line"></div><div class="line"><span class="built_in">Promise</span>.all([</div><div class="line">  booksPromise,</div><div class="line">  userPromise</div><div class="line">])</div><div class="line">.then(<span class="function">(<span class="params">[books, user]</span>) =&gt;</span> pickTopRecommentations(books, user));</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>booksPromise</code>å’Œ<code>userPromise</code>æ˜¯ä¸¤ä¸ªå¼‚æ­¥æ“ä½œï¼Œåªæœ‰ç­‰åˆ°å®ƒä»¬çš„ç»“æœéƒ½è¿”å›äº†ï¼Œæ‰ä¼šè§¦å‘<code>pickTopRecommentations</code>è¿™ä¸ªå›è°ƒå‡½æ•°ã€‚</p>
<h2 id="Promise-race"><a href="#Promise-race" class="headerlink" title="Promise.race()"></a>Promise.race()</h2><p><code>Promise.race</code>æ–¹æ³•åŒæ ·æ˜¯å°†å¤šä¸ªPromiseå®ä¾‹ï¼ŒåŒ…è£…æˆä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.race([p1, p2, p3]);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦<code>p1</code>ã€<code>p2</code>ã€<code>p3</code>ä¹‹ä¸­æœ‰ä¸€ä¸ªå®ä¾‹ç‡å…ˆæ”¹å˜çŠ¶æ€ï¼Œ<code>p</code>çš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚é‚£ä¸ªç‡å…ˆæ”¹å˜çš„ Promise å®ä¾‹çš„è¿”å›å€¼ï¼Œå°±ä¼ é€’ç»™<code>p</code>çš„å›è°ƒå‡½æ•°ã€‚</p>
<p><code>Promise.race</code>æ–¹æ³•çš„å‚æ•°ä¸<code>Promise.all</code>æ–¹æ³•ä¸€æ ·ï¼Œå¦‚æœä¸æ˜¯ Promise å®ä¾‹ï¼Œå°±ä¼šå…ˆè°ƒç”¨ä¸‹é¢è®²åˆ°çš„<code>Promise.resolve</code>æ–¹æ³•ï¼Œå°†å‚æ•°è½¬ä¸º Promise å®ä¾‹ï¼Œå†è¿›ä¸€æ­¥å¤„ç†ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œå¦‚æœæŒ‡å®šæ—¶é—´å†…æ²¡æœ‰è·å¾—ç»“æœï¼Œå°±å°†Promiseçš„çŠ¶æ€å˜ä¸º<code>reject</code>ï¼Œå¦åˆ™å˜ä¸º<code>resolve</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.race([</div><div class="line">  fetch(<span class="string">'/resource-that-may-take-a-while'</span>),</div><div class="line">  <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'request timeout'</span>)), <span class="number">5000</span>)</div><div class="line">  &#125;)</div><div class="line">])</div><div class="line">p.then(<span class="function"><span class="params">response</span> =&gt;</span> <span class="built_in">console</span>.log(response))</div><div class="line">p.catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.log(error))</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ5ç§’ä¹‹å†…<code>fetch</code>æ–¹æ³•æ— æ³•è¿”å›ç»“æœï¼Œå˜é‡<code>p</code>çš„çŠ¶æ€å°±ä¼šå˜ä¸º<code>rejected</code>ï¼Œä»è€Œè§¦å‘<code>catch</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ã€‚</p>
<h2 id="Promise-resolve"><a href="#Promise-resolve" class="headerlink" title="Promise.resolve()"></a>Promise.resolve()</h2><p>æœ‰æ—¶éœ€è¦å°†ç°æœ‰å¯¹è±¡è½¬ä¸ºPromiseå¯¹è±¡ï¼Œ<code>Promise.resolve</code>æ–¹æ³•å°±èµ·åˆ°è¿™ä¸ªä½œç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> jsPromise = <span class="built_in">Promise</span>.resolve($.ajax(<span class="string">'/whatever.json'</span>));</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†jQueryç”Ÿæˆçš„<code>deferred</code>å¯¹è±¡ï¼Œè½¬ä¸ºä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ã€‚</p>
<p><code>Promise.resolve</code>ç­‰ä»·äºä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.resolve(<span class="string">'foo'</span>)</div><div class="line"><span class="comment">// ç­‰ä»·äº</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> resolve(<span class="string">'foo'</span>))</div></pre></td></tr></table></figure>
<p><code>Promise.resolve</code>æ–¹æ³•çš„å‚æ•°åˆ†æˆå››ç§æƒ…å†µã€‚</p>
<p><strong>ï¼ˆ1ï¼‰å‚æ•°æ˜¯ä¸€ä¸ªPromiseå®ä¾‹</strong></p>
<p>å¦‚æœå‚æ•°æ˜¯Promiseå®ä¾‹ï¼Œé‚£ä¹ˆ<code>Promise.resolve</code>å°†ä¸åšä»»ä½•ä¿®æ”¹ã€åŸå°ä¸åŠ¨åœ°è¿”å›è¿™ä¸ªå®ä¾‹ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰å‚æ•°æ˜¯ä¸€ä¸ª<code>thenable</code>å¯¹è±¡</strong></p>
<p><code>thenable</code>å¯¹è±¡æŒ‡çš„æ˜¯å…·æœ‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> thenable = &#123;</div><div class="line">  <span class="attr">then</span>: <span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    resolve(<span class="number">42</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><code>Promise.resolve</code>æ–¹æ³•ä¼šå°†è¿™ä¸ªå¯¹è±¡è½¬ä¸ºPromiseå¯¹è±¡ï¼Œç„¶åå°±ç«‹å³æ‰§è¡Œ<code>thenable</code>å¯¹è±¡çš„<code>then</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> thenable = &#123;</div><div class="line">  <span class="attr">then</span>: <span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    resolve(<span class="number">42</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> p1 = <span class="built_in">Promise</span>.resolve(thenable);</div><div class="line">p1.then(<span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(value);  <span class="comment">// 42</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>thenable</code>å¯¹è±¡çš„<code>then</code>æ–¹æ³•æ‰§è¡Œåï¼Œå¯¹è±¡<code>p1</code>çš„çŠ¶æ€å°±å˜ä¸º<code>resolved</code>ï¼Œä»è€Œç«‹å³æ‰§è¡Œæœ€åé‚£ä¸ª<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°ï¼Œè¾“å‡º42ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰å‚æ•°ä¸æ˜¯å…·æœ‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œæˆ–æ ¹æœ¬å°±ä¸æ˜¯å¯¹è±¡</strong></p>
<p>å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªåŸå§‹å€¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªä¸å…·æœ‰<code>then</code>æ–¹æ³•çš„å¯¹è±¡ï¼Œåˆ™<code>Promise.resolve</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡ï¼ŒçŠ¶æ€ä¸º<code>Resolved</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve(<span class="string">'Hello'</span>);</div><div class="line"></div><div class="line">p.then(<span class="function"><span class="keyword">function</span> (<span class="params">s</span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(s)</div><div class="line">&#125;);</div><div class="line"><span class="comment">// Hello</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ç”Ÿæˆä¸€ä¸ªæ–°çš„Promiseå¯¹è±¡çš„å®ä¾‹<code>p</code>ã€‚ç”±äºå­—ç¬¦ä¸²<code>Hello</code>ä¸å±äºå¼‚æ­¥æ“ä½œï¼ˆåˆ¤æ–­æ–¹æ³•æ˜¯å®ƒä¸æ˜¯å…·æœ‰thenæ–¹æ³•çš„å¯¹è±¡ï¼‰ï¼Œè¿”å›Promiseå®ä¾‹çš„çŠ¶æ€ä»ä¸€ç”Ÿæˆå°±æ˜¯<code>Resolved</code>ï¼Œæ‰€ä»¥å›è°ƒå‡½æ•°ä¼šç«‹å³æ‰§è¡Œã€‚<code>Promise.resolve</code>æ–¹æ³•çš„å‚æ•°ï¼Œä¼šåŒæ—¶ä¼ ç»™å›è°ƒå‡½æ•°ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰ä¸å¸¦æœ‰ä»»ä½•å‚æ•°</strong></p>
<p><code>Promise.resolve</code>æ–¹æ³•å…è®¸è°ƒç”¨æ—¶ä¸å¸¦å‚æ•°ï¼Œç›´æ¥è¿”å›ä¸€ä¸ª<code>Resolved</code>çŠ¶æ€çš„Promiseå¯¹è±¡ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœå¸Œæœ›å¾—åˆ°ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„æ–¹æ³•å°±æ˜¯ç›´æ¥è°ƒç”¨<code>Promise.resolve</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.resolve();</div><div class="line"></div><div class="line">p.then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„å˜é‡<code>p</code>å°±æ˜¯ä¸€ä¸ªPromiseå¯¹è±¡ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç«‹å³<code>resolve</code>çš„Promiseå¯¹è±¡ï¼Œæ˜¯åœ¨æœ¬è½®â€œäº‹ä»¶å¾ªç¯â€ï¼ˆevent loopï¼‰çš„ç»“æŸæ—¶ï¼Œè€Œä¸æ˜¯åœ¨ä¸‹ä¸€è½®â€œäº‹ä»¶å¾ªç¯â€çš„å¼€å§‹æ—¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'three'</span>);</div><div class="line">&#125;, <span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="built_in">Promise</span>.resolve().then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'two'</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'one'</span>);</div><div class="line"></div><div class="line"><span class="comment">// one</span></div><div class="line"><span class="comment">// two</span></div><div class="line"><span class="comment">// three</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>setTimeout(fn, 0)</code>åœ¨ä¸‹ä¸€è½®â€œäº‹ä»¶å¾ªç¯â€å¼€å§‹æ—¶æ‰§è¡Œï¼Œ<code>Promise.resolve()</code>åœ¨æœ¬è½®â€œäº‹ä»¶å¾ªç¯â€ç»“æŸæ—¶æ‰§è¡Œï¼Œ<code>console.log(â€™oneâ€˜)</code>åˆ™æ˜¯ç«‹å³æ‰§è¡Œï¼Œå› æ­¤æœ€å…ˆè¾“å‡ºã€‚</p>
<h2 id="Promise-reject"><a href="#Promise-reject" class="headerlink" title="Promise.reject()"></a>Promise.reject()</h2><p><code>Promise.reject(reason)</code>æ–¹æ³•ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°çš„ Promise å®ä¾‹ï¼Œè¯¥å®ä¾‹çš„çŠ¶æ€ä¸º<code>rejected</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="built_in">Promise</span>.reject(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> reject(<span class="string">'å‡ºé”™äº†'</span>))</div><div class="line"></div><div class="line">p.then(<span class="literal">null</span>, <span class="function"><span class="keyword">function</span> (<span class="params">s</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(s)</div><div class="line">&#125;);</div><div class="line"><span class="comment">// å‡ºé”™äº†</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ç”Ÿæˆä¸€ä¸ªPromiseå¯¹è±¡çš„å®ä¾‹<code>p</code>ï¼ŒçŠ¶æ€ä¸º<code>rejected</code>ï¼Œå›è°ƒå‡½æ•°ä¼šç«‹å³æ‰§è¡Œã€‚</p>
<p>æ³¨æ„ï¼Œ<code>Promise.reject()</code>æ–¹æ³•çš„å‚æ•°ï¼Œä¼šåŸå°ä¸åŠ¨åœ°ä½œä¸º<code>reject</code>çš„ç†ç”±ï¼Œå˜æˆåç»­æ–¹æ³•çš„å‚æ•°ã€‚è¿™ä¸€ç‚¹ä¸<code>Promise.resolve</code>æ–¹æ³•ä¸ä¸€è‡´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> thenable = &#123;</div><div class="line">  then(resolve, reject) &#123;</div><div class="line">    reject(<span class="string">'å‡ºé”™äº†'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Promise</span>.reject(thenable)</div><div class="line">.catch(<span class="function"><span class="params">e</span> =&gt;</span> &#123;</div><div class="line">  <span class="built_in">console</span>.log(e === thenable)</div><div class="line">&#125;)</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Promise.reject</code>æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ª<code>thenable</code>å¯¹è±¡ï¼Œæ‰§è¡Œä»¥åï¼Œåé¢<code>catch</code>æ–¹æ³•çš„å‚æ•°ä¸æ˜¯<code>reject</code>æŠ›å‡ºçš„â€œå‡ºé”™äº†â€è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œæ˜¯<code>thenable</code>å¯¹è±¡ã€‚</p>
<h2 id="ä¸¤ä¸ªæœ‰ç”¨çš„é™„åŠ æ–¹æ³•"><a href="#ä¸¤ä¸ªæœ‰ç”¨çš„é™„åŠ æ–¹æ³•" class="headerlink" title="ä¸¤ä¸ªæœ‰ç”¨çš„é™„åŠ æ–¹æ³•"></a>ä¸¤ä¸ªæœ‰ç”¨çš„é™„åŠ æ–¹æ³•</h2><p>ES6çš„Promise APIæä¾›çš„æ–¹æ³•ä¸æ˜¯å¾ˆå¤šï¼Œæœ‰äº›æœ‰ç”¨çš„æ–¹æ³•å¯ä»¥è‡ªå·±éƒ¨ç½²ã€‚ä¸‹é¢ä»‹ç»å¦‚ä½•éƒ¨ç½²ä¸¤ä¸ªä¸åœ¨ES6ä¹‹ä¸­ã€ä½†å¾ˆæœ‰ç”¨çš„æ–¹æ³•ã€‚</p>
<h3 id="done"><a href="#done" class="headerlink" title="done()"></a>done()</h3><p>Promiseå¯¹è±¡çš„å›è°ƒé“¾ï¼Œä¸ç®¡ä»¥<code>then</code>æ–¹æ³•æˆ–<code>catch</code>æ–¹æ³•ç»“å°¾ï¼Œè¦æ˜¯æœ€åä¸€ä¸ªæ–¹æ³•æŠ›å‡ºé”™è¯¯ï¼Œéƒ½æœ‰å¯èƒ½æ— æ³•æ•æ‰åˆ°ï¼ˆå› ä¸ºPromiseå†…éƒ¨çš„é”™è¯¯ä¸ä¼šå†’æ³¡åˆ°å…¨å±€ï¼‰ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æä¾›ä¸€ä¸ª<code>done</code>æ–¹æ³•ï¼Œæ€»æ˜¯å¤„äºå›è°ƒé“¾çš„å°¾ç«¯ï¼Œä¿è¯æŠ›å‡ºä»»ä½•å¯èƒ½å‡ºç°çš„é”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">asyncFunc()</div><div class="line">  .then(f1)</div><div class="line">  .catch(r1)</div><div class="line">  .then(f2)</div><div class="line">  .done();</div></pre></td></tr></table></figure>
<p>å®ƒçš„å®ç°ä»£ç ç›¸å½“ç®€å•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.prototype.done = <span class="function"><span class="keyword">function</span> (<span class="params">onFulfilled, onRejected</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.then(onFulfilled, onRejected)</div><div class="line">    .catch(<span class="function"><span class="keyword">function</span> (<span class="params">reason</span>) </span>&#123;</div><div class="line">      <span class="comment">// æŠ›å‡ºä¸€ä¸ªå…¨å±€é”™è¯¯</span></div><div class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="keyword">throw</span> reason &#125;, <span class="number">0</span>);</div><div class="line">    &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢ä»£ç å¯è§ï¼Œ<code>done</code>æ–¹æ³•çš„ä½¿ç”¨ï¼Œå¯ä»¥åƒ<code>then</code>æ–¹æ³•é‚£æ ·ç”¨ï¼Œæä¾›<code>Fulfilled</code>å’Œ<code>Rejected</code>çŠ¶æ€çš„å›è°ƒå‡½æ•°ï¼Œä¹Ÿå¯ä»¥ä¸æä¾›ä»»ä½•å‚æ•°ã€‚ä½†ä¸ç®¡æ€æ ·ï¼Œ<code>done</code>éƒ½ä¼šæ•æ‰åˆ°ä»»ä½•å¯èƒ½å‡ºç°çš„é”™è¯¯ï¼Œå¹¶å‘å…¨å±€æŠ›å‡ºã€‚</p>
<h3 id="finally"><a href="#finally" class="headerlink" title="finally()"></a>finally()</h3><p><code>finally</code>æ–¹æ³•ç”¨äºæŒ‡å®šä¸ç®¡Promiseå¯¹è±¡æœ€åçŠ¶æ€å¦‚ä½•ï¼Œéƒ½ä¼šæ‰§è¡Œçš„æ“ä½œã€‚å®ƒä¸<code>done</code>æ–¹æ³•çš„æœ€å¤§åŒºåˆ«ï¼Œå®ƒæ¥å—ä¸€ä¸ªæ™®é€šçš„å›è°ƒå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œè¯¥å‡½æ•°ä¸ç®¡æ€æ ·éƒ½å¿…é¡»æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ŒæœåŠ¡å™¨ä½¿ç”¨Promiseå¤„ç†è¯·æ±‚ï¼Œç„¶åä½¿ç”¨<code>finally</code>æ–¹æ³•å…³æ‰æœåŠ¡å™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">server.listen(<span class="number">0</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// run test</span></div><div class="line">  &#125;)</div><div class="line">  .finally(server.stop);</div></pre></td></tr></table></figure>
<p>å®ƒçš„å®ç°ä¹Ÿå¾ˆç®€å•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.prototype.finally = <span class="function"><span class="keyword">function</span> (<span class="params">callback</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> P = <span class="keyword">this</span>.constructor;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.then(</div><div class="line">    <span class="function"><span class="params">value</span>  =&gt;</span> P.resolve(callback()).then(<span class="function"><span class="params">()</span> =&gt;</span> value),</div><div class="line">    reason =&gt; P.resolve(callback()).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123; <span class="keyword">throw</span> reason &#125;)</div><div class="line">  );</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸ç®¡å‰é¢çš„Promiseæ˜¯<code>fulfilled</code>è¿˜æ˜¯<code>rejected</code>ï¼Œéƒ½ä¼šæ‰§è¡Œå›è°ƒå‡½æ•°<code>callback</code>ã€‚</p>
<p>æ›´å¤šITæŠ€æœ¯åˆ†äº«å°½åœ¨ ğŸ”—<a href="http://microzz.com">æ¶µæœˆå¤©-microzz.com</a></p>
<h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><h3 id="åŠ è½½å›¾ç‰‡"><a href="#åŠ è½½å›¾ç‰‡" class="headerlink" title="åŠ è½½å›¾ç‰‡"></a>åŠ è½½å›¾ç‰‡</h3><p>æˆ‘ä»¬å¯ä»¥å°†å›¾ç‰‡çš„åŠ è½½å†™æˆä¸€ä¸ª<code>Promise</code>ï¼Œä¸€æ—¦åŠ è½½å®Œæˆï¼Œ<code>Promise</code>çš„çŠ¶æ€å°±å‘ç”Ÿå˜åŒ–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> preloadImage = <span class="function"><span class="keyword">function</span> (<span class="params">path</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> image = <span class="keyword">new</span> Image();</div><div class="line">    image.onload  = resolve;</div><div class="line">    image.onerror = reject;</div><div class="line">    image.src = path;</div><div class="line">  &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="Generatorå‡½æ•°ä¸Promiseçš„ç»“åˆ"><a href="#Generatorå‡½æ•°ä¸Promiseçš„ç»“åˆ" class="headerlink" title="Generatorå‡½æ•°ä¸Promiseçš„ç»“åˆ"></a>Generatorå‡½æ•°ä¸Promiseçš„ç»“åˆ</h3><p>ä½¿ç”¨Generatorå‡½æ•°ç®¡ç†æµç¨‹ï¼Œé‡åˆ°å¼‚æ­¥æ“ä½œçš„æ—¶å€™ï¼Œé€šå¸¸è¿”å›ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFoo</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>)</span>&#123;</div><div class="line">    resolve(<span class="string">'foo'</span>);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">var</span> foo = <span class="keyword">yield</span> getFoo();</div><div class="line">    <span class="built_in">console</span>.log(foo);</div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="built_in">console</span>.log(e);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">run</span> (<span class="params">generator</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> it = generator();</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">go</span>(<span class="params">result</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (result.done) <span class="keyword">return</span> result.value;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> result.value.then(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> go(it.next(value));</div><div class="line">    &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> go(it.throw(error));</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  go(it.next());</div><div class="line">&#125;</div><div class="line"></div><div class="line">run(g);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„Generatorå‡½æ•°<code>g</code>ä¹‹ä¸­ï¼Œæœ‰ä¸€ä¸ªå¼‚æ­¥æ“ä½œ<code>getFoo</code>ï¼Œå®ƒè¿”å›çš„å°±æ˜¯ä¸€ä¸ª<code>Promise</code>å¯¹è±¡ã€‚å‡½æ•°<code>run</code>ç”¨æ¥å¤„ç†è¿™ä¸ª<code>Promise</code>å¯¹è±¡ï¼Œå¹¶è°ƒç”¨ä¸‹ä¸€ä¸ª<code>next</code>æ–¹æ³•ã€‚</p>
<h2 id="Promise-try"><a href="#Promise-try" class="headerlink" title="Promise.try()"></a>Promise.try()</h2><p>å®é™…å¼€å‘ä¸­ï¼Œç»å¸¸é‡åˆ°ä¸€ç§æƒ…å†µï¼šä¸çŸ¥é“æˆ–è€…ä¸æƒ³åŒºåˆ†ï¼Œå‡½æ•°<code>f</code>æ˜¯åŒæ­¥å‡½æ•°è¿˜æ˜¯å¼‚æ­¥æ“ä½œï¼Œä½†æ˜¯æƒ³ç”¨ Promise æ¥å¤„ç†å®ƒã€‚å› ä¸ºè¿™æ ·å°±å¯ä»¥ä¸ç®¡<code>f</code>æ˜¯å¦åŒ…å«å¼‚æ­¥æ“ä½œï¼Œéƒ½ç”¨<code>then</code>æ–¹æ³•æŒ‡å®šä¸‹ä¸€æ­¥æµç¨‹ï¼Œç”¨<code>catch</code>æ–¹æ³•å¤„ç†<code>f</code>æŠ›å‡ºçš„é”™è¯¯ã€‚ä¸€èˆ¬å°±ä¼šé‡‡ç”¨ä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.resolve().then(f)</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„å†™æ³•æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯å¦‚æœ<code>f</code>æ˜¯åŒæ­¥å‡½æ•°ï¼Œé‚£ä¹ˆå®ƒä¼šåœ¨æœ¬è½®äº‹ä»¶å¾ªç¯çš„æœ«å°¾æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</div><div class="line"><span class="built_in">Promise</span>.resolve().then(f);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</div><div class="line"><span class="comment">// next</span></div><div class="line"><span class="comment">// now</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>f</code>æ˜¯åŒæ­¥çš„ï¼Œä½†æ˜¯ç”¨ Promise åŒ…è£…äº†ä»¥åï¼Œå°±å˜æˆå¼‚æ­¥æ‰§è¡Œäº†ã€‚</p>
<p>é‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§æ–¹æ³•ï¼Œè®©åŒæ­¥å‡½æ•°åŒæ­¥æ‰§è¡Œï¼Œå¼‚æ­¥å‡½æ•°å¼‚æ­¥æ‰§è¡Œï¼Œå¹¶ä¸”è®©å®ƒä»¬å…·æœ‰ç»Ÿä¸€çš„ API å‘¢ï¼Ÿå›ç­”æ˜¯å¯ä»¥çš„ï¼Œå¹¶ä¸”è¿˜æœ‰ä¸¤ç§å†™æ³•ã€‚ç¬¬ä¸€ç§å†™æ³•æ˜¯ç”¨<code>async</code>å‡½æ•°æ¥å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</div><div class="line"><span class="function">(<span class="params"><span class="keyword">async</span> (</span>) =&gt;</span> f())();</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</div><div class="line"><span class="comment">// now</span></div><div class="line"><span class="comment">// next</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒè¡Œæ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„åŒ¿åå‡½æ•°ï¼Œä¼šç«‹å³æ‰§è¡Œé‡Œé¢çš„<code>async</code>å‡½æ•°ï¼Œå› æ­¤å¦‚æœ<code>f</code>æ˜¯åŒæ­¥çš„ï¼Œå°±ä¼šå¾—åˆ°åŒæ­¥çš„ç»“æœï¼›å¦‚æœ<code>f</code>æ˜¯å¼‚æ­¥çš„ï¼Œå°±å¯ä»¥ç”¨<code>then</code>æŒ‡å®šä¸‹ä¸€æ­¥ï¼Œå°±åƒä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">async</span> () =&gt; f())()</div><div class="line">.then(...)</div></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>async () =&gt; f()</code>ä¼šåƒæ‰<code>f()</code>æŠ›å‡ºçš„é”™è¯¯ã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³æ•è·é”™è¯¯ï¼Œè¦ä½¿ç”¨<code>promise.catch</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">async</span> () =&gt; f())()</div><div class="line">.then(...)</div><div class="line">.catch(...)</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§å†™æ³•æ˜¯ä½¿ç”¨<code>new Promise()</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</div><div class="line">(</div><div class="line">  <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(</div><div class="line">    <span class="function"><span class="params">resolve</span> =&gt;</span> resolve(f())</div><div class="line">  )</div><div class="line">)();</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</div><div class="line"><span class="comment">// now</span></div><div class="line"><span class="comment">// next</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¹Ÿæ˜¯ä½¿ç”¨ç«‹å³æ‰§è¡Œçš„åŒ¿åå‡½æ•°ï¼Œæ‰§è¡Œ<code>new Promise()</code>ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒåŒæ­¥å‡½æ•°ä¹Ÿæ˜¯åŒæ­¥æ‰§è¡Œçš„ã€‚</p>
<p>é‰´äºè¿™æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œæ‰€ä»¥ç°åœ¨æœ‰ä¸€ä¸ª<a href="https://github.com/ljharb/proposal-promise-try" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œæä¾›<code>Promise.try</code>æ–¹æ³•æ›¿ä»£ä¸Šé¢çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'now'</span>);</div><div class="line"><span class="built_in">Promise</span>.try(f);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'next'</span>);</div><div class="line"><span class="comment">// now</span></div><div class="line"><span class="comment">// next</span></div></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼Œ<code>Promise.try</code>å­˜åœ¨å·²ä¹…ï¼ŒPromise åº“<a href="http://bluebirdjs.com/docs/api/promise.try.html" target="_blank" rel="external"><code>Bluebird</code></a>ã€<a href="https://github.com/kriskowal/q/wiki/API-Reference#promisefcallargs" target="_blank" rel="external"><code>Q</code></a>å’Œ<a href="https://github.com/cujojs/when/blob/master/docs/api.md#whentry" target="_blank" rel="external"><code>when</code></a>ï¼Œæ—©å°±æä¾›äº†è¿™ä¸ªæ–¹æ³•ã€‚</p>
<p>ç”±äº<code>Promise.try</code>ä¸ºæ‰€æœ‰æ“ä½œæä¾›äº†ç»Ÿä¸€çš„å¤„ç†æœºåˆ¶ï¼Œæ‰€ä»¥å¦‚æœæƒ³ç”¨<code>then</code>æ–¹æ³•ç®¡ç†æµç¨‹ï¼Œæœ€å¥½éƒ½ç”¨<code>Promise.try</code>åŒ…è£…ä¸€ä¸‹ã€‚è¿™æ ·æœ‰<a href="http://cryto.net/~joepie91/blog/2016/05/11/what-is-promise-try-and-why-does-it-matter/" target="_blank" rel="external">è®¸å¤šå¥½å¤„</a>ï¼Œå…¶ä¸­ä¸€ç‚¹å°±æ˜¯å¯ä»¥æ›´å¥½åœ°ç®¡ç†å¼‚å¸¸ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUsername</span>(<span class="params">userId</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> database.users.get(&#123;<span class="attr">id</span>: userId&#125;)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">user</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> user.name;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>database.users.get()</code>è¿”å›ä¸€ä¸ª Promise å¯¹è±¡ï¼Œå¦‚æœæŠ›å‡ºå¼‚æ­¥é”™è¯¯ï¼Œå¯ä»¥ç”¨<code>catch</code>æ–¹æ³•æ•è·ï¼Œå°±åƒä¸‹é¢è¿™æ ·å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">database.users.get(&#123;<span class="attr">id</span>: userId&#125;)</div><div class="line">.then(...)</div><div class="line">.catch(...)</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯<code>database.users.get()</code>å¯èƒ½è¿˜ä¼šæŠ›å‡ºåŒæ­¥é”™è¯¯ï¼ˆæ¯”å¦‚æ•°æ®åº“è¿æ¥é”™è¯¯ï¼Œå…·ä½“è¦çœ‹å®ç°æ–¹æ³•ï¼‰ï¼Œè¿™æ—¶ä½ å°±ä¸å¾—ä¸ç”¨<code>try...catch</code>å»æ•è·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  database.users.get(&#123;<span class="attr">id</span>: userId&#125;)</div><div class="line">  .then(...)</div><div class="line">  .catch(...)</div><div class="line">&#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™æ ·çš„å†™æ³•å°±å¾ˆç¬¨æ‹™äº†ï¼Œè¿™æ—¶å°±å¯ä»¥ç»Ÿä¸€ç”¨<code>promise.catch()</code>æ•è·æ‰€æœ‰åŒæ­¥å’Œå¼‚æ­¥çš„é”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.try(database.users.get(&#123;<span class="attr">id</span>: userId&#125;))</div><div class="line">  .then(...)</div><div class="line">  .catch(...)</div></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼Œ<code>Promise.try</code>å°±æ˜¯æ¨¡æ‹Ÿ<code>try</code>ä»£ç å—ï¼Œå°±åƒ<code>promise.catch</code>æ¨¡æ‹Ÿçš„æ˜¯<code>catch</code>ä»£ç å—ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Promiseå¯¹è±¡&quot;&gt;&lt;a href=&quot;#Promiseå¯¹è±¡&quot; class=&quot;headerlink&quot; title=&quot;Promiseå¯¹è±¡&quot;&gt;&lt;/a&gt;Promiseå¯¹è±¡&lt;/h1&gt;&lt;h2 id=&quot;Promiseçš„å«ä¹‰&quot;&gt;&lt;a href=&quot;#Promiseçš„å«ä¹‰&quot; cla
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Promise" scheme="http://microzz.com/tags/Promise/"/>
    
  </entry>
  
  <entry>
    <title>Generator å‡½æ•°</title>
    <link href="http://microzz.com/2017/01/13/generator/"/>
    <id>http://microzz.com/2017/01/13/generator/</id>
    <published>2017-01-13T06:51:58.000Z</published>
    <updated>2017-01-13T06:54:51.049Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Generator-å‡½æ•°"><a href="#Generator-å‡½æ•°" class="headerlink" title="Generator å‡½æ•°"></a>Generator å‡½æ•°</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><p>Generatorå‡½æ•°æ˜¯ES6æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆï¼Œè¯­æ³•è¡Œä¸ºä¸ä¼ ç»Ÿå‡½æ•°å®Œå…¨ä¸åŒã€‚æœ¬ç« è¯¦ç»†ä»‹ç»Generatorå‡½æ•°çš„è¯­æ³•å’ŒAPIï¼Œå®ƒçš„å¼‚æ­¥ç¼–ç¨‹åº”ç”¨è¯·çœ‹ã€Šå¼‚æ­¥æ“ä½œã€‹ä¸€ç« ã€‚</p>
<p>Generatorå‡½æ•°æœ‰å¤šç§ç†è§£è§’åº¦ã€‚ä»è¯­æ³•ä¸Šï¼Œé¦–å…ˆå¯ä»¥æŠŠå®ƒç†è§£æˆï¼ŒGeneratorå‡½æ•°æ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå°è£…äº†å¤šä¸ªå†…éƒ¨çŠ¶æ€ã€‚</p>
<p>æ‰§è¡ŒGeneratorå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒGeneratorå‡½æ•°é™¤äº†çŠ¶æ€æœºï¼Œè¿˜æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ã€‚è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œå¯ä»¥ä¾æ¬¡éå†Generatorå‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚</p>
<p>å½¢å¼ä¸Šï¼ŒGeneratorå‡½æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯æœ‰ä¸¤ä¸ªç‰¹å¾ã€‚ä¸€æ˜¯ï¼Œ<code>function</code>å…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼›äºŒæ˜¯ï¼Œå‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨<code>yield</code>è¯­å¥ï¼Œå®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ï¼ˆyieldè¯­å¥åœ¨è‹±è¯­é‡Œçš„æ„æ€å°±æ˜¯â€œäº§å‡ºâ€ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">helloWorldGenerator</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'hello'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'world'</span>;</div><div class="line">  <span class="keyword">return</span> <span class="string">'ending'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> hw = helloWorldGenerator();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªGeneratorå‡½æ•°<code>helloWorldGenerator</code>ï¼Œå®ƒå†…éƒ¨æœ‰ä¸¤ä¸ª<code>yield</code>è¯­å¥â€œhelloâ€å’Œâ€œworldâ€ï¼Œå³è¯¥å‡½æ•°æœ‰ä¸‰ä¸ªçŠ¶æ€ï¼šhelloï¼Œworldå’Œreturnè¯­å¥ï¼ˆç»“æŸæ‰§è¡Œï¼‰ã€‚</p>
<p>ç„¶åï¼ŒGeneratorå‡½æ•°çš„è°ƒç”¨æ–¹æ³•ä¸æ™®é€šå‡½æ•°ä¸€æ ·ï¼Œä¹Ÿæ˜¯åœ¨å‡½æ•°ååé¢åŠ ä¸Šä¸€å¯¹åœ†æ‹¬å·ã€‚ä¸åŒçš„æ˜¯ï¼Œè°ƒç”¨Generatorå‡½æ•°åï¼Œè¯¥å‡½æ•°å¹¶ä¸æ‰§è¡Œï¼Œè¿”å›çš„ä¹Ÿä¸æ˜¯å‡½æ•°è¿è¡Œç»“æœï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘å†…éƒ¨çŠ¶æ€çš„æŒ‡é’ˆå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä¸Šä¸€ç« ä»‹ç»çš„éå†å™¨å¯¹è±¡ï¼ˆIterator Objectï¼‰ã€‚</p>
<p>ä¸‹ä¸€æ­¥ï¼Œå¿…é¡»è°ƒç”¨éå†å™¨å¯¹è±¡çš„nextæ–¹æ³•ï¼Œä½¿å¾—æŒ‡é’ˆç§»å‘ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œå†…éƒ¨æŒ‡é’ˆå°±ä»å‡½æ•°å¤´éƒ¨æˆ–ä¸Šä¸€æ¬¡åœä¸‹æ¥çš„åœ°æ–¹å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª<code>yield</code>è¯­å¥ï¼ˆæˆ–<code>return</code>è¯­å¥ï¼‰ä¸ºæ­¢ã€‚æ¢è¨€ä¹‹ï¼ŒGeneratorå‡½æ•°æ˜¯åˆ†æ®µæ‰§è¡Œçš„ï¼Œ<code>yield</code>è¯­å¥æ˜¯æš‚åœæ‰§è¡Œçš„æ ‡è®°ï¼Œè€Œ<code>next</code>æ–¹æ³•å¯ä»¥æ¢å¤æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">hw.next()</div><div class="line"><span class="comment">// &#123; value: 'hello', done: false &#125;</span></div><div class="line"></div><div class="line">hw.next()</div><div class="line"><span class="comment">// &#123; value: 'world', done: false &#125;</span></div><div class="line"></div><div class="line">hw.next()</div><div class="line"><span class="comment">// &#123; value: 'ending', done: true &#125;</span></div><div class="line"></div><div class="line">hw.next()</div><div class="line"><span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸€å…±è°ƒç”¨äº†å››æ¬¡<code>next</code>æ–¹æ³•ã€‚</p>
<p>ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼ŒGeneratorå‡½æ•°å¼€å§‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ç¬¬ä¸€ä¸ª<code>yield</code>è¯­å¥ä¸ºæ­¢ã€‚<code>next</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒçš„<code>value</code>å±æ€§å°±æ˜¯å½“å‰<code>yield</code>è¯­å¥çš„å€¼helloï¼Œ<code>done</code>å±æ€§çš„å€¼falseï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸã€‚</p>
<p>ç¬¬äºŒæ¬¡è°ƒç”¨ï¼ŒGeneratorå‡½æ•°ä»ä¸Šæ¬¡<code>yield</code>è¯­å¥åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ª<code>yield</code>è¯­å¥ã€‚<code>next</code>æ–¹æ³•è¿”å›çš„å¯¹è±¡çš„<code>value</code>å±æ€§å°±æ˜¯å½“å‰<code>yield</code>è¯­å¥çš„å€¼worldï¼Œ<code>done</code>å±æ€§çš„å€¼falseï¼Œè¡¨ç¤ºéå†è¿˜æ²¡æœ‰ç»“æŸã€‚</p>
<p>ç¬¬ä¸‰æ¬¡è°ƒç”¨ï¼ŒGeneratorå‡½æ•°ä»ä¸Šæ¬¡<code>yield</code>è¯­å¥åœä¸‹çš„åœ°æ–¹ï¼Œä¸€ç›´æ‰§è¡Œåˆ°<code>return</code>è¯­å¥ï¼ˆå¦‚æœæ²¡æœ‰returnè¯­å¥ï¼Œå°±æ‰§è¡Œåˆ°å‡½æ•°ç»“æŸï¼‰ã€‚<code>next</code>æ–¹æ³•è¿”å›çš„å¯¹è±¡çš„<code>value</code>å±æ€§ï¼Œå°±æ˜¯ç´§è·Ÿåœ¨<code>return</code>è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼ˆå¦‚æœæ²¡æœ‰<code>return</code>è¯­å¥ï¼Œåˆ™<code>value</code>å±æ€§çš„å€¼ä¸ºundefinedï¼‰ï¼Œ<code>done</code>å±æ€§çš„å€¼trueï¼Œè¡¨ç¤ºéå†å·²ç»ç»“æŸã€‚</p>
<p>ç¬¬å››æ¬¡è°ƒç”¨ï¼Œæ­¤æ—¶Generatorå‡½æ•°å·²ç»è¿è¡Œå®Œæ¯•ï¼Œ<code>next</code>æ–¹æ³•è¿”å›å¯¹è±¡çš„<code>value</code>å±æ€§ä¸ºundefinedï¼Œ<code>done</code>å±æ€§ä¸ºtrueã€‚ä»¥åå†è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œè¿”å›çš„éƒ½æ˜¯è¿™ä¸ªå€¼ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œè°ƒç”¨Generatorå‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œä»£è¡¨Generatorå‡½æ•°çš„å†…éƒ¨æŒ‡é’ˆã€‚ä»¥åï¼Œæ¯æ¬¡è°ƒç”¨éå†å™¨å¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªæœ‰ç€<code>value</code>å’Œ<code>done</code>ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚<code>value</code>å±æ€§è¡¨ç¤ºå½“å‰çš„å†…éƒ¨çŠ¶æ€çš„å€¼ï¼Œæ˜¯<code>yield</code>è¯­å¥åé¢é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼›<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦éå†ç»“æŸã€‚</p>
<p>ES6æ²¡æœ‰è§„å®šï¼Œ<code>function</code>å…³é”®å­—ä¸å‡½æ•°åä¹‹é—´çš„æ˜Ÿå·ï¼Œå†™åœ¨å“ªä¸ªä½ç½®ã€‚è¿™å¯¼è‡´ä¸‹é¢çš„å†™æ³•éƒ½èƒ½é€šè¿‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> * <span class="title">foo</span>(<span class="params">x, y</span>) </span>&#123; Â·Â·Â· &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span>(<span class="params">x, y</span>) </span>&#123; Â·Â·Â· &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params">x, y</span>) </span>&#123; Â·Â·Â· &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>*<span class="title">foo</span>(<span class="params">x, y</span>) </span>&#123; Â·Â·Â· &#125;</div></pre></td></tr></table></figure>
<p>ç”±äºGeneratorå‡½æ•°ä»ç„¶æ˜¯æ™®é€šå‡½æ•°ï¼Œæ‰€ä»¥ä¸€èˆ¬çš„å†™æ³•æ˜¯ä¸Šé¢çš„ç¬¬ä¸‰ç§ï¼Œå³æ˜Ÿå·ç´§è·Ÿåœ¨<code>function</code>å…³é”®å­—åé¢ã€‚æœ¬ä¹¦ä¹Ÿé‡‡ç”¨è¿™ç§å†™æ³•ã€‚</p>
<h3 id="yieldè¯­å¥"><a href="#yieldè¯­å¥" class="headerlink" title="yieldè¯­å¥"></a>yieldè¯­å¥</h3><p>ç”±äºGeneratorå‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œåªæœ‰è°ƒç”¨<code>next</code>æ–¹æ³•æ‰ä¼šéå†ä¸‹ä¸€ä¸ªå†…éƒ¨çŠ¶æ€ï¼Œæ‰€ä»¥å…¶å®æä¾›äº†ä¸€ç§å¯ä»¥æš‚åœæ‰§è¡Œçš„å‡½æ•°ã€‚<code>yield</code>è¯­å¥å°±æ˜¯æš‚åœæ ‡å¿—ã€‚</p>
<p>éå†å™¨å¯¹è±¡çš„<code>next</code>æ–¹æ³•çš„è¿è¡Œé€»è¾‘å¦‚ä¸‹ã€‚</p>
<p>ï¼ˆ1ï¼‰é‡åˆ°<code>yield</code>è¯­å¥ï¼Œå°±æš‚åœæ‰§è¡Œåé¢çš„æ“ä½œï¼Œå¹¶å°†ç´§è·Ÿåœ¨<code>yield</code>åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„<code>value</code>å±æ€§å€¼ã€‚</p>
<p>ï¼ˆ2ï¼‰ä¸‹ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•æ—¶ï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ª<code>yield</code>è¯­å¥ã€‚</p>
<p>ï¼ˆ3ï¼‰å¦‚æœæ²¡æœ‰å†é‡åˆ°æ–°çš„<code>yield</code>è¯­å¥ï¼Œå°±ä¸€ç›´è¿è¡Œåˆ°å‡½æ•°ç»“æŸï¼Œç›´åˆ°<code>return</code>è¯­å¥ä¸ºæ­¢ï¼Œå¹¶å°†<code>return</code>è¯­å¥åé¢çš„è¡¨è¾¾å¼çš„å€¼ï¼Œä½œä¸ºè¿”å›çš„å¯¹è±¡çš„<code>value</code>å±æ€§å€¼ã€‚</p>
<p>ï¼ˆ4ï¼‰å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰<code>return</code>è¯­å¥ï¼Œåˆ™è¿”å›çš„å¯¹è±¡çš„<code>value</code>å±æ€§å€¼ä¸º<code>undefined</code>ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>yield</code>è¯­å¥åé¢çš„è¡¨è¾¾å¼ï¼Œåªæœ‰å½“è°ƒç”¨<code>next</code>æ–¹æ³•ã€å†…éƒ¨æŒ‡é’ˆæŒ‡å‘è¯¥è¯­å¥æ—¶æ‰ä¼šæ‰§è¡Œï¼Œå› æ­¤ç­‰äºä¸ºJavaScriptæä¾›äº†æ‰‹åŠ¨çš„â€œæƒ°æ€§æ±‚å€¼â€ï¼ˆLazy Evaluationï¼‰çš„è¯­æ³•åŠŸèƒ½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span>  <span class="number">123</span> + <span class="number">456</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œyieldåé¢çš„è¡¨è¾¾å¼<code>123 + 456</code>ï¼Œä¸ä¼šç«‹å³æ±‚å€¼ï¼Œåªä¼šåœ¨<code>next</code>æ–¹æ³•å°†æŒ‡é’ˆç§»åˆ°è¿™ä¸€å¥æ—¶ï¼Œæ‰ä¼šæ±‚å€¼ã€‚</p>
<p><code>yield</code>è¯­å¥ä¸<code>return</code>è¯­å¥æ—¢æœ‰ç›¸ä¼¼ä¹‹å¤„ï¼Œä¹Ÿæœ‰åŒºåˆ«ã€‚ç›¸ä¼¼ä¹‹å¤„åœ¨äºï¼Œéƒ½èƒ½è¿”å›ç´§è·Ÿåœ¨è¯­å¥åé¢çš„é‚£ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚åŒºåˆ«åœ¨äºæ¯æ¬¡é‡åˆ°<code>yield</code>ï¼Œå‡½æ•°æš‚åœæ‰§è¡Œï¼Œä¸‹ä¸€æ¬¡å†ä»è¯¥ä½ç½®ç»§ç»­å‘åæ‰§è¡Œï¼Œè€Œ<code>return</code>è¯­å¥ä¸å…·å¤‡ä½ç½®è®°å¿†çš„åŠŸèƒ½ã€‚ä¸€ä¸ªå‡½æ•°é‡Œé¢ï¼Œåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼ˆæˆ–è€…è¯´ä¸€ä¸ªï¼‰<code>return</code>è¯­å¥ï¼Œä½†æ˜¯å¯ä»¥æ‰§è¡Œå¤šæ¬¡ï¼ˆæˆ–è€…è¯´å¤šä¸ªï¼‰<code>yield</code>è¯­å¥ã€‚æ­£å¸¸å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå› ä¸ºåªèƒ½æ‰§è¡Œä¸€æ¬¡<code>return</code>ï¼›Generatorå‡½æ•°å¯ä»¥è¿”å›ä¸€ç³»åˆ—çš„å€¼ï¼Œå› ä¸ºå¯ä»¥æœ‰ä»»æ„å¤šä¸ª<code>yield</code>ã€‚ä»å¦ä¸€ä¸ªè§’åº¦çœ‹ï¼Œä¹Ÿå¯ä»¥è¯´Generatorç”Ÿæˆäº†ä¸€ç³»åˆ—çš„å€¼ï¼Œè¿™ä¹Ÿå°±æ˜¯å®ƒçš„åç§°çš„æ¥å†ï¼ˆåœ¨è‹±è¯­ä¸­ï¼Œgeneratorè¿™ä¸ªè¯æ˜¯â€œç”Ÿæˆå™¨â€çš„æ„æ€ï¼‰ã€‚</p>
<p>Generatorå‡½æ•°å¯ä»¥ä¸ç”¨<code>yield</code>è¯­å¥ï¼Œè¿™æ—¶å°±å˜æˆäº†ä¸€ä¸ªå•çº¯çš„æš‚ç¼“æ‰§è¡Œå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'æ‰§è¡Œäº†ï¼'</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> generator = f();</div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  generator.next()</div><div class="line">&#125;, <span class="number">2000</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>f</code>å¦‚æœæ˜¯æ™®é€šå‡½æ•°ï¼Œåœ¨ä¸ºå˜é‡<code>generator</code>èµ‹å€¼æ—¶å°±ä¼šæ‰§è¡Œã€‚ä½†æ˜¯ï¼Œå‡½æ•°<code>f</code>æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ï¼Œå°±å˜æˆåªæœ‰è°ƒç”¨<code>next</code>æ–¹æ³•æ—¶ï¼Œå‡½æ•°<code>f</code>æ‰ä¼šæ‰§è¡Œã€‚</p>
<p>å¦å¤–éœ€è¦æ³¨æ„ï¼Œ<code>yield</code>è¯­å¥ä¸èƒ½ç”¨åœ¨æ™®é€šå‡½æ•°ä¸­ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">&#125;)()</div><div class="line"><span class="comment">// SyntaxError: Unexpected number</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨ä¸€ä¸ªæ™®é€šå‡½æ•°ä¸­ä½¿ç”¨<code>yield</code>è¯­å¥ï¼Œç»“æœäº§ç”Ÿä¸€ä¸ªå¥æ³•é”™è¯¯ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, [[<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>]];</div><div class="line"></div><div class="line"><span class="keyword">var</span> flat = <span class="function"><span class="keyword">function</span>* (<span class="params">a</span>) </span>&#123;</div><div class="line">  a.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> item !== <span class="string">'number'</span>) &#123;</div><div class="line">      <span class="keyword">yield</span>* flat(item);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">yield</span> item;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> f <span class="keyword">of</span> flat(arr))&#123;</div><div class="line">  <span class="built_in">console</span>.log(f);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¹Ÿä¼šäº§ç”Ÿå¥æ³•é”™è¯¯ï¼Œå› ä¸º<code>forEach</code>æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªæ™®é€šå‡½æ•°ï¼Œä½†æ˜¯åœ¨é‡Œé¢ä½¿ç”¨äº†<code>yield</code>è¯­å¥ï¼ˆè¿™ä¸ªå‡½æ•°é‡Œé¢è¿˜ä½¿ç”¨äº†<code>yield*</code>è¯­å¥ï¼Œè¿™é‡Œå¯ä»¥ä¸ç”¨ç†ä¼šï¼Œè¯¦ç»†è¯´æ˜è§åæ–‡ï¼‰ã€‚ä¸€ç§ä¿®æ”¹æ–¹æ³•æ˜¯æ”¹ç”¨<code>for</code>å¾ªç¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, [[<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>]];</div><div class="line"></div><div class="line"><span class="keyword">var</span> flat = <span class="function"><span class="keyword">function</span>* (<span class="params">a</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> length = a.length;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> item = a[i];</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> item !== <span class="string">'number'</span>) &#123;</div><div class="line">      <span class="keyword">yield</span>* flat(item);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">yield</span> item;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> f <span class="keyword">of</span> flat(arr)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(f);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1, 2, 3, 4, 5, 6</span></div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œ<code>yield</code>è¯­å¥å¦‚æœç”¨åœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¹‹ä¸­ï¼Œå¿…é¡»æ”¾åœ¨åœ†æ‹¬å·é‡Œé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(<span class="string">'Hello'</span> + <span class="keyword">yield</span>); <span class="comment">// SyntaxError</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Hello'</span> + <span class="keyword">yield</span> <span class="number">123</span>); <span class="comment">// SyntaxError</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Hello'</span> + (<span class="keyword">yield</span>)); <span class="comment">// OK</span></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Hello'</span> + (<span class="keyword">yield</span> <span class="number">123</span>)); <span class="comment">// OK</span></div></pre></td></tr></table></figure>
<p><code>yield</code>è¯­å¥ç”¨ä½œå‡½æ•°å‚æ•°æˆ–èµ‹å€¼è¡¨è¾¾å¼çš„å³è¾¹ï¼Œå¯ä»¥ä¸åŠ æ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">foo(<span class="keyword">yield</span> <span class="string">'a'</span>, <span class="keyword">yield</span> <span class="string">'b'</span>); <span class="comment">// OK</span></div><div class="line"><span class="keyword">let</span> input = <span class="keyword">yield</span>; <span class="comment">// OK</span></div></pre></td></tr></table></figure>
<h3 id="ä¸Iteratoræ¥å£çš„å…³ç³»"><a href="#ä¸Iteratoræ¥å£çš„å…³ç³»" class="headerlink" title="ä¸Iteratoræ¥å£çš„å…³ç³»"></a>ä¸Iteratoræ¥å£çš„å…³ç³»</h3><p>ä¸Šä¸€ç« è¯´è¿‡ï¼Œä»»æ„ä¸€ä¸ªå¯¹è±¡çš„<code>Symbol.iterator</code>æ–¹æ³•ï¼Œç­‰äºè¯¥å¯¹è±¡çš„éå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œè°ƒç”¨è¯¥å‡½æ•°ä¼šè¿”å›è¯¥å¯¹è±¡çš„ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚</p>
<p>ç”±äºGeneratorå‡½æ•°å°±æ˜¯éå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œå› æ­¤å¯ä»¥æŠŠGeneratorèµ‹å€¼ç»™å¯¹è±¡çš„<code>Symbol.iterator</code>å±æ€§ï¼Œä»è€Œä½¿å¾—è¯¥å¯¹è±¡å…·æœ‰Iteratoræ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myIterable = &#123;&#125;;</div><div class="line">myIterable[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">[...myIterable] <span class="comment">// [1, 2, 3]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒGeneratorå‡½æ•°èµ‹å€¼ç»™<code>Symbol.iterator</code>å±æ€§ï¼Œä»è€Œä½¿å¾—<code>myIterable</code>å¯¹è±¡å…·æœ‰äº†Iteratoræ¥å£ï¼Œå¯ä»¥è¢«<code>...</code>è¿ç®—ç¬¦éå†äº†ã€‚</p>
<p>Generatorå‡½æ•°æ‰§è¡Œåï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚è¯¥å¯¹è±¡æœ¬èº«ä¹Ÿå…·æœ‰<code>Symbol.iterator</code>å±æ€§ï¼Œæ‰§è¡Œåè¿”å›è‡ªèº«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="comment">// some code</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line"></div><div class="line">g[<span class="built_in">Symbol</span>.iterator]() === g</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>gen</code>æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ï¼Œè°ƒç”¨å®ƒä¼šç”Ÿæˆä¸€ä¸ªéå†å™¨å¯¹è±¡<code>g</code>ã€‚å®ƒçš„<code>Symbol.iterator</code>å±æ€§ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ï¼Œæ‰§è¡Œåè¿”å›å®ƒè‡ªå·±ã€‚</p>
<h2 id="nextæ–¹æ³•çš„å‚æ•°"><a href="#nextæ–¹æ³•çš„å‚æ•°" class="headerlink" title="nextæ–¹æ³•çš„å‚æ•°"></a>nextæ–¹æ³•çš„å‚æ•°</h2><p><code>yield</code>å¥æœ¬èº«æ²¡æœ‰è¿”å›å€¼ï¼Œæˆ–è€…è¯´æ€»æ˜¯è¿”å›<code>undefined</code>ã€‚<code>next</code>æ–¹æ³•å¯ä»¥å¸¦ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°å°±ä¼šè¢«å½“ä½œä¸Šä¸€ä¸ª<code>yield</code>è¯­å¥çš„è¿”å›å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; <span class="literal">true</span>; i++) &#123;</div><div class="line">    <span class="keyword">var</span> reset = <span class="keyword">yield</span> i;</div><div class="line">    <span class="keyword">if</span>(reset) &#123; i = <span class="number">-1</span>; &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = f();</div><div class="line"></div><div class="line">g.next() <span class="comment">// &#123; value: 0, done: false &#125;</span></div><div class="line">g.next() <span class="comment">// &#123; value: 1, done: false &#125;</span></div><div class="line">g.next(<span class="literal">true</span>) <span class="comment">// &#123; value: 0, done: false &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å…ˆå®šä¹‰äº†ä¸€ä¸ªå¯ä»¥æ— é™è¿è¡Œçš„ Generator å‡½æ•°<code>f</code>ï¼Œå¦‚æœ<code>next</code>æ–¹æ³•æ²¡æœ‰å‚æ•°ï¼Œæ¯æ¬¡è¿è¡Œåˆ°<code>yield</code>è¯­å¥ï¼Œå˜é‡<code>reset</code>çš„å€¼æ€»æ˜¯<code>undefined</code>ã€‚å½“<code>next</code>æ–¹æ³•å¸¦ä¸€ä¸ªå‚æ•°<code>true</code>æ—¶ï¼Œå˜é‡<code>reset</code>å°±è¢«é‡ç½®ä¸ºè¿™ä¸ªå‚æ•°ï¼ˆå³<code>true</code>ï¼‰ï¼Œå› æ­¤<code>i</code>ä¼šç­‰äº<code>-1</code>ï¼Œä¸‹ä¸€è½®å¾ªç¯å°±ä¼šä»<code>-1</code>å¼€å§‹é€’å¢ã€‚</p>
<p>è¿™ä¸ªåŠŸèƒ½æœ‰å¾ˆé‡è¦çš„è¯­æ³•æ„ä¹‰ã€‚Generator å‡½æ•°ä»æš‚åœçŠ¶æ€åˆ°æ¢å¤è¿è¡Œï¼Œå®ƒçš„ä¸Šä¸‹æ–‡çŠ¶æ€ï¼ˆcontextï¼‰æ˜¯ä¸å˜çš„ã€‚é€šè¿‡<code>next</code>æ–¹æ³•çš„å‚æ•°ï¼Œå°±æœ‰åŠæ³•åœ¨ Generator å‡½æ•°å¼€å§‹è¿è¡Œä¹‹åï¼Œç»§ç»­å‘å‡½æ•°ä½“å†…éƒ¨æ³¨å…¥å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥åœ¨ Generator å‡½æ•°è¿è¡Œçš„ä¸åŒé˜¶æ®µï¼Œä»å¤–éƒ¨å‘å†…éƒ¨æ³¨å…¥ä¸åŒçš„å€¼ï¼Œä»è€Œè°ƒæ•´å‡½æ•°è¡Œä¸ºã€‚</p>
<p>å†çœ‹ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> y = <span class="number">2</span> * (<span class="keyword">yield</span> (x + <span class="number">1</span>));</div><div class="line">  <span class="keyword">var</span> z = <span class="keyword">yield</span> (y / <span class="number">3</span>);</div><div class="line">  <span class="keyword">return</span> (x + y + z);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = foo(<span class="number">5</span>);</div><div class="line">a.next() <span class="comment">// Object&#123;value:6, done:false&#125;</span></div><div class="line">a.next() <span class="comment">// Object&#123;value:NaN, done:false&#125;</span></div><div class="line">a.next() <span class="comment">// Object&#123;value:NaN, done:true&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> b = foo(<span class="number">5</span>);</div><div class="line">b.next() <span class="comment">// &#123; value:6, done:false &#125;</span></div><div class="line">b.next(<span class="number">12</span>) <span class="comment">// &#123; value:8, done:false &#125;</span></div><div class="line">b.next(<span class="number">13</span>) <span class="comment">// &#123; value:42, done:true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒæ¬¡è¿è¡Œ<code>next</code>æ–¹æ³•çš„æ—¶å€™ä¸å¸¦å‚æ•°ï¼Œå¯¼è‡´yçš„å€¼ç­‰äº<code>2 * undefined</code>ï¼ˆå³<code>NaN</code>ï¼‰ï¼Œé™¤ä»¥3ä»¥åè¿˜æ˜¯<code>NaN</code>ï¼Œå› æ­¤è¿”å›å¯¹è±¡çš„<code>value</code>å±æ€§ä¹Ÿç­‰äº<code>NaN</code>ã€‚ç¬¬ä¸‰æ¬¡è¿è¡Œ<code>Next</code>æ–¹æ³•çš„æ—¶å€™ä¸å¸¦å‚æ•°ï¼Œæ‰€ä»¥<code>z</code>ç­‰äº<code>undefined</code>ï¼Œè¿”å›å¯¹è±¡çš„<code>value</code>å±æ€§ç­‰äº<code>5 + NaN + undefined</code>ï¼Œå³<code>NaN</code>ã€‚</p>
<p>å¦‚æœå‘<code>next</code>æ–¹æ³•æä¾›å‚æ•°ï¼Œè¿”å›ç»“æœå°±å®Œå…¨ä¸ä¸€æ ·äº†ã€‚ä¸Šé¢ä»£ç ç¬¬ä¸€æ¬¡è°ƒç”¨<code>b</code>çš„<code>next</code>æ–¹æ³•æ—¶ï¼Œè¿”å›<code>x+1</code>çš„å€¼6ï¼›ç¬¬äºŒæ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œå°†ä¸Šä¸€æ¬¡<code>yield</code>è¯­å¥çš„å€¼è®¾ä¸º12ï¼Œå› æ­¤<code>y</code>ç­‰äº24ï¼Œè¿”å›<code>y / 3</code>çš„å€¼8ï¼›ç¬¬ä¸‰æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œå°†ä¸Šä¸€æ¬¡<code>yield</code>è¯­å¥çš„å€¼è®¾ä¸º13ï¼Œå› æ­¤<code>z</code>ç­‰äº13ï¼Œè¿™æ—¶<code>x</code>ç­‰äº5ï¼Œ<code>y</code>ç­‰äº24ï¼Œæ‰€ä»¥<code>return</code>è¯­å¥çš„å€¼ç­‰äº42ã€‚</p>
<p>æ³¨æ„ï¼Œç”±äº<code>next</code>æ–¹æ³•çš„å‚æ•°è¡¨ç¤ºä¸Šä¸€ä¸ª<code>yield</code>è¯­å¥çš„è¿”å›å€¼ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ä½¿ç”¨<code>next</code>æ–¹æ³•æ—¶ï¼Œä¸èƒ½å¸¦æœ‰å‚æ•°ã€‚V8å¼•æ“ç›´æ¥å¿½ç•¥ç¬¬ä¸€æ¬¡ä½¿ç”¨<code>next</code>æ–¹æ³•æ—¶çš„å‚æ•°ï¼Œåªæœ‰ä»ç¬¬äºŒæ¬¡ä½¿ç”¨<code>next</code>æ–¹æ³•å¼€å§‹ï¼Œå‚æ•°æ‰æ˜¯æœ‰æ•ˆçš„ã€‚ä»è¯­ä¹‰ä¸Šè®²ï¼Œç¬¬ä¸€ä¸ª<code>next</code>æ–¹æ³•ç”¨æ¥å¯åŠ¨éå†å™¨å¯¹è±¡ï¼Œæ‰€ä»¥ä¸ç”¨å¸¦æœ‰å‚æ•°ã€‚</p>
<p>å¦‚æœæƒ³è¦ç¬¬ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•æ—¶ï¼Œå°±èƒ½å¤Ÿè¾“å…¥å€¼ï¼Œå¯ä»¥åœ¨Generatorå‡½æ•°å¤–é¢å†åŒ…ä¸€å±‚ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">wrapper</span>(<span class="params">generatorFunction</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">...args</span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> generatorObject = generatorFunction(...args);</div><div class="line">    generatorObject.next();</div><div class="line">    <span class="keyword">return</span> generatorObject;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> wrapped = wrapper(<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`First input: <span class="subst">$&#123;<span class="keyword">yield</span>&#125;</span>`</span>);</div><div class="line">  <span class="keyword">return</span> <span class="string">'DONE'</span>;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">wrapped().next(<span class="string">'hello!'</span>)</div><div class="line"><span class="comment">// First input: hello!</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒGeneratorå‡½æ•°å¦‚æœä¸ç”¨<code>wrapper</code>å…ˆåŒ…ä¸€å±‚ï¼Œæ˜¯æ— æ³•ç¬¬ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œå°±è¾“å…¥å‚æ•°çš„ã€‚</p>
<p>å†çœ‹ä¸€ä¸ªé€šè¿‡<code>next</code>æ–¹æ³•çš„å‚æ•°ï¼Œå‘Generatorå‡½æ•°å†…éƒ¨è¾“å…¥å€¼çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">dataConsumer</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Started'</span>);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`1. <span class="subst">$&#123;<span class="keyword">yield</span>&#125;</span>`</span>);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`2. <span class="subst">$&#123;<span class="keyword">yield</span>&#125;</span>`</span>);</div><div class="line">  <span class="keyword">return</span> <span class="string">'result'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> genObj = dataConsumer();</div><div class="line">genObj.next();</div><div class="line"><span class="comment">// Started</span></div><div class="line">genObj.next(<span class="string">'a'</span>)</div><div class="line"><span class="comment">// 1. a</span></div><div class="line">genObj.next(<span class="string">'b'</span>)</div><div class="line"><span class="comment">// 2. b</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªå¾ˆç›´è§‚çš„ä¾‹å­ï¼Œæ¯æ¬¡é€šè¿‡<code>next</code>æ–¹æ³•å‘Generatorå‡½æ•°è¾“å…¥å€¼ï¼Œç„¶åæ‰“å°å‡ºæ¥ã€‚</p>
<h2 id="forâ€¦ofå¾ªç¯"><a href="#forâ€¦ofå¾ªç¯" class="headerlink" title="forâ€¦ofå¾ªç¯"></a>forâ€¦ofå¾ªç¯</h2><p><code>for...of</code>å¾ªç¯å¯ä»¥è‡ªåŠ¨éå†Generatorå‡½æ•°æ—¶ç”Ÿæˆçš„<code>Iterator</code>å¯¹è±¡ï¼Œä¸”æ­¤æ—¶ä¸å†éœ€è¦è°ƒç”¨<code>next</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">4</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">5</span>;</div><div class="line">  <span class="keyword">return</span> <span class="number">6</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> foo()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(v);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1 2 3 4 5</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨<code>for...of</code>å¾ªç¯ï¼Œä¾æ¬¡æ˜¾ç¤º5ä¸ª<code>yield</code>è¯­å¥çš„å€¼ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œä¸€æ—¦<code>next</code>æ–¹æ³•çš„è¿”å›å¯¹è±¡çš„<code>done</code>å±æ€§ä¸º<code>true</code>ï¼Œ<code>for...of</code>å¾ªç¯å°±ä¼šä¸­æ­¢ï¼Œä¸”ä¸åŒ…å«è¯¥è¿”å›å¯¹è±¡ï¼Œæ‰€ä»¥ä¸Šé¢ä»£ç çš„<code>return</code>è¯­å¥è¿”å›çš„6ï¼Œä¸åŒ…æ‹¬åœ¨<code>for...of</code>å¾ªç¯ä¹‹ä¸­ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ©ç”¨Generatorå‡½æ•°å’Œ<code>for...of</code>å¾ªç¯ï¼Œå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">fibonacci</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> [prev, curr] = [<span class="number">0</span>, <span class="number">1</span>];</div><div class="line">  <span class="keyword">for</span> (;;) &#123;</div><div class="line">    [prev, curr] = [curr, prev + curr];</div><div class="line">    <span class="keyword">yield</span> curr;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> n <span class="keyword">of</span> fibonacci()) &#123;</div><div class="line">  <span class="keyword">if</span> (n &gt; <span class="number">1000</span>) <span class="keyword">break</span>;</div><div class="line">  <span class="built_in">console</span>.log(n);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢ä»£ç å¯è§ï¼Œä½¿ç”¨<code>for...of</code>è¯­å¥æ—¶ä¸éœ€è¦ä½¿ç”¨<code>next</code>æ–¹æ³•ã€‚</p>
<p>åˆ©ç”¨<code>for...of</code>å¾ªç¯ï¼Œå¯ä»¥å†™å‡ºéå†ä»»æ„å¯¹è±¡ï¼ˆobjectï¼‰çš„æ–¹æ³•ã€‚åŸç”Ÿçš„JavaScriptå¯¹è±¡æ²¡æœ‰éå†æ¥å£ï¼Œæ— æ³•ä½¿ç”¨<code>for...of</code>å¾ªç¯ï¼Œé€šè¿‡Generatorå‡½æ•°ä¸ºå®ƒåŠ ä¸Šè¿™ä¸ªæ¥å£ï¼Œå°±å¯ä»¥ç”¨äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">objectEntries</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> propKeys = <span class="built_in">Reflect</span>.ownKeys(obj);</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> propKey <span class="keyword">of</span> propKeys) &#123;</div><div class="line">    <span class="keyword">yield</span> [propKey, obj[propKey]];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> jane = &#123; <span class="attr">first</span>: <span class="string">'Jane'</span>, <span class="attr">last</span>: <span class="string">'Doe'</span> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> objectEntries(jane)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>: <span class="subst">$&#123;value&#125;</span>`</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">// first: Jane</span></div><div class="line"><span class="comment">// last: Doe</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡<code>jane</code>åŸç”Ÿä¸å…·å¤‡Iteratoræ¥å£ï¼Œæ— æ³•ç”¨<code>for...of</code>éå†ã€‚è¿™æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡Generatorå‡½æ•°<code>objectEntries</code>ä¸ºå®ƒåŠ ä¸Šéå†å™¨æ¥å£ï¼Œå°±å¯ä»¥ç”¨<code>for...of</code>éå†äº†ã€‚åŠ ä¸Šéå†å™¨æ¥å£çš„å¦ä¸€ç§å†™æ³•æ˜¯ï¼Œå°†Generatorå‡½æ•°åŠ åˆ°å¯¹è±¡çš„<code>Symbol.iterator</code>å±æ€§ä¸Šé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">objectEntries</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> propKeys = <span class="built_in">Object</span>.keys(<span class="keyword">this</span>);</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> propKey <span class="keyword">of</span> propKeys) &#123;</div><div class="line">    <span class="keyword">yield</span> [propKey, <span class="keyword">this</span>[propKey]];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> jane = &#123; <span class="attr">first</span>: <span class="string">'Jane'</span>, <span class="attr">last</span>: <span class="string">'Doe'</span> &#125;;</div><div class="line"></div><div class="line">jane[<span class="built_in">Symbol</span>.iterator] = objectEntries;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> jane) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;key&#125;</span>: <span class="subst">$&#123;value&#125;</span>`</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">// first: Jane</span></div><div class="line"><span class="comment">// last: Doe</span></div></pre></td></tr></table></figure>
<p>é™¤äº†<code>for...of</code>å¾ªç¯ä»¥å¤–ï¼Œæ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰ã€è§£æ„èµ‹å€¼å’Œ<code>Array.from</code>æ–¹æ³•å†…éƒ¨è°ƒç”¨çš„ï¼Œéƒ½æ˜¯éå†å™¨æ¥å£ã€‚è¿™æ„å‘³ç€ï¼Œå®ƒä»¬éƒ½å¯ä»¥å°†Generatorå‡½æ•°è¿”å›çš„Iteratorå¯¹è±¡ï¼Œä½œä¸ºå‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">numbers</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span></div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span></div><div class="line">  <span class="keyword">return</span> <span class="number">3</span></div><div class="line">  <span class="keyword">yield</span> <span class="number">4</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ‰©å±•è¿ç®—ç¬¦</span></div><div class="line">[...numbers()] <span class="comment">// [1, 2]</span></div><div class="line"></div><div class="line"><span class="comment">// Array.from æ–¹æ³•</span></div><div class="line"><span class="built_in">Array</span>.from(numbers()) <span class="comment">// [1, 2]</span></div><div class="line"></div><div class="line"><span class="comment">// è§£æ„èµ‹å€¼</span></div><div class="line"><span class="keyword">let</span> [x, y] = numbers();</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// 2</span></div><div class="line"></div><div class="line"><span class="comment">// for...of å¾ªç¯</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> n <span class="keyword">of</span> numbers()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(n)</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1</span></div><div class="line"><span class="comment">// 2</span></div></pre></td></tr></table></figure>
<h2 id="Generator-prototype-throw"><a href="#Generator-prototype-throw" class="headerlink" title="Generator.prototype.throw()"></a>Generator.prototype.throw()</h2><p>Generatorå‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œéƒ½æœ‰ä¸€ä¸ª<code>throw</code>æ–¹æ³•ï¼Œå¯ä»¥åœ¨å‡½æ•°ä½“å¤–æŠ›å‡ºé”™è¯¯ï¼Œç„¶ååœ¨Generatorå‡½æ•°ä½“å†…æ•è·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">yield</span>;</div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'å†…éƒ¨æ•è·'</span>, e);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> i = g();</div><div class="line">i.next();</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  i.throw(<span class="string">'a'</span>);</div><div class="line">  i.throw(<span class="string">'b'</span>);</div><div class="line">&#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'å¤–éƒ¨æ•è·'</span>, e);</div><div class="line">&#125;</div><div class="line"><span class="comment">// å†…éƒ¨æ•è· a</span></div><div class="line"><span class="comment">// å¤–éƒ¨æ•è· b</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œéå†å™¨å¯¹è±¡<code>i</code>è¿ç»­æŠ›å‡ºä¸¤ä¸ªé”™è¯¯ã€‚ç¬¬ä¸€ä¸ªé”™è¯¯è¢«Generatorå‡½æ•°ä½“å†…çš„<code>catch</code>è¯­å¥æ•è·ã€‚<code>i</code>ç¬¬äºŒæ¬¡æŠ›å‡ºé”™è¯¯ï¼Œç”±äºGeneratorå‡½æ•°å†…éƒ¨çš„<code>catch</code>è¯­å¥å·²ç»æ‰§è¡Œè¿‡äº†ï¼Œä¸ä¼šå†æ•æ‰åˆ°è¿™ä¸ªé”™è¯¯äº†ï¼Œæ‰€ä»¥è¿™ä¸ªé”™è¯¯å°±è¢«æŠ›å‡ºäº†Generatorå‡½æ•°ä½“ï¼Œè¢«å‡½æ•°ä½“å¤–çš„<code>catch</code>è¯­å¥æ•è·ã€‚</p>
<p><code>throw</code>æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°ä¼šè¢«<code>catch</code>è¯­å¥æ¥æ”¶ï¼Œå»ºè®®æŠ›å‡º<code>Error</code>å¯¹è±¡çš„å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">yield</span>;</div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="built_in">console</span>.log(e);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> i = g();</div><div class="line">i.next();</div><div class="line">i.throw(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'å‡ºé”™äº†ï¼'</span>));</div><div class="line"><span class="comment">// Error: å‡ºé”™äº†ï¼(â€¦)</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œä¸è¦æ··æ·†éå†å™¨å¯¹è±¡çš„<code>throw</code>æ–¹æ³•å’Œå…¨å±€çš„<code>throw</code>å‘½ä»¤ã€‚ä¸Šé¢ä»£ç çš„é”™è¯¯ï¼Œæ˜¯ç”¨éå†å™¨å¯¹è±¡çš„<code>throw</code>æ–¹æ³•æŠ›å‡ºçš„ï¼Œè€Œä¸æ˜¯ç”¨<code>throw</code>å‘½ä»¤æŠ›å‡ºçš„ã€‚åè€…åªèƒ½è¢«å‡½æ•°ä½“å¤–çš„<code>catch</code>è¯­å¥æ•è·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">      <span class="keyword">yield</span>;</div><div class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">      <span class="keyword">if</span> (e != <span class="string">'a'</span>) <span class="keyword">throw</span> e;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'å†…éƒ¨æ•è·'</span>, e);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> i = g();</div><div class="line">i.next();</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'a'</span>);</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'b'</span>);</div><div class="line">&#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'å¤–éƒ¨æ•è·'</span>, e);</div><div class="line">&#125;</div><div class="line"><span class="comment">// å¤–éƒ¨æ•è· [Error: a]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¹‹æ‰€ä»¥åªæ•è·äº†<code>a</code>ï¼Œæ˜¯å› ä¸ºå‡½æ•°ä½“å¤–çš„<code>catch</code>è¯­å¥å—ï¼Œæ•è·äº†æŠ›å‡ºçš„<code>a</code>é”™è¯¯ä»¥åï¼Œå°±ä¸ä¼šå†ç»§ç»­<code>try</code>ä»£ç å—é‡Œé¢å‰©ä½™çš„è¯­å¥äº†ã€‚</p>
<p>å¦‚æœGeneratorå‡½æ•°å†…éƒ¨æ²¡æœ‰éƒ¨ç½²<code>try...catch</code>ä»£ç å—ï¼Œé‚£ä¹ˆ<code>throw</code>æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œå°†è¢«å¤–éƒ¨<code>try...catch</code>ä»£ç å—æ•è·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="keyword">yield</span>;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'å†…éƒ¨æ•è·'</span>, e);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> i = g();</div><div class="line">i.next();</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  i.throw(<span class="string">'a'</span>);</div><div class="line">  i.throw(<span class="string">'b'</span>);</div><div class="line">&#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'å¤–éƒ¨æ•è·'</span>, e);</div><div class="line">&#125;</div><div class="line"><span class="comment">// å¤–éƒ¨æ•è· a</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒGeneratorå‡½æ•°<code>g</code>å†…éƒ¨æ²¡æœ‰éƒ¨ç½²<code>try...catch</code>ä»£ç å—ï¼Œæ‰€ä»¥æŠ›å‡ºçš„é”™è¯¯ç›´æ¥è¢«å¤–éƒ¨<code>catch</code>ä»£ç å—æ•è·ã€‚</p>
<p>å¦‚æœGeneratorå‡½æ•°å†…éƒ¨å’Œå¤–éƒ¨ï¼Œéƒ½æ²¡æœ‰éƒ¨ç½²<code>try...catch</code>ä»£ç å—ï¼Œé‚£ä¹ˆç¨‹åºå°†æŠ¥é”™ï¼Œç›´æ¥ä¸­æ–­æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gen = <span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</div><div class="line">  <span class="keyword">yield</span> <span class="built_in">console</span>.log(<span class="string">'world'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line">g.next();</div><div class="line">g.throw();</div><div class="line"><span class="comment">// hello</span></div><div class="line"><span class="comment">// Uncaught undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>g.throw</code>æŠ›å‡ºé”™è¯¯ä»¥åï¼Œæ²¡æœ‰ä»»ä½•<code>try...catch</code>ä»£ç å—å¯ä»¥æ•è·è¿™ä¸ªé”™è¯¯ï¼Œå¯¼è‡´ç¨‹åºæŠ¥é”™ï¼Œä¸­æ–­æ‰§è¡Œã€‚</p>
<p><code>throw</code>æ–¹æ³•è¢«æ•è·ä»¥åï¼Œä¼šé™„å¸¦æ‰§è¡Œä¸‹ä¸€æ¡<code>yield</code>è¯­å¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šé™„å¸¦æ‰§è¡Œä¸€æ¬¡<code>next</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gen = <span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">yield</span> <span class="built_in">console</span>.log(<span class="string">'a'</span>);</div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">yield</span> <span class="built_in">console</span>.log(<span class="string">'b'</span>);</div><div class="line">  <span class="keyword">yield</span> <span class="built_in">console</span>.log(<span class="string">'c'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line">g.next() <span class="comment">// a</span></div><div class="line">g.throw() <span class="comment">// b</span></div><div class="line">g.next() <span class="comment">// c</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>g.throw</code>æ–¹æ³•è¢«æ•è·ä»¥åï¼Œè‡ªåŠ¨æ‰§è¡Œäº†ä¸€æ¬¡<code>next</code>æ–¹æ³•ï¼Œæ‰€ä»¥ä¼šæ‰“å°<code>b</code>ã€‚å¦å¤–ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œåªè¦Generatorå‡½æ•°å†…éƒ¨éƒ¨ç½²äº†<code>try...catch</code>ä»£ç å—ï¼Œé‚£ä¹ˆéå†å™¨çš„<code>throw</code>æ–¹æ³•æŠ›å‡ºçš„é”™è¯¯ï¼Œä¸å½±å“ä¸‹ä¸€æ¬¡éå†ã€‚</p>
<p>å¦å¤–ï¼Œ<code>throw</code>å‘½ä»¤ä¸<code>g.throw</code>æ–¹æ³•æ˜¯æ— å…³çš„ï¼Œä¸¤è€…äº’ä¸å½±å“ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> gen = <span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</div><div class="line">  <span class="keyword">yield</span> <span class="built_in">console</span>.log(<span class="string">'world'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line">g.next();</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</div><div class="line">&#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">  g.next();</div><div class="line">&#125;</div><div class="line"><span class="comment">// hello</span></div><div class="line"><span class="comment">// world</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>throw</code>å‘½ä»¤æŠ›å‡ºçš„é”™è¯¯ä¸ä¼šå½±å“åˆ°éå†å™¨çš„çŠ¶æ€ï¼Œæ‰€ä»¥ä¸¤æ¬¡æ‰§è¡Œ<code>next</code>æ–¹æ³•ï¼Œéƒ½è¿›è¡Œäº†æ­£ç¡®çš„æ“ä½œã€‚</p>
<p>è¿™ç§å‡½æ•°ä½“å†…æ•è·é”™è¯¯çš„æœºåˆ¶ï¼Œå¤§å¤§æ–¹ä¾¿äº†å¯¹é”™è¯¯çš„å¤„ç†ã€‚å¤šä¸ª<code>yield</code>è¯­å¥ï¼Œå¯ä»¥åªç”¨ä¸€ä¸ª<code>try...catch</code>ä»£ç å—æ¥æ•è·é”™è¯¯ã€‚å¦‚æœä½¿ç”¨å›è°ƒå‡½æ•°çš„å†™æ³•ï¼Œæƒ³è¦æ•è·å¤šä¸ªé”™è¯¯ï¼Œå°±ä¸å¾—ä¸ä¸ºæ¯ä¸ªå‡½æ•°å†…éƒ¨å†™ä¸€ä¸ªé”™è¯¯å¤„ç†è¯­å¥ï¼Œç°åœ¨åªåœ¨Generatorå‡½æ•°å†…éƒ¨å†™ä¸€æ¬¡<code>catch</code>è¯­å¥å°±å¯ä»¥äº†ã€‚</p>
<p>Generatorå‡½æ•°ä½“å¤–æŠ›å‡ºçš„é”™è¯¯ï¼Œå¯ä»¥åœ¨å‡½æ•°ä½“å†…æ•è·ï¼›åè¿‡æ¥ï¼ŒGeneratorå‡½æ•°ä½“å†…æŠ›å‡ºçš„é”™è¯¯ï¼Œä¹Ÿå¯ä»¥è¢«å‡½æ•°ä½“å¤–çš„<code>catch</code>æ•è·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> x = <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">  <span class="keyword">var</span> y = x.toUpperCase();</div><div class="line">  <span class="keyword">yield</span> y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> it = foo();</div><div class="line"></div><div class="line">it.next(); <span class="comment">// &#123; value:3, done:false &#125;</span></div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  it.next(<span class="number">42</span>);</div><div class="line">&#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">  <span class="built_in">console</span>.log(err);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç¬¬äºŒä¸ª<code>next</code>æ–¹æ³•å‘å‡½æ•°ä½“å†…ä¼ å…¥ä¸€ä¸ªå‚æ•°42ï¼Œæ•°å€¼æ˜¯æ²¡æœ‰<code>toUpperCase</code>æ–¹æ³•çš„ï¼Œæ‰€ä»¥ä¼šæŠ›å‡ºä¸€ä¸ªTypeErroré”™è¯¯ï¼Œè¢«å‡½æ•°ä½“å¤–çš„<code>catch</code>æ•è·ã€‚</p>
<p>ä¸€æ—¦Generatoræ‰§è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºé”™è¯¯ï¼Œä¸”æ²¡æœ‰è¢«å†…éƒ¨æ•è·ï¼Œå°±ä¸ä¼šå†æ‰§è¡Œä¸‹å»äº†ã€‚å¦‚æœæ­¤åè¿˜è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œå°†è¿”å›ä¸€ä¸ª<code>value</code>å±æ€§ç­‰äº<code>undefined</code>ã€<code>done</code>å±æ€§ç­‰äº<code>true</code>çš„å¯¹è±¡ï¼Œå³JavaScriptå¼•æ“è®¤ä¸ºè¿™ä¸ªGeneratorå·²ç»è¿è¡Œç»“æŸäº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">g</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'throwing an exception'</span>);</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'generator broke!'</span>);</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">generator</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> v;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'starting generator'</span>);</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    v = generator.next();</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'ç¬¬ä¸€æ¬¡è¿è¡Œnextæ–¹æ³•'</span>, v);</div><div class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•æ‰é”™è¯¯'</span>, v);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    v = generator.next();</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'ç¬¬äºŒæ¬¡è¿è¡Œnextæ–¹æ³•'</span>, v);</div><div class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•æ‰é”™è¯¯'</span>, v);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    v = generator.next();</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'ç¬¬ä¸‰æ¬¡è¿è¡Œnextæ–¹æ³•'</span>, v);</div><div class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'æ•æ‰é”™è¯¯'</span>, v);</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'caller done'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">log(g());</div><div class="line"><span class="comment">// starting generator</span></div><div class="line"><span class="comment">// ç¬¬ä¸€æ¬¡è¿è¡Œnextæ–¹æ³• &#123; value: 1, done: false &#125;</span></div><div class="line"><span class="comment">// throwing an exception</span></div><div class="line"><span class="comment">// æ•æ‰é”™è¯¯ &#123; value: 1, done: false &#125;</span></div><div class="line"><span class="comment">// ç¬¬ä¸‰æ¬¡è¿è¡Œnextæ–¹æ³• &#123; value: undefined, done: true &#125;</span></div><div class="line"><span class="comment">// caller done</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸€å…±ä¸‰æ¬¡è¿è¡Œ<code>next</code>æ–¹æ³•ï¼Œç¬¬äºŒæ¬¡è¿è¡Œçš„æ—¶å€™ä¼šæŠ›å‡ºé”™è¯¯ï¼Œç„¶åç¬¬ä¸‰æ¬¡è¿è¡Œçš„æ—¶å€™ï¼ŒGeneratorå‡½æ•°å°±å·²ç»ç»“æŸäº†ï¼Œä¸å†æ‰§è¡Œä¸‹å»äº†ã€‚</p>
<h2 id="Generator-prototype-return"><a href="#Generator-prototype-return" class="headerlink" title="Generator.prototype.return()"></a>Generator.prototype.return()</h2><p>Generatorå‡½æ•°è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>return</code>æ–¹æ³•ï¼Œå¯ä»¥è¿”å›ç»™å®šçš„å€¼ï¼Œå¹¶ä¸”ç»ˆç»“éå†Generatorå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line"></div><div class="line">g.next()        <span class="comment">// &#123; value: 1, done: false &#125;</span></div><div class="line">g.return(<span class="string">'foo'</span>) <span class="comment">// &#123; value: "foo", done: true &#125;</span></div><div class="line">g.next()        <span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œéå†å™¨å¯¹è±¡<code>g</code>è°ƒç”¨<code>return</code>æ–¹æ³•åï¼Œè¿”å›å€¼çš„<code>value</code>å±æ€§å°±æ˜¯<code>return</code>æ–¹æ³•çš„å‚æ•°<code>foo</code>ã€‚å¹¶ä¸”ï¼ŒGeneratorå‡½æ•°çš„éå†å°±ç»ˆæ­¢äº†ï¼Œè¿”å›å€¼çš„<code>done</code>å±æ€§ä¸º<code>true</code>ï¼Œä»¥åå†è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œ<code>done</code>å±æ€§æ€»æ˜¯è¿”å›<code>true</code>ã€‚</p>
<p>å¦‚æœ<code>return</code>æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¸æä¾›å‚æ•°ï¼Œåˆ™è¿”å›å€¼çš„<code>value</code>å±æ€§ä¸º<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line"></div><div class="line">g.next()        <span class="comment">// &#123; value: 1, done: false &#125;</span></div><div class="line">g.return() <span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
<p>å¦‚æœGeneratorå‡½æ•°å†…éƒ¨æœ‰<code>try...finally</code>ä»£ç å—ï¼Œé‚£ä¹ˆ<code>return</code>æ–¹æ³•ä¼šæ¨è¿Ÿåˆ°<code>finally</code>ä»£ç å—æ‰§è¡Œå®Œå†æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">numbers</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">    <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">  &#125; <span class="keyword">finally</span> &#123;</div><div class="line">    <span class="keyword">yield</span> <span class="number">4</span>;</div><div class="line">    <span class="keyword">yield</span> <span class="number">5</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">yield</span> <span class="number">6</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> g = numbers()</div><div class="line">g.next() <span class="comment">// &#123; done: false, value: 1 &#125;</span></div><div class="line">g.next() <span class="comment">// &#123; done: false, value: 2 &#125;</span></div><div class="line">g.return(<span class="number">7</span>) <span class="comment">// &#123; done: false, value: 4 &#125;</span></div><div class="line">g.next() <span class="comment">// &#123; done: false, value: 5 &#125;</span></div><div class="line">g.next() <span class="comment">// &#123; done: true, value: 7 &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨<code>return</code>æ–¹æ³•åï¼Œå°±å¼€å§‹æ‰§è¡Œ<code>finally</code>ä»£ç å—ï¼Œç„¶åç­‰åˆ°<code>finally</code>ä»£ç å—æ‰§è¡Œå®Œï¼Œå†æ‰§è¡Œ<code>return</code>æ–¹æ³•ã€‚</p>
<h2 id="yield-è¯­å¥"><a href="#yield-è¯­å¥" class="headerlink" title="yield* è¯­å¥"></a>yield* è¯­å¥</h2><p>å¦‚æœåœ¨ Generator å‡½æ•°å†…éƒ¨ï¼Œè°ƒç”¨å¦ä¸€ä¸ª Generator å‡½æ•°ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯æ²¡æœ‰æ•ˆæœçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'a'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'b'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'x'</span>;</div><div class="line">  foo();</div><div class="line">  <span class="keyword">yield</span> <span class="string">'y'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> bar())&#123;</div><div class="line">  <span class="built_in">console</span>.log(v);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "x"</span></div><div class="line"><span class="comment">// "y"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>foo</code>å’Œ<code>bar</code>éƒ½æ˜¯ Generator å‡½æ•°ï¼Œåœ¨<code>bar</code>é‡Œé¢è°ƒç”¨<code>foo</code>ï¼Œæ˜¯ä¸ä¼šæœ‰æ•ˆæœçš„ã€‚</p>
<p>è¿™ä¸ªå°±éœ€è¦ç”¨åˆ°<code>yield*</code>è¯­å¥ï¼Œç”¨æ¥åœ¨ä¸€ä¸ª Generator å‡½æ•°é‡Œé¢æ‰§è¡Œå¦ä¸€ä¸ª Generator å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'x'</span>;</div><div class="line">  <span class="keyword">yield</span>* foo();</div><div class="line">  <span class="keyword">yield</span> <span class="string">'y'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'x'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'a'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'b'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'y'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'x'</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> foo()) &#123;</div><div class="line">    <span class="keyword">yield</span> v;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'y'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> bar())&#123;</div><div class="line">  <span class="built_in">console</span>.log(v);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "x"</span></div><div class="line"><span class="comment">// "a"</span></div><div class="line"><span class="comment">// "b"</span></div><div class="line"><span class="comment">// "y"</span></div></pre></td></tr></table></figure>
<p>å†æ¥çœ‹ä¸€ä¸ªå¯¹æ¯”çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">inner</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'hello!'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">outer1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'open'</span>;</div><div class="line">  <span class="keyword">yield</span> inner();</div><div class="line">  <span class="keyword">yield</span> <span class="string">'close'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> gen = outer1()</div><div class="line">gen.next().value <span class="comment">// "open"</span></div><div class="line">gen.next().value <span class="comment">// è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡</span></div><div class="line">gen.next().value <span class="comment">// "close"</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">outer2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'open'</span></div><div class="line">  <span class="keyword">yield</span>* inner()</div><div class="line">  <span class="keyword">yield</span> <span class="string">'close'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> gen = outer2()</div><div class="line">gen.next().value <span class="comment">// "open"</span></div><div class="line">gen.next().value <span class="comment">// "hello!"</span></div><div class="line">gen.next().value <span class="comment">// "close"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¾‹å­ä¸­ï¼Œ<code>outer2</code>ä½¿ç”¨äº†<code>yield*</code>ï¼Œ<code>outer1</code>æ²¡ä½¿ç”¨ã€‚ç»“æœå°±æ˜¯ï¼Œ<code>outer1</code>è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œ<code>outer2</code>è¿”å›è¯¥éå†å™¨å¯¹è±¡çš„å†…éƒ¨å€¼ã€‚</p>
<p>ä»è¯­æ³•è§’åº¦çœ‹ï¼Œå¦‚æœ<code>yield</code>å‘½ä»¤åé¢è·Ÿçš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œéœ€è¦åœ¨<code>yield</code>å‘½ä»¤åé¢åŠ ä¸Šæ˜Ÿå·ï¼Œè¡¨æ˜å®ƒè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚è¿™è¢«ç§°ä¸º<code>yield*</code>è¯­å¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> delegatedIterator = (<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'Hello!'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'Bye!'</span>;</div><div class="line">&#125;());</div><div class="line"></div><div class="line"><span class="keyword">let</span> delegatingIterator = (<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'Greetings!'</span>;</div><div class="line">  <span class="keyword">yield</span>* delegatedIterator;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'Ok, bye.'</span>;</div><div class="line">&#125;());</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> value <span class="keyword">of</span> delegatingIterator) &#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "Greetings!</span></div><div class="line"><span class="comment">// "Hello!"</span></div><div class="line"><span class="comment">// "Bye!"</span></div><div class="line"><span class="comment">// "Ok, bye."</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>delegatingIterator</code>æ˜¯ä»£ç†è€…ï¼Œ<code>delegatedIterator</code>æ˜¯è¢«ä»£ç†è€…ã€‚ç”±äº<code>yield* delegatedIterator</code>è¯­å¥å¾—åˆ°çš„å€¼ï¼Œæ˜¯ä¸€ä¸ªéå†å™¨ï¼Œæ‰€ä»¥è¦ç”¨æ˜Ÿå·è¡¨ç¤ºã€‚è¿è¡Œç»“æœå°±æ˜¯ä½¿ç”¨ä¸€ä¸ªéå†å™¨ï¼Œéå†äº†å¤šä¸ªGeneratorå‡½æ•°ï¼Œæœ‰é€’å½’çš„æ•ˆæœã€‚</p>
<p><code>yield*</code>åé¢çš„Generatorå‡½æ•°ï¼ˆæ²¡æœ‰<code>return</code>è¯­å¥æ—¶ï¼‰ï¼Œç­‰åŒäºåœ¨Generatorå‡½æ•°å†…éƒ¨ï¼Œéƒ¨ç½²ä¸€ä¸ª<code>for...of</code>å¾ªç¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">concat</span>(<span class="params">iter1, iter2</span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span>* iter1;</div><div class="line">  <span class="keyword">yield</span>* iter2;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">concat</span>(<span class="params">iter1, iter2</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> value <span class="keyword">of</span> iter1) &#123;</div><div class="line">    <span class="keyword">yield</span> value;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> value <span class="keyword">of</span> iter2) &#123;</div><div class="line">    <span class="keyword">yield</span> value;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼Œ<code>yield*</code>åé¢çš„Generatorå‡½æ•°ï¼ˆæ²¡æœ‰<code>return</code>è¯­å¥æ—¶ï¼‰ï¼Œä¸è¿‡æ˜¯<code>for...of</code>çš„ä¸€ç§ç®€å†™å½¢å¼ï¼Œå®Œå…¨å¯ä»¥ç”¨åè€…æ›¿ä»£å‰è€…ã€‚åä¹‹ï¼Œåˆ™éœ€è¦ç”¨<code>var value = yield* iterator</code>çš„å½¢å¼è·å–<code>return</code>è¯­å¥çš„å€¼ã€‚</p>
<p>å¦‚æœ<code>yield*</code>åé¢è·Ÿç€ä¸€ä¸ªæ•°ç»„ï¼Œç”±äºæ•°ç»„åŸç”Ÿæ”¯æŒéå†å™¨ï¼Œå› æ­¤å°±ä¼šéå†æ•°ç»„æˆå‘˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">yield</span>* [<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">gen().next() <span class="comment">// &#123; value:"a", done:false &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>yield</code>å‘½ä»¤åé¢å¦‚æœä¸åŠ æ˜Ÿå·ï¼Œè¿”å›çš„æ˜¯æ•´ä¸ªæ•°ç»„ï¼ŒåŠ äº†æ˜Ÿå·å°±è¡¨ç¤ºè¿”å›çš„æ˜¯æ•°ç»„çš„éå†å™¨å¯¹è±¡ã€‚</p>
<p>å®é™…ä¸Šï¼Œä»»ä½•æ•°æ®ç»“æ„åªè¦æœ‰Iteratoræ¥å£ï¼Œå°±å¯ä»¥è¢«<code>yield*</code>éå†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> read = (<span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'hello'</span>;</div><div class="line">  <span class="keyword">yield</span>* <span class="string">'hello'</span>;</div><div class="line">&#125;)();</div><div class="line"></div><div class="line">read.next().value <span class="comment">// "hello"</span></div><div class="line">read.next().value <span class="comment">// "h"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>yield</code>è¯­å¥è¿”å›æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œ<code>yield*</code>è¯­å¥è¿”å›å•ä¸ªå­—ç¬¦ã€‚å› ä¸ºå­—ç¬¦ä¸²å…·æœ‰Iteratoræ¥å£ï¼Œæ‰€ä»¥è¢«<code>yield*</code>éå†ã€‚</p>
<p>å¦‚æœè¢«ä»£ç†çš„Generatorå‡½æ•°æœ‰<code>return</code>è¯­å¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥å‘ä»£ç†å®ƒçš„Generatorå‡½æ•°è¿”å›æ•°æ®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">  <span class="keyword">return</span> <span class="string">"foo"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">var</span> v = <span class="keyword">yield</span> *foo();</div><div class="line">  <span class="built_in">console</span>.log( <span class="string">"v: "</span> + v );</div><div class="line">  <span class="keyword">yield</span> <span class="number">4</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> it = bar();</div><div class="line"></div><div class="line">it.next()</div><div class="line"><span class="comment">// &#123;value: 1, done: false&#125;</span></div><div class="line">it.next()</div><div class="line"><span class="comment">// &#123;value: 2, done: false&#125;</span></div><div class="line">it.next()</div><div class="line"><span class="comment">// &#123;value: 3, done: false&#125;</span></div><div class="line">it.next();</div><div class="line"><span class="comment">// "v: foo"</span></div><div class="line"><span class="comment">// &#123;value: 4, done: false&#125;</span></div><div class="line">it.next()</div><div class="line"><span class="comment">// &#123;value: undefined, done: true&#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨ç¬¬å››æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•çš„æ—¶å€™ï¼Œå±å¹•ä¸Šä¼šæœ‰è¾“å‡ºï¼Œè¿™æ˜¯å› ä¸ºå‡½æ•°<code>foo</code>çš„<code>return</code>è¯­å¥ï¼Œå‘å‡½æ•°<code>bar</code>æä¾›äº†è¿”å›å€¼ã€‚</p>
<p>å†çœ‹ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">genFuncWithReturn</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'a'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'b'</span>;</div><div class="line">  <span class="keyword">return</span> <span class="string">'The result'</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">logReturned</span>(<span class="params">genObj</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> result = <span class="keyword">yield</span>* genObj;</div><div class="line">  <span class="built_in">console</span>.log(result);</div><div class="line">&#125;</div><div class="line"></div><div class="line">[...logReturned(genFuncWithReturn())]</div><div class="line"><span class="comment">// The result</span></div><div class="line"><span class="comment">// å€¼ä¸º [ 'a', 'b' ]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­˜åœ¨ä¸¤æ¬¡éå†ã€‚ç¬¬ä¸€æ¬¡æ˜¯æ‰©å±•è¿ç®—ç¬¦éå†å‡½æ•°<code>logReturned</code>è¿”å›çš„éå†å™¨å¯¹è±¡ï¼Œç¬¬äºŒæ¬¡æ˜¯<code>yield*</code>è¯­å¥éå†å‡½æ•°<code>genFuncWithReturn</code>è¿”å›çš„éå†å™¨å¯¹è±¡ã€‚è¿™ä¸¤æ¬¡éå†çš„æ•ˆæœæ˜¯å åŠ çš„ï¼Œæœ€ç»ˆè¡¨ç°ä¸ºæ‰©å±•è¿ç®—ç¬¦éå†å‡½æ•°<code>genFuncWithReturn</code>è¿”å›çš„éå†å™¨å¯¹è±¡ã€‚æ‰€ä»¥ï¼Œæœ€åçš„æ•°æ®è¡¨è¾¾å¼å¾—åˆ°çš„å€¼ç­‰äº<code>[ &#39;a&#39;, &#39;b&#39; ]</code>ã€‚ä½†æ˜¯ï¼Œå‡½æ•°<code>genFuncWithReturn</code>çš„<code>return</code>è¯­å¥çš„è¿”å›å€¼<code>The result</code>ï¼Œä¼šè¿”å›ç»™å‡½æ•°<code>logReturned</code>å†…éƒ¨çš„<code>result</code>å˜é‡ï¼Œå› æ­¤ä¼šæœ‰ç»ˆç«¯è¾“å‡ºã€‚</p>
<p><code>yield*</code>å‘½ä»¤å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å–å‡ºåµŒå¥—æ•°ç»„çš„æ‰€æœ‰æˆå‘˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">iterTree</span>(<span class="params">tree</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(tree)) &#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>; i &lt; tree.length; i++) &#123;</div><div class="line">      <span class="keyword">yield</span>* iterTree(tree[i]);</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">yield</span> tree;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> tree = [ <span class="string">'a'</span>, [<span class="string">'b'</span>, <span class="string">'c'</span>], [<span class="string">'d'</span>, <span class="string">'e'</span>] ];</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> x <span class="keyword">of</span> iterTree(tree)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div><div class="line"><span class="comment">// a</span></div><div class="line"><span class="comment">// b</span></div><div class="line"><span class="comment">// c</span></div><div class="line"><span class="comment">// d</span></div><div class="line"><span class="comment">// e</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç¨å¾®å¤æ‚çš„ä¾‹å­ï¼Œä½¿ç”¨<code>yield*</code>è¯­å¥éå†å®Œå…¨äºŒå‰æ ‘ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¸‹é¢æ˜¯äºŒå‰æ ‘çš„æ„é€ å‡½æ•°ï¼Œ</span></div><div class="line"><span class="comment">// ä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯å·¦æ ‘ã€å½“å‰èŠ‚ç‚¹å’Œå³æ ‘</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Tree</span>(<span class="params">left, label, right</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.left = left;</div><div class="line">  <span class="keyword">this</span>.label = label;</div><div class="line">  <span class="keyword">this</span>.right = right;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ä¸‹é¢æ˜¯ä¸­åºï¼ˆinorderï¼‰éå†å‡½æ•°ã€‚</span></div><div class="line"><span class="comment">// ç”±äºè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨ï¼Œæ‰€ä»¥è¦ç”¨generatorå‡½æ•°ã€‚</span></div><div class="line"><span class="comment">// å‡½æ•°ä½“å†…é‡‡ç”¨é€’å½’ç®—æ³•ï¼Œæ‰€ä»¥å·¦æ ‘å’Œå³æ ‘è¦ç”¨yield*éå†</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">inorder</span>(<span class="params">t</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (t) &#123;</div><div class="line">    <span class="keyword">yield</span>* inorder(t.left);</div><div class="line">    <span class="keyword">yield</span> t.label;</div><div class="line">    <span class="keyword">yield</span>* inorder(t.right);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ä¸‹é¢ç”ŸæˆäºŒå‰æ ‘</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">make</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="comment">// åˆ¤æ–­æ˜¯å¦ä¸ºå¶èŠ‚ç‚¹</span></div><div class="line">  <span class="keyword">if</span> (array.length == <span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">new</span> Tree(<span class="literal">null</span>, array[<span class="number">0</span>], <span class="literal">null</span>);</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> Tree(make(array[<span class="number">0</span>]), array[<span class="number">1</span>], make(array[<span class="number">2</span>]));</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> tree = make([[[<span class="string">'a'</span>], <span class="string">'b'</span>, [<span class="string">'c'</span>]], <span class="string">'d'</span>, [[<span class="string">'e'</span>], <span class="string">'f'</span>, [<span class="string">'g'</span>]]]);</div><div class="line"></div><div class="line"><span class="comment">// éå†äºŒå‰æ ‘</span></div><div class="line"><span class="keyword">var</span> result = [];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> node <span class="keyword">of</span> inorder(tree)) &#123;</div><div class="line">  result.push(node);</div><div class="line">&#125;</div><div class="line"></div><div class="line">result</div><div class="line"><span class="comment">// ['a', 'b', 'c', 'd', 'e', 'f', 'g']</span></div></pre></td></tr></table></figure>
<h2 id="ä½œä¸ºå¯¹è±¡å±æ€§çš„Generatorå‡½æ•°"><a href="#ä½œä¸ºå¯¹è±¡å±æ€§çš„Generatorå‡½æ•°" class="headerlink" title="ä½œä¸ºå¯¹è±¡å±æ€§çš„Generatorå‡½æ•°"></a>ä½œä¸ºå¯¹è±¡å±æ€§çš„Generatorå‡½æ•°</h2><p>å¦‚æœä¸€ä¸ªå¯¹è±¡çš„å±æ€§æ˜¯Generatorå‡½æ•°ï¼Œå¯ä»¥ç®€å†™æˆä¸‹é¢çš„å½¢å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  * myGeneratorMethod() &#123;</div><div class="line">    Â·Â·Â·</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>myGeneratorMethod</code>å±æ€§å‰é¢æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼Œè¡¨ç¤ºè¿™ä¸ªå±æ€§æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ã€‚</p>
<p>å®ƒçš„å®Œæ•´å½¢å¼å¦‚ä¸‹ï¼Œä¸ä¸Šé¢çš„å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  <span class="attr">myGeneratorMethod</span>: <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// Â·Â·Â·</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="Generatorå‡½æ•°çš„this"><a href="#Generatorå‡½æ•°çš„this" class="headerlink" title="Generatorå‡½æ•°çš„this"></a>Generatorå‡½æ•°çš„<code>this</code></h2><p>Generatorå‡½æ•°æ€»æ˜¯è¿”å›ä¸€ä¸ªéå†å™¨ï¼ŒES6è§„å®šè¿™ä¸ªéå†å™¨æ˜¯Generatorå‡½æ•°çš„å®ä¾‹ï¼Œä¹Ÿç»§æ‰¿äº†Generatorå‡½æ•°çš„<code>prototype</code>å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">g</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line"></div><div class="line">g.prototype.hello = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">'hi!'</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = g();</div><div class="line"></div><div class="line">obj <span class="keyword">instanceof</span> g <span class="comment">// true</span></div><div class="line">obj.hello() <span class="comment">// 'hi!'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨æ˜ï¼ŒGeneratorå‡½æ•°<code>g</code>è¿”å›çš„éå†å™¨<code>obj</code>ï¼Œæ˜¯<code>g</code>çš„å®ä¾‹ï¼Œè€Œä¸”ç»§æ‰¿äº†<code>g.prototype</code>ã€‚ä½†æ˜¯ï¼Œå¦‚æœæŠŠ<code>g</code>å½“ä½œæ™®é€šçš„æ„é€ å‡½æ•°ï¼Œå¹¶ä¸ä¼šç”Ÿæ•ˆï¼Œå› ä¸º<code>g</code>è¿”å›çš„æ€»æ˜¯éå†å™¨å¯¹è±¡ï¼Œè€Œä¸æ˜¯<code>this</code>å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">g</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.a = <span class="number">11</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = g();</div><div class="line">obj.a <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒGeneratorå‡½æ•°<code>g</code>åœ¨<code>this</code>å¯¹è±¡ä¸Šé¢æ·»åŠ äº†ä¸€ä¸ªå±æ€§<code>a</code>ï¼Œä½†æ˜¯<code>obj</code>å¯¹è±¡æ‹¿ä¸åˆ°è¿™ä¸ªå±æ€§ã€‚</p>
<p>Generatorå‡½æ•°ä¹Ÿä¸èƒ½è·Ÿ<code>new</code>å‘½ä»¤ä¸€èµ·ç”¨ï¼Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">F</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="keyword">this</span>.x = <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="keyword">this</span>.y = <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">new</span> F()</div><div class="line"><span class="comment">// TypeError: F is not a constructor</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>new</code>å‘½ä»¤è·Ÿæ„é€ å‡½æ•°<code>F</code>ä¸€èµ·ä½¿ç”¨ï¼Œç»“æœæŠ¥é”™ï¼Œå› ä¸º<code>F</code>ä¸æ˜¯æ„é€ å‡½æ•°ã€‚</p>
<p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰åŠæ³•è®©Generatorå‡½æ•°è¿”å›ä¸€ä¸ªæ­£å¸¸çš„å¯¹è±¡å®ä¾‹ï¼Œæ—¢å¯ä»¥ç”¨<code>next</code>æ–¹æ³•ï¼Œåˆå¯ä»¥è·å¾—æ­£å¸¸çš„<code>this</code>ï¼Ÿ</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå˜é€šæ–¹æ³•ã€‚é¦–å…ˆï¼Œç”Ÿæˆä¸€ä¸ªç©ºå¯¹è±¡ï¼Œä½¿ç”¨<code>call</code>æ–¹æ³•ç»‘å®šGeneratorå‡½æ•°å†…éƒ¨çš„<code>this</code>ã€‚è¿™æ ·ï¼Œæ„é€ å‡½æ•°è°ƒç”¨ä»¥åï¼Œè¿™ä¸ªç©ºå¯¹è±¡å°±æ˜¯Generatorå‡½æ•°çš„å®ä¾‹å¯¹è±¡äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">F</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.a = <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="keyword">this</span>.b = <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="keyword">this</span>.c = <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> f = F.call(obj);</div><div class="line"></div><div class="line">f.next();  <span class="comment">// Object &#123;value: 2, done: false&#125;</span></div><div class="line">f.next();  <span class="comment">// Object &#123;value: 3, done: false&#125;</span></div><div class="line">f.next();  <span class="comment">// Object &#123;value: undefined, done: true&#125;</span></div><div class="line"></div><div class="line">obj.a <span class="comment">// 1</span></div><div class="line">obj.b <span class="comment">// 2</span></div><div class="line">obj.c <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œé¦–å…ˆæ˜¯<code>F</code>å†…éƒ¨çš„<code>this</code>å¯¹è±¡ç»‘å®š<code>obj</code>å¯¹è±¡ï¼Œç„¶åè°ƒç”¨å®ƒï¼Œè¿”å›ä¸€ä¸ªIteratorå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡æ‰§è¡Œä¸‰æ¬¡<code>next</code>æ–¹æ³•ï¼ˆå› ä¸º<code>F</code>å†…éƒ¨æœ‰ä¸¤ä¸ª<code>yield</code>è¯­å¥ï¼‰ï¼Œå®ŒæˆFå†…éƒ¨æ‰€æœ‰ä»£ç çš„è¿è¡Œã€‚è¿™æ—¶ï¼Œæ‰€æœ‰å†…éƒ¨å±æ€§éƒ½ç»‘å®šåœ¨<code>obj</code>å¯¹è±¡ä¸Šäº†ï¼Œå› æ­¤<code>obj</code>å¯¹è±¡ä¹Ÿå°±æˆäº†<code>F</code>çš„å®ä¾‹ã€‚</p>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ‰§è¡Œçš„æ˜¯éå†å™¨å¯¹è±¡<code>f</code>ï¼Œä½†æ˜¯ç”Ÿæˆçš„å¯¹è±¡å®ä¾‹æ˜¯<code>obj</code>ï¼Œæœ‰æ²¡æœ‰åŠæ³•å°†è¿™ä¸¤ä¸ªå¯¹è±¡ç»Ÿä¸€å‘¢ï¼Ÿ</p>
<p>ä¸€ä¸ªåŠæ³•å°±æ˜¯å°†<code>obj</code>æ¢æˆ<code>F.prototype</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">F</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.a = <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="keyword">this</span>.b = <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="keyword">this</span>.c = <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> f = F.call(F.prototype);</div><div class="line"></div><div class="line">f.next();  <span class="comment">// Object &#123;value: 2, done: false&#125;</span></div><div class="line">f.next();  <span class="comment">// Object &#123;value: 3, done: false&#125;</span></div><div class="line">f.next();  <span class="comment">// Object &#123;value: undefined, done: true&#125;</span></div><div class="line"></div><div class="line">f.a <span class="comment">// 1</span></div><div class="line">f.b <span class="comment">// 2</span></div><div class="line">f.c <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>å†å°†<code>F</code>æ”¹æˆæ„é€ å‡½æ•°ï¼Œå°±å¯ä»¥å¯¹å®ƒæ‰§è¡Œ<code>new</code>å‘½ä»¤äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.a = <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="keyword">this</span>.b = <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="keyword">this</span>.c = <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">F</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> gen.call(gen.prototype);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> f = <span class="keyword">new</span> F();</div><div class="line"></div><div class="line">f.next();  <span class="comment">// Object &#123;value: 2, done: false&#125;</span></div><div class="line">f.next();  <span class="comment">// Object &#123;value: 3, done: false&#125;</span></div><div class="line">f.next();  <span class="comment">// Object &#123;value: undefined, done: true&#125;</span></div><div class="line"></div><div class="line">f.a <span class="comment">// 1</span></div><div class="line">f.b <span class="comment">// 2</span></div><div class="line">f.c <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<h2 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h2><h3 id="Generatorä¸çŠ¶æ€æœº"><a href="#Generatorä¸çŠ¶æ€æœº" class="headerlink" title="Generatorä¸çŠ¶æ€æœº"></a>Generatorä¸çŠ¶æ€æœº</h3><p>Generatoræ˜¯å®ç°çŠ¶æ€æœºçš„æœ€ä½³ç»“æ„ã€‚æ¯”å¦‚ï¼Œä¸‹é¢çš„clockå‡½æ•°å°±æ˜¯ä¸€ä¸ªçŠ¶æ€æœºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ticking = <span class="literal">true</span>;</div><div class="line"><span class="keyword">var</span> clock = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (ticking)</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Tick!'</span>);</div><div class="line">  <span class="keyword">else</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Tock!'</span>);</div><div class="line">  ticking = !ticking;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„clockå‡½æ•°ä¸€å…±æœ‰ä¸¤ç§çŠ¶æ€ï¼ˆTickå’ŒTockï¼‰ï¼Œæ¯è¿è¡Œä¸€æ¬¡ï¼Œå°±æ”¹å˜ä¸€æ¬¡çŠ¶æ€ã€‚è¿™ä¸ªå‡½æ•°å¦‚æœç”¨Generatorå®ç°ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> clock = <span class="function"><span class="keyword">function</span>*(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Tick!'</span>);</div><div class="line">    <span class="keyword">yield</span>;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Tock!'</span>);</div><div class="line">    <span class="keyword">yield</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„Generatorå®ç°ä¸ES5å®ç°å¯¹æ¯”ï¼Œå¯ä»¥çœ‹åˆ°å°‘äº†ç”¨æ¥ä¿å­˜çŠ¶æ€çš„å¤–éƒ¨å˜é‡<code>ticking</code>ï¼Œè¿™æ ·å°±æ›´ç®€æ´ï¼Œæ›´å®‰å…¨ï¼ˆçŠ¶æ€ä¸ä¼šè¢«éæ³•ç¯¡æ”¹ï¼‰ã€æ›´ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹çš„æ€æƒ³ï¼Œåœ¨å†™æ³•ä¸Šä¹Ÿæ›´ä¼˜é›…ã€‚Generatorä¹‹æ‰€ä»¥å¯ä»¥ä¸ç”¨å¤–éƒ¨å˜é‡ä¿å­˜çŠ¶æ€ï¼Œæ˜¯å› ä¸ºå®ƒæœ¬èº«å°±åŒ…å«äº†ä¸€ä¸ªçŠ¶æ€ä¿¡æ¯ï¼Œå³ç›®å‰æ˜¯å¦å¤„äºæš‚åœæ€ã€‚</p>
<h3 id="Generatorä¸åç¨‹"><a href="#Generatorä¸åç¨‹" class="headerlink" title="Generatorä¸åç¨‹"></a>Generatorä¸åç¨‹</h3><p>åç¨‹ï¼ˆcoroutineï¼‰æ˜¯ä¸€ç§ç¨‹åºè¿è¡Œçš„æ–¹å¼ï¼Œå¯ä»¥ç†è§£æˆâ€œåä½œçš„çº¿ç¨‹â€æˆ–â€œåä½œçš„å‡½æ•°â€ã€‚åç¨‹æ—¢å¯ä»¥ç”¨å•çº¿ç¨‹å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨å¤šçº¿ç¨‹å®ç°ã€‚å‰è€…æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­ä¾‹ç¨‹ï¼Œåè€…æ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿ç¨‹ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰åç¨‹ä¸å­ä¾‹ç¨‹çš„å·®å¼‚</strong></p>
<p>ä¼ ç»Ÿçš„â€œå­ä¾‹ç¨‹â€ï¼ˆsubroutineï¼‰é‡‡ç”¨å †æ ˆå¼â€œåè¿›å…ˆå‡ºâ€çš„æ‰§è¡Œæ–¹å¼ï¼Œåªæœ‰å½“è°ƒç”¨çš„å­å‡½æ•°å®Œå…¨æ‰§è¡Œå®Œæ¯•ï¼Œæ‰ä¼šç»“æŸæ‰§è¡Œçˆ¶å‡½æ•°ã€‚åç¨‹ä¸å…¶ä¸åŒï¼Œå¤šä¸ªçº¿ç¨‹ï¼ˆå•çº¿ç¨‹æƒ…å†µä¸‹ï¼Œå³å¤šä¸ªå‡½æ•°ï¼‰å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œä½†æ˜¯åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰å¤„äºæ­£åœ¨è¿è¡Œçš„çŠ¶æ€ï¼Œå…¶ä»–çº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰éƒ½å¤„äºæš‚åœæ€ï¼ˆsuspendedï¼‰ï¼Œçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰ä¹‹é—´å¯ä»¥äº¤æ¢æ‰§è¡Œæƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰æ‰§è¡Œåˆ°ä¸€åŠï¼Œå¯ä»¥æš‚åœæ‰§è¡Œï¼Œå°†æ‰§è¡Œæƒäº¤ç»™å¦ä¸€ä¸ªçº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰ï¼Œç­‰åˆ°ç¨åæ”¶å›æ‰§è¡Œæƒçš„æ—¶å€™ï¼Œå†æ¢å¤æ‰§è¡Œã€‚è¿™ç§å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€äº¤æ¢æ‰§è¡Œæƒçš„çº¿ç¨‹ï¼ˆæˆ–å‡½æ•°ï¼‰ï¼Œå°±ç§°ä¸ºåç¨‹ã€‚</p>
<p>ä»å®ç°ä¸Šçœ‹ï¼Œåœ¨å†…å­˜ä¸­ï¼Œå­ä¾‹ç¨‹åªä½¿ç”¨ä¸€ä¸ªæ ˆï¼ˆstackï¼‰ï¼Œè€Œåç¨‹æ˜¯åŒæ—¶å­˜åœ¨å¤šä¸ªæ ˆï¼Œä½†åªæœ‰ä¸€ä¸ªæ ˆæ˜¯åœ¨è¿è¡ŒçŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåç¨‹æ˜¯ä»¥å¤šå ç”¨å†…å­˜ä¸ºä»£ä»·ï¼Œå®ç°å¤šä»»åŠ¡çš„å¹¶è¡Œã€‚</p>
<p><strong>ï¼ˆ2ï¼‰åç¨‹ä¸æ™®é€šçº¿ç¨‹çš„å·®å¼‚</strong></p>
<p>ä¸éš¾çœ‹å‡ºï¼Œåç¨‹é€‚åˆç”¨äºå¤šä»»åŠ¡è¿è¡Œçš„ç¯å¢ƒã€‚åœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œå®ƒä¸æ™®é€šçš„çº¿ç¨‹å¾ˆç›¸ä¼¼ï¼Œéƒ½æœ‰è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€å¯ä»¥åˆ†äº«å…¨å±€å˜é‡ã€‚å®ƒä»¬çš„ä¸åŒä¹‹å¤„åœ¨äºï¼ŒåŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ï¼Œä½†æ˜¯è¿è¡Œçš„åç¨‹åªèƒ½æœ‰ä¸€ä¸ªï¼Œå…¶ä»–åç¨‹éƒ½å¤„äºæš‚åœçŠ¶æ€ã€‚æ­¤å¤–ï¼Œæ™®é€šçš„çº¿ç¨‹æ˜¯æŠ¢å…ˆå¼çš„ï¼Œåˆ°åº•å“ªä¸ªçº¿ç¨‹ä¼˜å…ˆå¾—åˆ°èµ„æºï¼Œå¿…é¡»ç”±è¿è¡Œç¯å¢ƒå†³å®šï¼Œä½†æ˜¯åç¨‹æ˜¯åˆä½œå¼çš„ï¼Œæ‰§è¡Œæƒç”±åç¨‹è‡ªå·±åˆ†é…ã€‚</p>
<p>ç”±äºECMAScriptæ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œåªèƒ½ä¿æŒä¸€ä¸ªè°ƒç”¨æ ˆã€‚å¼•å…¥åç¨‹ä»¥åï¼Œæ¯ä¸ªä»»åŠ¡å¯ä»¥ä¿æŒè‡ªå·±çš„è°ƒç”¨æ ˆã€‚è¿™æ ·åšçš„æœ€å¤§å¥½å¤„ï¼Œå°±æ˜¯æŠ›å‡ºé”™è¯¯çš„æ—¶å€™ï¼Œå¯ä»¥æ‰¾åˆ°åŸå§‹çš„è°ƒç”¨æ ˆã€‚ä¸è‡³äºåƒå¼‚æ­¥æ“ä½œçš„å›è°ƒå‡½æ•°é‚£æ ·ï¼Œä¸€æ—¦å‡ºé”™ï¼ŒåŸå§‹çš„è°ƒç”¨æ ˆæ—©å°±ç»“æŸã€‚</p>
<p>Generatorå‡½æ•°æ˜¯ECMAScript 6å¯¹åç¨‹çš„å®ç°ï¼Œä½†å±äºä¸å®Œå…¨å®ç°ã€‚Generatorå‡½æ•°è¢«ç§°ä¸ºâ€œåŠåç¨‹â€ï¼ˆsemi-coroutineï¼‰ï¼Œæ„æ€æ˜¯åªæœ‰Generatorå‡½æ•°çš„è°ƒç”¨è€…ï¼Œæ‰èƒ½å°†ç¨‹åºçš„æ‰§è¡Œæƒè¿˜ç»™Generatorå‡½æ•°ã€‚å¦‚æœæ˜¯å®Œå…¨æ‰§è¡Œçš„åç¨‹ï¼Œä»»ä½•å‡½æ•°éƒ½å¯ä»¥è®©æš‚åœçš„åç¨‹ç»§ç»­æ‰§è¡Œã€‚</p>
<p>å¦‚æœå°†Generatorå‡½æ•°å½“ä½œåç¨‹ï¼Œå®Œå…¨å¯ä»¥å°†å¤šä¸ªéœ€è¦äº’ç›¸åä½œçš„ä»»åŠ¡å†™æˆGeneratorå‡½æ•°ï¼Œå®ƒä»¬ä¹‹é—´ä½¿ç”¨yieldè¯­å¥äº¤æ¢æ§åˆ¶æƒã€‚</p>
<h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><p>Generatorå¯ä»¥æš‚åœå‡½æ•°æ‰§è¡Œï¼Œè¿”å›ä»»æ„è¡¨è¾¾å¼çš„å€¼ã€‚è¿™ç§ç‰¹ç‚¹ä½¿å¾—Generatoræœ‰å¤šç§åº”ç”¨åœºæ™¯ã€‚</p>
<h3 id="ï¼ˆ1ï¼‰å¼‚æ­¥æ“ä½œçš„åŒæ­¥åŒ–è¡¨è¾¾"><a href="#ï¼ˆ1ï¼‰å¼‚æ­¥æ“ä½œçš„åŒæ­¥åŒ–è¡¨è¾¾" class="headerlink" title="ï¼ˆ1ï¼‰å¼‚æ­¥æ“ä½œçš„åŒæ­¥åŒ–è¡¨è¾¾"></a>ï¼ˆ1ï¼‰å¼‚æ­¥æ“ä½œçš„åŒæ­¥åŒ–è¡¨è¾¾</h3><p>Generatorå‡½æ•°çš„æš‚åœæ‰§è¡Œçš„æ•ˆæœï¼Œæ„å‘³ç€å¯ä»¥æŠŠå¼‚æ­¥æ“ä½œå†™åœ¨yieldè¯­å¥é‡Œé¢ï¼Œç­‰åˆ°è°ƒç”¨nextæ–¹æ³•æ—¶å†å¾€åæ‰§è¡Œã€‚è¿™å®é™…ä¸Šç­‰åŒäºä¸éœ€è¦å†™å›è°ƒå‡½æ•°äº†ï¼Œå› ä¸ºå¼‚æ­¥æ“ä½œçš„åç»­æ“ä½œå¯ä»¥æ”¾åœ¨yieldè¯­å¥ä¸‹é¢ï¼Œåæ­£è¦ç­‰åˆ°è°ƒç”¨nextæ–¹æ³•æ—¶å†æ‰§è¡Œã€‚æ‰€ä»¥ï¼ŒGeneratorå‡½æ•°çš„ä¸€ä¸ªé‡è¦å®é™…æ„ä¹‰å°±æ˜¯ç”¨æ¥å¤„ç†å¼‚æ­¥æ“ä½œï¼Œæ”¹å†™å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">loadUI</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  showLoadingScreen();</div><div class="line">  <span class="keyword">yield</span> loadUIDataAsynchronously();</div><div class="line">  hideLoadingScreen();</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> loader = loadUI();</div><div class="line"><span class="comment">// åŠ è½½UI</span></div><div class="line">loader.next()</div><div class="line"></div><div class="line"><span class="comment">// å¸è½½UI</span></div><div class="line">loader.next()</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨loadUIå‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°ä¸ä¼šæ‰§è¡Œï¼Œä»…è¿”å›ä¸€ä¸ªéå†å™¨ã€‚ä¸‹ä¸€æ¬¡å¯¹è¯¥éå†å™¨è°ƒç”¨nextæ–¹æ³•ï¼Œåˆ™ä¼šæ˜¾ç¤ºLoadingç•Œé¢ï¼Œå¹¶ä¸”å¼‚æ­¥åŠ è½½æ•°æ®ã€‚ç­‰åˆ°æ•°æ®åŠ è½½å®Œæˆï¼Œå†ä¸€æ¬¡ä½¿ç”¨nextæ–¹æ³•ï¼Œåˆ™ä¼šéšè—Loadingç•Œé¢ã€‚å¯ä»¥çœ‹åˆ°ï¼Œè¿™ç§å†™æ³•çš„å¥½å¤„æ˜¯æ‰€æœ‰Loadingç•Œé¢çš„é€»è¾‘ï¼Œéƒ½è¢«å°è£…åœ¨ä¸€ä¸ªå‡½æ•°ï¼ŒæŒ‰éƒ¨å°±ç­éå¸¸æ¸…æ™°ã€‚</p>
<p>Ajaxæ˜¯å…¸å‹çš„å¼‚æ­¥æ“ä½œï¼Œé€šè¿‡Generatorå‡½æ•°éƒ¨ç½²Ajaxæ“ä½œï¼Œå¯ä»¥ç”¨åŒæ­¥çš„æ–¹å¼è¡¨è¾¾ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">main</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> result = <span class="keyword">yield</span> request(<span class="string">"http://some.url"</span>);</div><div class="line">  <span class="keyword">var</span> resp = <span class="built_in">JSON</span>.parse(result);</div><div class="line">    <span class="built_in">console</span>.log(resp.value);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">request</span>(<span class="params">url</span>) </span>&#123;</div><div class="line">  makeAjaxCall(url, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</div><div class="line">    it.next(response);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> it = main();</div><div class="line">it.next();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„mainå‡½æ•°ï¼Œå°±æ˜¯é€šè¿‡Ajaxæ“ä½œè·å–æ•°æ®ã€‚å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†å¤šäº†ä¸€ä¸ªyieldï¼Œå®ƒå‡ ä¹ä¸åŒæ­¥æ“ä½œçš„å†™æ³•å®Œå…¨ä¸€æ ·ã€‚æ³¨æ„ï¼ŒmakeAjaxCallå‡½æ•°ä¸­çš„nextæ–¹æ³•ï¼Œå¿…é¡»åŠ ä¸Šresponseå‚æ•°ï¼Œå› ä¸ºyieldè¯­å¥æ„æˆçš„è¡¨è¾¾å¼ï¼Œæœ¬èº«æ˜¯æ²¡æœ‰å€¼çš„ï¼Œæ€»æ˜¯ç­‰äºundefinedã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œé€šè¿‡Generatorå‡½æ•°é€è¡Œè¯»å–æ–‡æœ¬æ–‡ä»¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">numbers</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> file = <span class="keyword">new</span> FileReader(<span class="string">"numbers.txt"</span>);</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">while</span>(!file.eof) &#123;</div><div class="line">      <span class="keyword">yield</span> <span class="built_in">parseInt</span>(file.readLine(), <span class="number">10</span>);</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">finally</span> &#123;</div><div class="line">    file.close();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ‰“å¼€æ–‡æœ¬æ–‡ä»¶ï¼Œä½¿ç”¨yieldè¯­å¥å¯ä»¥æ‰‹åŠ¨é€è¡Œè¯»å–æ–‡ä»¶ã€‚</p>
<h3 id="ï¼ˆ2ï¼‰æ§åˆ¶æµç®¡ç†"><a href="#ï¼ˆ2ï¼‰æ§åˆ¶æµç®¡ç†" class="headerlink" title="ï¼ˆ2ï¼‰æ§åˆ¶æµç®¡ç†"></a>ï¼ˆ2ï¼‰æ§åˆ¶æµç®¡ç†</h3><p>å¦‚æœæœ‰ä¸€ä¸ªå¤šæ­¥æ“ä½œéå¸¸è€—æ—¶ï¼Œé‡‡ç”¨å›è°ƒå‡½æ•°ï¼Œå¯èƒ½ä¼šå†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">step1(<span class="function"><span class="keyword">function</span> (<span class="params">value1</span>) </span>&#123;</div><div class="line">  step2(value1, <span class="function"><span class="keyword">function</span>(<span class="params">value2</span>) </span>&#123;</div><div class="line">    step3(value2, <span class="function"><span class="keyword">function</span>(<span class="params">value3</span>) </span>&#123;</div><div class="line">      step4(value3, <span class="function"><span class="keyword">function</span>(<span class="params">value4</span>) </span>&#123;</div><div class="line">        <span class="comment">// Do something with value4</span></div><div class="line">      &#125;);</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>é‡‡ç”¨Promiseæ”¹å†™ä¸Šé¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Promise</span>.resolve(step1)</div><div class="line">  .then(step2)</div><div class="line">  .then(step3)</div><div class="line">  .then(step4)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">value4</span>) </span>&#123;</div><div class="line">    <span class="comment">// Do something with value4</span></div><div class="line">  &#125;, <span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">    <span class="comment">// Handle any error from step1 through step4</span></div><div class="line">  &#125;)</div><div class="line">  .done();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å·²ç»æŠŠå›è°ƒå‡½æ•°ï¼Œæ”¹æˆäº†ç›´çº¿æ‰§è¡Œçš„å½¢å¼ï¼Œä½†æ˜¯åŠ å…¥äº†å¤§é‡Promiseçš„è¯­æ³•ã€‚Generatorå‡½æ•°å¯ä»¥è¿›ä¸€æ­¥æ”¹å–„ä»£ç è¿è¡Œæµç¨‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">longRunningTask</span>(<span class="params">value1</span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">var</span> value2 = <span class="keyword">yield</span> step1(value1);</div><div class="line">    <span class="keyword">var</span> value3 = <span class="keyword">yield</span> step2(value2);</div><div class="line">    <span class="keyword">var</span> value4 = <span class="keyword">yield</span> step3(value3);</div><div class="line">    <span class="keyword">var</span> value5 = <span class="keyword">yield</span> step4(value4);</div><div class="line">    <span class="comment">// Do something with value4</span></div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="comment">// Handle any error from step1 through step4</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‡½æ•°ï¼ŒæŒ‰æ¬¡åºè‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰æ­¥éª¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">scheduler(longRunningTask(initialValue));</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">scheduler</span>(<span class="params">task</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> taskObj = task.next(task.value);</div><div class="line">  <span class="comment">// å¦‚æœGeneratorå‡½æ•°æœªç»“æŸï¼Œå°±ç»§ç»­è°ƒç”¨</span></div><div class="line">  <span class="keyword">if</span> (!taskObj.done) &#123;</div><div class="line">    task.value = taskObj.value</div><div class="line">    scheduler(task);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œä¸Šé¢è¿™ç§åšæ³•ï¼Œåªé€‚åˆåŒæ­¥æ“ä½œï¼Œå³æ‰€æœ‰çš„<code>task</code>éƒ½å¿…é¡»æ˜¯åŒæ­¥çš„ï¼Œä¸èƒ½æœ‰å¼‚æ­¥æ“ä½œã€‚å› ä¸ºè¿™é‡Œçš„ä»£ç ä¸€å¾—åˆ°è¿”å›å€¼ï¼Œå°±ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œæ²¡æœ‰åˆ¤æ–­å¼‚æ­¥æ“ä½œä½•æ—¶å®Œæˆã€‚å¦‚æœè¦æ§åˆ¶å¼‚æ­¥çš„æ“ä½œæµç¨‹ï¼Œè¯¦è§åé¢çš„ã€Šå¼‚æ­¥æ“ä½œã€‹ä¸€ç« ã€‚</p>
<p>ä¸‹é¢ï¼Œåˆ©ç”¨<code>for...of</code>å¾ªç¯ä¼šè‡ªåŠ¨ä¾æ¬¡æ‰§è¡Œ<code>yield</code>å‘½ä»¤çš„ç‰¹æ€§ï¼Œæä¾›ä¸€ç§æ›´ä¸€èˆ¬çš„æ§åˆ¶æµç®¡ç†çš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> steps = [step1Func, step2Func, step3Func];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">iterateSteps</span>(<span class="params">steps</span>)</span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt; steps.length; i++)&#123;</div><div class="line">    <span class="keyword">var</span> step = steps[i];</div><div class="line">    <span class="keyword">yield</span> step();</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„<code>steps</code>å°è£…äº†ä¸€ä¸ªä»»åŠ¡çš„å¤šä¸ªæ­¥éª¤ï¼ŒGeneratorå‡½æ•°<code>iterateSteps</code>åˆ™æ˜¯ä¾æ¬¡ä¸ºè¿™äº›æ­¥éª¤åŠ ä¸Š<code>yield</code>å‘½ä»¤ã€‚</p>
<p>å°†ä»»åŠ¡åˆ†è§£æˆæ­¥éª¤ä¹‹åï¼Œè¿˜å¯ä»¥å°†é¡¹ç›®åˆ†è§£æˆå¤šä¸ªä¾æ¬¡æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> jobs = [job1, job2, job3];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">iterateJobs</span>(<span class="params">jobs</span>)</span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt; jobs.length; i++)&#123;</div><div class="line">    <span class="keyword">var</span> job = jobs[i];</div><div class="line">    <span class="keyword">yield</span> *iterateSteps(job.steps);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„<code>jobs</code>å°è£…äº†ä¸€ä¸ªé¡¹ç›®çš„å¤šä¸ªä»»åŠ¡ï¼ŒGeneratorå‡½æ•°<code>iterateJobs</code>åˆ™æ˜¯ä¾æ¬¡ä¸ºè¿™äº›ä»»åŠ¡åŠ ä¸Š<code>yield *</code>å‘½ä»¤ã€‚</p>
<p>æœ€åï¼Œå°±å¯ä»¥ç”¨<code>for...of</code>å¾ªç¯ä¸€æ¬¡æ€§ä¾æ¬¡æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡çš„æ‰€æœ‰æ­¥éª¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> step <span class="keyword">of</span> iterateJobs(jobs))&#123;</div><div class="line">  <span class="built_in">console</span>.log(step.id);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†æ¬¡æé†’ï¼Œä¸Šé¢çš„åšæ³•åªèƒ½ç”¨äºæ‰€æœ‰æ­¥éª¤éƒ½æ˜¯åŒæ­¥æ“ä½œçš„æƒ…å†µï¼Œä¸èƒ½æœ‰å¼‚æ­¥æ“ä½œçš„æ­¥éª¤ã€‚å¦‚æœæƒ³è¦ä¾æ¬¡æ‰§è¡Œå¼‚æ­¥çš„æ­¥éª¤ï¼Œå¿…é¡»ä½¿ç”¨åé¢çš„ã€Šå¼‚æ­¥æ“ä½œã€‹ä¸€ç« ä»‹ç»çš„æ–¹æ³•ã€‚</p>
<p><code>for...of</code>çš„æœ¬è´¨æ˜¯ä¸€ä¸ª<code>while</code>å¾ªç¯ï¼Œæ‰€ä»¥ä¸Šé¢çš„ä»£ç å®è´¨ä¸Šæ‰§è¡Œçš„æ˜¯ä¸‹é¢çš„é€»è¾‘ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> it = iterateJobs(jobs);</div><div class="line"><span class="keyword">var</span> res = it.next();</div><div class="line"></div><div class="line"><span class="keyword">while</span> (!res.done)&#123;</div><div class="line">  <span class="keyword">var</span> result = res.value;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  res = it.next();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="ï¼ˆ3ï¼‰éƒ¨ç½²Iteratoræ¥å£"><a href="#ï¼ˆ3ï¼‰éƒ¨ç½²Iteratoræ¥å£" class="headerlink" title="ï¼ˆ3ï¼‰éƒ¨ç½²Iteratoræ¥å£"></a>ï¼ˆ3ï¼‰éƒ¨ç½²Iteratoræ¥å£</h3><p>åˆ©ç”¨Generatorå‡½æ•°ï¼Œå¯ä»¥åœ¨ä»»æ„å¯¹è±¡ä¸Šéƒ¨ç½²Iteratoræ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">iterEntries</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> keys = <span class="built_in">Object</span>.keys(obj);</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i=<span class="number">0</span>; i &lt; keys.length; i++) &#123;</div><div class="line">    <span class="keyword">let</span> key = keys[i];</div><div class="line">    <span class="keyword">yield</span> [key, obj[key]];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> myObj = &#123; <span class="attr">foo</span>: <span class="number">3</span>, <span class="attr">bar</span>: <span class="number">7</span> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> iterEntries(myObj)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key, value);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// foo 3</span></div><div class="line"><span class="comment">// bar 7</span></div></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œ<code>myObj</code>æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡ï¼Œé€šè¿‡<code>iterEntries</code>å‡½æ•°ï¼Œå°±æœ‰äº†Iteratoræ¥å£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥åœ¨ä»»æ„å¯¹è±¡ä¸Šéƒ¨ç½²<code>next</code>æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹æ•°ç»„éƒ¨ç½²Iteratoræ¥å£çš„ä¾‹å­ï¼Œå°½ç®¡æ•°ç»„åŸç”Ÿå…·æœ‰è¿™ä¸ªæ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">makeSimpleGenerator</span>(<span class="params">array</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> nextIndex = <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">while</span>(nextIndex &lt; array.length)&#123;</div><div class="line">    <span class="keyword">yield</span> array[nextIndex++];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> gen = makeSimpleGenerator([<span class="string">'yo'</span>, <span class="string">'ya'</span>]);</div><div class="line"></div><div class="line">gen.next().value <span class="comment">// 'yo'</span></div><div class="line">gen.next().value <span class="comment">// 'ya'</span></div><div class="line">gen.next().done  <span class="comment">// true</span></div></pre></td></tr></table></figure>
<h3 id="ï¼ˆ4ï¼‰ä½œä¸ºæ•°æ®ç»“æ„"><a href="#ï¼ˆ4ï¼‰ä½œä¸ºæ•°æ®ç»“æ„" class="headerlink" title="ï¼ˆ4ï¼‰ä½œä¸ºæ•°æ®ç»“æ„"></a>ï¼ˆ4ï¼‰ä½œä¸ºæ•°æ®ç»“æ„</h3><p>Generatorå¯ä»¥çœ‹ä½œæ˜¯æ•°æ®ç»“æ„ï¼Œæ›´ç¡®åˆ‡åœ°è¯´ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªæ•°ç»„ç»“æ„ï¼Œå› ä¸ºGeneratorå‡½æ•°å¯ä»¥è¿”å›ä¸€ç³»åˆ—çš„å€¼ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥å¯¹ä»»æ„è¡¨è¾¾å¼ï¼Œæä¾›ç±»ä¼¼æ•°ç»„çš„æ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">doStuff</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> fs.readFile.bind(<span class="literal">null</span>, <span class="string">'hello.txt'</span>);</div><div class="line">  <span class="keyword">yield</span> fs.readFile.bind(<span class="literal">null</span>, <span class="string">'world.txt'</span>);</div><div class="line">  <span class="keyword">yield</span> fs.readFile.bind(<span class="literal">null</span>, <span class="string">'and-such.txt'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°±æ˜¯ä¾æ¬¡è¿”å›ä¸‰ä¸ªå‡½æ•°ï¼Œä½†æ˜¯ç”±äºä½¿ç”¨äº†Generatorå‡½æ•°ï¼Œå¯¼è‡´å¯ä»¥åƒå¤„ç†æ•°ç»„é‚£æ ·ï¼Œå¤„ç†è¿™ä¸‰ä¸ªè¿”å›çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (task <span class="keyword">of</span> doStuff()) &#123;</div><div class="line">  <span class="comment">// taskæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥åƒå›è°ƒå‡½æ•°é‚£æ ·ä½¿ç”¨å®ƒ</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®é™…ä¸Šï¼Œå¦‚æœç”¨ES5è¡¨è¾¾ï¼Œå®Œå…¨å¯ä»¥ç”¨æ•°ç»„æ¨¡æ‹ŸGeneratorçš„è¿™ç§ç”¨æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doStuff</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [</div><div class="line">    fs.readFile.bind(<span class="literal">null</span>, <span class="string">'hello.txt'</span>),</div><div class="line">    fs.readFile.bind(<span class="literal">null</span>, <span class="string">'world.txt'</span>),</div><div class="line">    fs.readFile.bind(<span class="literal">null</span>, <span class="string">'and-such.txt'</span>)</div><div class="line">  ];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„å‡½æ•°ï¼Œå¯ä»¥ç”¨ä¸€æ¨¡ä¸€æ ·çš„forâ€¦ofå¾ªç¯å¤„ç†ï¼ä¸¤ç›¸ä¸€æ¯”è¾ƒï¼Œå°±ä¸éš¾çœ‹å‡ºGeneratorä½¿å¾—æ•°æ®æˆ–è€…æ“ä½œï¼Œå…·å¤‡äº†ç±»ä¼¼æ•°ç»„çš„æ¥å£ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Generator-å‡½æ•°&quot;&gt;&lt;a href=&quot;#Generator-å‡½æ•°&quot; class=&quot;headerlink&quot; title=&quot;Generator å‡½æ•°&quot;&gt;&lt;/a&gt;Generator å‡½æ•°&lt;/h1&gt;&lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Generator" scheme="http://microzz.com/tags/Generator/"/>
    
  </entry>
  
  <entry>
    <title>Iteratorå’Œfor...ofå¾ªç¯</title>
    <link href="http://microzz.com/2017/01/12/iterator/"/>
    <id>http://microzz.com/2017/01/12/iterator/</id>
    <published>2017-01-12T07:45:19.000Z</published>
    <updated>2017-01-12T08:22:07.898Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Iteratorå’Œforâ€¦ofå¾ªç¯"><a href="#Iteratorå’Œforâ€¦ofå¾ªç¯" class="headerlink" title="Iteratorå’Œforâ€¦ofå¾ªç¯"></a>Iteratorå’Œforâ€¦ofå¾ªç¯</h1><h2 id="Iteratorï¼ˆéå†å™¨ï¼‰çš„æ¦‚å¿µ"><a href="#Iteratorï¼ˆéå†å™¨ï¼‰çš„æ¦‚å¿µ" class="headerlink" title="Iteratorï¼ˆéå†å™¨ï¼‰çš„æ¦‚å¿µ"></a>Iteratorï¼ˆéå†å™¨ï¼‰çš„æ¦‚å¿µ</h2><p>JavaScriptåŸæœ‰çš„è¡¨ç¤ºâ€œé›†åˆâ€çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦æ˜¯æ•°ç»„ï¼ˆArrayï¼‰å’Œå¯¹è±¡ï¼ˆObjectï¼‰ï¼ŒES6åˆæ·»åŠ äº†Mapå’ŒSetã€‚è¿™æ ·å°±æœ‰äº†å››ç§æ•°æ®é›†åˆï¼Œç”¨æˆ·è¿˜å¯ä»¥ç»„åˆä½¿ç”¨å®ƒä»¬ï¼Œå®šä¹‰è‡ªå·±çš„æ•°æ®ç»“æ„ï¼Œæ¯”å¦‚æ•°ç»„çš„æˆå‘˜æ˜¯Mapï¼ŒMapçš„æˆå‘˜æ˜¯å¯¹è±¡ã€‚è¿™æ ·å°±éœ€è¦ä¸€ç§ç»Ÿä¸€çš„æ¥å£æœºåˆ¶ï¼Œæ¥å¤„ç†æ‰€æœ‰ä¸åŒçš„æ•°æ®ç»“æ„ã€‚</p>
<p>éå†å™¨ï¼ˆIteratorï¼‰å°±æ˜¯è¿™æ ·ä¸€ç§æœºåˆ¶ã€‚å®ƒæ˜¯ä¸€ç§æ¥å£ï¼Œä¸ºå„ç§ä¸åŒçš„æ•°æ®ç»“æ„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ã€‚ä»»ä½•æ•°æ®ç»“æ„åªè¦éƒ¨ç½²Iteratoræ¥å£ï¼Œå°±å¯ä»¥å®Œæˆéå†æ“ä½œï¼ˆå³ä¾æ¬¡å¤„ç†è¯¥æ•°æ®ç»“æ„çš„æ‰€æœ‰æˆå‘˜ï¼‰ã€‚</p>
<p>Iteratorçš„ä½œç”¨æœ‰ä¸‰ä¸ªï¼šä¸€æ˜¯ä¸ºå„ç§æ•°æ®ç»“æ„ï¼Œæä¾›ä¸€ä¸ªç»Ÿä¸€çš„ã€ç®€ä¾¿çš„è®¿é—®æ¥å£ï¼›äºŒæ˜¯ä½¿å¾—æ•°æ®ç»“æ„çš„æˆå‘˜èƒ½å¤ŸæŒ‰æŸç§æ¬¡åºæ’åˆ—ï¼›ä¸‰æ˜¯ES6åˆ›é€ äº†ä¸€ç§æ–°çš„éå†å‘½ä»¤<code>for...of</code>å¾ªç¯ï¼ŒIteratoræ¥å£ä¸»è¦ä¾›<code>for...of</code>æ¶ˆè´¹ã€‚</p>
<p>Iteratorçš„éå†è¿‡ç¨‹æ˜¯è¿™æ ·çš„ã€‚</p>
<p>ï¼ˆ1ï¼‰åˆ›å»ºä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ï¼ŒæŒ‡å‘å½“å‰æ•°æ®ç»“æ„çš„èµ·å§‹ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œéå†å™¨å¯¹è±¡æœ¬è´¨ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆå¯¹è±¡ã€‚</p>
<p>ï¼ˆ2ï¼‰ç¬¬ä¸€æ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œå¯ä»¥å°†æŒ‡é’ˆæŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ã€‚</p>
<p>ï¼ˆ3ï¼‰ç¬¬äºŒæ¬¡è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼ŒæŒ‡é’ˆå°±æŒ‡å‘æ•°æ®ç»“æ„çš„ç¬¬äºŒä¸ªæˆå‘˜ã€‚</p>
<p>ï¼ˆ4ï¼‰ä¸æ–­è°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œç›´åˆ°å®ƒæŒ‡å‘æ•°æ®ç»“æ„çš„ç»“æŸä½ç½®ã€‚</p>
<p>æ¯ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›æ•°æ®ç»“æ„çš„å½“å‰æˆå‘˜çš„ä¿¡æ¯ã€‚å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯è¿”å›ä¸€ä¸ªåŒ…å«<code>value</code>å’Œ<code>done</code>ä¸¤ä¸ªå±æ€§çš„å¯¹è±¡ã€‚å…¶ä¸­ï¼Œ<code>value</code>å±æ€§æ˜¯å½“å‰æˆå‘˜çš„å€¼ï¼Œ<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿ<code>next</code>æ–¹æ³•è¿”å›å€¼çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> it = makeIterator([<span class="string">'a'</span>, <span class="string">'b'</span>]);</div><div class="line"></div><div class="line">it.next() <span class="comment">// &#123; value: "a", done: false &#125;</span></div><div class="line">it.next() <span class="comment">// &#123; value: "b", done: false &#125;</span></div><div class="line">it.next() <span class="comment">// &#123; value: undefined, done: true &#125;</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeIterator</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> nextIndex = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">next</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> nextIndex &lt; array.length ?</div><div class="line">        &#123;<span class="attr">value</span>: array[nextIndex++], <span class="attr">done</span>: <span class="literal">false</span>&#125; :</div><div class="line">        &#123;<span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span>&#125;;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ª<code>makeIterator</code>å‡½æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªéå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œä½œç”¨å°±æ˜¯è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚å¯¹æ•°ç»„<code>[&#39;a&#39;, &#39;b&#39;]</code>æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå°±ä¼šè¿”å›è¯¥æ•°ç»„çš„éå†å™¨å¯¹è±¡ï¼ˆå³æŒ‡é’ˆå¯¹è±¡ï¼‰<code>it</code>ã€‚</p>
<p>æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œç”¨æ¥ç§»åŠ¨æŒ‡é’ˆã€‚å¼€å§‹æ—¶ï¼ŒæŒ‡é’ˆæŒ‡å‘æ•°ç»„çš„å¼€å§‹ä½ç½®ã€‚ç„¶åï¼Œæ¯æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼ŒæŒ‡é’ˆå°±ä¼šæŒ‡å‘æ•°ç»„çš„ä¸‹ä¸€ä¸ªæˆå‘˜ã€‚ç¬¬ä¸€æ¬¡è°ƒç”¨ï¼ŒæŒ‡å‘<code>a</code>ï¼›ç¬¬äºŒæ¬¡è°ƒç”¨ï¼ŒæŒ‡å‘<code>b</code>ã€‚</p>
<p><code>next</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºå½“å‰æ•°æ®æˆå‘˜çš„ä¿¡æ¯ã€‚è¿™ä¸ªå¯¹è±¡å…·æœ‰<code>value</code>å’Œ<code>done</code>ä¸¤ä¸ªå±æ€§ï¼Œ<code>value</code>å±æ€§è¿”å›å½“å‰ä½ç½®çš„æˆå‘˜ï¼Œ<code>done</code>å±æ€§æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºéå†æ˜¯å¦ç»“æŸï¼Œå³æ˜¯å¦è¿˜æœ‰å¿…è¦å†ä¸€æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ã€‚</p>
<p>æ€»ä¹‹ï¼Œè°ƒç”¨æŒ‡é’ˆå¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œå°±å¯ä»¥éå†äº‹å…ˆç»™å®šçš„æ•°æ®ç»“æ„ã€‚</p>
<p>å¯¹äºéå†å™¨å¯¹è±¡æ¥è¯´ï¼Œ<code>done: false</code>å’Œ<code>value: undefined</code>å±æ€§éƒ½æ˜¯å¯ä»¥çœç•¥çš„ï¼Œå› æ­¤ä¸Šé¢çš„<code>makeIterator</code>å‡½æ•°å¯ä»¥ç®€å†™æˆä¸‹é¢çš„å½¢å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">makeIterator</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> nextIndex = <span class="number">0</span>;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">next</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> nextIndex &lt; array.length ?</div><div class="line">        &#123;<span class="attr">value</span>: array[nextIndex++]&#125; :</div><div class="line">        &#123;<span class="attr">done</span>: <span class="literal">true</span>&#125;;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç”±äºIteratoråªæ˜¯æŠŠæ¥å£è§„æ ¼åŠ åˆ°æ•°æ®ç»“æ„ä¹‹ä¸Šï¼Œæ‰€ä»¥ï¼Œéå†å™¨ä¸å®ƒæ‰€éå†çš„é‚£ä¸ªæ•°æ®ç»“æ„ï¼Œå®é™…ä¸Šæ˜¯åˆ†å¼€çš„ï¼Œå®Œå…¨å¯ä»¥å†™å‡ºæ²¡æœ‰å¯¹åº”æ•°æ®ç»“æ„çš„éå†å™¨å¯¹è±¡ï¼Œæˆ–è€…è¯´ç”¨éå†å™¨å¯¹è±¡æ¨¡æ‹Ÿå‡ºæ•°æ®ç»“æ„ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæ— é™è¿è¡Œçš„éå†å™¨å¯¹è±¡çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> it = idMaker();</div><div class="line"></div><div class="line">it.next().value <span class="comment">// '0'</span></div><div class="line">it.next().value <span class="comment">// '1'</span></div><div class="line">it.next().value <span class="comment">// '2'</span></div><div class="line"><span class="comment">// ...</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">idMaker</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> index = <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">next</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> &#123;<span class="attr">value</span>: index++, <span class="attr">done</span>: <span class="literal">false</span>&#125;;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œéå†å™¨ç”Ÿæˆå‡½æ•°<code>idMaker</code>ï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼ˆå³æŒ‡é’ˆå¯¹è±¡ï¼‰ã€‚ä½†æ˜¯å¹¶æ²¡æœ‰å¯¹åº”çš„æ•°æ®ç»“æ„ï¼Œæˆ–è€…è¯´ï¼Œéå†å™¨å¯¹è±¡è‡ªå·±æè¿°äº†ä¸€ä¸ªæ•°æ®ç»“æ„å‡ºæ¥ã€‚</p>
<p>åœ¨ES6ä¸­ï¼Œæœ‰äº›æ•°æ®ç»“æ„åŸç”Ÿå…·å¤‡Iteratoræ¥å£ï¼ˆæ¯”å¦‚æ•°ç»„ï¼‰ï¼Œå³ä¸ç”¨ä»»ä½•å¤„ç†ï¼Œå°±å¯ä»¥è¢«<code>for...of</code>å¾ªç¯éå†ï¼Œæœ‰äº›å°±ä¸è¡Œï¼ˆæ¯”å¦‚å¯¹è±¡ï¼‰ã€‚åŸå› åœ¨äºï¼Œè¿™äº›æ•°æ®ç»“æ„åŸç”Ÿéƒ¨ç½²äº†<code>Symbol.iterator</code>å±æ€§ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œå¦å¤–ä¸€äº›æ•°æ®ç»“æ„æ²¡æœ‰ã€‚å‡¡æ˜¯éƒ¨ç½²äº†<code>Symbol.iterator</code>å±æ€§çš„æ•°æ®ç»“æ„ï¼Œå°±ç§°ä¸ºéƒ¨ç½²äº†éå†å™¨æ¥å£ã€‚è°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚</p>
<p>å¦‚æœä½¿ç”¨TypeScriptçš„å†™æ³•ï¼Œéå†å™¨æ¥å£ï¼ˆIterableï¼‰ã€æŒ‡é’ˆå¯¹è±¡ï¼ˆIteratorï¼‰å’Œnextæ–¹æ³•è¿”å›å€¼çš„è§„æ ¼å¯ä»¥æè¿°å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">interface Iterable &#123;</div><div class="line">  [<span class="built_in">Symbol</span>.iterator]() : Iterator,</div><div class="line">&#125;</div><div class="line"></div><div class="line">interface Iterator &#123;</div><div class="line">  next(value?: any) : IterationResult,</div><div class="line">&#125;</div><div class="line"></div><div class="line">interface IterationResult &#123;</div><div class="line">  <span class="attr">value</span>: any,</div><div class="line">  <span class="attr">done</span>: boolean,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ•°æ®ç»“æ„çš„é»˜è®¤Iteratoræ¥å£"><a href="#æ•°æ®ç»“æ„çš„é»˜è®¤Iteratoræ¥å£" class="headerlink" title="æ•°æ®ç»“æ„çš„é»˜è®¤Iteratoræ¥å£"></a>æ•°æ®ç»“æ„çš„é»˜è®¤Iteratoræ¥å£</h2><p>Iteratoræ¥å£çš„ç›®çš„ï¼Œå°±æ˜¯ä¸ºæ‰€æœ‰æ•°æ®ç»“æ„ï¼Œæä¾›äº†ä¸€ç§ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ï¼Œå³<code>for...of</code>å¾ªç¯ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ã€‚å½“ä½¿ç”¨<code>for...of</code>å¾ªç¯éå†æŸç§æ•°æ®ç»“æ„æ—¶ï¼Œè¯¥å¾ªç¯ä¼šè‡ªåŠ¨å»å¯»æ‰¾Iteratoræ¥å£ã€‚</p>
<p>ä¸€ç§æ•°æ®ç»“æ„åªè¦éƒ¨ç½²äº†Iteratoræ¥å£ï¼Œæˆ‘ä»¬å°±ç§°è¿™ç§æ•°æ®ç»“æ„æ˜¯â€å¯éå†çš„â€œï¼ˆiterableï¼‰ã€‚</p>
<p>ES6è§„å®šï¼Œé»˜è®¤çš„Iteratoræ¥å£éƒ¨ç½²åœ¨æ•°æ®ç»“æ„çš„<code>Symbol.iterator</code>å±æ€§ï¼Œæˆ–è€…è¯´ï¼Œä¸€ä¸ªæ•°æ®ç»“æ„åªè¦å…·æœ‰<code>Symbol.iterator</code>å±æ€§ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯â€œå¯éå†çš„â€ï¼ˆiterableï¼‰ã€‚<code>Symbol.iterator</code>å±æ€§æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå°±æ˜¯å½“å‰æ•°æ®ç»“æ„é»˜è®¤çš„éå†å™¨ç”Ÿæˆå‡½æ•°ã€‚æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œå°±ä¼šè¿”å›ä¸€ä¸ªéå†å™¨ã€‚è‡³äºå±æ€§å<code>Symbol.iterator</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œè¿”å›<code>Symbol</code>å¯¹è±¡çš„<code>iterator</code>å±æ€§ï¼Œè¿™æ˜¯ä¸€ä¸ªé¢„å®šä¹‰å¥½çš„ã€ç±»å‹ä¸ºSymbolçš„ç‰¹æ®Šå€¼ï¼Œæ‰€ä»¥è¦æ”¾åœ¨æ–¹æ‹¬å·å†…ã€‚ï¼ˆå‚è§Symbolä¸€ç« ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">  [<span class="built_in">Symbol</span>.iterator] : <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">next</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">          <span class="attr">value</span>: <span class="number">1</span>,</div><div class="line">          <span class="attr">done</span>: <span class="literal">true</span></div><div class="line">        &#125;;</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡<code>obj</code>æ˜¯å¯éå†çš„ï¼ˆiterableï¼‰ï¼Œå› ä¸ºå…·æœ‰<code>Symbol.iterator</code>å±æ€§ã€‚æ‰§è¡Œè¿™ä¸ªå±æ€§ï¼Œä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ã€‚è¯¥å¯¹è±¡çš„æ ¹æœ¬ç‰¹å¾å°±æ˜¯å…·æœ‰<code>next</code>æ–¹æ³•ã€‚æ¯æ¬¡è°ƒç”¨<code>next</code>æ–¹æ³•ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªä»£è¡¨å½“å‰æˆå‘˜çš„ä¿¡æ¯å¯¹è±¡ï¼Œå…·æœ‰<code>value</code>å’Œ<code>done</code>ä¸¤ä¸ªå±æ€§ã€‚</p>
<p>åœ¨ES6ä¸­ï¼Œæœ‰ä¸‰ç±»æ•°æ®ç»“æ„åŸç”Ÿå…·å¤‡Iteratoræ¥å£ï¼šæ•°ç»„ã€æŸäº›ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€Setå’ŒMapç»“æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</div><div class="line"><span class="keyword">let</span> iter = arr[<span class="built_in">Symbol</span>.iterator]();</div><div class="line"></div><div class="line">iter.next() <span class="comment">// &#123; value: 'a', done: false &#125;</span></div><div class="line">iter.next() <span class="comment">// &#123; value: 'b', done: false &#125;</span></div><div class="line">iter.next() <span class="comment">// &#123; value: 'c', done: false &#125;</span></div><div class="line">iter.next() <span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>arr</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŸç”Ÿå°±å…·æœ‰éå†å™¨æ¥å£ï¼Œéƒ¨ç½²åœ¨<code>arr</code>çš„<code>Symbol.iterator</code>å±æ€§ä¸Šé¢ã€‚æ‰€ä»¥ï¼Œè°ƒç”¨è¿™ä¸ªå±æ€§ï¼Œå°±å¾—åˆ°éå†å™¨å¯¹è±¡ã€‚</p>
<p>ä¸Šé¢æåˆ°ï¼ŒåŸç”Ÿå°±éƒ¨ç½²Iteratoræ¥å£çš„æ•°æ®ç»“æ„æœ‰ä¸‰ç±»ï¼Œå¯¹äºè¿™ä¸‰ç±»æ•°æ®ç»“æ„ï¼Œä¸ç”¨è‡ªå·±å†™éå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œ<code>for...of</code>å¾ªç¯ä¼šè‡ªåŠ¨éå†å®ƒä»¬ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå…¶ä»–æ•°æ®ç»“æ„ï¼ˆä¸»è¦æ˜¯å¯¹è±¡ï¼‰çš„Iteratoræ¥å£ï¼Œéƒ½éœ€è¦è‡ªå·±åœ¨<code>Symbol.iterator</code>å±æ€§ä¸Šé¢éƒ¨ç½²ï¼Œè¿™æ ·æ‰ä¼šè¢«<code>for...of</code>å¾ªç¯éå†ã€‚</p>
<p>å¯¹è±¡ï¼ˆObjectï¼‰ä¹‹æ‰€ä»¥æ²¡æœ‰é»˜è®¤éƒ¨ç½²Iteratoræ¥å£ï¼Œæ˜¯å› ä¸ºå¯¹è±¡çš„å“ªä¸ªå±æ€§å…ˆéå†ï¼Œå“ªä¸ªå±æ€§åéå†æ˜¯ä¸ç¡®å®šçš„ï¼Œéœ€è¦å¼€å‘è€…æ‰‹åŠ¨æŒ‡å®šã€‚æœ¬è´¨ä¸Šï¼Œéå†å™¨æ˜¯ä¸€ç§çº¿æ€§å¤„ç†ï¼Œå¯¹äºä»»ä½•éçº¿æ€§çš„æ•°æ®ç»“æ„ï¼Œéƒ¨ç½²éå†å™¨æ¥å£ï¼Œå°±ç­‰äºéƒ¨ç½²ä¸€ç§çº¿æ€§è½¬æ¢ã€‚ä¸è¿‡ï¼Œä¸¥æ ¼åœ°è¯´ï¼Œå¯¹è±¡éƒ¨ç½²éå†å™¨æ¥å£å¹¶ä¸æ˜¯å¾ˆå¿…è¦ï¼Œå› ä¸ºè¿™æ—¶å¯¹è±¡å®é™…ä¸Šè¢«å½“ä½œMapç»“æ„ä½¿ç”¨ï¼ŒES5æ²¡æœ‰Mapç»“æ„ï¼Œè€ŒES6åŸç”Ÿæä¾›äº†ã€‚</p>
<p>ä¸€ä¸ªå¯¹è±¡å¦‚æœè¦æœ‰å¯è¢«<code>for...of</code>å¾ªç¯è°ƒç”¨çš„Iteratoræ¥å£ï¼Œå°±å¿…é¡»åœ¨<code>Symbol.iterator</code>çš„å±æ€§ä¸Šéƒ¨ç½²éå†å™¨ç”Ÿæˆæ–¹æ³•ï¼ˆåŸå‹é“¾ä¸Šçš„å¯¹è±¡å…·æœ‰è¯¥æ–¹æ³•ä¹Ÿå¯ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">RangeIterator</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(start, stop) &#123;</div><div class="line">    <span class="keyword">this</span>.value = start;</div><div class="line">    <span class="keyword">this</span>.stop = stop;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  [<span class="built_in">Symbol</span>.iterator]() &#123; <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</div><div class="line"></div><div class="line">  next() &#123;</div><div class="line">    <span class="keyword">var</span> value = <span class="keyword">this</span>.value;</div><div class="line">    <span class="keyword">if</span> (value &lt; <span class="keyword">this</span>.stop) &#123;</div><div class="line">      <span class="keyword">this</span>.value++;</div><div class="line">      <span class="keyword">return</span> &#123;<span class="attr">done</span>: <span class="literal">false</span>, <span class="attr">value</span>: value&#125;;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> &#123;<span class="attr">done</span>: <span class="literal">true</span>, <span class="attr">value</span>: <span class="literal">undefined</span>&#125;;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">range</span>(<span class="params">start, stop</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> RangeIterator(start, stop);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> value <span class="keyword">of</span> range(<span class="number">0</span>, <span class="number">3</span>)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªç±»éƒ¨ç½²Iteratoræ¥å£çš„å†™æ³•ã€‚<code>Symbol.iterator</code>å±æ€§å¯¹åº”ä¸€ä¸ªå‡½æ•°ï¼Œæ‰§è¡Œåè¿”å›å½“å‰å¯¹è±¡çš„éå†å™¨å¯¹è±¡ã€‚</p>
<p>ä¸‹é¢æ˜¯é€šè¿‡éå†å™¨å®ç°æŒ‡é’ˆç»“æ„çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Obj</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.value = value;</div><div class="line">  <span class="keyword">this</span>.next = <span class="literal">null</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Obj.prototype[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> iterator = &#123;</div><div class="line">    <span class="attr">next</span>: next</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> current = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (current) &#123;</div><div class="line">      <span class="keyword">var</span> value = current.value;</div><div class="line">      current = current.next;</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">done</span>: <span class="literal">false</span>,</div><div class="line">        <span class="attr">value</span>: value</div><div class="line">      &#125;;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">done</span>: <span class="literal">true</span></div><div class="line">      &#125;;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> iterator;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> one = <span class="keyword">new</span> Obj(<span class="number">1</span>);</div><div class="line"><span class="keyword">var</span> two = <span class="keyword">new</span> Obj(<span class="number">2</span>);</div><div class="line"><span class="keyword">var</span> three = <span class="keyword">new</span> Obj(<span class="number">3</span>);</div><div class="line"></div><div class="line">one.next = two;</div><div class="line">two.next = three;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">of</span> one)&#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1</span></div><div class="line"><span class="comment">// 2</span></div><div class="line"><span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç é¦–å…ˆåœ¨æ„é€ å‡½æ•°çš„åŸå‹é“¾ä¸Šéƒ¨ç½²<code>Symbol.iterator</code>æ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ä¼šè¿”å›éå†å™¨å¯¹è±¡<code>iterator</code>ï¼Œè°ƒç”¨è¯¥å¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œåœ¨è¿”å›ä¸€ä¸ªå€¼çš„åŒæ—¶ï¼Œè‡ªåŠ¨å°†å†…éƒ¨æŒ‡é’ˆç§»åˆ°ä¸‹ä¸€ä¸ªå®ä¾‹ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¸ºå¯¹è±¡æ·»åŠ Iteratoræ¥å£çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  <span class="attr">data</span>: [ <span class="string">'hello'</span>, <span class="string">'world'</span> ],</div><div class="line">  [<span class="built_in">Symbol</span>.iterator]() &#123;</div><div class="line">    <span class="keyword">const</span> self = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">let</span> index = <span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      next() &#123;</div><div class="line">        <span class="keyword">if</span> (index &lt; self.data.length) &#123;</div><div class="line">          <span class="keyword">return</span> &#123;</div><div class="line">            <span class="attr">value</span>: self.data[index++],</div><div class="line">            <span class="attr">done</span>: <span class="literal">false</span></div><div class="line">          &#125;;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å¯¹äºç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆå­˜åœ¨æ•°å€¼é”®åå’Œlengthå±æ€§ï¼‰ï¼Œéƒ¨ç½²Iteratoræ¥å£ï¼Œæœ‰ä¸€ä¸ªç®€ä¾¿æ–¹æ³•ï¼Œå°±æ˜¯<code>Symbol.iterator</code>æ–¹æ³•ç›´æ¥å¼•ç”¨æ•°ç»„çš„Iteratoræ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">NodeList.prototype[<span class="built_in">Symbol</span>.iterator] = <span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.iterator];</div><div class="line"><span class="comment">// æˆ–è€…</span></div><div class="line">NodeList.prototype[<span class="built_in">Symbol</span>.iterator] = [][<span class="built_in">Symbol</span>.iterator];</div><div class="line"></div><div class="line">[...document.querySelectorAll(<span class="string">'div'</span>)] <span class="comment">// å¯ä»¥æ‰§è¡Œäº†</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡è°ƒç”¨æ•°ç»„çš„<code>Symbol.iterator</code>æ–¹æ³•çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> iterable = &#123;</div><div class="line">  <span class="number">0</span>: <span class="string">'a'</span>,</div><div class="line">  <span class="number">1</span>: <span class="string">'b'</span>,</div><div class="line">  <span class="number">2</span>: <span class="string">'c'</span>,</div><div class="line">  <span class="attr">length</span>: <span class="number">3</span>,</div><div class="line">  [<span class="built_in">Symbol</span>.iterator]: <span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.iterator]</div><div class="line">&#125;;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> iterable) &#123;</div><div class="line">  <span class="built_in">console</span>.log(item); <span class="comment">// 'a', 'b', 'c'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œæ™®é€šå¯¹è±¡éƒ¨ç½²æ•°ç»„çš„<code>Symbol.iterator</code>æ–¹æ³•ï¼Œå¹¶æ— æ•ˆæœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> iterable = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="string">'a'</span>,</div><div class="line">  <span class="attr">b</span>: <span class="string">'b'</span>,</div><div class="line">  <span class="attr">c</span>: <span class="string">'c'</span>,</div><div class="line">  <span class="attr">length</span>: <span class="number">3</span>,</div><div class="line">  [<span class="built_in">Symbol</span>.iterator]: <span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.iterator]</div><div class="line">&#125;;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> iterable) &#123;</div><div class="line">  <span class="built_in">console</span>.log(item); <span class="comment">// undefined, undefined, undefined</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>Symbol.iterator</code>æ–¹æ³•å¯¹åº”çš„ä¸æ˜¯éå†å™¨ç”Ÿæˆå‡½æ•°ï¼ˆå³ä¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼‰ï¼Œè§£é‡Šå¼•æ“å°†ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"></div><div class="line">obj[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="params">()</span> =&gt;</span> <span class="number">1</span>;</div><div class="line"></div><div class="line">[...obj] <span class="comment">// TypeError: [] is not a function</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡objçš„Symbol.iteratoræ–¹æ³•å¯¹åº”çš„ä¸æ˜¯éå†å™¨ç”Ÿæˆå‡½æ•°ï¼Œå› æ­¤æŠ¥é”™ã€‚</p>
<p>æœ‰äº†éå†å™¨æ¥å£ï¼Œæ•°æ®ç»“æ„å°±å¯ä»¥ç”¨<code>for...of</code>å¾ªç¯éå†ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>while</code>å¾ªç¯éå†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> $iterator = ITERABLE[<span class="built_in">Symbol</span>.iterator]();</div><div class="line"><span class="keyword">var</span> $result = $iterator.next();</div><div class="line"><span class="keyword">while</span> (!$result.done) &#123;</div><div class="line">  <span class="keyword">var</span> x = $result.value;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  $result = $iterator.next();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>ITERABLE</code>ä»£è¡¨æŸç§å¯éå†çš„æ•°æ®ç»“æ„ï¼Œ<code>$iterator</code>æ˜¯å®ƒçš„éå†å™¨å¯¹è±¡ã€‚éå†å™¨å¯¹è±¡æ¯æ¬¡ç§»åŠ¨æŒ‡é’ˆï¼ˆ<code>next</code>æ–¹æ³•ï¼‰ï¼Œéƒ½æ£€æŸ¥ä¸€ä¸‹è¿”å›å€¼çš„<code>done</code>å±æ€§ï¼Œå¦‚æœéå†è¿˜æ²¡ç»“æŸï¼Œå°±ç§»åŠ¨éå†å™¨å¯¹è±¡çš„æŒ‡é’ˆåˆ°ä¸‹ä¸€æ­¥ï¼ˆ<code>next</code>æ–¹æ³•ï¼‰ï¼Œä¸æ–­å¾ªç¯ã€‚</p>
<h2 id="è°ƒç”¨Iteratoræ¥å£çš„åœºåˆ"><a href="#è°ƒç”¨Iteratoræ¥å£çš„åœºåˆ" class="headerlink" title="è°ƒç”¨Iteratoræ¥å£çš„åœºåˆ"></a>è°ƒç”¨Iteratoræ¥å£çš„åœºåˆ</h2><p>æœ‰ä¸€äº›åœºåˆä¼šé»˜è®¤è°ƒç”¨Iteratoræ¥å£ï¼ˆå³<code>Symbol.iterator</code>æ–¹æ³•ï¼‰ï¼Œé™¤äº†ä¸‹æ–‡ä¼šä»‹ç»çš„<code>for...of</code>å¾ªç¯ï¼Œè¿˜æœ‰å‡ ä¸ªåˆ«çš„åœºåˆã€‚</p>
<p><strong>ï¼ˆ1ï¼‰è§£æ„èµ‹å€¼</strong></p>
<p>å¯¹æ•°ç»„å’ŒSetç»“æ„è¿›è¡Œè§£æ„èµ‹å€¼æ—¶ï¼Œä¼šé»˜è®¤è°ƒç”¨<code>Symbol.iterator</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>().add(<span class="string">'a'</span>).add(<span class="string">'b'</span>).add(<span class="string">'c'</span>);</div><div class="line"></div><div class="line"><span class="keyword">let</span> [x,y] = set;</div><div class="line"><span class="comment">// x='a'; y='b'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [first, ...rest] = set;</div><div class="line"><span class="comment">// first='a'; rest=['b','c'];</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰æ‰©å±•è¿ç®—ç¬¦</strong></p>
<p>æ‰©å±•è¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰ä¹Ÿä¼šè°ƒç”¨é»˜è®¤çš„iteratoræ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¾‹ä¸€</span></div><div class="line"><span class="keyword">var</span> str = <span class="string">'hello'</span>;</div><div class="line">[...str] <span class="comment">//  ['h','e','l','l','o']</span></div><div class="line"></div><div class="line"><span class="comment">// ä¾‹äºŒ</span></div><div class="line"><span class="keyword">let</span> arr = [<span class="string">'b'</span>, <span class="string">'c'</span>];</div><div class="line">[<span class="string">'a'</span>, ...arr, <span class="string">'d'</span>]</div><div class="line"><span class="comment">// ['a', 'b', 'c', 'd']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨å°±è°ƒç”¨Iteratoræ¥å£ã€‚</p>
<p>å®é™…ä¸Šï¼Œè¿™æä¾›äº†ä¸€ç§ç®€ä¾¿æœºåˆ¶ï¼Œå¯ä»¥å°†ä»»ä½•éƒ¨ç½²äº†Iteratoræ¥å£çš„æ•°æ®ç»“æ„ï¼Œè½¬ä¸ºæ•°ç»„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æŸä¸ªæ•°æ®ç»“æ„éƒ¨ç½²äº†Iteratoræ¥å£ï¼Œå°±å¯ä»¥å¯¹å®ƒä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œå°†å…¶è½¬ä¸ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arr = [...iterable];</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰yield* </strong></p>
<p>yield*åé¢è·Ÿçš„æ˜¯ä¸€ä¸ªå¯éå†çš„ç»“æ„ï¼Œå®ƒä¼šè°ƒç”¨è¯¥ç»“æ„çš„éå†å™¨æ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> generator = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span>* [<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</div><div class="line">  <span class="keyword">yield</span> <span class="number">5</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> iterator = generator();</div><div class="line"></div><div class="line">iterator.next() <span class="comment">// &#123; value: 1, done: false &#125;</span></div><div class="line">iterator.next() <span class="comment">// &#123; value: 2, done: false &#125;</span></div><div class="line">iterator.next() <span class="comment">// &#123; value: 3, done: false &#125;</span></div><div class="line">iterator.next() <span class="comment">// &#123; value: 4, done: false &#125;</span></div><div class="line">iterator.next() <span class="comment">// &#123; value: 5, done: false &#125;</span></div><div class="line">iterator.next() <span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰å…¶ä»–åœºåˆ</strong></p>
<p>ç”±äºæ•°ç»„çš„éå†ä¼šè°ƒç”¨éå†å™¨æ¥å£ï¼Œæ‰€ä»¥ä»»ä½•æ¥å—æ•°ç»„ä½œä¸ºå‚æ•°çš„åœºåˆï¼Œå…¶å®éƒ½è°ƒç”¨äº†éå†å™¨æ¥å£ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ã€‚</p>
<ul>
<li>forâ€¦of</li>
<li>Array.from()</li>
<li>Map(), Set(), WeakMap(), WeakSet()ï¼ˆæ¯”å¦‚<code>new Map([[&#39;a&#39;,1],[&#39;b&#39;,2]])</code>ï¼‰</li>
<li>Promise.all()</li>
<li>Promise.race()</li>
</ul>
<h2 id="å­—ç¬¦ä¸²çš„Iteratoræ¥å£"><a href="#å­—ç¬¦ä¸²çš„Iteratoræ¥å£" class="headerlink" title="å­—ç¬¦ä¸²çš„Iteratoræ¥å£"></a>å­—ç¬¦ä¸²çš„Iteratoræ¥å£</h2><p>å­—ç¬¦ä¸²æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œä¹ŸåŸç”Ÿå…·æœ‰Iteratoræ¥å£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> someString = <span class="string">"hi"</span>;</div><div class="line"><span class="keyword">typeof</span> someString[<span class="built_in">Symbol</span>.iterator]</div><div class="line"><span class="comment">// "function"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> iterator = someString[<span class="built_in">Symbol</span>.iterator]();</div><div class="line"></div><div class="line">iterator.next()  <span class="comment">// &#123; value: "h", done: false &#125;</span></div><div class="line">iterator.next()  <span class="comment">// &#123; value: "i", done: false &#125;</span></div><div class="line">iterator.next()  <span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨<code>Symbol.iterator</code>æ–¹æ³•è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œåœ¨è¿™ä¸ªéå†å™¨ä¸Šå¯ä»¥è°ƒç”¨nextæ–¹æ³•ï¼Œå®ç°å¯¹äºå­—ç¬¦ä¸²çš„éå†ã€‚</p>
<p>å¯ä»¥è¦†ç›–åŸç”Ÿçš„<code>Symbol.iterator</code>æ–¹æ³•ï¼Œè¾¾åˆ°ä¿®æ”¹éå†å™¨è¡Œä¸ºçš„ç›®çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"hi"</span>);</div><div class="line"></div><div class="line">[...str] <span class="comment">// ["h", "i"]</span></div><div class="line"></div><div class="line">str[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">next</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>._first) &#123;</div><div class="line">        <span class="keyword">this</span>._first = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="string">"bye"</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;;</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> &#123; <span class="attr">done</span>: <span class="literal">true</span> &#125;;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">_first</span>: <span class="literal">true</span></div><div class="line">  &#125;;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">[...str] <span class="comment">// ["bye"]</span></div><div class="line">str <span class="comment">// "hi"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²strçš„<code>Symbol.iterator</code>æ–¹æ³•è¢«ä¿®æ”¹äº†ï¼Œæ‰€ä»¥æ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰è¿”å›çš„å€¼å˜æˆäº†<code>bye</code>ï¼Œè€Œå­—ç¬¦ä¸²æœ¬èº«è¿˜æ˜¯<code>hi</code>ã€‚</p>
<h2 id="Iteratoræ¥å£ä¸Generatorå‡½æ•°"><a href="#Iteratoræ¥å£ä¸Generatorå‡½æ•°" class="headerlink" title="Iteratoræ¥å£ä¸Generatorå‡½æ•°"></a>Iteratoræ¥å£ä¸Generatorå‡½æ•°</h2><p><code>Symbol.iterator</code>æ–¹æ³•çš„æœ€ç®€å•å®ç°ï¼Œè¿˜æ˜¯ä½¿ç”¨ä¸‹ä¸€ç« è¦ä»‹ç»çš„Generatorå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myIterable = &#123;&#125;;</div><div class="line"></div><div class="line">myIterable[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;;</div><div class="line">[...myIterable] <span class="comment">// [1, 2, 3]</span></div><div class="line"></div><div class="line"><span class="comment">// æˆ–è€…é‡‡ç”¨ä¸‹é¢çš„ç®€æ´å†™æ³•</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  * [<span class="built_in">Symbol</span>.iterator]() &#123;</div><div class="line">    <span class="keyword">yield</span> <span class="string">'hello'</span>;</div><div class="line">    <span class="keyword">yield</span> <span class="string">'world'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> obj) &#123;</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div><div class="line"><span class="comment">// hello</span></div><div class="line"><span class="comment">// world</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Symbol.iterator</code>æ–¹æ³•å‡ ä¹ä¸ç”¨éƒ¨ç½²ä»»ä½•ä»£ç ï¼Œåªè¦ç”¨yieldå‘½ä»¤ç»™å‡ºæ¯ä¸€æ­¥çš„è¿”å›å€¼å³å¯ã€‚</p>
<h2 id="éå†å™¨å¯¹è±¡çš„return-ï¼Œthrow"><a href="#éå†å™¨å¯¹è±¡çš„return-ï¼Œthrow" class="headerlink" title="éå†å™¨å¯¹è±¡çš„return()ï¼Œthrow()"></a>éå†å™¨å¯¹è±¡çš„return()ï¼Œthrow()</h2><p>éå†å™¨å¯¹è±¡é™¤äº†å…·æœ‰<code>next</code>æ–¹æ³•ï¼Œè¿˜å¯ä»¥å…·æœ‰<code>return</code>æ–¹æ³•å’Œ<code>throw</code>æ–¹æ³•ã€‚å¦‚æœä½ è‡ªå·±å†™éå†å™¨å¯¹è±¡ç”Ÿæˆå‡½æ•°ï¼Œé‚£ä¹ˆ<code>next</code>æ–¹æ³•æ˜¯å¿…é¡»éƒ¨ç½²çš„ï¼Œ<code>return</code>æ–¹æ³•å’Œ<code>throw</code>æ–¹æ³•æ˜¯å¦éƒ¨ç½²æ˜¯å¯é€‰çš„ã€‚</p>
<p><code>return</code>æ–¹æ³•çš„ä½¿ç”¨åœºåˆæ˜¯ï¼Œå¦‚æœ<code>for...of</code>å¾ªç¯æå‰é€€å‡ºï¼ˆé€šå¸¸æ˜¯å› ä¸ºå‡ºé”™ï¼Œæˆ–è€…æœ‰<code>break</code>è¯­å¥æˆ–<code>continue</code>è¯­å¥ï¼‰ï¼Œå°±ä¼šè°ƒç”¨<code>return</code>æ–¹æ³•ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨å®Œæˆéå†å‰ï¼Œéœ€è¦æ¸…ç†æˆ–é‡Šæ”¾èµ„æºï¼Œå°±å¯ä»¥éƒ¨ç½²<code>return</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">readLinesSync</span>(<span class="params">file</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    next() &#123;</div><div class="line">      <span class="keyword">if</span> (file.isAtEndOfFile()) &#123;</div><div class="line">        file.close();</div><div class="line">        <span class="keyword">return</span> &#123; <span class="attr">done</span>: <span class="literal">true</span> &#125;;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="keyword">return</span>() &#123;</div><div class="line">      file.close();</div><div class="line">      <span class="keyword">return</span> &#123; <span class="attr">done</span>: <span class="literal">true</span> &#125;;</div><div class="line">    &#125;,</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>readLinesSync</code>æ¥å—ä¸€ä¸ªæ–‡ä»¶å¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå…¶ä¸­é™¤äº†<code>next</code>æ–¹æ³•ï¼Œè¿˜éƒ¨ç½²äº†<code>return</code>æ–¹æ³•ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬è®©æ–‡ä»¶çš„éå†æå‰è¿”å›ï¼Œè¿™æ ·å°±ä¼šè§¦å‘æ‰§è¡Œ<code>return</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> line <span class="keyword">of</span> readLinesSync(fileName)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(line);</div><div class="line">  <span class="keyword">break</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œ<code>return</code>æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ˜¯Generatorè§„æ ¼å†³å®šçš„ã€‚</p>
<p><code>throw</code>æ–¹æ³•ä¸»è¦æ˜¯é…åˆGeneratorå‡½æ•°ä½¿ç”¨ï¼Œä¸€èˆ¬çš„éå†å™¨å¯¹è±¡ç”¨ä¸åˆ°è¿™ä¸ªæ–¹æ³•ã€‚è¯·å‚é˜…ã€ŠGeneratorå‡½æ•°ã€‹ä¸€ç« ã€‚</p>
<h2 id="forâ€¦ofå¾ªç¯"><a href="#forâ€¦ofå¾ªç¯" class="headerlink" title="forâ€¦ofå¾ªç¯"></a>forâ€¦ofå¾ªç¯</h2><p>ES6 å€Ÿé‰´ C++ã€Javaã€C# å’Œ Python è¯­è¨€ï¼Œå¼•å…¥äº†<code>for...of</code>å¾ªç¯ï¼Œä½œä¸ºéå†æ‰€æœ‰æ•°æ®ç»“æ„çš„ç»Ÿä¸€çš„æ–¹æ³•ã€‚</p>
<p>ä¸€ä¸ªæ•°æ®ç»“æ„åªè¦éƒ¨ç½²äº†<code>Symbol.iterator</code>å±æ€§ï¼Œå°±è¢«è§†ä¸ºå…·æœ‰iteratoræ¥å£ï¼Œå°±å¯ä»¥ç”¨<code>for...of</code>å¾ªç¯éå†å®ƒçš„æˆå‘˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>for...of</code>å¾ªç¯å†…éƒ¨è°ƒç”¨çš„æ˜¯æ•°æ®ç»“æ„çš„<code>Symbol.iterator</code>æ–¹æ³•ã€‚</p>
<p><code>for...of</code>å¾ªç¯å¯ä»¥ä½¿ç”¨çš„èŒƒå›´åŒ…æ‹¬æ•°ç»„ã€Set å’Œ Map ç»“æ„ã€æŸäº›ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆæ¯”å¦‚<code>arguments</code>å¯¹è±¡ã€DOM NodeList å¯¹è±¡ï¼‰ã€åæ–‡çš„ Generator å¯¹è±¡ï¼Œä»¥åŠå­—ç¬¦ä¸²ã€‚</p>
<h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>æ•°ç»„åŸç”Ÿå…·å¤‡<code>iterator</code>æ¥å£ï¼ˆå³é»˜è®¤éƒ¨ç½²äº†<code>Symbol.iterator</code>å±æ€§ï¼‰ï¼Œ<code>for...of</code>å¾ªç¯æœ¬è´¨ä¸Šå°±æ˜¯è°ƒç”¨è¿™ä¸ªæ¥å£äº§ç”Ÿçš„éå†å™¨ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç è¯æ˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> arr = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>];</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> v <span class="keyword">of</span> arr) &#123;</div><div class="line">  <span class="built_in">console</span>.log(v); <span class="comment">// red green blue</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> obj = &#123;&#125;;</div><div class="line">obj[<span class="built_in">Symbol</span>.iterator] = arr[<span class="built_in">Symbol</span>.iterator].bind(arr);</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> v <span class="keyword">of</span> obj) &#123;</div><div class="line">  <span class="built_in">console</span>.log(v); <span class="comment">// red green blue</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç©ºå¯¹è±¡<code>obj</code>éƒ¨ç½²äº†æ•°ç»„<code>arr</code>çš„<code>Symbol.iterator</code>å±æ€§ï¼Œç»“æœ<code>obj</code>çš„<code>for...of</code>å¾ªç¯ï¼Œäº§ç”Ÿäº†ä¸<code>arr</code>å®Œå…¨ä¸€æ ·çš„ç»“æœã€‚</p>
<p><code>for...of</code>å¾ªç¯å¯ä»¥ä»£æ›¿æ•°ç»„å®ä¾‹çš„<code>forEach</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> arr = [<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>];</div><div class="line"></div><div class="line">arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">element, index</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(element); <span class="comment">// red green blue</span></div><div class="line">  <span class="built_in">console</span>.log(index);   <span class="comment">// 0 1 2</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>JavaScriptåŸæœ‰çš„<code>for...in</code>å¾ªç¯ï¼Œåªèƒ½è·å¾—å¯¹è±¡çš„é”®åï¼Œä¸èƒ½ç›´æ¥è·å–é”®å€¼ã€‚ES6æä¾›<code>for...of</code>å¾ªç¯ï¼Œå…è®¸éå†è·å¾—é”®å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>];</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> a <span class="keyword">in</span> arr) &#123;</div><div class="line">  <span class="built_in">console</span>.log(a); <span class="comment">// 0 1 2 3</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> a <span class="keyword">of</span> arr) &#123;</div><div class="line">  <span class="built_in">console</span>.log(a); <span class="comment">// a b c d</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨æ˜ï¼Œ<code>for...in</code>å¾ªç¯è¯»å–é”®åï¼Œ<code>for...of</code>å¾ªç¯è¯»å–é”®å€¼ã€‚å¦‚æœè¦é€šè¿‡<code>for...of</code>å¾ªç¯ï¼Œè·å–æ•°ç»„çš„ç´¢å¼•ï¼Œå¯ä»¥å€ŸåŠ©æ•°ç»„å®ä¾‹çš„<code>entries</code>æ–¹æ³•å’Œ<code>keys</code>æ–¹æ³•ï¼Œå‚è§ã€Šæ•°ç»„çš„æ‰©å±•ã€‹ç« èŠ‚ã€‚</p>
<p><code>for...of</code>å¾ªç¯è°ƒç”¨éå†å™¨æ¥å£ï¼Œæ•°ç»„çš„éå†å™¨æ¥å£åªè¿”å›å…·æœ‰æ•°å­—ç´¢å¼•çš„å±æ€§ã€‚è¿™ä¸€ç‚¹è·Ÿ<code>for...in</code>å¾ªç¯ä¹Ÿä¸ä¸€æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arr = [<span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>];</div><div class="line">arr.foo = <span class="string">'hello'</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> arr) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i); <span class="comment">// "0", "1", "2", "foo"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> arr) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i); <span class="comment">//  "3", "5", "7"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>for...of</code>å¾ªç¯ä¸ä¼šè¿”å›æ•°ç»„<code>arr</code>çš„<code>foo</code>å±æ€§ã€‚</p>
<h3 id="Setå’ŒMapç»“æ„"><a href="#Setå’ŒMapç»“æ„" class="headerlink" title="Setå’ŒMapç»“æ„"></a>Setå’ŒMapç»“æ„</h3><p>Setå’ŒMapç»“æ„ä¹ŸåŸç”Ÿå…·æœ‰Iteratoræ¥å£ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>for...of</code>å¾ªç¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> engines = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">"Gecko"</span>, <span class="string">"Trident"</span>, <span class="string">"Webkit"</span>, <span class="string">"Webkit"</span>]);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> e <span class="keyword">of</span> engines) &#123;</div><div class="line">  <span class="built_in">console</span>.log(e);</div><div class="line">&#125;</div><div class="line"><span class="comment">// Gecko</span></div><div class="line"><span class="comment">// Trident</span></div><div class="line"><span class="comment">// Webkit</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> es6 = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">es6.set(<span class="string">"edition"</span>, <span class="number">6</span>);</div><div class="line">es6.set(<span class="string">"committee"</span>, <span class="string">"TC39"</span>);</div><div class="line">es6.set(<span class="string">"standard"</span>, <span class="string">"ECMA-262"</span>);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> [name, value] <span class="keyword">of</span> es6) &#123;</div><div class="line">  <span class="built_in">console</span>.log(name + <span class="string">": "</span> + value);</div><div class="line">&#125;</div><div class="line"><span class="comment">// edition: 6</span></div><div class="line"><span class="comment">// committee: TC39</span></div><div class="line"><span class="comment">// standard: ECMA-262</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ¼”ç¤ºäº†å¦‚ä½•éå†Setç»“æ„å’ŒMapç»“æ„ã€‚å€¼å¾—æ³¨æ„çš„åœ°æ–¹æœ‰ä¸¤ä¸ªï¼Œé¦–å…ˆï¼Œéå†çš„é¡ºåºæ˜¯æŒ‰ç…§å„ä¸ªæˆå‘˜è¢«æ·»åŠ è¿›æ•°æ®ç»“æ„çš„é¡ºåºã€‚å…¶æ¬¡ï¼ŒSetç»“æ„éå†æ—¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå€¼ï¼Œè€ŒMapç»“æ„éå†æ—¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„ä¸¤ä¸ªæˆå‘˜åˆ†åˆ«ä¸ºå½“å‰Mapæˆå‘˜çš„é”®åå’Œé”®å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>().set(<span class="string">'a'</span>, <span class="number">1</span>).set(<span class="string">'b'</span>, <span class="number">2</span>);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> pair <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="built_in">console</span>.log(pair);</div><div class="line">&#125;</div><div class="line"><span class="comment">// ['a', 1]</span></div><div class="line"><span class="comment">// ['b', 2]</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key + <span class="string">' : '</span> + value);</div><div class="line">&#125;</div><div class="line"><span class="comment">// a : 1</span></div><div class="line"><span class="comment">// b : 2</span></div></pre></td></tr></table></figure>
<h3 id="è®¡ç®—ç”Ÿæˆçš„æ•°æ®ç»“æ„"><a href="#è®¡ç®—ç”Ÿæˆçš„æ•°æ®ç»“æ„" class="headerlink" title="è®¡ç®—ç”Ÿæˆçš„æ•°æ®ç»“æ„"></a>è®¡ç®—ç”Ÿæˆçš„æ•°æ®ç»“æ„</h3><p>æœ‰äº›æ•°æ®ç»“æ„æ˜¯åœ¨ç°æœ‰æ•°æ®ç»“æ„çš„åŸºç¡€ä¸Šï¼Œè®¡ç®—ç”Ÿæˆçš„ã€‚æ¯”å¦‚ï¼ŒES6çš„æ•°ç»„ã€Setã€Mapéƒ½éƒ¨ç½²äº†ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ï¼Œè°ƒç”¨åéƒ½è¿”å›éå†å™¨å¯¹è±¡ã€‚</p>
<ul>
<li><code>entries()</code> è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†<code>[é”®å, é”®å€¼]</code>ç»„æˆçš„æ•°ç»„ã€‚å¯¹äºæ•°ç»„ï¼Œé”®åå°±æ˜¯ç´¢å¼•å€¼ï¼›å¯¹äºSetï¼Œé”®åä¸é”®å€¼ç›¸åŒã€‚Mapç»“æ„çš„iteratoræ¥å£ï¼Œé»˜è®¤å°±æ˜¯è°ƒç”¨entriesæ–¹æ³•ã€‚</li>
<li><code>keys()</code> è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„é”®åã€‚</li>
<li><code>values()</code> è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„é”®å€¼ã€‚</li>
</ul>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•è°ƒç”¨åç”Ÿæˆçš„éå†å™¨å¯¹è±¡ï¼Œæ‰€éå†çš„éƒ½æ˜¯è®¡ç®—ç”Ÿæˆçš„æ•°æ®ç»“æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> pair <span class="keyword">of</span> arr.entries()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(pair);</div><div class="line">&#125;</div><div class="line"><span class="comment">// [0, 'a']</span></div><div class="line"><span class="comment">// [1, 'b']</span></div><div class="line"><span class="comment">// [2, 'c']</span></div></pre></td></tr></table></figure>
<h3 id="ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡"><a href="#ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡" class="headerlink" title="ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡"></a>ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡</h3><p>ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡åŒ…æ‹¬å¥½å‡ ç±»ã€‚ä¸‹é¢æ˜¯<code>for...of</code>å¾ªç¯ç”¨äºå­—ç¬¦ä¸²ã€DOM NodeListå¯¹è±¡ã€argumentså¯¹è±¡çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å­—ç¬¦ä¸²</span></div><div class="line"><span class="keyword">let</span> str = <span class="string">"hello"</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> s <span class="keyword">of</span> str) &#123;</div><div class="line">  <span class="built_in">console</span>.log(s); <span class="comment">// h e l l o</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// DOM NodeListå¯¹è±¡</span></div><div class="line"><span class="keyword">let</span> paras = <span class="built_in">document</span>.querySelectorAll(<span class="string">"p"</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> p <span class="keyword">of</span> paras) &#123;</div><div class="line">  p.classList.add(<span class="string">"test"</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// argumentså¯¹è±¡</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">printArgs</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> <span class="built_in">arguments</span>) &#123;</div><div class="line">    <span class="built_in">console</span>.log(x);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">printArgs(<span class="string">'a'</span>, <span class="string">'b'</span>);</div><div class="line"><span class="comment">// 'a'</span></div><div class="line"><span class="comment">// 'b'</span></div></pre></td></tr></table></figure>
<p>å¯¹äºå­—ç¬¦ä¸²æ¥è¯´ï¼Œ<code>for...of</code>å¾ªç¯è¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯ä¼šæ­£ç¡®è¯†åˆ«32ä½UTF-16å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> <span class="string">'a\uD83D\uDC0A'</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 'a'</span></div><div class="line"><span class="comment">// '\uD83D\uDC0A'</span></div></pre></td></tr></table></figure>
<p>å¹¶ä¸æ˜¯æ‰€æœ‰ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½å…·æœ‰iteratoræ¥å£ï¼Œä¸€ä¸ªç®€ä¾¿çš„è§£å†³æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨Array.fromæ–¹æ³•å°†å…¶è½¬ä¸ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arrayLike = &#123; <span class="attr">length</span>: <span class="number">2</span>, <span class="number">0</span>: <span class="string">'a'</span>, <span class="number">1</span>: <span class="string">'b'</span> &#125;;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> arrayLike) &#123;</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ­£ç¡®</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> <span class="built_in">Array</span>.from(arrayLike)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å¯¹è±¡"><a href="#å¯¹è±¡" class="headerlink" title="å¯¹è±¡"></a>å¯¹è±¡</h3><p>å¯¹äºæ™®é€šçš„å¯¹è±¡ï¼Œ<code>for...of</code>ç»“æ„ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œä¼šæŠ¥é”™ï¼Œå¿…é¡»éƒ¨ç½²äº†iteratoræ¥å£åæ‰èƒ½ä½¿ç”¨ã€‚ä½†æ˜¯ï¼Œè¿™æ ·æƒ…å†µä¸‹ï¼Œ<code>for...in</code>å¾ªç¯ä¾ç„¶å¯ä»¥ç”¨æ¥éå†é”®åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> es6 = &#123;</div><div class="line">  <span class="attr">edition</span>: <span class="number">6</span>,</div><div class="line">  <span class="attr">committee</span>: <span class="string">"TC39"</span>,</div><div class="line">  <span class="attr">standard</span>: <span class="string">"ECMA-262"</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> e <span class="keyword">in</span> es6) &#123;</div><div class="line">  <span class="built_in">console</span>.log(e);</div><div class="line">&#125;</div><div class="line"><span class="comment">// edition</span></div><div class="line"><span class="comment">// committee</span></div><div class="line"><span class="comment">// standard</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> e <span class="keyword">of</span> es6) &#123;</div><div class="line">  <span class="built_in">console</span>.log(e);</div><div class="line">&#125;</div><div class="line"><span class="comment">// TypeError: es6 is not iterable</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯¹äºæ™®é€šçš„å¯¹è±¡ï¼Œ<code>for...in</code>å¾ªç¯å¯ä»¥éå†é”®åï¼Œ<code>for...of</code>å¾ªç¯ä¼šæŠ¥é”™ã€‚</p>
<p>ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨<code>Object.keys</code>æ–¹æ³•å°†å¯¹è±¡çš„é”®åç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶åéå†è¿™ä¸ªæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(someObject)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key + <span class="string">": "</span> + someObject[key]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åœ¨å¯¹è±¡ä¸Šéƒ¨ç½²iteratoræ¥å£çš„ä»£ç ï¼Œå‚è§æœ¬ç« å‰é¢éƒ¨åˆ†ã€‚ä¸€ä¸ªæ–¹ä¾¿çš„æ–¹æ³•æ˜¯å°†æ•°ç»„çš„<code>Symbol.iterator</code>å±æ€§ï¼Œç›´æ¥èµ‹å€¼ç»™å…¶ä»–å¯¹è±¡çš„<code>Symbol.iterator</code>å±æ€§ã€‚æ¯”å¦‚ï¼Œæƒ³è¦è®©<code>for...of</code>ç¯éå†jQueryå¯¹è±¡ï¼Œåªè¦åŠ ä¸Šä¸‹é¢è¿™ä¸€è¡Œå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">jQuery.prototype[<span class="built_in">Symbol</span>.iterator] =</div><div class="line">  <span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.iterator];</div></pre></td></tr></table></figure>
<p>å¦ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨Generatorå‡½æ•°å°†å¯¹è±¡é‡æ–°åŒ…è£…ä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">entries</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(obj)) &#123;</div><div class="line">    <span class="keyword">yield</span> [key, obj[key]];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> entries(obj)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key, <span class="string">"-&gt;"</span>, value);</div><div class="line">&#125;</div><div class="line"><span class="comment">// a -&gt; 1</span></div><div class="line"><span class="comment">// b -&gt; 2</span></div><div class="line"><span class="comment">// c -&gt; 3</span></div></pre></td></tr></table></figure>
<h3 id="ä¸å…¶ä»–éå†è¯­æ³•çš„æ¯”è¾ƒ"><a href="#ä¸å…¶ä»–éå†è¯­æ³•çš„æ¯”è¾ƒ" class="headerlink" title="ä¸å…¶ä»–éå†è¯­æ³•çš„æ¯”è¾ƒ"></a>ä¸å…¶ä»–éå†è¯­æ³•çš„æ¯”è¾ƒ</h3><p>ä»¥æ•°ç»„ä¸ºä¾‹ï¼ŒJavaScriptæä¾›å¤šç§éå†è¯­æ³•ã€‚æœ€åŸå§‹çš„å†™æ³•å°±æ˜¯forå¾ªç¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; myArray.length; index++) &#123;</div><div class="line">  <span class="built_in">console</span>.log(myArray[index]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™ç§å†™æ³•æ¯”è¾ƒéº»çƒ¦ï¼Œå› æ­¤æ•°ç»„æä¾›å†…ç½®çš„forEachæ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">myArray.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è¿™ç§å†™æ³•çš„é—®é¢˜åœ¨äºï¼Œæ— æ³•ä¸­é€”è·³å‡º<code>forEach</code>å¾ªç¯ï¼Œbreakå‘½ä»¤æˆ–returnå‘½ä»¤éƒ½ä¸èƒ½å¥æ•ˆã€‚</p>
<p><code>for...in</code>å¾ªç¯å¯ä»¥éå†æ•°ç»„çš„é”®åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> index <span class="keyword">in</span> myArray) &#123;</div><div class="line">  <span class="built_in">console</span>.log(myArray[index]);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>forâ€¦inå¾ªç¯æœ‰å‡ ä¸ªç¼ºç‚¹ã€‚</p>
<ul>
<li>æ•°ç»„çš„é”®åæ˜¯æ•°å­—ï¼Œä½†æ˜¯forâ€¦inå¾ªç¯æ˜¯ä»¥å­—ç¬¦ä¸²ä½œä¸ºé”®åâ€œ0â€ã€â€œ1â€ã€â€œ2â€ç­‰ç­‰ã€‚</li>
<li>forâ€¦inå¾ªç¯ä¸ä»…éå†æ•°å­—é”®åï¼Œè¿˜ä¼šéå†æ‰‹åŠ¨æ·»åŠ çš„å…¶ä»–é”®ï¼Œç”šè‡³åŒ…æ‹¬åŸå‹é“¾ä¸Šçš„é”®ã€‚</li>
<li>æŸäº›æƒ…å†µä¸‹ï¼Œforâ€¦inå¾ªç¯ä¼šä»¥ä»»æ„é¡ºåºéå†é”®åã€‚</li>
</ul>
<p>æ€»ä¹‹ï¼Œ<code>for...in</code>å¾ªç¯ä¸»è¦æ˜¯ä¸ºéå†å¯¹è±¡è€Œè®¾è®¡çš„ï¼Œä¸é€‚ç”¨äºéå†æ•°ç»„ã€‚</p>
<p><code>for...of</code>å¾ªç¯ç›¸æ¯”ä¸Šé¢å‡ ç§åšæ³•ï¼Œæœ‰ä¸€äº›æ˜¾è‘—çš„ä¼˜ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> myArray) &#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>æœ‰ç€åŒforâ€¦inä¸€æ ·çš„ç®€æ´è¯­æ³•ï¼Œä½†æ˜¯æ²¡æœ‰forâ€¦iné‚£äº›ç¼ºç‚¹ã€‚</li>
<li>ä¸åŒç”¨äºforEachæ–¹æ³•ï¼Œå®ƒå¯ä»¥ä¸breakã€continueå’Œreturné…åˆä½¿ç”¨ã€‚</li>
<li>æä¾›äº†éå†æ‰€æœ‰æ•°æ®ç»“æ„çš„ç»Ÿä¸€æ“ä½œæ¥å£ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨breakè¯­å¥ï¼Œè·³å‡º<code>for...of</code>å¾ªç¯çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> n <span class="keyword">of</span> fibonacci) &#123;</div><div class="line">  <span class="keyword">if</span> (n &gt; <span class="number">1000</span>)</div><div class="line">    <span class="keyword">break</span>;</div><div class="line">  <span class="built_in">console</span>.log(n);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­ï¼Œä¼šè¾“å‡ºæ–æ³¢çº³å¥‘æ•°åˆ—å°äºç­‰äº1000çš„é¡¹ã€‚å¦‚æœå½“å‰é¡¹å¤§äº1000ï¼Œå°±ä¼šä½¿ç”¨breakè¯­å¥è·³å‡º<code>for...of</code>å¾ªç¯ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Iteratorå’Œforâ€¦ofå¾ªç¯&quot;&gt;&lt;a href=&quot;#Iteratorå’Œforâ€¦ofå¾ªç¯&quot; class=&quot;headerlink&quot; title=&quot;Iteratorå’Œforâ€¦ofå¾ªç¯&quot;&gt;&lt;/a&gt;Iteratorå’Œforâ€¦ofå¾ªç¯&lt;/h1&gt;&lt;h2 id=&quot;Itera
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Iterator" scheme="http://microzz.com/tags/Iterator/"/>
    
      <category term="for" scheme="http://microzz.com/tags/for/"/>
    
  </entry>
  
  <entry>
    <title>Reflect</title>
    <link href="http://microzz.com/2017/01/11/reflect/"/>
    <id>http://microzz.com/2017/01/11/reflect/</id>
    <published>2017-01-11T00:25:19.000Z</published>
    <updated>2017-01-12T08:19:34.606Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Reflect"><a href="#Reflect" class="headerlink" title="Reflect"></a>Reflect</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p><code>Reflect</code>å¯¹è±¡ä¸<code>Proxy</code>å¯¹è±¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯ ES6 ä¸ºäº†æ“ä½œå¯¹è±¡è€Œæä¾›çš„æ–° APIã€‚<code>Reflect</code>å¯¹è±¡çš„è®¾è®¡ç›®çš„æœ‰è¿™æ ·å‡ ä¸ªã€‚</p>
<p>ï¼ˆ1ï¼‰ å°†<code>Object</code>å¯¹è±¡çš„ä¸€äº›æ˜æ˜¾å±äºè¯­è¨€å†…éƒ¨çš„æ–¹æ³•ï¼ˆæ¯”å¦‚<code>Object.defineProperty</code>ï¼‰ï¼Œæ”¾åˆ°<code>Reflect</code>å¯¹è±¡ä¸Šã€‚ç°é˜¶æ®µï¼ŒæŸäº›æ–¹æ³•åŒæ—¶åœ¨<code>Object</code>å’Œ<code>Reflect</code>å¯¹è±¡ä¸Šéƒ¨ç½²ï¼Œæœªæ¥çš„æ–°æ–¹æ³•å°†åªéƒ¨ç½²åœ¨<code>Reflect</code>å¯¹è±¡ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»<code>Reflect</code>å¯¹è±¡ä¸Šå¯ä»¥æ‹¿åˆ°è¯­è¨€å†…éƒ¨çš„æ–¹æ³•ã€‚</p>
<p>ï¼ˆ2ï¼‰ ä¿®æ”¹æŸäº›<code>Object</code>æ–¹æ³•çš„è¿”å›ç»“æœï¼Œè®©å…¶å˜å¾—æ›´åˆç†ã€‚æ¯”å¦‚ï¼Œ<code>Object.defineProperty(obj, name, desc)</code>åœ¨æ— æ³•å®šä¹‰å±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè€Œ<code>Reflect.defineProperty(obj, name, desc)</code>åˆ™ä¼šè¿”å›<code>false</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è€å†™æ³•</span></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  <span class="built_in">Object</span>.defineProperty(target, property, attributes);</div><div class="line">  <span class="comment">// success</span></div><div class="line">&#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">  <span class="comment">// failure</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="keyword">if</span> (<span class="built_in">Reflect</span>.defineProperty(target, property, attributes)) &#123;</div><div class="line">  <span class="comment">// success</span></div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  <span class="comment">// failure</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰ è®©<code>Object</code>æ“ä½œéƒ½å˜æˆå‡½æ•°è¡Œä¸ºã€‚æŸäº›<code>Object</code>æ“ä½œæ˜¯å‘½ä»¤å¼ï¼Œæ¯”å¦‚<code>name in obj</code>å’Œ<code>delete obj[name]</code>ï¼Œè€Œ<code>Reflect.has(obj, name)</code>å’Œ<code>Reflect.deleteProperty(obj, name)</code>è®©å®ƒä»¬å˜æˆäº†å‡½æ•°è¡Œä¸ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è€å†™æ³•</span></div><div class="line"><span class="string">'assign'</span> <span class="keyword">in</span> <span class="built_in">Object</span> <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.has(<span class="built_in">Object</span>, <span class="string">'assign'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ï¼ˆ4ï¼‰<code>Reflect</code>å¯¹è±¡çš„æ–¹æ³•ä¸<code>Proxy</code>å¯¹è±¡çš„æ–¹æ³•ä¸€ä¸€å¯¹åº”ï¼Œåªè¦æ˜¯<code>Proxy</code>å¯¹è±¡çš„æ–¹æ³•ï¼Œå°±èƒ½åœ¨<code>Reflect</code>å¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•ã€‚è¿™å°±è®©<code>Proxy</code>å¯¹è±¡å¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨å¯¹åº”çš„<code>Reflect</code>æ–¹æ³•ï¼Œå®Œæˆé»˜è®¤è¡Œä¸ºï¼Œä½œä¸ºä¿®æ”¹è¡Œä¸ºçš„åŸºç¡€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡<code>Proxy</code>æ€ä¹ˆä¿®æ”¹é»˜è®¤è¡Œä¸ºï¼Œä½ æ€»å¯ä»¥åœ¨<code>Reflect</code>ä¸Šè·å–é»˜è®¤è¡Œä¸ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Proxy</span>(target, &#123;</div><div class="line">  <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, name, value, receiver</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> success = <span class="built_in">Reflect</span>.set(target,name, value, receiver);</div><div class="line">    <span class="keyword">if</span> (success) &#123;</div><div class="line">      log(<span class="string">'property '</span> + name + <span class="string">' on '</span> + target + <span class="string">' set to '</span> + value);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> success;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Proxy</code>æ–¹æ³•æ‹¦æˆª<code>target</code>å¯¹è±¡çš„å±æ€§èµ‹å€¼è¡Œä¸ºã€‚å®ƒé‡‡ç”¨<code>Reflect.set</code>æ–¹æ³•å°†å€¼èµ‹å€¼ç»™å¯¹è±¡çš„å±æ€§ï¼Œç¡®ä¿å®ŒæˆåŸæœ‰çš„è¡Œä¸ºï¼Œç„¶åå†éƒ¨ç½²é¢å¤–çš„åŠŸèƒ½ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> loggedObj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</div><div class="line">  get(target, name) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'get'</span>, target, name);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, name);</div><div class="line">  &#125;,</div><div class="line">  deleteProperty(target, name) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'delete'</span> + name);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.deleteProperty(target, name);</div><div class="line">  &#125;,</div><div class="line">  has(target, name) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'has'</span> + name);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.has(target, name);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯ä¸€ä¸ª<code>Proxy</code>å¯¹è±¡çš„æ‹¦æˆªæ“ä½œï¼ˆ<code>get</code>ã€<code>delete</code>ã€<code>has</code>ï¼‰ï¼Œå†…éƒ¨éƒ½è°ƒç”¨å¯¹åº”çš„<code>Reflect</code>æ–¹æ³•ï¼Œä¿è¯åŸç”Ÿè¡Œä¸ºèƒ½å¤Ÿæ­£å¸¸æ‰§è¡Œã€‚æ·»åŠ çš„å·¥ä½œï¼Œå°±æ˜¯å°†æ¯ä¸€ä¸ªæ“ä½œè¾“å‡ºä¸€è¡Œæ—¥å¿—ã€‚</p>
<p>æœ‰äº†<code>Reflect</code>å¯¹è±¡ä»¥åï¼Œå¾ˆå¤šæ“ä½œä¼šæ›´æ˜“è¯»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è€å†™æ³•</span></div><div class="line"><span class="built_in">Function</span>.prototype.apply.call(<span class="built_in">Math</span>.floor, <span class="literal">undefined</span>, [<span class="number">1.75</span>]) <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.apply(<span class="built_in">Math</span>.floor, <span class="literal">undefined</span>, [<span class="number">1.75</span>]) <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<h2 id="é™æ€æ–¹æ³•"><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h2><p><code>Reflect</code>å¯¹è±¡ä¸€å…±æœ‰13ä¸ªé™æ€æ–¹æ³•ã€‚</p>
<ul>
<li>Reflect.apply(target,thisArg,args)</li>
<li>Reflect.construct(target,args)</li>
<li>Reflect.get(target,name,receiver)</li>
<li>Reflect.set(target,name,value,receiver)</li>
<li>Reflect.defineProperty(target,name,desc)</li>
<li>Reflect.deleteProperty(target,name)</li>
<li>Reflect.has(target,name)</li>
<li>Reflect.ownKeys(target)</li>
<li>Reflect.isExtensible(target)</li>
<li>Reflect.preventExtensions(target)</li>
<li>Reflect.getOwnPropertyDescriptor(target, name)</li>
<li>Reflect.getPrototypeOf(target)</li>
<li>Reflect.setPrototypeOf(target, prototype)</li>
</ul>
<p>ä¸Šé¢è¿™äº›æ–¹æ³•çš„ä½œç”¨ï¼Œå¤§éƒ¨åˆ†ä¸<code>Object</code>å¯¹è±¡çš„åŒåæ–¹æ³•çš„ä½œç”¨éƒ½æ˜¯ç›¸åŒçš„ï¼Œè€Œä¸”å®ƒä¸<code>Proxy</code>å¯¹è±¡çš„æ–¹æ³•æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ä¸‹é¢æ˜¯å¯¹å®ƒä»¬çš„è§£é‡Šã€‚</p>
<h3 id="Reflect-get-target-name-receiver"><a href="#Reflect-get-target-name-receiver" class="headerlink" title="Reflect.get(target, name, receiver)"></a>Reflect.get(target, name, receiver)</h3><p><code>Reflect.get</code>æ–¹æ³•æŸ¥æ‰¾å¹¶è¿”å›<code>target</code>å¯¹è±¡çš„<code>name</code>å±æ€§ï¼Œå¦‚æœæ²¡æœ‰è¯¥å±æ€§ï¼Œåˆ™è¿”å›<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">bar</span>: <span class="number">2</span>,</div><div class="line">  get baz() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.foo + <span class="keyword">this</span>.bar;</div><div class="line">  &#125;,</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">Reflect</span>.get(myObject, <span class="string">'foo'</span>) <span class="comment">// 1</span></div><div class="line"><span class="built_in">Reflect</span>.get(myObject, <span class="string">'bar'</span>) <span class="comment">// 2</span></div><div class="line"><span class="built_in">Reflect</span>.get(myObject, <span class="string">'baz'</span>) <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>name</code>å±æ€§éƒ¨ç½²äº†è¯»å–å‡½æ•°ï¼ˆgetterï¼‰ï¼Œåˆ™è¯»å–å‡½æ•°çš„<code>this</code>ç»‘å®š<code>receiver</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">bar</span>: <span class="number">2</span>,</div><div class="line">  get baz() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.foo + <span class="keyword">this</span>.bar;</div><div class="line">  &#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> myReceiverObject = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">4</span>,</div><div class="line">  <span class="attr">bar</span>: <span class="number">4</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Reflect</span>.get(myObject, <span class="string">'baz'</span>, myReceiverObject) <span class="comment">// 8</span></div></pre></td></tr></table></figure>
<p>å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ<code>Reflect.get</code>æ–¹æ³•ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Reflect</span>.get(<span class="number">1</span>, <span class="string">'foo'</span>) <span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="built_in">Reflect</span>.get(<span class="literal">false</span>, <span class="string">'foo'</span>) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h3 id="Reflect-set-target-name-value-receiver"><a href="#Reflect-set-target-name-value-receiver" class="headerlink" title="Reflect.set(target, name, value, receiver)"></a>Reflect.set(target, name, value, receiver)</h3><p><code>Reflect.set</code>æ–¹æ³•è®¾ç½®<code>target</code>å¯¹è±¡çš„<code>name</code>å±æ€§ç­‰äº<code>value</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</div><div class="line">  set bar(value) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.foo = value;</div><div class="line">  &#125;,</div><div class="line">&#125;</div><div class="line"></div><div class="line">myObject.foo <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="built_in">Reflect</span>.set(myObject, <span class="string">'foo'</span>, <span class="number">2</span>);</div><div class="line">myObject.foo <span class="comment">// 2</span></div><div class="line"></div><div class="line"><span class="built_in">Reflect</span>.set(myObject, <span class="string">'bar'</span>, <span class="number">3</span>)</div><div class="line">myObject.foo <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>name</code>å±æ€§è®¾ç½®äº†èµ‹å€¼å‡½æ•°ï¼Œåˆ™èµ‹å€¼å‡½æ•°çš„<code>this</code>ç»‘å®š<code>receiver</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">4</span>,</div><div class="line">  set bar(value) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.foo = value;</div><div class="line">  &#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> myReceiverObject = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">0</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Reflect</span>.set(myObject, <span class="string">'bar'</span>, <span class="number">1</span>, myReceiverObject);</div><div class="line">myObject.foo <span class="comment">// 4</span></div><div class="line">myReceiverObject.foo <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<p>å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ<code>Reflect.set</code>ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Reflect</span>.set(<span class="number">1</span>, <span class="string">'foo'</span>, &#123;&#125;) <span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="built_in">Reflect</span>.set(<span class="literal">false</span>, <span class="string">'foo'</span>, &#123;&#125;) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h3 id="Reflect-has-obj-name"><a href="#Reflect-has-obj-name" class="headerlink" title="Reflect.has(obj, name)"></a>Reflect.has(obj, name)</h3><p><code>Reflect.has</code>æ–¹æ³•å¯¹åº”<code>name in obj</code>é‡Œé¢çš„<code>in</code>è¿ç®—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="string">'foo'</span> <span class="keyword">in</span> myObject <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.has(myObject, <span class="string">'foo'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ<code>Reflect.has</code>å’Œ<code>in</code>è¿ç®—ç¬¦éƒ½ä¼šæŠ¥é”™ã€‚</p>
<h3 id="Reflect-deleteProperty-obj-name"><a href="#Reflect-deleteProperty-obj-name" class="headerlink" title="Reflect.deleteProperty(obj, name)"></a>Reflect.deleteProperty(obj, name)</h3><p><code>Reflect.deleteProperty</code>æ–¹æ³•ç­‰åŒäº<code>delete obj[name]</code>ï¼Œç”¨äºåˆ é™¤å¯¹è±¡çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> myObj = &#123; <span class="attr">foo</span>: <span class="string">'bar'</span> &#125;;</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="keyword">delete</span> myObj.foo;</div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.deleteProperty(myObj, <span class="string">'foo'</span>);</div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚å¦‚æœåˆ é™¤æˆåŠŸï¼Œæˆ–è€…è¢«åˆ é™¤çš„å±æ€§ä¸å­˜åœ¨ï¼Œè¿”å›<code>true</code>ï¼›åˆ é™¤å¤±è´¥ï¼Œè¢«åˆ é™¤çš„å±æ€§ä¾ç„¶å­˜åœ¨ï¼Œè¿”å›<code>false</code>ã€‚</p>
<h3 id="Reflect-construct-target-args"><a href="#Reflect-construct-target-args" class="headerlink" title="Reflect.construct(target, args)"></a>Reflect.construct(target, args)</h3><p><code>Reflect.construct</code>æ–¹æ³•ç­‰åŒäº<code>new target(...args)</code>ï¼Œè¿™æä¾›äº†ä¸€ç§ä¸ä½¿ç”¨<code>new</code>ï¼Œæ¥è°ƒç”¨æ„é€ å‡½æ•°çš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.name = name;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// new çš„å†™æ³•</span></div><div class="line"><span class="keyword">const</span> instance = <span class="keyword">new</span> Greeting(<span class="string">'å¼ ä¸‰'</span>);</div><div class="line"></div><div class="line"><span class="comment">// Reflect.construct çš„å†™æ³•</span></div><div class="line"><span class="keyword">const</span> instance = <span class="built_in">Reflect</span>.construct(Greeting, <span class="string">'å¼ ä¸‰'</span>);</div></pre></td></tr></table></figure>
<h3 id="Reflect-getPrototypeOf-obj"><a href="#Reflect-getPrototypeOf-obj" class="headerlink" title="Reflect.getPrototypeOf(obj)"></a>Reflect.getPrototypeOf(obj)</h3><p><code>Reflect.getPrototypeOf</code>æ–¹æ³•ç”¨äºè¯»å–å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼Œå¯¹åº”<code>Object.getPrototypeOf(obj)</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> myObj = <span class="keyword">new</span> FancyThing();</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="built_in">Object</span>.getPrototypeOf(myObj) === FancyThing.prototype;</div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.getPrototypeOf(myObj) === FancyThing.prototype;</div></pre></td></tr></table></figure>
<p><code>Reflect.getPrototypeOf</code>å’Œ<code>Object.getPrototypeOf</code>çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼ˆåŒ…æ‹¬<code>null</code>å’Œ<code>undefined</code>ï¼‰ï¼Œ<code>Object.getPrototypeOf</code>ä¼šå°†è¿™ä¸ªå‚æ•°è½¬ä¸ºå¯¹è±¡ï¼Œç„¶åå†è¿è¡Œï¼Œè€Œ<code>Reflect.getPrototypeOf</code>ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.getPrototypeOf(<span class="number">1</span>) <span class="comment">// undefined</span></div><div class="line"><span class="built_in">Reflect</span>.getPrototypeOf(<span class="number">1</span>) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h3 id="Reflect-setPrototypeOf-obj-newProto"><a href="#Reflect-setPrototypeOf-obj-newProto" class="headerlink" title="Reflect.setPrototypeOf(obj, newProto)"></a>Reflect.setPrototypeOf(obj, newProto)</h3><p><code>Reflect.setPrototypeOf</code>æ–¹æ³•ç”¨äºè®¾ç½®å¯¹è±¡çš„<code>__proto__</code>å±æ€§ï¼Œå¯¹åº”<code>Object.setPrototypeOf(obj, newProto)</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> myObj = <span class="keyword">new</span> FancyThing();</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="built_in">Object</span>.setPrototypeOf(myObj, OtherThing.prototype);</div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.setPrototypeOf(myObj, OtherThing.prototype);</div></pre></td></tr></table></figure>
<p>å¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ<code>Reflect.setPrototypeOf</code>å’Œ<code>Object.setPrototypeOf</code>éƒ½ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.setPrototypeOf(<span class="number">1</span>) <span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="built_in">Reflect</span>.setPrototypeOf(<span class="number">1</span>) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h3 id="Reflect-apply-func-thisArg-args"><a href="#Reflect-apply-func-thisArg-args" class="headerlink" title="Reflect.apply(func, thisArg, args)"></a>Reflect.apply(func, thisArg, args)</h3><p><code>Reflect.apply</code>æ–¹æ³•ç­‰åŒäº<code>Function.prototype.apply.call(func, thisArg, args)</code>ï¼Œç”¨äºç»‘å®š<code>this</code>å¯¹è±¡åæ‰§è¡Œç»™å®šå‡½æ•°ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœè¦ç»‘å®šä¸€ä¸ªå‡½æ•°çš„<code>this</code>å¯¹è±¡ï¼Œå¯ä»¥è¿™æ ·å†™<code>fn.apply(obj, args)</code>ï¼Œä½†æ˜¯å¦‚æœå‡½æ•°å®šä¹‰äº†è‡ªå·±çš„<code>apply</code>æ–¹æ³•ï¼Œå°±åªèƒ½å†™æˆ<code>Function.prototype.apply.call(fn, obj, args)</code>ï¼Œé‡‡ç”¨<code>Reflect</code>å¯¹è±¡å¯ä»¥ç®€åŒ–è¿™ç§æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> ages = [<span class="number">11</span>, <span class="number">33</span>, <span class="number">12</span>, <span class="number">54</span>, <span class="number">18</span>, <span class="number">96</span>];</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="keyword">const</span> youngest = <span class="built_in">Math</span>.min.apply(<span class="built_in">Math</span>, ages);</div><div class="line"><span class="keyword">const</span> oldest = <span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>, ages);</div><div class="line"><span class="keyword">const</span> type = <span class="built_in">Object</span>.prototype.toString.call(youngest);</div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="keyword">const</span> youngest = <span class="built_in">Reflect</span>.apply(<span class="built_in">Math</span>.min, <span class="built_in">Math</span>, ages);</div><div class="line"><span class="keyword">const</span> oldest = <span class="built_in">Reflect</span>.apply(<span class="built_in">Math</span>.max, <span class="built_in">Math</span>, ages);</div><div class="line"><span class="keyword">const</span> type = <span class="built_in">Reflect</span>.apply(<span class="built_in">Object</span>.prototype.toString, youngest);</div></pre></td></tr></table></figure>
<h3 id="Reflect-defineProperty-target-propertyKey-attributes"><a href="#Reflect-defineProperty-target-propertyKey-attributes" class="headerlink" title="Reflect.defineProperty(target, propertyKey, attributes)"></a>Reflect.defineProperty(target, propertyKey, attributes)</h3><p><code>Reflect.defineProperty</code>æ–¹æ³•åŸºæœ¬ç­‰åŒäº<code>Object.defineProperty</code>ï¼Œç”¨æ¥ä¸ºå¯¹è±¡å®šä¹‰å±æ€§ã€‚æœªæ¥ï¼Œåè€…ä¼šè¢«é€æ¸åºŸé™¤ï¼Œè¯·ä»ç°åœ¨å¼€å§‹å°±ä½¿ç”¨<code>Reflect.defineProperty</code>ä»£æ›¿å®ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyDate</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">/*â€¦*/</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="built_in">Object</span>.defineProperty(MyDate, <span class="string">'now'</span>, &#123;</div><div class="line">  <span class="attr">value</span>: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Date</span>.now()</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.defineProperty(MyDate, <span class="string">'now'</span>, &#123;</div><div class="line">  <span class="attr">value</span>: <span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Date</span>.now()</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>Reflect.defineProperty</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œå°±ä¼šæŠ›å‡ºé”™è¯¯ï¼Œæ¯”å¦‚<code>Reflect.defineProperty(1, &#39;foo&#39;)</code>ã€‚</p>
<h3 id="Reflect-getOwnPropertyDescriptor-target-propertyKey"><a href="#Reflect-getOwnPropertyDescriptor-target-propertyKey" class="headerlink" title="Reflect.getOwnPropertyDescriptor(target, propertyKey)"></a>Reflect.getOwnPropertyDescriptor(target, propertyKey)</h3><p><code>Reflect.getOwnPropertyDescriptor</code>åŸºæœ¬ç­‰åŒäº<code>Object.getOwnPropertyDescriptor</code>ï¼Œç”¨äºå¾—åˆ°æŒ‡å®šå±æ€§çš„æè¿°å¯¹è±¡ï¼Œå°†æ¥ä¼šæ›¿ä»£æ‰åè€…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.defineProperty(myObject, <span class="string">'hidden'</span>, &#123;</div><div class="line">  <span class="attr">value</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">enumerable</span>: <span class="literal">false</span>,</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="keyword">var</span> theDescriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(myObject, <span class="string">'hidden'</span>);</div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="keyword">var</span> theDescriptor = <span class="built_in">Reflect</span>.getOwnPropertyDescriptor(myObject, <span class="string">'hidden'</span>);</div></pre></td></tr></table></figure>
<p><code>Reflect.getOwnPropertyDescriptor</code>å’Œ<code>Object.getOwnPropertyDescriptor</code>çš„ä¸€ä¸ªåŒºåˆ«æ˜¯ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ<code>Object.getOwnPropertyDescriptor(1, &#39;foo&#39;)</code>ä¸æŠ¥é”™ï¼Œè¿”å›<code>undefined</code>ï¼Œè€Œ<code>Reflect.getOwnPropertyDescriptor(1, &#39;foo&#39;)</code>ä¼šæŠ›å‡ºé”™è¯¯ï¼Œè¡¨ç¤ºå‚æ•°éæ³•ã€‚</p>
<h3 id="Reflect-isExtensible-target"><a href="#Reflect-isExtensible-target" class="headerlink" title="Reflect.isExtensible (target)"></a>Reflect.isExtensible (target)</h3><p><code>Reflect.isExtensible</code>æ–¹æ³•å¯¹åº”<code>Object.isExtensible</code>ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå½“å‰å¯¹è±¡æ˜¯å¦å¯æ‰©å±•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> myObject = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="built_in">Object</span>.isExtensible(myObject) <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.isExtensible(myObject) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å¦‚æœå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ<code>Object.isExtensible</code>ä¼šè¿”å›<code>false</code>ï¼Œå› ä¸ºéå¯¹è±¡æœ¬æ¥å°±æ˜¯ä¸å¯æ‰©å±•çš„ï¼Œè€Œ<code>Reflect.isExtensible</code>ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.isExtensible(<span class="number">1</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Reflect</span>.isExtensible(<span class="number">1</span>) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h3 id="Reflect-preventExtensions-target"><a href="#Reflect-preventExtensions-target" class="headerlink" title="Reflect.preventExtensions(target)"></a>Reflect.preventExtensions(target)</h3><p><code>Reflect.preventExtensions</code>å¯¹åº”<code>Object.preventExtensions</code>æ–¹æ³•ï¼Œç”¨äºè®©ä¸€ä¸ªå¯¹è±¡å˜ä¸ºä¸å¯æ‰©å±•ã€‚å®ƒè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ“ä½œæˆåŠŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="built_in">Object</span>.isExtensible(myObject) <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.preventExtensions(myObject) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å¦‚æœå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ<code>Object.isExtensible</code>åœ¨ ES5 ç¯å¢ƒæŠ¥é”™ï¼Œåœ¨ ES6 ç¯å¢ƒè¿”å›è¿™ä¸ªå‚æ•°ï¼Œè€Œ<code>Reflect.preventExtensions</code>ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5</span></div><div class="line"><span class="built_in">Object</span>.preventExtensions(<span class="number">1</span>) <span class="comment">// æŠ¥é”™</span></div><div class="line"></div><div class="line"><span class="comment">// ES6</span></div><div class="line"><span class="built_in">Object</span>.preventExtensions(<span class="number">1</span>) <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.preventExtensions(<span class="number">1</span>) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h3 id="Reflect-ownKeys-target"><a href="#Reflect-ownKeys-target" class="headerlink" title="Reflect.ownKeys (target)"></a>Reflect.ownKeys (target)</h3><p><code>Reflect.ownKeys</code>æ–¹æ³•ç”¨äºè¿”å›å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼ŒåŸºæœ¬ç­‰åŒäº<code>Object.getOwnPropertyNames</code>ä¸<code>Object.getOwnPropertySymbols</code>ä¹‹å’Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">bar</span>: <span class="number">2</span>,</div><div class="line">  [<span class="built_in">Symbol</span>.for(<span class="string">'baz'</span>)]: <span class="number">3</span>,</div><div class="line">  [<span class="built_in">Symbol</span>.for(<span class="string">'bing'</span>)]: <span class="number">4</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æ—§å†™æ³•</span></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(myObject)</div><div class="line"><span class="comment">// ['foo', 'bar']</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertySymbols(myObject)</div><div class="line"><span class="comment">//[Symbol.for('baz'), Symbol.for('bing')]</span></div><div class="line"></div><div class="line"><span class="comment">// æ–°å†™æ³•</span></div><div class="line"><span class="built_in">Reflect</span>.ownKeys(myObject)</div><div class="line"><span class="comment">// ['foo', 'bar', Symbol.for('baz'), Symbol.for('bing')]</span></div></pre></td></tr></table></figure>
<h2 id="å®ä¾‹ï¼šä½¿ç”¨-Proxy-å®ç°è§‚å¯Ÿè€…æ¨¡å¼"><a href="#å®ä¾‹ï¼šä½¿ç”¨-Proxy-å®ç°è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="å®ä¾‹ï¼šä½¿ç”¨ Proxy å®ç°è§‚å¯Ÿè€…æ¨¡å¼"></a>å®ä¾‹ï¼šä½¿ç”¨ Proxy å®ç°è§‚å¯Ÿè€…æ¨¡å¼</h2><p>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserver modeï¼‰æŒ‡çš„æ˜¯å‡½æ•°è‡ªåŠ¨è§‚å¯Ÿæ•°æ®å¯¹è±¡ï¼Œä¸€æ—¦å¯¹è±¡æœ‰å˜åŒ–ï¼Œå‡½æ•°å°±ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> person = observable(&#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'å¼ ä¸‰'</span>,</div><div class="line">  <span class="attr">age</span>: <span class="number">20</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">print</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;person.name&#125;</span>, <span class="subst">$&#123;person.age&#125;</span>`</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line">observe(print);</div><div class="line">person.name = <span class="string">'æå››'</span>;</div><div class="line"><span class="comment">// è¾“å‡º</span></div><div class="line"><span class="comment">// æå››, 20</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°æ®å¯¹è±¡<code>person</code>æ˜¯è§‚å¯Ÿç›®æ ‡ï¼Œå‡½æ•°<code>print</code>æ˜¯è§‚å¯Ÿè€…ã€‚ä¸€æ—¦æ•°æ®å¯¹è±¡å‘ç”Ÿå˜åŒ–ï¼Œ<code>print</code>å°±ä¼šè‡ªåŠ¨æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢ï¼Œä½¿ç”¨ Proxy å†™ä¸€ä¸ªè§‚å¯Ÿè€…æ¨¡å¼çš„æœ€ç®€å•å®ç°ï¼Œå³å®ç°<code>observable</code>å’Œ<code>observe</code>è¿™ä¸¤ä¸ªå‡½æ•°ã€‚æ€è·¯æ˜¯<code>observable</code>å‡½æ•°è¿”å›ä¸€ä¸ªåŸå§‹å¯¹è±¡çš„ Proxy ä»£ç†ï¼Œæ‹¦æˆªèµ‹å€¼æ“ä½œï¼Œè§¦å‘å……å½“è§‚å¯Ÿè€…çš„å„ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> queuedObservers = <span class="keyword">new</span> <span class="built_in">Set</span>();</div><div class="line"></div><div class="line"><span class="keyword">const</span> observe = <span class="function"><span class="params">fn</span> =&gt;</span> queuedObservers.add(fn);</div><div class="line"><span class="keyword">const</span> observable = <span class="function"><span class="params">obj</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;set&#125;);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">set</span>(<span class="params">target, key, value, receiver</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> result = <span class="built_in">Reflect</span>.set(target, key, value, receiver);</div><div class="line">  queuedObservers.forEach(<span class="function"><span class="params">observer</span> =&gt;</span> observer());</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå…ˆå®šä¹‰äº†ä¸€ä¸ª<code>Set</code>é›†åˆï¼Œæ‰€æœ‰è§‚å¯Ÿè€…å‡½æ•°éƒ½æ”¾è¿›è¿™ä¸ªé›†åˆã€‚ç„¶åï¼Œ<code>observable</code>å‡½æ•°è¿”å›åŸå§‹å¯¹è±¡çš„ä»£ç†ï¼Œæ‹¦æˆªèµ‹å€¼æ“ä½œã€‚æ‹¦æˆªå‡½æ•°<code>set</code>ä¹‹ä¸­ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œæ‰€æœ‰è§‚å¯Ÿè€…ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Reflect&quot;&gt;&lt;a href=&quot;#Reflect&quot; class=&quot;headerlink&quot; title=&quot;Reflect&quot;&gt;&lt;/a&gt;Reflect&lt;/h1&gt;&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Reflect" scheme="http://microzz.com/tags/Reflect/"/>
    
  </entry>
  
  <entry>
    <title>Proxy</title>
    <link href="http://microzz.com/2017/01/09/proxy/"/>
    <id>http://microzz.com/2017/01/09/proxy/</id>
    <published>2017-01-09T02:40:19.000Z</published>
    <updated>2017-01-12T08:18:16.019Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>Proxy ç”¨äºä¿®æ”¹æŸäº›æ“ä½œçš„é»˜è®¤è¡Œä¸ºï¼Œç­‰åŒäºåœ¨è¯­è¨€å±‚é¢åšå‡ºä¿®æ”¹ï¼Œæ‰€ä»¥å±äºä¸€ç§â€œå…ƒç¼–ç¨‹â€ï¼ˆmeta programmingï¼‰ï¼Œå³å¯¹ç¼–ç¨‹è¯­è¨€è¿›è¡Œç¼–ç¨‹ã€‚</p>
<p>Proxy å¯ä»¥ç†è§£æˆï¼Œåœ¨ç›®æ ‡å¯¹è±¡ä¹‹å‰æ¶è®¾ä¸€å±‚â€œæ‹¦æˆªâ€ï¼Œå¤–ç•Œå¯¹è¯¥å¯¹è±¡çš„è®¿é—®ï¼Œéƒ½å¿…é¡»å…ˆé€šè¿‡è¿™å±‚æ‹¦æˆªï¼Œå› æ­¤æä¾›äº†ä¸€ç§æœºåˆ¶ï¼Œå¯ä»¥å¯¹å¤–ç•Œçš„è®¿é—®è¿›è¡Œè¿‡æ»¤å’Œæ”¹å†™ã€‚Proxy è¿™ä¸ªè¯çš„åŸæ„æ˜¯ä»£ç†ï¼Œç”¨åœ¨è¿™é‡Œè¡¨ç¤ºç”±å®ƒæ¥â€œä»£ç†â€æŸäº›æ“ä½œï¼Œå¯ä»¥è¯‘ä¸ºâ€œä»£ç†å™¨â€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">get</span>: <span class="function"><span class="keyword">function</span> (<span class="params">target, key, receiver</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`getting <span class="subst">$&#123;key&#125;</span>!`</span>);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, key, receiver);</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">set</span>: <span class="function"><span class="keyword">function</span> (<span class="params">target, key, value, receiver</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">`setting <span class="subst">$&#123;key&#125;</span>!`</span>);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.set(target, key, value, receiver);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯¹ä¸€ä¸ªç©ºå¯¹è±¡æ¶è®¾äº†ä¸€å±‚æ‹¦æˆªï¼Œé‡å®šä¹‰äº†å±æ€§çš„è¯»å–ï¼ˆ<code>get</code>ï¼‰å’Œè®¾ç½®ï¼ˆ<code>set</code>ï¼‰è¡Œä¸ºã€‚è¿™é‡Œæš‚æ—¶å…ˆä¸è§£é‡Šå…·ä½“çš„è¯­æ³•ï¼Œåªçœ‹è¿è¡Œç»“æœã€‚å¯¹è®¾ç½®äº†æ‹¦æˆªè¡Œä¸ºçš„å¯¹è±¡<code>obj</code>ï¼Œå»è¯»å†™å®ƒçš„å±æ€§ï¼Œå°±ä¼šå¾—åˆ°ä¸‹é¢çš„ç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">obj.count = <span class="number">1</span></div><div class="line"><span class="comment">//  setting count!</span></div><div class="line">++obj.count</div><div class="line"><span class="comment">//  getting count!</span></div><div class="line"><span class="comment">//  setting count!</span></div><div class="line"><span class="comment">//  2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼ŒProxy å®é™…ä¸Šé‡è½½ï¼ˆoverloadï¼‰äº†ç‚¹è¿ç®—ç¬¦ï¼Œå³ç”¨è‡ªå·±çš„å®šä¹‰è¦†ç›–äº†è¯­è¨€çš„åŸå§‹å®šä¹‰ã€‚</p>
<p>ES6 åŸç”Ÿæä¾› Proxy æ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”Ÿæˆ Proxy å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div></pre></td></tr></table></figure>
<p>Proxy å¯¹è±¡çš„æ‰€æœ‰ç”¨æ³•ï¼Œéƒ½æ˜¯ä¸Šé¢è¿™ç§å½¢å¼ï¼Œä¸åŒçš„åªæ˜¯<code>handler</code>å‚æ•°çš„å†™æ³•ã€‚å…¶ä¸­ï¼Œ<code>new Proxy()</code>è¡¨ç¤ºç”Ÿæˆä¸€ä¸ª<code>Proxy</code>å®ä¾‹ï¼Œ<code>target</code>å‚æ•°è¡¨ç¤ºæ‰€è¦æ‹¦æˆªçš„ç›®æ ‡å¯¹è±¡ï¼Œ<code>handler</code>å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œç”¨æ¥å®šåˆ¶æ‹¦æˆªè¡Œä¸ºã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªæ‹¦æˆªè¯»å–å±æ€§è¡Œä¸ºçš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, property</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">35</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">proxy.time <span class="comment">// 35</span></div><div class="line">proxy.name <span class="comment">// 35</span></div><div class="line">proxy.title <span class="comment">// 35</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä½œä¸ºæ„é€ å‡½æ•°ï¼Œ<code>Proxy</code>æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ‰€è¦ä»£ç†çš„ç›®æ ‡å¯¹è±¡ï¼ˆä¸Šä¾‹æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼‰ï¼Œå³å¦‚æœæ²¡æœ‰<code>Proxy</code>çš„ä»‹å…¥ï¼Œæ“ä½œåŸæ¥è¦è®¿é—®çš„å°±æ˜¯è¿™ä¸ªå¯¹è±¡ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå¯¹äºæ¯ä¸€ä¸ªè¢«ä»£ç†çš„æ“ä½œï¼Œéœ€è¦æä¾›ä¸€ä¸ªå¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†æ‹¦æˆªå¯¹åº”çš„æ“ä½œã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œé…ç½®å¯¹è±¡æœ‰ä¸€ä¸ª<code>get</code>æ–¹æ³•ï¼Œç”¨æ¥æ‹¦æˆªå¯¹ç›®æ ‡å¯¹è±¡å±æ€§çš„è®¿é—®è¯·æ±‚ã€‚<code>get</code>æ–¹æ³•çš„ä¸¤ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ç›®æ ‡å¯¹è±¡å’Œæ‰€è¦è®¿é—®çš„å±æ€§ã€‚å¯ä»¥çœ‹åˆ°ï¼Œç”±äºæ‹¦æˆªå‡½æ•°æ€»æ˜¯è¿”å›<code>35</code>ï¼Œæ‰€ä»¥è®¿é—®ä»»ä½•å±æ€§éƒ½å¾—åˆ°<code>35</code>ã€‚</p>
<p>æ³¨æ„ï¼Œè¦ä½¿å¾—<code>Proxy</code>èµ·ä½œç”¨ï¼Œå¿…é¡»é’ˆå¯¹<code>Proxy</code>å®ä¾‹ï¼ˆä¸Šä¾‹æ˜¯<code>proxy</code>å¯¹è±¡ï¼‰è¿›è¡Œæ“ä½œï¼Œè€Œä¸æ˜¯é’ˆå¯¹ç›®æ ‡å¯¹è±¡ï¼ˆä¸Šä¾‹æ˜¯ç©ºå¯¹è±¡ï¼‰è¿›è¡Œæ“ä½œã€‚</p>
<p>å¦‚æœ<code>handler</code>æ²¡æœ‰è®¾ç½®ä»»ä½•æ‹¦æˆªï¼Œé‚£å°±ç­‰åŒäºç›´æ¥é€šå‘åŸå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> target = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> handler = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line">proxy.a = <span class="string">'b'</span>;</div><div class="line">target.a <span class="comment">// "b"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>handler</code>æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œæ²¡æœ‰ä»»ä½•æ‹¦æˆªæ•ˆæœï¼Œè®¿é—®<code>handler</code>å°±ç­‰åŒäºè®¿é—®<code>target</code>ã€‚</p>
<p>ä¸€ä¸ªæŠ€å·§æ˜¯å°† Proxy å¯¹è±¡ï¼Œè®¾ç½®åˆ°<code>object.proxy</code>å±æ€§ï¼Œä»è€Œå¯ä»¥åœ¨<code>object</code>å¯¹è±¡ä¸Šè°ƒç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> object = &#123; <span class="attr">proxy</span>: <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler) &#125;;</div></pre></td></tr></table></figure>
<p>Proxy å®ä¾‹ä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–å¯¹è±¡çš„åŸå‹å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, property</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">35</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="built_in">Object</span>.create(proxy);</div><div class="line">obj.time <span class="comment">// 35</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>proxy</code>å¯¹è±¡æ˜¯<code>obj</code>å¯¹è±¡çš„åŸå‹ï¼Œ<code>obj</code>å¯¹è±¡æœ¬èº«å¹¶æ²¡æœ‰<code>time</code>å±æ€§ï¼Œæ‰€ä»¥æ ¹æ®åŸå‹é“¾ï¼Œä¼šåœ¨<code>proxy</code>å¯¹è±¡ä¸Šè¯»å–è¯¥å±æ€§ï¼Œå¯¼è‡´è¢«æ‹¦æˆªã€‚</p>
<p>åŒä¸€ä¸ªæ‹¦æˆªå™¨å‡½æ•°ï¼Œå¯ä»¥è®¾ç½®æ‹¦æˆªå¤šä¸ªæ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, name</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (name === <span class="string">'prototype'</span>) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Object</span>.prototype;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="string">'Hello, '</span> + name;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">apply</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, thisBinding, args</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> args[<span class="number">0</span>];</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">construct</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, args</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;<span class="attr">value</span>: args[<span class="number">1</span>]&#125;;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> fproxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(<span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x + y;</div><div class="line">&#125;, handler);</div><div class="line"></div><div class="line">fproxy(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 1</span></div><div class="line"><span class="keyword">new</span> fproxy(<span class="number">1</span>,<span class="number">2</span>) <span class="comment">// &#123;value: 2&#125;</span></div><div class="line">fproxy.prototype === <span class="built_in">Object</span>.prototype <span class="comment">// true</span></div><div class="line">fproxy.foo <span class="comment">// "Hello, foo"</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ Proxy æ”¯æŒçš„æ‹¦æˆªæ“ä½œä¸€è§ˆã€‚</p>
<p>å¯¹äºå¯ä»¥è®¾ç½®ã€ä½†æ²¡æœ‰è®¾ç½®æ‹¦æˆªçš„æ“ä½œï¼Œåˆ™ç›´æ¥è½åœ¨ç›®æ ‡å¯¹è±¡ä¸Šï¼ŒæŒ‰ç…§åŸå…ˆçš„æ–¹å¼äº§ç”Ÿç»“æœã€‚</p>
<p><strong>ï¼ˆ1ï¼‰get(target, propKey, receiver)</strong></p>
<p>æ‹¦æˆªå¯¹è±¡å±æ€§çš„è¯»å–ï¼Œæ¯”å¦‚<code>proxy.foo</code>å’Œ<code>proxy[&#39;foo&#39;]</code>ã€‚</p>
<p>æœ€åä¸€ä¸ªå‚æ•°<code>receiver</code>æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯é€‰ï¼Œå‚è§ä¸‹é¢<code>Reflect.get</code>çš„éƒ¨åˆ†ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰set(target, propKey, value, receiver)</strong></p>
<p>æ‹¦æˆªå¯¹è±¡å±æ€§çš„è®¾ç½®ï¼Œæ¯”å¦‚<code>proxy.foo = v</code>æˆ–<code>proxy[&#39;foo&#39;] = v</code>ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰has(target, propKey)</strong></p>
<p>æ‹¦æˆª<code>propKey in proxy</code>çš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰deleteProperty(target, propKey)</strong></p>
<p>æ‹¦æˆª<code>delete proxy[propKey]</code>çš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰ownKeys(target)</strong></p>
<p>æ‹¦æˆª<code>Object.getOwnPropertyNames(proxy)</code>ã€<code>Object.getOwnPropertySymbols(proxy)</code>ã€<code>Object.keys(proxy)</code>ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ–¹æ³•è¿”å›ç›®æ ‡å¯¹è±¡æ‰€æœ‰è‡ªèº«çš„å±æ€§çš„å±æ€§åï¼Œè€Œ<code>Object.keys()</code>çš„è¿”å›ç»“æœä»…åŒ…æ‹¬ç›®æ ‡å¯¹è±¡è‡ªèº«çš„å¯éå†å±æ€§ã€‚</p>
<p><strong>ï¼ˆ6ï¼‰getOwnPropertyDescriptor(target, propKey)</strong></p>
<p>æ‹¦æˆª<code>Object.getOwnPropertyDescriptor(proxy, propKey)</code>ï¼Œè¿”å›å±æ€§çš„æè¿°å¯¹è±¡ã€‚</p>
<p><strong>ï¼ˆ7ï¼‰defineProperty(target, propKey, propDesc)</strong></p>
<p>æ‹¦æˆª<code>Object.defineProperty(proxy, propKey, propDescï¼‰</code>ã€<code>Object.defineProperties(proxy, propDescs)</code>ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</p>
<p><strong>ï¼ˆ8ï¼‰preventExtensions(target)</strong></p>
<p>æ‹¦æˆª<code>Object.preventExtensions(proxy)</code>ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</p>
<p><strong>ï¼ˆ9ï¼‰getPrototypeOf(target)</strong></p>
<p>æ‹¦æˆª<code>Object.getPrototypeOf(proxy)</code>ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<p><strong>ï¼ˆ10ï¼‰isExtensible(target)</strong></p>
<p>æ‹¦æˆª<code>Object.isExtensible(proxy)</code>ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</p>
<p><strong>ï¼ˆ11ï¼‰setPrototypeOf(target, proto)</strong></p>
<p>æ‹¦æˆª<code>Object.setPrototypeOf(proxy, proto)</code>ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚</p>
<p>å¦‚æœç›®æ ‡å¯¹è±¡æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸¤ç§é¢å¤–æ“ä½œå¯ä»¥æ‹¦æˆªã€‚</p>
<p><strong>ï¼ˆ12ï¼‰apply(target, object, args)</strong></p>
<p>æ‹¦æˆª Proxy å®ä¾‹ä½œä¸ºå‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œæ¯”å¦‚<code>proxy(...args)</code>ã€<code>proxy.call(object, ...args)</code>ã€<code>proxy.apply(...)</code>ã€‚</p>
<p><strong>ï¼ˆ13ï¼‰construct(target, args)</strong></p>
<p>æ‹¦æˆª Proxy å®ä¾‹ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œæ¯”å¦‚<code>new proxy(...args)</code>ã€‚</p>
<h2 id="Proxy-å®ä¾‹çš„æ–¹æ³•"><a href="#Proxy-å®ä¾‹çš„æ–¹æ³•" class="headerlink" title="Proxy å®ä¾‹çš„æ–¹æ³•"></a>Proxy å®ä¾‹çš„æ–¹æ³•</h2><p>ä¸‹é¢æ˜¯ä¸Šé¢è¿™äº›æ‹¦æˆªæ–¹æ³•çš„è¯¦ç»†ä»‹ç»ã€‚</p>
<h3 id="get"><a href="#get" class="headerlink" title="get()"></a>get()</h3><p><code>get</code>æ–¹æ³•ç”¨äºæ‹¦æˆªæŸä¸ªå±æ€§çš„è¯»å–æ“ä½œã€‚ä¸Šæ–‡å·²ç»æœ‰ä¸€ä¸ªä¾‹å­ï¼Œä¸‹é¢æ˜¯å¦ä¸€ä¸ªæ‹¦æˆªè¯»å–æ“ä½œçš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> person = &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">"å¼ ä¸‰"</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(person, &#123;</div><div class="line">  <span class="attr">get</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, property</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (property <span class="keyword">in</span> target) &#123;</div><div class="line">      <span class="keyword">return</span> target[property];</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">ReferenceError</span>(<span class="string">"Property \""</span> + property + <span class="string">"\" does not exist."</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">proxy.name <span class="comment">// "å¼ ä¸‰"</span></div><div class="line">proxy.age <span class="comment">// æŠ›å‡ºä¸€ä¸ªé”™è¯¯</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœè®¿é—®ç›®æ ‡å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªæ‹¦æˆªå‡½æ•°ï¼Œè®¿é—®ä¸å­˜åœ¨çš„å±æ€§ï¼Œåªä¼šè¿”å›<code>undefined</code>ã€‚</p>
<p><code>get</code>æ–¹æ³•å¯ä»¥ç»§æ‰¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> proto = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  get(target, propertyKey, receiver) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'GET '</span>+propertyKey);</div><div class="line">    <span class="keyword">return</span> target[propertyKey];</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = <span class="built_in">Object</span>.create(proto);</div><div class="line">obj.xxx <span class="comment">// "GET xxx"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ‹¦æˆªæ“ä½œå®šä¹‰åœ¨<code>Prototype</code>å¯¹è±¡ä¸Šé¢ï¼Œæ‰€ä»¥å¦‚æœè¯»å–<code>obj</code>å¯¹è±¡ç»§æ‰¿çš„å±æ€§æ—¶ï¼Œæ‹¦æˆªä¼šç”Ÿæ•ˆã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨<code>get</code>æ‹¦æˆªï¼Œå®ç°æ•°ç»„è¯»å–è´Ÿæ•°çš„ç´¢å¼•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createArray</span>(<span class="params">...elements</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> handler = &#123;</div><div class="line">    get(target, propKey, receiver) &#123;</div><div class="line">      <span class="keyword">let</span> index = <span class="built_in">Number</span>(propKey);</div><div class="line">      <span class="keyword">if</span> (index &lt; <span class="number">0</span>) &#123;</div><div class="line">        propKey = <span class="built_in">String</span>(target.length + index);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, propKey, receiver);</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">let</span> target = [];</div><div class="line">  target.push(...elements);</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> arr = createArray(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>);</div><div class="line">arr[<span class="number">-1</span>] <span class="comment">// c</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„çš„ä½ç½®å‚æ•°æ˜¯<code>-1</code>ï¼Œå°±ä¼šè¾“å‡ºæ•°ç»„çš„å€’æ•°æœ€åä¸€ä¸ªæˆå‘˜ã€‚</p>
<p>åˆ©ç”¨ Proxyï¼Œå¯ä»¥å°†è¯»å–å±æ€§çš„æ“ä½œï¼ˆ<code>get</code>ï¼‰ï¼Œè½¬å˜ä¸ºæ‰§è¡ŒæŸä¸ªå‡½æ•°ï¼Œä»è€Œå®ç°å±æ€§çš„é“¾å¼æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> pipe = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> funcStack = [];</div><div class="line">    <span class="keyword">var</span> oproxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125; , &#123;</div><div class="line">      <span class="attr">get</span> : <span class="function"><span class="keyword">function</span> (<span class="params">pipeObject, fnName</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (fnName === <span class="string">'get'</span>) &#123;</div><div class="line">          <span class="keyword">return</span> funcStack.reduce(<span class="function"><span class="keyword">function</span> (<span class="params">val, fn</span>) </span>&#123;</div><div class="line">            <span class="keyword">return</span> fn(val);</div><div class="line">          &#125;,value);</div><div class="line">        &#125;</div><div class="line">        funcStack.push(<span class="built_in">window</span>[fnName]);</div><div class="line">        <span class="keyword">return</span> oproxy;</div><div class="line">      &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> oproxy;</div><div class="line">  &#125;</div><div class="line">&#125;());</div><div class="line"></div><div class="line"><span class="keyword">var</span> double = <span class="function"><span class="params">n</span> =&gt;</span> n * <span class="number">2</span>;</div><div class="line"><span class="keyword">var</span> pow    = <span class="function"><span class="params">n</span> =&gt;</span> n * n;</div><div class="line"><span class="keyword">var</span> reverseInt = <span class="function"><span class="params">n</span> =&gt;</span> n.toString().split(<span class="string">""</span>).reverse().join(<span class="string">""</span>) | <span class="number">0</span>;</div><div class="line"></div><div class="line">pipe(<span class="number">3</span>).double.pow.reverseInt.get; <span class="comment">// 63</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è®¾ç½® Proxy ä»¥åï¼Œè¾¾åˆ°äº†å°†å‡½æ•°åé“¾å¼ä½¿ç”¨çš„æ•ˆæœã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­åˆ™æ˜¯åˆ©ç”¨<code>get</code>æ‹¦æˆªï¼Œå®ç°ä¸€ä¸ªç”Ÿæˆå„ç§DOMèŠ‚ç‚¹çš„é€šç”¨å‡½æ•°<code>dom</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> dom = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  get(target, property) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">attrs = &#123;&#125;, ...children</span>) </span>&#123;</div><div class="line">      <span class="keyword">const</span> el = <span class="built_in">document</span>.createElement(property);</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> prop <span class="keyword">of</span> <span class="built_in">Object</span>.keys(attrs)) &#123;</div><div class="line">        el.setAttribute(prop, attrs[prop]);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">for</span> (<span class="keyword">let</span> child <span class="keyword">of</span> children) &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> child === <span class="string">'string'</span>) &#123;</div><div class="line">          child = <span class="built_in">document</span>.createTextNode(child);</div><div class="line">        &#125;</div><div class="line">        el.appendChild(child);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">return</span> el;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> el = dom.div(&#123;&#125;,</div><div class="line">  <span class="string">'Hello, my name is '</span>,</div><div class="line">  dom.a(&#123;<span class="attr">href</span>: <span class="string">'//example.com'</span>&#125;, <span class="string">'Mark'</span>),</div><div class="line">  <span class="string">'. I like:'</span>,</div><div class="line">  dom.ul(&#123;&#125;,</div><div class="line">    dom.li(&#123;&#125;, <span class="string">'The web'</span>),</div><div class="line">    dom.li(&#123;&#125;, <span class="string">'Food'</span>),</div><div class="line">    dom.li(&#123;&#125;, <span class="string">'â€¦actually that\'s it'</span>)</div><div class="line">  )</div><div class="line">);</div><div class="line"></div><div class="line"><span class="built_in">document</span>.body.appendChild(el);</div></pre></td></tr></table></figure>
<p>å¦‚æœä¸€ä¸ªå±æ€§ä¸å¯é…ç½®ï¼ˆconfigurableï¼‰å’Œä¸å¯å†™ï¼ˆwritableï¼‰ï¼Œåˆ™è¯¥å±æ€§ä¸èƒ½è¢«ä»£ç†ï¼Œé€šè¿‡ Proxy å¯¹è±¡è®¿é—®è¯¥å±æ€§ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> target = <span class="built_in">Object</span>.defineProperties(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">foo</span>: &#123;</div><div class="line">    <span class="attr">value</span>: <span class="number">123</span>,</div><div class="line">    <span class="attr">writable</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">configurable</span>: <span class="literal">false</span></div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">const</span> handler = &#123;</div><div class="line">  get(target, propKey) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'abc'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"></div><div class="line">proxy.foo</div><div class="line"><span class="comment">// TypeError: Invariant check failed</span></div></pre></td></tr></table></figure>
<h3 id="set"><a href="#set" class="headerlink" title="set()"></a>set()</h3><p><code>set</code>æ–¹æ³•ç”¨æ¥æ‹¦æˆªæŸä¸ªå±æ€§çš„èµ‹å€¼æ“ä½œã€‚</p>
<p>å‡å®š<code>Person</code>å¯¹è±¡æœ‰ä¸€ä¸ª<code>age</code>å±æ€§ï¼Œè¯¥å±æ€§åº”è¯¥æ˜¯ä¸€ä¸ªä¸å¤§äº200çš„æ•´æ•°ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨<code>Proxy</code>ä¿è¯<code>age</code>çš„å±æ€§å€¼ç¬¦åˆè¦æ±‚ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> validator = &#123;</div><div class="line">  <span class="attr">set</span>: <span class="function"><span class="keyword">function</span>(<span class="params">obj, prop, value</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (prop === <span class="string">'age'</span>) &#123;</div><div class="line">      <span class="keyword">if</span> (!<span class="built_in">Number</span>.isInteger(value)) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'The age is not an integer'</span>);</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">if</span> (value &gt; <span class="number">200</span>) &#123;</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RangeError</span>(<span class="string">'The age seems invalid'</span>);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// å¯¹äºageä»¥å¤–çš„å±æ€§ï¼Œç›´æ¥ä¿å­˜</span></div><div class="line">    obj[prop] = value;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> person = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, validator);</div><div class="line"></div><div class="line">person.age = <span class="number">100</span>;</div><div class="line"></div><div class="line">person.age <span class="comment">// 100</span></div><div class="line">person.age = <span class="string">'young'</span> <span class="comment">// æŠ¥é”™</span></div><div class="line">person.age = <span class="number">300</span> <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºè®¾ç½®äº†å­˜å€¼å‡½æ•°<code>set</code>ï¼Œä»»ä½•ä¸ç¬¦åˆè¦æ±‚çš„<code>age</code>å±æ€§èµ‹å€¼ï¼Œéƒ½ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ï¼Œè¿™æ˜¯æ•°æ®éªŒè¯çš„ä¸€ç§å®ç°æ–¹æ³•ã€‚åˆ©ç”¨<code>set</code>æ–¹æ³•ï¼Œè¿˜å¯ä»¥æ•°æ®ç»‘å®šï¼Œå³æ¯å½“å¯¹è±¡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ–° DOMã€‚</p>
<p>æœ‰æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨å¯¹è±¡ä¸Šé¢è®¾ç½®å†…éƒ¨å±æ€§ï¼Œå±æ€§åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ä½¿ç”¨ä¸‹åˆ’çº¿å¼€å¤´ï¼Œè¡¨ç¤ºè¿™äº›å±æ€§ä¸åº”è¯¥è¢«å¤–éƒ¨ä½¿ç”¨ã€‚ç»“åˆ<code>get</code>å’Œ<code>set</code>æ–¹æ³•ï¼Œå°±å¯ä»¥åšåˆ°é˜²æ­¢è¿™äº›å†…éƒ¨å±æ€§è¢«å¤–éƒ¨è¯»å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  get (target, key) &#123;</div><div class="line">    invariant(key, <span class="string">'get'</span>);</div><div class="line">    <span class="keyword">return</span> target[key];</div><div class="line">  &#125;,</div><div class="line">  set (target, key, value) &#123;</div><div class="line">    invariant(key, <span class="string">'set'</span>);</div><div class="line">    target[key] = value;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">invariant</span> (<span class="params">key, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (key[<span class="number">0</span>] === <span class="string">'_'</span>) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`Invalid attempt to <span class="subst">$&#123;action&#125;</span> private "<span class="subst">$&#123;key&#125;</span>" property`</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> target = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line">proxy._prop</div><div class="line"><span class="comment">// Error: Invalid attempt to get private "_prop" property</span></div><div class="line">proxy._prop = <span class="string">'c'</span></div><div class="line"><span class="comment">// Error: Invalid attempt to set private "_prop" property</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦è¯»å†™çš„å±æ€§åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸‹åˆ’çº¿ï¼Œä¸€å¾‹æŠ›é”™ï¼Œä»è€Œè¾¾åˆ°ç¦æ­¢è¯»å†™å†…éƒ¨å±æ€§çš„ç›®çš„ã€‚</p>
<p>æ³¨æ„ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡è‡ªèº«çš„æŸä¸ªå±æ€§ï¼Œä¸å¯å†™ä¹Ÿä¸å¯é…ç½®ï¼Œé‚£ä¹ˆ<code>set</code>ä¸å¾—æ”¹å˜è¿™ä¸ªå±æ€§çš„å€¼ï¼Œåªèƒ½è¿”å›åŒæ ·çš„å€¼ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p>
<h3 id="apply"><a href="#apply" class="headerlink" title="apply()"></a>apply()</h3><p><code>apply</code>æ–¹æ³•æ‹¦æˆªå‡½æ•°çš„è°ƒç”¨ã€<code>call</code>å’Œ<code>apply</code>æ“ä½œã€‚</p>
<p><code>apply</code>æ–¹æ³•å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ç›®æ ‡å¯¹è±¡ã€ç›®æ ‡å¯¹è±¡çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼ˆ<code>this</code>ï¼‰å’Œç›®æ ‡å¯¹è±¡çš„å‚æ•°æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  apply (target, ctx, args) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.apply(...arguments);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> target = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="string">'I am the target'</span>; &#125;;</div><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  <span class="attr">apply</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'I am the proxy'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"></div><div class="line">p()</div><div class="line"><span class="comment">// "I am the proxy"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>p</code>æ˜¯ Proxy çš„å®ä¾‹ï¼Œå½“å®ƒä½œä¸ºå‡½æ•°è°ƒç”¨æ—¶ï¼ˆ<code>p()</code>ï¼‰ï¼Œå°±ä¼šè¢«<code>apply</code>æ–¹æ³•æ‹¦æˆªï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> twice = &#123;</div><div class="line">  apply (target, ctx, args) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.apply(...arguments) * <span class="number">2</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span> (<span class="params">left, right</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> left + right;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(sum, twice);</div><div class="line">proxy(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// 6</span></div><div class="line">proxy.call(<span class="literal">null</span>, <span class="number">5</span>, <span class="number">6</span>) <span class="comment">// 22</span></div><div class="line">proxy.apply(<span class="literal">null</span>, [<span class="number">7</span>, <span class="number">8</span>]) <span class="comment">// 30</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¯å½“æ‰§è¡Œ<code>proxy</code>å‡½æ•°ï¼ˆç›´æ¥è°ƒç”¨æˆ–<code>call</code>å’Œ<code>apply</code>è°ƒç”¨ï¼‰ï¼Œå°±ä¼šè¢«<code>apply</code>æ–¹æ³•æ‹¦æˆªã€‚</p>
<p>å¦å¤–ï¼Œç›´æ¥è°ƒç”¨<code>Reflect.apply</code>æ–¹æ³•ï¼Œä¹Ÿä¼šè¢«æ‹¦æˆªã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Reflect</span>.apply(proxy, <span class="literal">null</span>, [<span class="number">9</span>, <span class="number">10</span>]) <span class="comment">// 38</span></div></pre></td></tr></table></figure>
<h3 id="has"><a href="#has" class="headerlink" title="has()"></a>has()</h3><p><code>has</code>æ–¹æ³•ç”¨æ¥æ‹¦æˆª<code>HasProperty</code>æ“ä½œï¼Œå³åˆ¤æ–­å¯¹è±¡æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šç”Ÿæ•ˆã€‚å…¸å‹çš„æ“ä½œå°±æ˜¯<code>in</code>è¿ç®—ç¬¦ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­ä½¿ç”¨<code>has</code>æ–¹æ³•éšè—æŸäº›å±æ€§ï¼Œä¸è¢«<code>in</code>è¿ç®—ç¬¦å‘ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  has (target, key) &#123;</div><div class="line">    <span class="keyword">if</span> (key[<span class="number">0</span>] === <span class="string">'_'</span>) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> key <span class="keyword">in</span> target;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> target = &#123; <span class="attr">_prop</span>: <span class="string">'foo'</span>, <span class="attr">prop</span>: <span class="string">'foo'</span> &#125;;</div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"><span class="string">'_prop'</span> <span class="keyword">in</span> proxy <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœåŸå¯¹è±¡çš„å±æ€§åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦æ˜¯ä¸‹åˆ’çº¿ï¼Œ<code>proxy.has</code>å°±ä¼šè¿”å›<code>false</code>ï¼Œä»è€Œä¸ä¼šè¢«<code>in</code>è¿ç®—ç¬¦å‘ç°ã€‚</p>
<p>å¦‚æœåŸå¯¹è±¡ä¸å¯é…ç½®æˆ–è€…ç¦æ­¢æ‰©å±•ï¼Œè¿™æ—¶<code>has</code>æ‹¦æˆªä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">a</span>: <span class="number">10</span> &#125;;</div><div class="line"><span class="built_in">Object</span>.preventExtensions(obj);</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</div><div class="line">  <span class="attr">has</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, prop</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="string">'a'</span> <span class="keyword">in</span> p <span class="comment">// TypeError is thrown</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>obj</code>å¯¹è±¡ç¦æ­¢æ‰©å±•ï¼Œç»“æœä½¿ç”¨<code>has</code>æ‹¦æˆªå°±ä¼šæŠ¥é”™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸä¸ªå±æ€§ä¸å¯é…ç½®ï¼ˆæˆ–è€…ç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•ï¼‰ï¼Œåˆ™<code>has</code>æ–¹æ³•å°±ä¸å¾—â€œéšè—â€ï¼ˆå³è¿”å›<code>false</code>ï¼‰ç›®æ ‡å¯¹è±¡çš„è¯¥å±æ€§ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ<code>has</code>æ–¹æ³•æ‹¦æˆªçš„æ˜¯<code>HasProperty</code>æ“ä½œï¼Œè€Œä¸æ˜¯<code>HasOwnProperty</code>æ“ä½œï¼Œå³<code>has</code>æ–¹æ³•ä¸åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿˜æ˜¯ç»§æ‰¿çš„å±æ€§ã€‚</p>
<p>å¦å¤–ï¼Œè™½ç„¶<code>for...in</code>å¾ªç¯ä¹Ÿç”¨åˆ°äº†<code>in</code>è¿ç®—ç¬¦ï¼Œä½†æ˜¯<code>has</code>æ‹¦æˆªå¯¹<code>for...in</code>å¾ªç¯ä¸ç”Ÿæ•ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> stu1 = &#123;<span class="attr">name</span>: <span class="string">'å¼ ä¸‰'</span>, <span class="attr">score</span>: <span class="number">59</span>&#125;;</div><div class="line"><span class="keyword">let</span> stu2 = &#123;<span class="attr">name</span>: <span class="string">'æå››'</span>, <span class="attr">score</span>: <span class="number">99</span>&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> handler = &#123;</div><div class="line">  has(target, prop) &#123;</div><div class="line">    <span class="keyword">if</span> (prop === <span class="string">'score'</span> &amp;&amp; target[prop] &lt; <span class="number">60</span>) &#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;target.name&#125;</span> ä¸åŠæ ¼`</span>);</div><div class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> prop <span class="keyword">in</span> target;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> oproxy1 = <span class="keyword">new</span> <span class="built_in">Proxy</span>(stu1, handler);</div><div class="line"><span class="keyword">let</span> oproxy2 = <span class="keyword">new</span> <span class="built_in">Proxy</span>(stu2, handler);</div><div class="line"></div><div class="line"><span class="string">'score'</span> <span class="keyword">in</span> oproxy1</div><div class="line"><span class="comment">// å¼ ä¸‰ ä¸åŠæ ¼</span></div><div class="line"><span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="string">'score'</span> <span class="keyword">in</span> oproxy2</div><div class="line"><span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> a <span class="keyword">in</span> oproxy1) &#123;</div><div class="line">  <span class="built_in">console</span>.log(oproxy1[a]);</div><div class="line">&#125;</div><div class="line"><span class="comment">// å¼ ä¸‰</span></div><div class="line"><span class="comment">// 59</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> b <span class="keyword">in</span> oproxy2) &#123;</div><div class="line">  <span class="built_in">console</span>.log(oproxy2[b]);</div><div class="line">&#125;</div><div class="line"><span class="comment">// æå››</span></div><div class="line"><span class="comment">// 99</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>has</code>æ‹¦æˆªåªå¯¹<code>in</code>å¾ªç¯ç”Ÿæ•ˆï¼Œå¯¹<code>for...in</code>å¾ªç¯ä¸ç”Ÿæ•ˆï¼Œå¯¼è‡´ä¸ç¬¦åˆè¦æ±‚çš„å±æ€§æ²¡æœ‰è¢«æ’é™¤åœ¨<code>for...in</code>å¾ªç¯ä¹‹å¤–ã€‚</p>
<h3 id="construct"><a href="#construct" class="headerlink" title="construct()"></a>construct()</h3><p><code>construct</code>æ–¹æ³•ç”¨äºæ‹¦æˆª<code>new</code>å‘½ä»¤ï¼Œä¸‹é¢æ˜¯æ‹¦æˆªå¯¹è±¡çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  construct (target, args, newTarget) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> target(...args);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><code>construct</code>æ–¹æ³•å¯ä»¥æ¥å—ä¸¤ä¸ªå‚æ•°ã€‚</p>
<ul>
<li><code>target</code>: ç›®æ ‡å¯¹è±¡</li>
<li><code>args</code>ï¼šæ„å»ºå‡½æ•°çš„å‚æ•°å¯¹è±¡</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;, &#123;</div><div class="line">  <span class="attr">construct</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, args</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'called: '</span> + args.join(<span class="string">', '</span>));</div><div class="line">    <span class="keyword">return</span> &#123; <span class="attr">value</span>: args[<span class="number">0</span>] * <span class="number">10</span> &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">(<span class="keyword">new</span> p(<span class="number">1</span>)).value</div><div class="line"><span class="comment">// "called: 1"</span></div><div class="line"><span class="comment">// 10</span></div></pre></td></tr></table></figure>
<p><code>construct</code>æ–¹æ³•è¿”å›çš„å¿…é¡»æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;, &#123;</div><div class="line">  <span class="attr">construct</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target, argumentsList</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">new</span> p() <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h3 id="deleteProperty"><a href="#deleteProperty" class="headerlink" title="deleteProperty()"></a>deleteProperty()</h3><p><code>deleteProperty</code>æ–¹æ³•ç”¨äºæ‹¦æˆª<code>delete</code>æ“ä½œï¼Œå¦‚æœè¿™ä¸ªæ–¹æ³•æŠ›å‡ºé”™è¯¯æˆ–è€…è¿”å›<code>false</code>ï¼Œå½“å‰å±æ€§å°±æ— æ³•è¢«<code>delete</code>å‘½ä»¤åˆ é™¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  deleteProperty (target, key) &#123;</div><div class="line">    invariant(key, <span class="string">'delete'</span>);</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">invariant</span> (<span class="params">key, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (key[<span class="number">0</span>] === <span class="string">'_'</span>) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">`Invalid attempt to <span class="subst">$&#123;action&#125;</span> private "<span class="subst">$&#123;key&#125;</span>" property`</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> target = &#123; <span class="attr">_prop</span>: <span class="string">'foo'</span> &#125;;</div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"><span class="keyword">delete</span> proxy._prop</div><div class="line"><span class="comment">// Error: Invalid attempt to delete private "_prop" property</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>deleteProperty</code>æ–¹æ³•æ‹¦æˆªäº†<code>delete</code>æ“ä½œç¬¦ï¼Œåˆ é™¤ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä¸‹åˆ’çº¿çš„å±æ€§ä¼šæŠ¥é”™ã€‚</p>
<p>æ³¨æ„ï¼Œç›®æ ‡å¯¹è±¡è‡ªèº«çš„ä¸å¯é…ç½®ï¼ˆconfigurableï¼‰çš„å±æ€§ï¼Œä¸èƒ½è¢«<code>deleteProperty</code>æ–¹æ³•åˆ é™¤ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p>
<h3 id="defineProperty"><a href="#defineProperty" class="headerlink" title="defineProperty()"></a>defineProperty()</h3><p><code>defineProperty</code>æ–¹æ³•æ‹¦æˆªäº†<code>Object.defineProperty</code>æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  defineProperty (target, key, descriptor) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> target = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line">proxy.foo = <span class="string">'bar'</span></div><div class="line"><span class="comment">// TypeError: proxy defineProperty handler returned false for property '"foo"'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>defineProperty</code>æ–¹æ³•è¿”å›<code>false</code>ï¼Œå¯¼è‡´æ·»åŠ æ–°å±æ€§ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p>
<p>æ³¨æ„ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•ï¼ˆextensibleï¼‰ï¼Œåˆ™<code>defineProperty</code>ä¸èƒ½å¢åŠ ç›®æ ‡å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡çš„æŸä¸ªå±æ€§ä¸å¯å†™ï¼ˆwritableï¼‰æˆ–ä¸å¯é…ç½®ï¼ˆconfigurableï¼‰ï¼Œåˆ™<code>defineProperty</code>æ–¹æ³•ä¸å¾—æ”¹å˜è¿™ä¸¤ä¸ªè®¾ç½®ã€‚</p>
<h3 id="getOwnPropertyDescriptor"><a href="#getOwnPropertyDescriptor" class="headerlink" title="getOwnPropertyDescriptor()"></a>getOwnPropertyDescriptor()</h3><p><code>getOwnPropertyDescriptor</code>æ–¹æ³•æ‹¦æˆª<code>Object.getOwnPropertyDescriptor</code>ï¼Œè¿”å›ä¸€ä¸ªå±æ€§æè¿°å¯¹è±¡æˆ–è€…<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  getOwnPropertyDescriptor (target, key) &#123;</div><div class="line">    <span class="keyword">if</span> (key[<span class="number">0</span>] === <span class="string">'_'</span>) &#123;</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.getOwnPropertyDescriptor(target, key);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> target = &#123; <span class="attr">_foo</span>: <span class="string">'bar'</span>, <span class="attr">baz</span>: <span class="string">'tar'</span> &#125;;</div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(proxy, <span class="string">'wat'</span>)</div><div class="line"><span class="comment">// undefined</span></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(proxy, <span class="string">'_foo'</span>)</div><div class="line"><span class="comment">// undefined</span></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(proxy, <span class="string">'baz'</span>)</div><div class="line"><span class="comment">// &#123; value: 'tar', writable: true, enumerable: true, configurable: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>handler.getOwnPropertyDescriptor</code>æ–¹æ³•å¯¹äºç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä¸‹åˆ’çº¿çš„å±æ€§åä¼šè¿”å›<code>undefined</code>ã€‚</p>
<h3 id="getPrototypeOf"><a href="#getPrototypeOf" class="headerlink" title="getPrototypeOf()"></a>getPrototypeOf()</h3><p><code>getPrototypeOf</code>æ–¹æ³•ä¸»è¦ç”¨æ¥æ‹¦æˆª<code>Object.getPrototypeOf()</code>è¿ç®—ç¬¦ï¼Œä»¥åŠå…¶ä»–ä¸€äº›æ“ä½œã€‚</p>
<ul>
<li><code>Object.prototype.__proto__</code></li>
<li><code>Object.prototype.isPrototypeOf()</code></li>
<li><code>Object.getPrototypeOf()</code></li>
<li><code>Reflect.getPrototypeOf()</code></li>
<li><code>instanceof</code>è¿ç®—ç¬¦</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> proto = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  getPrototypeOf(target) &#123;</div><div class="line">    <span class="keyword">return</span> proto;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"><span class="built_in">Object</span>.getPrototypeOf(p) === proto <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>getPrototypeOf</code>æ–¹æ³•æ‹¦æˆª<code>Object.getPrototypeOf()</code>ï¼Œè¿”å›<code>proto</code>å¯¹è±¡ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>getPrototypeOf</code>æ–¹æ³•çš„è¿”å›å€¼å¿…é¡»æ˜¯å¯¹è±¡æˆ–è€…<code>null</code>ï¼Œå¦åˆ™æŠ¥é”™ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•ï¼ˆextensibleï¼‰ï¼Œ <code>getPrototypeOf</code>æ–¹æ³•å¿…é¡»è¿”å›ç›®æ ‡å¯¹è±¡çš„åŸå‹å¯¹è±¡ã€‚</p>
<h3 id="isExtensible"><a href="#isExtensible" class="headerlink" title="isExtensible()"></a>isExtensible()</h3><p><code>isExtensible</code>æ–¹æ³•æ‹¦æˆª<code>Object.isExtensible</code>æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">isExtensible</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"called"</span>);</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.isExtensible(p)</div><div class="line"><span class="comment">// "called"</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è®¾ç½®äº†<code>isExtensible</code>æ–¹æ³•ï¼Œåœ¨è°ƒç”¨<code>Object.isExtensible</code>æ—¶ä¼šè¾“å‡º<code>called</code>ã€‚</p>
<p>æ³¨æ„ï¼Œè¯¥æ–¹æ³•åªèƒ½è¿”å›å¸ƒå°”å€¼ï¼Œå¦åˆ™è¿”å›å€¼ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå¸ƒå°”å€¼ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªå¼ºé™åˆ¶ï¼Œå®ƒçš„è¿”å›å€¼å¿…é¡»ä¸ç›®æ ‡å¯¹è±¡çš„<code>isExtensible</code>å±æ€§ä¿æŒä¸€è‡´ï¼Œå¦åˆ™å°±ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.isExtensible(proxy) === <span class="built_in">Object</span>.isExtensible(target)</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">isExtensible</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.isExtensible(p) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h3 id="ownKeys"><a href="#ownKeys" class="headerlink" title="ownKeys()"></a>ownKeys()</h3><p><code>ownKeys</code>æ–¹æ³•ç”¨æ¥æ‹¦æˆªä»¥ä¸‹æ“ä½œã€‚</p>
<ul>
<li><code>Object.getOwnPropertyNames()</code></li>
<li><code>Object.getOwnPropertySymbols()</code></li>
<li><code>Object.keys()</code></li>
</ul>
<p>ä¸‹é¢æ˜¯æ‹¦æˆª<code>Object.keys()</code>çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> target = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">b</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">c</span>: <span class="number">3</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> handler = &#123;</div><div class="line">  ownKeys(target) &#123;</div><div class="line">    <span class="keyword">return</span> [<span class="string">'a'</span>];</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.keys(proxy)</div><div class="line"><span class="comment">// [ 'a' ]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ‹¦æˆªäº†å¯¹äº<code>target</code>å¯¹è±¡çš„<code>Object.keys()</code>æ“ä½œï¼Œåªè¿”å›<code>a</code>ã€<code>b</code>ã€<code>c</code>ä¸‰ä¸ªå±æ€§ä¹‹ä¸­çš„<code>a</code>å±æ€§ã€‚</p>
<p>ä¸‹é¢çš„ä¾‹å­æ˜¯æ‹¦æˆªç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ºä¸‹åˆ’çº¿çš„å±æ€§åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> target = &#123;</div><div class="line">  <span class="attr">_bar</span>: <span class="string">'foo'</span>,</div><div class="line">  <span class="attr">_prop</span>: <span class="string">'bar'</span>,</div><div class="line">  <span class="attr">prop</span>: <span class="string">'baz'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> handler = &#123;</div><div class="line">  ownKeys (target) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.ownKeys(target).filter(<span class="function"><span class="params">key</span> =&gt;</span> key[<span class="number">0</span>] !== <span class="string">'_'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(proxy)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(target[key]);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "baz"</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œä½¿ç”¨<code>Object.keys</code>æ–¹æ³•æ—¶ï¼Œæœ‰ä¸‰ç±»å±æ€§ä¼šè¢«<code>ownKeys</code>æ–¹æ³•è‡ªåŠ¨è¿‡æ»¤ï¼Œä¸ä¼šè¿”å›ã€‚</p>
<ul>
<li>ç›®æ ‡å¯¹è±¡ä¸Šä¸å­˜åœ¨çš„å±æ€§</li>
<li>å±æ€§åä¸º Symbol å€¼</li>
<li>ä¸å¯éå†ï¼ˆ<code>enumerable</code>ï¼‰çš„å±æ€§</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> target = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">  <span class="attr">b</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">c</span>: <span class="number">3</span>,</div><div class="line">  [<span class="built_in">Symbol</span>.for(<span class="string">'secret'</span>)]: <span class="string">'4'</span>,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.defineProperty(target, <span class="string">'key'</span>, &#123;</div><div class="line">  <span class="attr">enumerable</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">configurable</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">writable</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">value</span>: <span class="string">'static'</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">let</span> handler = &#123;</div><div class="line">  ownKeys(target) &#123;</div><div class="line">    <span class="keyword">return</span> [<span class="string">'a'</span>, <span class="string">'d'</span>, <span class="built_in">Symbol</span>.for(<span class="string">'secret'</span>), <span class="string">'key'</span>];</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.keys(proxy)</div><div class="line"><span class="comment">// ['a']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>ownKeys</code>æ–¹æ³•ä¹‹ä¸­ï¼Œæ˜¾å¼è¿”å›ä¸å­˜åœ¨çš„å±æ€§ï¼ˆ<code>d</code>ï¼‰ã€Symbol å€¼ï¼ˆ<code>Symbol.for(&#39;secret&#39;)</code>ï¼‰ã€ä¸å¯éå†çš„å±æ€§ï¼ˆ<code>key</code>ï¼‰ï¼Œç»“æœéƒ½è¢«è‡ªåŠ¨è¿‡æ»¤æ‰ã€‚</p>
<p><code>ownKeys</code>æ–¹æ³•è¿˜å¯ä»¥æ‹¦æˆª<code>Object.getOwnPropertyNames()</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">ownKeys</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(p)</div><div class="line"><span class="comment">// [ 'a', 'b', 'c' ]</span></div></pre></td></tr></table></figure>
<p><code>ownKeys</code>æ–¹æ³•è¿”å›çš„æ•°ç»„æˆå‘˜ï¼Œåªèƒ½æ˜¯å­—ç¬¦ä¸²æˆ– Symbol å€¼ã€‚å¦‚æœæœ‰å…¶ä»–ç±»å‹çš„å€¼ï¼Œæˆ–è€…è¿”å›çš„æ ¹æœ¬ä¸æ˜¯æ•°ç»„ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</div><div class="line">  <span class="attr">ownKeys</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> [<span class="number">123</span>, <span class="literal">true</span>, <span class="literal">undefined</span>, <span class="literal">null</span>, &#123;&#125;, []];</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(p)</div><div class="line"><span class="comment">// Uncaught TypeError: 123 is not a valid property name</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>ownKeys</code>æ–¹æ³•è™½ç„¶è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œä½†æ˜¯æ¯ä¸€ä¸ªæ•°ç»„æˆå‘˜éƒ½ä¸æ˜¯å­—ç¬¦ä¸²æˆ– Symbol å€¼ï¼Œå› æ­¤å°±æŠ¥é”™äº†ã€‚</p>
<p>å¦‚æœç›®æ ‡å¯¹è±¡è‡ªèº«åŒ…å«ä¸å¯é…ç½®çš„å±æ€§ï¼Œåˆ™è¯¥å±æ€§å¿…é¡»è¢«<code>ownKeys</code>æ–¹æ³•è¿”å›ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'a'</span>, &#123;</div><div class="line">  <span class="attr">configurable</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">enumerable</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">value</span>: <span class="number">10</span> &#125;</div><div class="line">);</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</div><div class="line">  <span class="attr">ownKeys</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> [<span class="string">'b'</span>];</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(p)</div><div class="line"><span class="comment">// Uncaught TypeError: 'ownKeys' on proxy: trap result did not include 'a'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>obj</code>å¯¹è±¡çš„<code>a</code>å±æ€§æ˜¯ä¸å¯é…ç½®çš„ï¼Œè¿™æ—¶<code>ownKeys</code>æ–¹æ³•è¿”å›çš„æ•°ç»„ä¹‹ä¸­ï¼Œå¿…é¡»åŒ…å«<code>a</code>ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<p>å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡æ˜¯ä¸å¯æ‰©å±•çš„ï¼ˆnon-extensitionï¼‰ï¼Œè¿™æ—¶<code>ownKeys</code>æ–¹æ³•è¿”å›çš„æ•°ç»„ä¹‹ä¸­ï¼Œå¿…é¡»åŒ…å«åŸå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œä¸”ä¸èƒ½åŒ…å«å¤šä½™çš„å±æ€§ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">1</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.preventExtensions(obj);</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</div><div class="line">  <span class="attr">ownKeys</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> [<span class="string">'a'</span>, <span class="string">'b'</span>];</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(p)</div><div class="line"><span class="comment">// Uncaught TypeError: 'ownKeys' on proxy: trap returned extra keys but proxy target is non-extensible</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Obj</code>å¯¹è±¡æ˜¯ä¸å¯æ‰©å±•çš„ï¼Œè¿™æ—¶<code>ownKeys</code>æ–¹æ³•è¿”å›çš„æ•°ç»„ä¹‹ä¸­ï¼ŒåŒ…å«äº†<code>obj</code>å¯¹è±¡çš„å¤šä½™å±æ€§<code>b</code>ï¼Œæ‰€ä»¥å¯¼è‡´äº†æŠ¥é”™ã€‚</p>
<h3 id="preventExtensions"><a href="#preventExtensions" class="headerlink" title="preventExtensions()"></a>preventExtensions()</h3><p><code>preventExtensions</code>æ–¹æ³•æ‹¦æˆª<code>Object.preventExtensions()</code>ã€‚è¯¥æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå¦åˆ™ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå¸ƒå°”å€¼ã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œåªæœ‰ç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•æ—¶ï¼ˆå³<code>Object.isExtensible(proxy)</code>ä¸º<code>false</code>ï¼‰ï¼Œ<code>proxy.preventExtensions</code>æ‰èƒ½è¿”å›<code>true</code>ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">preventExtensions</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.preventExtensions(p) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>proxy.preventExtensions</code>æ–¹æ³•è¿”å›<code>true</code>ï¼Œä½†è¿™æ—¶<code>Object.isExtensible(proxy)</code>ä¼šè¿”å›<code>true</code>ï¼Œå› æ­¤æŠ¥é”™ã€‚</p>
<p>ä¸ºäº†é˜²æ­¢å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œé€šå¸¸è¦åœ¨<code>proxy.preventExtensions</code>æ–¹æ³•é‡Œé¢ï¼Œè°ƒç”¨ä¸€æ¬¡<code>Object.preventExtensions</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">  <span class="attr">preventExtensions</span>: <span class="function"><span class="keyword">function</span>(<span class="params">target</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'called'</span>);</div><div class="line">    <span class="built_in">Object</span>.preventExtensions(target);</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.preventExtensions(p)</div><div class="line"><span class="comment">// "called"</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<h3 id="setPrototypeOf"><a href="#setPrototypeOf" class="headerlink" title="setPrototypeOf()"></a>setPrototypeOf()</h3><p><code>setPrototypeOf</code>æ–¹æ³•ä¸»è¦ç”¨æ¥æ‹¦æˆª<code>Object.setPrototypeOf</code>æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  setPrototypeOf (target, proto) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Changing the prototype is forbidden'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> proto = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> target = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"><span class="keyword">var</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line">proxy.setPrototypeOf(proxy, proto);</div><div class="line"><span class="comment">// Error: Changing the prototype is forbidden</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªè¦ä¿®æ”¹<code>target</code>çš„åŸå‹å¯¹è±¡ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p>æ³¨æ„ï¼Œè¯¥æ–¹æ³•åªèƒ½è¿”å›å¸ƒå°”å€¼ï¼Œå¦åˆ™ä¼šè¢«è‡ªåŠ¨è½¬ä¸ºå¸ƒå°”å€¼ã€‚å¦å¤–ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸å¯æ‰©å±•ï¼ˆextensibleï¼‰ï¼Œ<code>setPrototypeOf</code>æ–¹æ³•ä¸å¾—æ”¹å˜ç›®æ ‡å¯¹è±¡çš„åŸå‹ã€‚</p>
<h2 id="Proxy-revocable"><a href="#Proxy-revocable" class="headerlink" title="Proxy.revocable()"></a>Proxy.revocable()</h2><p><code>Proxy.revocable</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¯å–æ¶ˆçš„ Proxy å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> target = &#123;&#125;;</div><div class="line"><span class="keyword">let</span> handler = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> &#123;proxy, revoke&#125; = <span class="built_in">Proxy</span>.revocable(target, handler);</div><div class="line"></div><div class="line">proxy.foo = <span class="number">123</span>;</div><div class="line">proxy.foo <span class="comment">// 123</span></div><div class="line"></div><div class="line">revoke();</div><div class="line">proxy.foo <span class="comment">// TypeError: Revoked</span></div></pre></td></tr></table></figure>
<p><code>Proxy.revocable</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„<code>proxy</code>å±æ€§æ˜¯<code>Proxy</code>å®ä¾‹ï¼Œ<code>revoke</code>å±æ€§æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥å–æ¶ˆ<code>Proxy</code>å®ä¾‹ã€‚ä¸Šé¢ä»£ç ä¸­ï¼Œå½“æ‰§è¡Œ<code>revoke</code>å‡½æ•°ä¹‹åï¼Œå†è®¿é—®<code>Proxy</code>å®ä¾‹ï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<p><code>Proxy.revocable</code>çš„ä¸€ä¸ªä½¿ç”¨åœºæ™¯æ˜¯ï¼Œç›®æ ‡å¯¹è±¡ä¸å…è®¸ç›´æ¥è®¿é—®ï¼Œå¿…é¡»é€šè¿‡ä»£ç†è®¿é—®ï¼Œä¸€æ—¦è®¿é—®ç»“æŸï¼Œå°±æ”¶å›ä»£ç†æƒï¼Œä¸å…è®¸å†æ¬¡è®¿é—®ã€‚</p>
<h2 id="this-é—®é¢˜"><a href="#this-é—®é¢˜" class="headerlink" title="this é—®é¢˜"></a>this é—®é¢˜</h2><p>è™½ç„¶ Proxy å¯ä»¥ä»£ç†é’ˆå¯¹ç›®æ ‡å¯¹è±¡çš„è®¿é—®ï¼Œä½†å®ƒä¸æ˜¯ç›®æ ‡å¯¹è±¡çš„é€æ˜ä»£ç†ï¼Œå³ä¸åšä»»ä½•æ‹¦æˆªçš„æƒ…å†µä¸‹ï¼Œä¹Ÿæ— æ³•ä¿è¯ä¸ç›®æ ‡å¯¹è±¡çš„è¡Œä¸ºä¸€è‡´ã€‚ä¸»è¦åŸå› å°±æ˜¯åœ¨ Proxy ä»£ç†çš„æƒ…å†µä¸‹ï¼Œç›®æ ‡å¯¹è±¡å†…éƒ¨çš„<code>this</code>å…³é”®å­—ä¼šæŒ‡å‘ Proxy ä»£ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> target = &#123;</div><div class="line">  <span class="attr">m</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span> === proxy);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> handler = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"></div><div class="line">target.m() <span class="comment">// false</span></div><div class="line">proxy.m()  <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸€æ—¦<code>proxy</code>ä»£ç†<code>target.m</code>ï¼Œåè€…å†…éƒ¨çš„<code>this</code>å°±æ˜¯æŒ‡å‘<code>proxy</code>ï¼Œè€Œä¸æ˜¯<code>target</code>ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼Œç”±äº<code>this</code>æŒ‡å‘çš„å˜åŒ–ï¼Œå¯¼è‡´ Proxy æ— æ³•ä»£ç†ç›®æ ‡å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> _name = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(name) &#123;</div><div class="line">    _name.set(<span class="keyword">this</span>, name);</div><div class="line">  &#125;</div><div class="line">  get name() &#123;</div><div class="line">    <span class="keyword">return</span> _name.get(<span class="keyword">this</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> jane = <span class="keyword">new</span> Person(<span class="string">'Jane'</span>);</div><div class="line">jane.name <span class="comment">// 'Jane'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(jane, &#123;&#125;);</div><div class="line">proxy.name <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç›®æ ‡å¯¹è±¡<code>jane</code>çš„<code>name</code>å±æ€§ï¼Œå®é™…ä¿å­˜åœ¨å¤–éƒ¨<code>WeakMap</code>å¯¹è±¡<code>_name</code>ä¸Šé¢ï¼Œé€šè¿‡<code>this</code>é”®åŒºåˆ†ã€‚ç”±äºé€šè¿‡<code>proxy.name</code>è®¿é—®æ—¶ï¼Œ<code>this</code>æŒ‡å‘<code>proxy</code>ï¼Œå¯¼è‡´æ— æ³•å–åˆ°å€¼ï¼Œæ‰€ä»¥è¿”å›<code>undefined</code>ã€‚</p>
<p>æ­¤å¤–ï¼Œæœ‰äº›åŸç”Ÿå¯¹è±¡çš„å†…éƒ¨å±æ€§ï¼Œåªæœ‰é€šè¿‡æ­£ç¡®çš„<code>this</code>æ‰èƒ½æ‹¿åˆ°ï¼Œæ‰€ä»¥ Proxy ä¹Ÿæ— æ³•ä»£ç†è¿™äº›åŸç”Ÿå¯¹è±¡çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> target = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"><span class="keyword">const</span> handler = &#123;&#125;;</div><div class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"></div><div class="line">proxy.getDate();</div><div class="line"><span class="comment">// TypeError: this is not a Date object.</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>getDate</code>æ–¹æ³•åªèƒ½åœ¨<code>Date</code>å¯¹è±¡å®ä¾‹ä¸Šé¢æ‹¿åˆ°ï¼Œå¦‚æœ<code>this</code>ä¸æ˜¯<code>Date</code>å¯¹è±¡å®ä¾‹å°±ä¼šæŠ¥é”™ã€‚è¿™æ—¶ï¼Œ<code>this</code>ç»‘å®šåŸå§‹å¯¹è±¡ï¼Œå°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> target = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">'2015-01-01'</span>);</div><div class="line"><span class="keyword">const</span> handler = &#123;</div><div class="line">  get(target, prop) &#123;</div><div class="line">    <span class="keyword">if</span> (prop === <span class="string">'getDate'</span>) &#123;</div><div class="line">      <span class="keyword">return</span> target.getDate.bind(target);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, prop);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> proxy = <span class="keyword">new</span> <span class="built_in">Proxy</span>(target, handler);</div><div class="line"></div><div class="line">proxy.getDate() <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<h2 id="å®ä¾‹ï¼šWeb-æœåŠ¡çš„å®¢æˆ·ç«¯"><a href="#å®ä¾‹ï¼šWeb-æœåŠ¡çš„å®¢æˆ·ç«¯" class="headerlink" title="å®ä¾‹ï¼šWeb æœåŠ¡çš„å®¢æˆ·ç«¯"></a>å®ä¾‹ï¼šWeb æœåŠ¡çš„å®¢æˆ·ç«¯</h2><p>Proxy å¯¹è±¡å¯ä»¥æ‹¦æˆªç›®æ ‡å¯¹è±¡çš„ä»»æ„å±æ€§ï¼Œè¿™ä½¿å¾—å®ƒå¾ˆåˆé€‚ç”¨æ¥å†™ Web æœåŠ¡çš„å®¢æˆ·ç«¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> service = createWebService(<span class="string">'http://example.com/data'</span>);</div><div class="line"></div><div class="line">service.employees().then(<span class="function"><span class="params">json</span> =&gt;</span> &#123;</div><div class="line">  <span class="keyword">const</span> employees = <span class="built_in">JSON</span>.parse(json);</div><div class="line">  <span class="comment">// Â·Â·Â·</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ–°å»ºäº†ä¸€ä¸ª Web æœåŠ¡çš„æ¥å£ï¼Œè¿™ä¸ªæ¥å£è¿”å›å„ç§æ•°æ®ã€‚Proxy å¯ä»¥æ‹¦æˆªè¿™ä¸ªå¯¹è±¡çš„ä»»æ„å±æ€§ï¼Œæ‰€ä»¥ä¸ç”¨ä¸ºæ¯ä¸€ç§æ•°æ®å†™ä¸€ä¸ªé€‚é…æ–¹æ³•ï¼Œåªè¦å†™ä¸€ä¸ª Proxy æ‹¦æˆªå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">createWebService</span>(<span class="params">baseUrl</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Proxy</span>(&#123;&#125;, &#123;</div><div class="line">    get(target, propKey, receiver) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> httpGet(baseUrl+<span class="string">'/'</span> + propKey);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>åŒç†ï¼ŒProxy ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°æ•°æ®åº“çš„ ORM å±‚ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Proxy&quot;&gt;&lt;a href=&quot;#Proxy&quot; class=&quot;headerlink&quot; title=&quot;Proxy&quot;&gt;&lt;/a&gt;Proxy&lt;/h1&gt;&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;/a&gt;æ¦‚
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Proxy" scheme="http://microzz.com/tags/Proxy/"/>
    
  </entry>
  
  <entry>
    <title>Setå’ŒMapæ•°æ®ç»“æ„</title>
    <link href="http://microzz.com/2017/01/05/set-map/"/>
    <id>http://microzz.com/2017/01/05/set-map/</id>
    <published>2017-01-05T03:40:19.000Z</published>
    <updated>2017-01-12T08:16:10.816Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Setå’ŒMapæ•°æ®ç»“æ„"><a href="#Setå’ŒMapæ•°æ®ç»“æ„" class="headerlink" title="Setå’ŒMapæ•°æ®ç»“æ„"></a>Setå’ŒMapæ•°æ®ç»“æ„</h1><h2 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>ES6æä¾›äº†æ–°çš„æ•°æ®ç»“æ„Setã€‚å®ƒç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯æˆå‘˜çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤çš„å€¼ã€‚</p>
<p>Setæœ¬èº«æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œç”¨æ¥ç”ŸæˆSetæ•°æ®ç»“æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> <span class="built_in">Set</span>();</div><div class="line"></div><div class="line">[<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>].map(<span class="function"><span class="params">x</span> =&gt;</span> s.add(x));</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> s) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 2 3 5 4</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç é€šè¿‡<code>add</code>æ–¹æ³•å‘Setç»“æ„åŠ å…¥æˆå‘˜ï¼Œç»“æœè¡¨æ˜Setç»“æ„ä¸ä¼šæ·»åŠ é‡å¤çš„å€¼ã€‚</p>
<p>Setå‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ï¼ˆæˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼‰ä½œä¸ºå‚æ•°ï¼Œç”¨æ¥åˆå§‹åŒ–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¾‹ä¸€</span></div><div class="line"><span class="keyword">var</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>]);</div><div class="line">[...set]</div><div class="line"><span class="comment">// [1, 2, 3, 4]</span></div><div class="line"></div><div class="line"><span class="comment">// ä¾‹äºŒ</span></div><div class="line"><span class="keyword">var</span> items = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">5</span>]);</div><div class="line">items.size <span class="comment">// 5</span></div><div class="line"></div><div class="line"><span class="comment">// ä¾‹ä¸‰</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">divs</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [...document.querySelectorAll(<span class="string">'div'</span>)];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>(divs());</div><div class="line">set.size <span class="comment">// 56</span></div><div class="line"></div><div class="line"><span class="comment">// ç±»ä¼¼äº</span></div><div class="line">divs().forEach(<span class="function"><span class="params">div</span> =&gt;</span> set.add(div));</div><div class="line">set.size <span class="comment">// 56</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¾‹ä¸€å’Œä¾‹äºŒéƒ½æ˜¯<code>Set</code>å‡½æ•°æ¥å—æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œä¾‹ä¸‰æ˜¯æ¥å—ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚</p>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¹Ÿå±•ç¤ºäº†ä¸€ç§å»é™¤æ•°ç»„é‡å¤æˆå‘˜çš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å»é™¤æ•°ç»„çš„é‡å¤æˆå‘˜</span></div><div class="line">[...new <span class="built_in">Set</span>(array)]</div></pre></td></tr></table></figure>
<p>å‘SetåŠ å…¥å€¼çš„æ—¶å€™ï¼Œä¸ä¼šå‘ç”Ÿç±»å‹è½¬æ¢ï¼Œæ‰€ä»¥<code>5</code>å’Œ<code>&quot;5&quot;</code>æ˜¯ä¸¤ä¸ªä¸åŒçš„å€¼ã€‚Setå†…éƒ¨åˆ¤æ–­ä¸¤ä¸ªå€¼æ˜¯å¦ä¸åŒï¼Œä½¿ç”¨çš„ç®—æ³•å«åšâ€œSame-value equalityâ€ï¼Œå®ƒç±»ä¼¼äºç²¾ç¡®ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ<code>===</code>ï¼‰ï¼Œä¸»è¦çš„åŒºåˆ«æ˜¯<code>NaN</code>ç­‰äºè‡ªèº«ï¼Œè€Œç²¾ç¡®ç›¸ç­‰è¿ç®—ç¬¦è®¤ä¸º<code>NaN</code>ä¸ç­‰äºè‡ªèº«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>();</div><div class="line"><span class="keyword">let</span> a = <span class="literal">NaN</span>;</div><div class="line"><span class="keyword">let</span> b = <span class="literal">NaN</span>;</div><div class="line">set.add(a);</div><div class="line">set.add(b);</div><div class="line">set <span class="comment">// Set &#123;NaN&#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å‘Setå®ä¾‹æ·»åŠ äº†ä¸¤ä¸ª<code>NaN</code>ï¼Œä½†æ˜¯åªèƒ½åŠ å…¥ä¸€ä¸ªã€‚è¿™è¡¨æ˜ï¼Œåœ¨Setå†…éƒ¨ï¼Œä¸¤ä¸ª<code>NaN</code>æ˜¯ç›¸ç­‰ã€‚</p>
<p>å¦å¤–ï¼Œä¸¤ä¸ªå¯¹è±¡æ€»æ˜¯ä¸ç›¸ç­‰çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>();</div><div class="line"></div><div class="line">set.add(&#123;&#125;);</div><div class="line">set.size <span class="comment">// 1</span></div><div class="line"></div><div class="line">set.add(&#123;&#125;);</div><div class="line">set.size <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œç”±äºä¸¤ä¸ªç©ºå¯¹è±¡ä¸ç›¸ç­‰ï¼Œæ‰€ä»¥å®ƒä»¬è¢«è§†ä¸ºä¸¤ä¸ªå€¼ã€‚</p>
<h3 id="Setå®ä¾‹çš„å±æ€§å’Œæ–¹æ³•"><a href="#Setå®ä¾‹çš„å±æ€§å’Œæ–¹æ³•" class="headerlink" title="Setå®ä¾‹çš„å±æ€§å’Œæ–¹æ³•"></a>Setå®ä¾‹çš„å±æ€§å’Œæ–¹æ³•</h3><p>Setç»“æ„çš„å®ä¾‹æœ‰ä»¥ä¸‹å±æ€§ã€‚</p>
<ul>
<li><code>Set.prototype.constructor</code>ï¼šæ„é€ å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯<code>Set</code>å‡½æ•°ã€‚</li>
<li><code>Set.prototype.size</code>ï¼šè¿”å›<code>Set</code>å®ä¾‹çš„æˆå‘˜æ€»æ•°ã€‚</li>
</ul>
<p>Setå®ä¾‹çš„æ–¹æ³•åˆ†ä¸ºä¸¤å¤§ç±»ï¼šæ“ä½œæ–¹æ³•ï¼ˆç”¨äºæ“ä½œæ•°æ®ï¼‰å’Œéå†æ–¹æ³•ï¼ˆç”¨äºéå†æˆå‘˜ï¼‰ã€‚ä¸‹é¢å…ˆä»‹ç»å››ä¸ªæ“ä½œæ–¹æ³•ã€‚</p>
<ul>
<li><code>add(value)</code>ï¼šæ·»åŠ æŸä¸ªå€¼ï¼Œè¿”å›Setç»“æ„æœ¬èº«ã€‚</li>
<li><code>delete(value)</code>ï¼šåˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºåˆ é™¤æ˜¯å¦æˆåŠŸã€‚</li>
<li><code>has(value)</code>ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å€¼æ˜¯å¦ä¸º<code>Set</code>çš„æˆå‘˜ã€‚</li>
<li><code>clear()</code>ï¼šæ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</li>
</ul>
<p>ä¸Šé¢è¿™äº›å±æ€§å’Œæ–¹æ³•çš„å®ä¾‹å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">s.add(<span class="number">1</span>).add(<span class="number">2</span>).add(<span class="number">2</span>);</div><div class="line"><span class="comment">// æ³¨æ„2è¢«åŠ å…¥äº†ä¸¤æ¬¡</span></div><div class="line"></div><div class="line">s.size <span class="comment">// 2</span></div><div class="line"></div><div class="line">s.has(<span class="number">1</span>) <span class="comment">// true</span></div><div class="line">s.has(<span class="number">2</span>) <span class="comment">// true</span></div><div class="line">s.has(<span class="number">3</span>) <span class="comment">// false</span></div><div class="line"></div><div class="line">s.delete(<span class="number">2</span>);</div><div class="line">s.has(<span class="number">2</span>) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå¯¹æ¯”ï¼Œçœ‹çœ‹åœ¨åˆ¤æ–­æ˜¯å¦åŒ…æ‹¬ä¸€ä¸ªé”®ä¸Šé¢ï¼Œ<code>Object</code>ç»“æ„å’Œ<code>Set</code>ç»“æ„çš„å†™æ³•ä¸åŒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¯¹è±¡çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> properties = &#123;</div><div class="line">  <span class="string">'width'</span>: <span class="number">1</span>,</div><div class="line">  <span class="string">'height'</span>: <span class="number">1</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (properties[someName]) &#123;</div><div class="line">  <span class="comment">// do something</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Setçš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> properties = <span class="keyword">new</span> <span class="built_in">Set</span>();</div><div class="line"></div><div class="line">properties.add(<span class="string">'width'</span>);</div><div class="line">properties.add(<span class="string">'height'</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (properties.has(someName)) &#123;</div><div class="line">  <span class="comment">// do something</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>Array.from</code>æ–¹æ³•å¯ä»¥å°†Setç»“æ„è½¬ä¸ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> items = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]);</div><div class="line"><span class="keyword">var</span> array = <span class="built_in">Array</span>.from(items);</div></pre></td></tr></table></figure>
<p>è¿™å°±æä¾›äº†å»é™¤æ•°ç»„é‡å¤æˆå‘˜çš„å¦ä¸€ç§æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">dedupe</span>(<span class="params">array</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(array));</div><div class="line">&#125;</div><div class="line"></div><div class="line">dedupe([<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]) <span class="comment">// [1, 2, 3]</span></div></pre></td></tr></table></figure>
<h3 id="éå†æ“ä½œ"><a href="#éå†æ“ä½œ" class="headerlink" title="éå†æ“ä½œ"></a>éå†æ“ä½œ</h3><p>Setç»“æ„çš„å®ä¾‹æœ‰å››ä¸ªéå†æ–¹æ³•ï¼Œå¯ä»¥ç”¨äºéå†æˆå‘˜ã€‚</p>
<ul>
<li><code>keys()</code>ï¼šè¿”å›é”®åçš„éå†å™¨</li>
<li><code>values()</code>ï¼šè¿”å›é”®å€¼çš„éå†å™¨</li>
<li><code>entries()</code>ï¼šè¿”å›é”®å€¼å¯¹çš„éå†å™¨</li>
<li><code>forEach()</code>ï¼šä½¿ç”¨å›è°ƒå‡½æ•°éå†æ¯ä¸ªæˆå‘˜</li>
</ul>
<p>éœ€è¦ç‰¹åˆ«æŒ‡å‡ºçš„æ˜¯ï¼Œ<code>Set</code>çš„éå†é¡ºåºå°±æ˜¯æ’å…¥é¡ºåºã€‚è¿™ä¸ªç‰¹æ€§æœ‰æ—¶éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚ä½¿ç”¨Setä¿å­˜ä¸€ä¸ªå›è°ƒå‡½æ•°åˆ—è¡¨ï¼Œè°ƒç”¨æ—¶å°±èƒ½ä¿è¯æŒ‰ç…§æ·»åŠ é¡ºåºè°ƒç”¨ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰<code>keys()</code>ï¼Œ<code>values()</code>ï¼Œ<code>entries()</code></strong></p>
<p><code>keys</code>æ–¹æ³•ã€<code>values</code>æ–¹æ³•ã€<code>entries</code>æ–¹æ³•è¿”å›çš„éƒ½æ˜¯éå†å™¨å¯¹è±¡ï¼ˆè¯¦è§ã€ŠIterator å¯¹è±¡ã€‹ä¸€ç« ï¼‰ã€‚ç”±äº Set ç»“æ„æ²¡æœ‰é”®åï¼Œåªæœ‰é”®å€¼ï¼ˆæˆ–è€…è¯´é”®åå’Œé”®å€¼æ˜¯åŒä¸€ä¸ªå€¼ï¼‰ï¼Œæ‰€ä»¥<code>keys</code>æ–¹æ³•å’Œ<code>values</code>æ–¹æ³•çš„è¡Œä¸ºå®Œå…¨ä¸€è‡´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.keys()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(item);</div><div class="line">&#125;</div><div class="line"><span class="comment">// red</span></div><div class="line"><span class="comment">// green</span></div><div class="line"><span class="comment">// blue</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.values()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(item);</div><div class="line">&#125;</div><div class="line"><span class="comment">// red</span></div><div class="line"><span class="comment">// green</span></div><div class="line"><span class="comment">// blue</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> set.entries()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(item);</div><div class="line">&#125;</div><div class="line"><span class="comment">// ["red", "red"]</span></div><div class="line"><span class="comment">// ["green", "green"]</span></div><div class="line"><span class="comment">// ["blue", "blue"]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>entries</code>æ–¹æ³•è¿”å›çš„éå†å™¨ï¼ŒåŒæ—¶åŒ…æ‹¬é”®åå’Œé”®å€¼ï¼Œæ‰€ä»¥æ¯æ¬¡è¾“å‡ºä¸€ä¸ªæ•°ç»„ï¼Œå®ƒçš„ä¸¤ä¸ªæˆå‘˜å®Œå…¨ç›¸ç­‰ã€‚</p>
<p>Setç»“æ„çš„å®ä¾‹é»˜è®¤å¯éå†ï¼Œå®ƒçš„é»˜è®¤éå†å™¨ç”Ÿæˆå‡½æ•°å°±æ˜¯å®ƒçš„<code>values</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Set</span>.prototype[<span class="built_in">Symbol</span>.iterator] === <span class="built_in">Set</span>.prototype.values</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™æ„å‘³ç€ï¼Œå¯ä»¥çœç•¥<code>values</code>æ–¹æ³•ï¼Œç›´æ¥ç”¨<code>for...of</code>å¾ªç¯éå†Setã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> set) &#123;</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div><div class="line"><span class="comment">// red</span></div><div class="line"><span class="comment">// green</span></div><div class="line"><span class="comment">// blue</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰<code>forEach()</code></strong></p>
<p>Setç»“æ„çš„å®ä¾‹çš„<code>forEach</code>æ–¹æ³•ï¼Œç”¨äºå¯¹æ¯ä¸ªæˆå‘˜æ‰§è¡ŒæŸç§æ“ä½œï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line">set.forEach(<span class="function">(<span class="params">value, key</span>) =&gt;</span> <span class="built_in">console</span>.log(value * <span class="number">2</span>) )</div><div class="line"><span class="comment">// 2</span></div><div class="line"><span class="comment">// 4</span></div><div class="line"><span class="comment">// 6</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼Œ<code>forEach</code>æ–¹æ³•çš„å‚æ•°å°±æ˜¯ä¸€ä¸ªå¤„ç†å‡½æ•°ã€‚è¯¥å‡½æ•°çš„å‚æ•°ä¾æ¬¡ä¸ºé”®å€¼ã€é”®åã€é›†åˆæœ¬èº«ï¼ˆä¸Šä¾‹çœç•¥äº†è¯¥å‚æ•°ï¼‰ã€‚å¦å¤–ï¼Œ<code>forEach</code>æ–¹æ³•è¿˜å¯ä»¥æœ‰ç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºç»‘å®šçš„thiså¯¹è±¡ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰éå†çš„åº”ç”¨</strong></p>
<p>æ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰å†…éƒ¨ä½¿ç”¨<code>for...of</code>å¾ªç¯ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç”¨äºSetç»“æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'red'</span>, <span class="string">'green'</span>, <span class="string">'blue'</span>]);</div><div class="line"><span class="keyword">let</span> arr = [...set];</div><div class="line"><span class="comment">// ['red', 'green', 'blue']</span></div></pre></td></tr></table></figure>
<p>æ‰©å±•è¿ç®—ç¬¦å’ŒSetç»“æ„ç›¸ç»“åˆï¼Œå°±å¯ä»¥å»é™¤æ•°ç»„çš„é‡å¤æˆå‘˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arr = [<span class="number">3</span>, <span class="number">5</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">5</span>];</div><div class="line"><span class="keyword">let</span> unique = [...new <span class="built_in">Set</span>(arr)];</div><div class="line"><span class="comment">// [3, 5, 2]</span></div></pre></td></tr></table></figure>
<p>è€Œä¸”ï¼Œæ•°ç»„çš„<code>map</code>å’Œ<code>filter</code>æ–¹æ³•ä¹Ÿå¯ä»¥ç”¨äºSetäº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line">set = <span class="keyword">new</span> <span class="built_in">Set</span>([...set].map(<span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">2</span>));</div><div class="line"><span class="comment">// è¿”å›Setç»“æ„ï¼š&#123;2, 4, 6&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]);</div><div class="line">set = <span class="keyword">new</span> <span class="built_in">Set</span>([...set].filter(<span class="function"><span class="params">x</span> =&gt;</span> (x % <span class="number">2</span>) == <span class="number">0</span>));</div><div class="line"><span class="comment">// è¿”å›Setç»“æ„ï¼š&#123;2, 4&#125;</span></div></pre></td></tr></table></figure>
<p>å› æ­¤ä½¿ç”¨Setå¯ä»¥å¾ˆå®¹æ˜“åœ°å®ç°å¹¶é›†ï¼ˆUnionï¼‰ã€äº¤é›†ï¼ˆIntersectï¼‰å’Œå·®é›†ï¼ˆDifferenceï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> a = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line"><span class="keyword">let</span> b = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]);</div><div class="line"></div><div class="line"><span class="comment">// å¹¶é›†</span></div><div class="line"><span class="keyword">let</span> union = <span class="keyword">new</span> <span class="built_in">Set</span>([...a, ...b]);</div><div class="line"><span class="comment">// Set &#123;1, 2, 3, 4&#125;</span></div><div class="line"></div><div class="line"><span class="comment">// äº¤é›†</span></div><div class="line"><span class="keyword">let</span> intersect = <span class="keyword">new</span> <span class="built_in">Set</span>([...a].filter(<span class="function"><span class="params">x</span> =&gt;</span> b.has(x)));</div><div class="line"><span class="comment">// set &#123;2, 3&#125;</span></div><div class="line"></div><div class="line"><span class="comment">// å·®é›†</span></div><div class="line"><span class="keyword">let</span> difference = <span class="keyword">new</span> <span class="built_in">Set</span>([...a].filter(<span class="function"><span class="params">x</span> =&gt;</span> !b.has(x)));</div><div class="line"><span class="comment">// Set &#123;1&#125;</span></div></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³åœ¨éå†æ“ä½œä¸­ï¼ŒåŒæ­¥æ”¹å˜åŸæ¥çš„Setç»“æ„ï¼Œç›®å‰æ²¡æœ‰ç›´æ¥çš„æ–¹æ³•ï¼Œä½†æœ‰ä¸¤ç§å˜é€šæ–¹æ³•ã€‚ä¸€ç§æ˜¯åˆ©ç”¨åŸSetç»“æ„æ˜ å°„å‡ºä¸€ä¸ªæ–°çš„ç»“æ„ï¼Œç„¶åèµ‹å€¼ç»™åŸæ¥çš„Setç»“æ„ï¼›å¦ä¸€ç§æ˜¯åˆ©ç”¨<code>Array.from</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ–¹æ³•ä¸€</span></div><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line">set = <span class="keyword">new</span> <span class="built_in">Set</span>([...set].map(<span class="function"><span class="params">val</span> =&gt;</span> val * <span class="number">2</span>));</div><div class="line"><span class="comment">// setçš„å€¼æ˜¯2, 4, 6</span></div><div class="line"></div><div class="line"><span class="comment">// æ–¹æ³•äºŒ</span></div><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line">set = <span class="keyword">new</span> <span class="built_in">Set</span>(<span class="built_in">Array</span>.from(set, val =&gt; val * <span class="number">2</span>));</div><div class="line"><span class="comment">// setçš„å€¼æ˜¯2, 4, 6</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æä¾›äº†ä¸¤ç§æ–¹æ³•ï¼Œç›´æ¥åœ¨éå†æ“ä½œä¸­æ”¹å˜åŸæ¥çš„Setç»“æ„ã€‚</p>
<h2 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h2><p>WeakSetç»“æ„ä¸Setç±»ä¼¼ï¼Œä¹Ÿæ˜¯ä¸é‡å¤çš„å€¼çš„é›†åˆã€‚ä½†æ˜¯ï¼Œå®ƒä¸Setæœ‰ä¸¤ä¸ªåŒºåˆ«ã€‚</p>
<p>é¦–å…ˆï¼ŒWeakSetçš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ï¼Œè€Œä¸èƒ½æ˜¯å…¶ä»–ç±»å‹çš„å€¼ã€‚</p>
<p>å…¶æ¬¡ï¼ŒWeakSetä¸­çš„å¯¹è±¡éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œå³åƒåœ¾å›æ”¶æœºåˆ¶ä¸è€ƒè™‘WeakSetå¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå…¶ä»–å¯¹è±¡éƒ½ä¸å†å¼•ç”¨è¯¥å¯¹è±¡ï¼Œé‚£ä¹ˆåƒåœ¾å›æ”¶æœºåˆ¶ä¼šè‡ªåŠ¨å›æ”¶è¯¥å¯¹è±¡æ‰€å ç”¨çš„å†…å­˜ï¼Œä¸è€ƒè™‘è¯¥å¯¹è±¡è¿˜å­˜åœ¨äºWeakSetä¹‹ä¸­ã€‚è¿™ä¸ªç‰¹ç‚¹æ„å‘³ç€ï¼Œæ— æ³•å¼•ç”¨WeakSetçš„æˆå‘˜ï¼Œå› æ­¤WeakSetæ˜¯ä¸å¯éå†çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</div><div class="line">ws.add(<span class="number">1</span>)</div><div class="line"><span class="comment">// TypeError: Invalid value used in weak set</span></div><div class="line">ws.add(<span class="built_in">Symbol</span>())</div><div class="line"><span class="comment">// TypeError: invalid value used in weak set</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯•å›¾å‘WeakSetæ·»åŠ ä¸€ä¸ªæ•°å€¼å’Œ<code>Symbol</code>å€¼ï¼Œç»“æœæŠ¥é”™ï¼Œå› ä¸ºWeakSetåªèƒ½æ”¾ç½®å¯¹è±¡ã€‚</p>
<p>WeakSetæ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨<code>new</code>å‘½ä»¤ï¼Œåˆ›å»ºWeakSetæ•°æ®ç»“æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</div></pre></td></tr></table></figure>
<p>ä½œä¸ºæ„é€ å‡½æ•°ï¼ŒWeakSetå¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„æˆ–ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ä½œä¸ºå‚æ•°ã€‚ï¼ˆå®é™…ä¸Šï¼Œä»»ä½•å…·æœ‰iterableæ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ä½œä¸ºWeakSetçš„å‚æ•°ã€‚ï¼‰è¯¥æ•°ç»„çš„æ‰€æœ‰æˆå‘˜ï¼Œéƒ½ä¼šè‡ªåŠ¨æˆä¸ºWeakSetå®ä¾‹å¯¹è±¡çš„æˆå‘˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [[<span class="number">1</span>,<span class="number">2</span>], [<span class="number">3</span>,<span class="number">4</span>]];</div><div class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>(a);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>a</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå®ƒæœ‰ä¸¤ä¸ªæˆå‘˜ï¼Œä¹Ÿéƒ½æ˜¯æ•°ç»„ã€‚å°†<code>a</code>ä½œä¸ºWeakSetæ„é€ å‡½æ•°çš„å‚æ•°ï¼Œ<code>a</code>çš„æˆå‘˜ä¼šè‡ªåŠ¨æˆä¸ºWeakSetçš„æˆå‘˜ã€‚</p>
<p>æ³¨æ„ï¼Œæ˜¯<code>a</code>æ•°ç»„çš„æˆå‘˜æˆä¸ºWeakSetçš„æˆå‘˜ï¼Œè€Œä¸æ˜¯<code>a</code>æ•°ç»„æœ¬èº«ã€‚è¿™æ„å‘³ç€ï¼Œæ•°ç»„çš„æˆå‘˜åªèƒ½æ˜¯å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> b = [<span class="number">3</span>, <span class="number">4</span>];</div><div class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>(b);</div><div class="line"><span class="comment">// Uncaught TypeError: Invalid value used in weak set(â€¦)</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„<code>b</code>çš„æˆå‘˜ä¸æ˜¯å¯¹è±¡ï¼ŒåŠ å…¥WeaKSetå°±ä¼šæŠ¥é”™ã€‚</p>
<p>WeakSetç»“æ„æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ–¹æ³•ã€‚</p>
<ul>
<li><strong>WeakSet.prototype.add(value)</strong>ï¼šå‘WeakSetå®ä¾‹æ·»åŠ ä¸€ä¸ªæ–°æˆå‘˜ã€‚</li>
<li><strong>WeakSet.prototype.delete(value)</strong>ï¼šæ¸…é™¤WeakSetå®ä¾‹çš„æŒ‡å®šæˆå‘˜ã€‚</li>
<li><strong>WeakSet.prototype.has(value)</strong>ï¼šè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªå€¼æ˜¯å¦åœ¨WeakSetå®ä¾‹ä¹‹ä¸­ã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="built_in">WeakSet</span>();</div><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> foo = &#123;&#125;;</div><div class="line"></div><div class="line">ws.add(<span class="built_in">window</span>);</div><div class="line">ws.add(obj);</div><div class="line"></div><div class="line">ws.has(<span class="built_in">window</span>); <span class="comment">// true</span></div><div class="line">ws.has(foo);    <span class="comment">// false</span></div><div class="line"></div><div class="line">ws.delete(<span class="built_in">window</span>);</div><div class="line">ws.has(<span class="built_in">window</span>);    <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>WeakSetæ²¡æœ‰<code>size</code>å±æ€§ï¼Œæ²¡æœ‰åŠæ³•éå†å®ƒçš„æˆå‘˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">ws.size <span class="comment">// undefined</span></div><div class="line">ws.forEach <span class="comment">// undefined</span></div><div class="line"></div><div class="line">ws.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123; <span class="built_in">console</span>.log(<span class="string">'WeakSet has '</span> + item)&#125;)</div><div class="line"><span class="comment">// TypeError: undefined is not a function</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯•å›¾è·å–<code>size</code>å’Œ<code>forEach</code>å±æ€§ï¼Œç»“æœéƒ½ä¸èƒ½æˆåŠŸã€‚</p>
<p>WeakSetä¸èƒ½éå†ï¼Œæ˜¯å› ä¸ºæˆå‘˜éƒ½æ˜¯å¼±å¼•ç”¨ï¼Œéšæ—¶å¯èƒ½æ¶ˆå¤±ï¼Œéå†æœºåˆ¶æ— æ³•ä¿è¯æˆå‘˜çš„å­˜åœ¨ï¼Œå¾ˆå¯èƒ½åˆšåˆšéå†ç»“æŸï¼Œæˆå‘˜å°±å–ä¸åˆ°äº†ã€‚WeakSetçš„ä¸€ä¸ªç”¨å¤„ï¼Œæ˜¯å‚¨å­˜DOMèŠ‚ç‚¹ï¼Œè€Œä¸ç”¨æ‹…å¿ƒè¿™äº›èŠ‚ç‚¹ä»æ–‡æ¡£ç§»é™¤æ—¶ï¼Œä¼šå¼•å‘å†…å­˜æ³„æ¼ã€‚</p>
<p>ä¸‹é¢æ˜¯WeakSetçš„å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foos = <span class="keyword">new</span> <span class="built_in">WeakSet</span>()</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    foos.add(<span class="keyword">this</span>)</div><div class="line">  &#125;</div><div class="line">  method () &#123;</div><div class="line">    <span class="keyword">if</span> (!foos.has(<span class="keyword">this</span>)) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>(<span class="string">'Foo.prototype.method åªèƒ½åœ¨Fooçš„å®ä¾‹ä¸Šè°ƒç”¨ï¼'</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¿è¯äº†<code>Foo</code>çš„å®ä¾‹æ–¹æ³•ï¼Œåªèƒ½åœ¨<code>Foo</code>çš„å®ä¾‹ä¸Šè°ƒç”¨ã€‚è¿™é‡Œä½¿ç”¨WeakSetçš„å¥½å¤„æ˜¯ï¼Œ<code>foos</code>å¯¹å®ä¾‹çš„å¼•ç”¨ï¼Œä¸ä¼šè¢«è®¡å…¥å†…å­˜å›æ”¶æœºåˆ¶ï¼Œæ‰€ä»¥åˆ é™¤å®ä¾‹çš„æ—¶å€™ï¼Œä¸ç”¨è€ƒè™‘<code>foos</code>ï¼Œä¹Ÿä¸ä¼šå‡ºç°å†…å­˜æ³„æ¼ã€‚</p>
<h2 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h2><h3 id="Mapç»“æ„çš„ç›®çš„å’ŒåŸºæœ¬ç”¨æ³•"><a href="#Mapç»“æ„çš„ç›®çš„å’ŒåŸºæœ¬ç”¨æ³•" class="headerlink" title="Mapç»“æ„çš„ç›®çš„å’ŒåŸºæœ¬ç”¨æ³•"></a>Mapç»“æ„çš„ç›®çš„å’ŒåŸºæœ¬ç”¨æ³•</h3><p>JavaScriptçš„å¯¹è±¡ï¼ˆObjectï¼‰ï¼Œæœ¬è´¨ä¸Šæ˜¯é”®å€¼å¯¹çš„é›†åˆï¼ˆHashç»“æ„ï¼‰ï¼Œä½†æ˜¯ä¼ ç»Ÿä¸Šåªèƒ½ç”¨å­—ç¬¦ä¸²å½“ä½œé”®ã€‚è¿™ç»™å®ƒçš„ä½¿ç”¨å¸¦æ¥äº†å¾ˆå¤§çš„é™åˆ¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> data = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">'myDiv'</span>);</div><div class="line"></div><div class="line">data[element] = <span class="string">'metadata'</span>;</div><div class="line">data[<span class="string">'[object HTMLDivElement]'</span>] <span class="comment">// "metadata"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åŸæ„æ˜¯å°†ä¸€ä¸ªDOMèŠ‚ç‚¹ä½œä¸ºå¯¹è±¡<code>data</code>çš„é”®ï¼Œä½†æ˜¯ç”±äºå¯¹è±¡åªæ¥å—å­—ç¬¦ä¸²ä½œä¸ºé”®åï¼Œæ‰€ä»¥<code>element</code>è¢«è‡ªåŠ¨è½¬ä¸ºå­—ç¬¦ä¸²<code>[object HTMLDivElement]</code>ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES6æä¾›äº†Mapæ•°æ®ç»“æ„ã€‚å®ƒç±»ä¼¼äºå¯¹è±¡ï¼Œä¹Ÿæ˜¯é”®å€¼å¯¹çš„é›†åˆï¼Œä½†æ˜¯â€œé”®â€çš„èŒƒå›´ä¸é™äºå­—ç¬¦ä¸²ï¼Œå„ç§ç±»å‹çš„å€¼ï¼ˆåŒ…æ‹¬å¯¹è±¡ï¼‰éƒ½å¯ä»¥å½“ä½œé”®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒObjectç»“æ„æä¾›äº†â€œå­—ç¬¦ä¸²â€”å€¼â€çš„å¯¹åº”ï¼ŒMapç»“æ„æä¾›äº†â€œå€¼â€”å€¼â€çš„å¯¹åº”ï¼Œæ˜¯ä¸€ç§æ›´å®Œå–„çš„Hashç»“æ„å®ç°ã€‚å¦‚æœä½ éœ€è¦â€œé”®å€¼å¯¹â€çš„æ•°æ®ç»“æ„ï¼ŒMapæ¯”Objectæ›´åˆé€‚ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"><span class="keyword">var</span> o = &#123;<span class="attr">p</span>: <span class="string">'Hello World'</span>&#125;;</div><div class="line"></div><div class="line">m.set(o, <span class="string">'content'</span>)</div><div class="line">m.get(o) <span class="comment">// "content"</span></div><div class="line"></div><div class="line">m.has(o) <span class="comment">// true</span></div><div class="line">m.delete(o) <span class="comment">// true</span></div><div class="line">m.has(o) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨<code>set</code>æ–¹æ³•ï¼Œå°†å¯¹è±¡<code>o</code>å½“ä½œ<code>m</code>çš„ä¸€ä¸ªé”®ï¼Œç„¶ååˆä½¿ç”¨<code>get</code>æ–¹æ³•è¯»å–è¿™ä¸ªé”®ï¼Œæ¥ç€ä½¿ç”¨<code>delete</code>æ–¹æ³•åˆ é™¤äº†è¿™ä¸ªé”®ã€‚</p>
<p>ä½œä¸ºæ„é€ å‡½æ•°ï¼ŒMapä¹Ÿå¯ä»¥æ¥å—ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ã€‚è¯¥æ•°ç»„çš„æˆå‘˜æ˜¯ä¸€ä¸ªä¸ªè¡¨ç¤ºé”®å€¼å¯¹çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</div><div class="line">  [<span class="string">'name'</span>, <span class="string">'å¼ ä¸‰'</span>],</div><div class="line">  [<span class="string">'title'</span>, <span class="string">'Author'</span>]</div><div class="line">]);</div><div class="line"></div><div class="line">map.size <span class="comment">// 2</span></div><div class="line">map.has(<span class="string">'name'</span>) <span class="comment">// true</span></div><div class="line">map.get(<span class="string">'name'</span>) <span class="comment">// "å¼ ä¸‰"</span></div><div class="line">map.has(<span class="string">'title'</span>) <span class="comment">// true</span></div><div class="line">map.get(<span class="string">'title'</span>) <span class="comment">// "Author"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨æ–°å»ºMapå®ä¾‹æ—¶ï¼Œå°±æŒ‡å®šäº†ä¸¤ä¸ªé”®<code>name</code>å’Œ<code>title</code>ã€‚</p>
<p>Mapæ„é€ å‡½æ•°æ¥å—æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œå®é™…ä¸Šæ‰§è¡Œçš„æ˜¯ä¸‹é¢çš„ç®—æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> items = [</div><div class="line">  [<span class="string">'name'</span>, <span class="string">'å¼ ä¸‰'</span>],</div><div class="line">  [<span class="string">'title'</span>, <span class="string">'Author'</span>]</div><div class="line">];</div><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">items.forEach(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> map.set(key, value));</div></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œå­—ç¬¦ä¸²<code>true</code>å’Œå¸ƒå°”å€¼<code>true</code>æ˜¯ä¸¤ä¸ªä¸åŒçš„é”®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>([</div><div class="line">  [<span class="literal">true</span>, <span class="string">'foo'</span>],</div><div class="line">  [<span class="string">'true'</span>, <span class="string">'bar'</span>]</div><div class="line">]);</div><div class="line"></div><div class="line">m.get(<span class="literal">true</span>) <span class="comment">// 'foo'</span></div><div class="line">m.get(<span class="string">'true'</span>) <span class="comment">// 'bar'</span></div></pre></td></tr></table></figure>
<p>å¦‚æœå¯¹åŒä¸€ä¸ªé”®å¤šæ¬¡èµ‹å€¼ï¼Œåé¢çš„å€¼å°†è¦†ç›–å‰é¢çš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"></div><div class="line">map</div><div class="line">.set(<span class="number">1</span>, <span class="string">'aaa'</span>)</div><div class="line">.set(<span class="number">1</span>, <span class="string">'bbb'</span>);</div><div class="line"></div><div class="line">map.get(<span class="number">1</span>) <span class="comment">// "bbb"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯¹é”®<code>1</code>è¿ç»­èµ‹å€¼ä¸¤æ¬¡ï¼Œåä¸€æ¬¡çš„å€¼è¦†ç›–å‰ä¸€æ¬¡çš„å€¼ã€‚</p>
<p>å¦‚æœè¯»å–ä¸€ä¸ªæœªçŸ¥çš„é”®ï¼Œåˆ™è¿”å›<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Map</span>().get(<span class="string">'asfddfsasadf'</span>)</div><div class="line"><span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œåªæœ‰å¯¹åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼ŒMapç»“æ„æ‰å°†å…¶è§†ä¸ºåŒä¸€ä¸ªé”®ã€‚è¿™ä¸€ç‚¹è¦éå¸¸å°å¿ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"></div><div class="line">map.set([<span class="string">'a'</span>], <span class="number">555</span>);</div><div class="line">map.get([<span class="string">'a'</span>]) <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>set</code>å’Œ<code>get</code>æ–¹æ³•ï¼Œè¡¨é¢æ˜¯é’ˆå¯¹åŒä¸€ä¸ªé”®ï¼Œä½†å®é™…ä¸Šè¿™æ˜¯ä¸¤ä¸ªå€¼ï¼Œå†…å­˜åœ°å€æ˜¯ä¸ä¸€æ ·çš„ï¼Œå› æ­¤<code>get</code>æ–¹æ³•æ— æ³•è¯»å–è¯¥é”®ï¼Œè¿”å›<code>undefined</code>ã€‚</p>
<p>åŒç†ï¼ŒåŒæ ·çš„å€¼çš„ä¸¤ä¸ªå®ä¾‹ï¼Œåœ¨Mapç»“æ„ä¸­è¢«è§†ä¸ºä¸¤ä¸ªé”®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"></div><div class="line"><span class="keyword">var</span> k1 = [<span class="string">'a'</span>];</div><div class="line"><span class="keyword">var</span> k2 = [<span class="string">'a'</span>];</div><div class="line"></div><div class="line">map</div><div class="line">.set(k1, <span class="number">111</span>)</div><div class="line">.set(k2, <span class="number">222</span>);</div><div class="line"></div><div class="line">map.get(k1) <span class="comment">// 111</span></div><div class="line">map.get(k2) <span class="comment">// 222</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>k1</code>å’Œ<code>k2</code>çš„å€¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å®ƒä»¬åœ¨Mapç»“æ„ä¸­è¢«è§†ä¸ºä¸¤ä¸ªé”®ã€‚</p>
<p>ç”±ä¸Šå¯çŸ¥ï¼ŒMapçš„é”®å®é™…ä¸Šæ˜¯è·Ÿå†…å­˜åœ°å€ç»‘å®šçš„ï¼Œåªè¦å†…å­˜åœ°å€ä¸ä¸€æ ·ï¼Œå°±è§†ä¸ºä¸¤ä¸ªé”®ã€‚è¿™å°±è§£å†³äº†åŒåå±æ€§ç¢°æ’ï¼ˆclashï¼‰çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ‰©å±•åˆ«äººçš„åº“çš„æ—¶å€™ï¼Œå¦‚æœä½¿ç”¨å¯¹è±¡ä½œä¸ºé”®åï¼Œå°±ä¸ç”¨æ‹…å¿ƒè‡ªå·±çš„å±æ€§ä¸åŸä½œè€…çš„å±æ€§åŒåã€‚</p>
<p>å¦‚æœMapçš„é”®æ˜¯ä¸€ä¸ªç®€å•ç±»å‹çš„å€¼ï¼ˆæ•°å­—ã€å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼ï¼‰ï¼Œåˆ™åªè¦ä¸¤ä¸ªå€¼ä¸¥æ ¼ç›¸ç­‰ï¼ŒMapå°†å…¶è§†ä¸ºä¸€ä¸ªé”®ï¼ŒåŒ…æ‹¬<code>0</code>å’Œ<code>-0</code>ã€‚å¦å¤–ï¼Œè™½ç„¶<code>NaN</code>ä¸ä¸¥æ ¼ç›¸ç­‰äºè‡ªèº«ï¼Œä½†Mapå°†å…¶è§†ä¸ºåŒä¸€ä¸ªé”®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"></div><div class="line">map.set(<span class="literal">NaN</span>, <span class="number">123</span>);</div><div class="line">map.get(<span class="literal">NaN</span>) <span class="comment">// 123</span></div><div class="line"></div><div class="line">map.set(<span class="number">-0</span>, <span class="number">123</span>);</div><div class="line">map.get(+<span class="number">0</span>) <span class="comment">// 123</span></div></pre></td></tr></table></figure>
<h3 id="å®ä¾‹çš„å±æ€§å’Œæ“ä½œæ–¹æ³•"><a href="#å®ä¾‹çš„å±æ€§å’Œæ“ä½œæ–¹æ³•" class="headerlink" title="å®ä¾‹çš„å±æ€§å’Œæ“ä½œæ–¹æ³•"></a>å®ä¾‹çš„å±æ€§å’Œæ“ä½œæ–¹æ³•</h3><p>Mapç»“æ„çš„å®ä¾‹æœ‰ä»¥ä¸‹å±æ€§å’Œæ“ä½œæ–¹æ³•ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰sizeå±æ€§</strong></p>
<p><code>size</code>å±æ€§è¿”å›Mapç»“æ„çš„æˆå‘˜æ€»æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">map.set(<span class="string">'foo'</span>, <span class="literal">true</span>);</div><div class="line">map.set(<span class="string">'bar'</span>, <span class="literal">false</span>);</div><div class="line"></div><div class="line">map.size <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰set(key, value)</strong></p>
<p><code>set</code>æ–¹æ³•è®¾ç½®<code>key</code>æ‰€å¯¹åº”çš„é”®å€¼ï¼Œç„¶åè¿”å›æ•´ä¸ªMapç»“æ„ã€‚å¦‚æœ<code>key</code>å·²ç»æœ‰å€¼ï¼Œåˆ™é”®å€¼ä¼šè¢«æ›´æ–°ï¼Œå¦åˆ™å°±æ–°ç”Ÿæˆè¯¥é”®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"></div><div class="line">m.set(<span class="string">"edition"</span>, <span class="number">6</span>)        <span class="comment">// é”®æ˜¯å­—ç¬¦ä¸²</span></div><div class="line">m.set(<span class="number">262</span>, <span class="string">"standard"</span>)     <span class="comment">// é”®æ˜¯æ•°å€¼</span></div><div class="line">m.set(<span class="literal">undefined</span>, <span class="string">"nah"</span>)    <span class="comment">// é”®æ˜¯undefined</span></div></pre></td></tr></table></figure>
<p><code>set</code>æ–¹æ³•è¿”å›çš„æ˜¯Mapæœ¬èº«ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>()</div><div class="line">  .set(<span class="number">1</span>, <span class="string">'a'</span>)</div><div class="line">  .set(<span class="number">2</span>, <span class="string">'b'</span>)</div><div class="line">  .set(<span class="number">3</span>, <span class="string">'c'</span>);</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰get(key)</strong></p>
<p><code>get</code>æ–¹æ³•è¯»å–<code>key</code>å¯¹åº”çš„é”®å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°<code>key</code>ï¼Œè¿”å›<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"></div><div class="line"><span class="keyword">var</span> hello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;<span class="built_in">console</span>.log(<span class="string">"hello"</span>);&#125;</div><div class="line">m.set(hello, <span class="string">"Hello ES6!"</span>) <span class="comment">// é”®æ˜¯å‡½æ•°</span></div><div class="line"></div><div class="line">m.get(hello)  <span class="comment">// Hello ES6!</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰has(key)</strong></p>
<p><code>has</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªé”®æ˜¯å¦åœ¨Mapæ•°æ®ç»“æ„ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line"></div><div class="line">m.set(<span class="string">"edition"</span>, <span class="number">6</span>);</div><div class="line">m.set(<span class="number">262</span>, <span class="string">"standard"</span>);</div><div class="line">m.set(<span class="literal">undefined</span>, <span class="string">"nah"</span>);</div><div class="line"></div><div class="line">m.has(<span class="string">"edition"</span>)     <span class="comment">// true</span></div><div class="line">m.has(<span class="string">"years"</span>)       <span class="comment">// false</span></div><div class="line">m.has(<span class="number">262</span>)           <span class="comment">// true</span></div><div class="line">m.has(<span class="literal">undefined</span>)     <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ5ï¼‰delete(key)</strong></p>
<p><code>delete</code>æ–¹æ³•åˆ é™¤æŸä¸ªé”®ï¼Œè¿”å›trueã€‚å¦‚æœåˆ é™¤å¤±è´¥ï¼Œè¿”å›falseã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">m.set(<span class="literal">undefined</span>, <span class="string">"nah"</span>);</div><div class="line">m.has(<span class="literal">undefined</span>)     <span class="comment">// true</span></div><div class="line"></div><div class="line">m.delete(<span class="literal">undefined</span>)</div><div class="line">m.has(<span class="literal">undefined</span>)       <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ6ï¼‰clear()</strong></p>
<p><code>clear</code>æ–¹æ³•æ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">map.set(<span class="string">'foo'</span>, <span class="literal">true</span>);</div><div class="line">map.set(<span class="string">'bar'</span>, <span class="literal">false</span>);</div><div class="line"></div><div class="line">map.size <span class="comment">// 2</span></div><div class="line">map.clear()</div><div class="line">map.size <span class="comment">// 0</span></div></pre></td></tr></table></figure>
<h3 id="éå†æ–¹æ³•"><a href="#éå†æ–¹æ³•" class="headerlink" title="éå†æ–¹æ³•"></a>éå†æ–¹æ³•</h3><p>MapåŸç”Ÿæä¾›ä¸‰ä¸ªéå†å™¨ç”Ÿæˆå‡½æ•°å’Œä¸€ä¸ªéå†æ–¹æ³•ã€‚</p>
<ul>
<li><code>keys()</code>ï¼šè¿”å›é”®åçš„éå†å™¨ã€‚</li>
<li><code>values()</code>ï¼šè¿”å›é”®å€¼çš„éå†å™¨ã€‚</li>
<li><code>entries()</code>ï¼šè¿”å›æ‰€æœ‰æˆå‘˜çš„éå†å™¨ã€‚</li>
<li><code>forEach()</code>ï¼šéå†Mapçš„æ‰€æœ‰æˆå‘˜ã€‚</li>
</ul>
<p>éœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼ŒMapçš„éå†é¡ºåºå°±æ˜¯æ’å…¥é¡ºåºã€‚</p>
<p>ä¸‹é¢æ˜¯ä½¿ç”¨å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</div><div class="line">  [<span class="string">'F'</span>, <span class="string">'no'</span>],</div><div class="line">  [<span class="string">'T'</span>,  <span class="string">'yes'</span>],</div><div class="line">]);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> map.keys()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "F"</span></div><div class="line"><span class="comment">// "T"</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> map.values()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "no"</span></div><div class="line"><span class="comment">// "yes"</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> map.entries()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(item[<span class="number">0</span>], item[<span class="number">1</span>]);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "F" "no"</span></div><div class="line"><span class="comment">// "T" "yes"</span></div><div class="line"></div><div class="line"><span class="comment">// æˆ–è€…</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map.entries()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key, value);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäºä½¿ç”¨map.entries()</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key, value);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æœ€åçš„é‚£ä¸ªä¾‹å­ï¼Œè¡¨ç¤ºMapç»“æ„çš„é»˜è®¤éå†å™¨æ¥å£ï¼ˆ<code>Symbol.iterator</code>å±æ€§ï¼‰ï¼Œå°±æ˜¯<code>entries</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">map[<span class="built_in">Symbol</span>.iterator] === map.entries</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>Mapç»“æ„è½¬ä¸ºæ•°ç»„ç»“æ„ï¼Œæ¯”è¾ƒå¿«é€Ÿçš„æ–¹æ³•æ˜¯ç»“åˆä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</div><div class="line">  [<span class="number">1</span>, <span class="string">'one'</span>],</div><div class="line">  [<span class="number">2</span>, <span class="string">'two'</span>],</div><div class="line">  [<span class="number">3</span>, <span class="string">'three'</span>],</div><div class="line">]);</div><div class="line"></div><div class="line">[...map.keys()]</div><div class="line"><span class="comment">// [1, 2, 3]</span></div><div class="line"></div><div class="line">[...map.values()]</div><div class="line"><span class="comment">// ['one', 'two', 'three']</span></div><div class="line"></div><div class="line">[...map.entries()]</div><div class="line"><span class="comment">// [[1,'one'], [2, 'two'], [3, 'three']]</span></div><div class="line"></div><div class="line">[...map]</div><div class="line"><span class="comment">// [[1,'one'], [2, 'two'], [3, 'three']]</span></div></pre></td></tr></table></figure>
<p>ç»“åˆæ•°ç»„çš„<code>map</code>æ–¹æ³•ã€<code>filter</code>æ–¹æ³•ï¼Œå¯ä»¥å®ç°Mapçš„éå†å’Œè¿‡æ»¤ï¼ˆMapæœ¬èº«æ²¡æœ‰<code>map</code>å’Œ<code>filter</code>æ–¹æ³•ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map0 = <span class="keyword">new</span> <span class="built_in">Map</span>()</div><div class="line">  .set(<span class="number">1</span>, <span class="string">'a'</span>)</div><div class="line">  .set(<span class="number">2</span>, <span class="string">'b'</span>)</div><div class="line">  .set(<span class="number">3</span>, <span class="string">'c'</span>);</div><div class="line"></div><div class="line"><span class="keyword">let</span> map1 = <span class="keyword">new</span> <span class="built_in">Map</span>(</div><div class="line">  [...map0].filter(<span class="function">(<span class="params">[k, v]</span>) =&gt;</span> k &lt; <span class="number">3</span>)</div><div class="line">);</div><div class="line"><span class="comment">// äº§ç”ŸMapç»“æ„ &#123;1 =&gt; 'a', 2 =&gt; 'b'&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> map2 = <span class="keyword">new</span> <span class="built_in">Map</span>(</div><div class="line">  [...map0].map(<span class="function">(<span class="params">[k, v]</span>) =&gt;</span> [k * <span class="number">2</span>, <span class="string">'_'</span> + v])</div><div class="line">    );</div><div class="line"><span class="comment">// äº§ç”ŸMapç»“æ„ &#123;2 =&gt; '_a', 4 =&gt; '_b', 6 =&gt; '_c'&#125;</span></div></pre></td></tr></table></figure>
<p>æ­¤å¤–ï¼ŒMapè¿˜æœ‰ä¸€ä¸ª<code>forEach</code>æ–¹æ³•ï¼Œä¸æ•°ç»„çš„<code>forEach</code>æ–¹æ³•ç±»ä¼¼ï¼Œä¹Ÿå¯ä»¥å®ç°éå†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">map.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value, key, map</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">"Key: %s, Value: %s"</span>, key, value);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><code>forEach</code>æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®š<code>this</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> reporter = &#123;</div><div class="line">  <span class="attr">report</span>: <span class="function"><span class="keyword">function</span>(<span class="params">key, value</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Key: %s, Value: %s"</span>, key, value);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">map.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">value, key, map</span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.report(key, value);</div><div class="line">&#125;, reporter);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>forEach</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°çš„<code>this</code>ï¼Œå°±æŒ‡å‘<code>reporter</code>ã€‚</p>
<h3 id="ä¸å…¶ä»–æ•°æ®ç»“æ„çš„äº’ç›¸è½¬æ¢"><a href="#ä¸å…¶ä»–æ•°æ®ç»“æ„çš„äº’ç›¸è½¬æ¢" class="headerlink" title="ä¸å…¶ä»–æ•°æ®ç»“æ„çš„äº’ç›¸è½¬æ¢"></a>ä¸å…¶ä»–æ•°æ®ç»“æ„çš„äº’ç›¸è½¬æ¢</h3><p><strong>ï¼ˆ1ï¼‰Mapè½¬ä¸ºæ•°ç»„</strong></p>
<p>å‰é¢å·²ç»æè¿‡ï¼ŒMapè½¬ä¸ºæ•°ç»„æœ€æ–¹ä¾¿çš„æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼ˆâ€¦ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> myMap = <span class="keyword">new</span> <span class="built_in">Map</span>().set(<span class="literal">true</span>, <span class="number">7</span>).set(&#123;<span class="attr">foo</span>: <span class="number">3</span>&#125;, [<span class="string">'abc'</span>]);</div><div class="line">[...myMap]</div><div class="line"><span class="comment">// [ [ true, 7 ], [ &#123; foo: 3 &#125;, [ 'abc' ] ] ]</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰æ•°ç»„è½¬ä¸ºMap</strong></p>
<p>å°†æ•°ç»„è½¬å…¥Mapæ„é€ å‡½æ•°ï¼Œå°±å¯ä»¥è½¬ä¸ºMapã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="literal">true</span>, <span class="number">7</span>], [&#123;<span class="attr">foo</span>: <span class="number">3</span>&#125;, [<span class="string">'abc'</span>]]])</div><div class="line"><span class="comment">// Map &#123;true =&gt; 7, Object &#123;foo: 3&#125; =&gt; ['abc']&#125;</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰Mapè½¬ä¸ºå¯¹è±¡</strong></p>
<p>å¦‚æœæ‰€æœ‰Mapçš„é”®éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œå®ƒå¯ä»¥è½¬ä¸ºå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">strMapToObj</span>(<span class="params">strMap</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> obj = <span class="built_in">Object</span>.create(<span class="literal">null</span>);</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> [k,v] <span class="keyword">of</span> strMap) &#123;</div><div class="line">    obj[k] = v;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> obj;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> myMap = <span class="keyword">new</span> <span class="built_in">Map</span>().set(<span class="string">'yes'</span>, <span class="literal">true</span>).set(<span class="string">'no'</span>, <span class="literal">false</span>);</div><div class="line">strMapToObj(myMap)</div><div class="line"><span class="comment">// &#123; yes: true, no: false &#125;</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰å¯¹è±¡è½¬ä¸ºMap</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">objToStrMap</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> strMap = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> k <span class="keyword">of</span> <span class="built_in">Object</span>.keys(obj)) &#123;</div><div class="line">    strMap.set(k, obj[k]);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> strMap;</div><div class="line">&#125;</div><div class="line"></div><div class="line">objToStrMap(&#123;<span class="attr">yes</span>: <span class="literal">true</span>, <span class="attr">no</span>: <span class="literal">false</span>&#125;)</div><div class="line"><span class="comment">// [ [ 'yes', true ], [ 'no', false ] ]</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ5ï¼‰Mapè½¬ä¸ºJSON</strong></p>
<p>Mapè½¬ä¸ºJSONè¦åŒºåˆ†ä¸¤ç§æƒ…å†µã€‚ä¸€ç§æƒ…å†µæ˜¯ï¼ŒMapçš„é”®åéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©è½¬ä¸ºå¯¹è±¡JSONã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">strMapToJson</span>(<span class="params">strMap</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">JSON</span>.stringify(strMapToObj(strMap));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> myMap = <span class="keyword">new</span> <span class="built_in">Map</span>().set(<span class="string">'yes'</span>, <span class="literal">true</span>).set(<span class="string">'no'</span>, <span class="literal">false</span>);</div><div class="line">strMapToJson(myMap)</div><div class="line"><span class="comment">// '&#123;"yes":true,"no":false&#125;'</span></div></pre></td></tr></table></figure>
<p>å¦ä¸€ç§æƒ…å†µæ˜¯ï¼ŒMapçš„é”®åæœ‰éå­—ç¬¦ä¸²ï¼Œè¿™æ—¶å¯ä»¥é€‰æ‹©è½¬ä¸ºæ•°ç»„JSONã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapToArrayJson</span>(<span class="params">map</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">JSON</span>.stringify([...map]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> myMap = <span class="keyword">new</span> <span class="built_in">Map</span>().set(<span class="literal">true</span>, <span class="number">7</span>).set(&#123;<span class="attr">foo</span>: <span class="number">3</span>&#125;, [<span class="string">'abc'</span>]);</div><div class="line">mapToArrayJson(myMap)</div><div class="line"><span class="comment">// '[[true,7],[&#123;"foo":3&#125;,["abc"]]]'</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ6ï¼‰JSONè½¬ä¸ºMap</strong></p>
<p>JSONè½¬ä¸ºMapï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œæ‰€æœ‰é”®åéƒ½æ˜¯å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">jsonToStrMap</span>(<span class="params">jsonStr</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> objToStrMap(<span class="built_in">JSON</span>.parse(jsonStr));</div><div class="line">&#125;</div><div class="line"></div><div class="line">jsonToStrMap(<span class="string">'&#123;"yes":true,"no":false&#125;'</span>)</div><div class="line"><span class="comment">// Map &#123;'yes' =&gt; true, 'no' =&gt; false&#125;</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œæœ‰ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œæ•´ä¸ªJSONå°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸”æ¯ä¸ªæ•°ç»„æˆå‘˜æœ¬èº«ï¼Œåˆæ˜¯ä¸€ä¸ªæœ‰ä¸¤ä¸ªæˆå‘˜çš„æ•°ç»„ã€‚è¿™æ—¶ï¼Œå®ƒå¯ä»¥ä¸€ä¸€å¯¹åº”åœ°è½¬ä¸ºMapã€‚è¿™å¾€å¾€æ˜¯æ•°ç»„è½¬ä¸ºJSONçš„é€†æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">jsonToMap</span>(<span class="params">jsonStr</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="built_in">JSON</span>.parse(jsonStr));</div><div class="line">&#125;</div><div class="line"></div><div class="line">jsonToMap(<span class="string">'[[true,7],[&#123;"foo":3&#125;,["abc"]]]'</span>)</div><div class="line"><span class="comment">// Map &#123;true =&gt; 7, Object &#123;foo: 3&#125; =&gt; ['abc']&#125;</span></div></pre></td></tr></table></figure>
<h2 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h2><p><code>WeakMap</code>ç»“æ„ä¸<code>Map</code>ç»“æ„åŸºæœ¬ç±»ä¼¼ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å®ƒåªæ¥å—å¯¹è±¡ä½œä¸ºé”®åï¼ˆ<code>null</code>é™¤å¤–ï¼‰ï¼Œä¸æ¥å—å…¶ä»–ç±»å‹çš„å€¼ä½œä¸ºé”®åï¼Œè€Œä¸”é”®åæ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œä¸è®¡å…¥åƒåœ¾å›æ”¶æœºåˆ¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</div><div class="line">map.set(<span class="number">1</span>, <span class="number">2</span>)</div><div class="line"><span class="comment">// TypeError: 1 is not an object!</span></div><div class="line">map.set(<span class="built_in">Symbol</span>(), <span class="number">2</span>)</div><div class="line"><span class="comment">// TypeError: Invalid value used as weak map key</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå°†<code>1</code>å’Œ<code>Symbol</code>ä½œä¸ºWeakMapçš„é”®åï¼Œéƒ½ä¼šæŠ¥é”™ã€‚</p>
<p><code>WeakMap</code>çš„è®¾è®¡ç›®çš„åœ¨äºï¼Œé”®åæ˜¯å¯¹è±¡çš„å¼±å¼•ç”¨ï¼ˆåƒåœ¾å›æ”¶æœºåˆ¶ä¸å°†è¯¥å¼•ç”¨è€ƒè™‘åœ¨å†…ï¼‰ï¼Œæ‰€ä»¥å…¶æ‰€å¯¹åº”çš„å¯¹è±¡å¯èƒ½ä¼šè¢«è‡ªåŠ¨å›æ”¶ã€‚å½“å¯¹è±¡è¢«å›æ”¶åï¼Œ<code>WeakMap</code>è‡ªåŠ¨ç§»é™¤å¯¹åº”çš„é”®å€¼å¯¹ã€‚å…¸å‹åº”ç”¨æ˜¯ï¼Œä¸€ä¸ªå¯¹åº”DOMå…ƒç´ çš„<code>WeakMap</code>ç»“æ„ï¼Œå½“æŸä¸ªDOMå…ƒç´ è¢«æ¸…é™¤ï¼Œå…¶æ‰€å¯¹åº”çš„<code>WeakMap</code>è®°å½•å°±ä¼šè‡ªåŠ¨è¢«ç§»é™¤ã€‚åŸºæœ¬ä¸Šï¼Œ<code>WeakMap</code>çš„ä¸“ç”¨åœºåˆå°±æ˜¯ï¼Œå®ƒçš„é”®æ‰€å¯¹åº”çš„å¯¹è±¡ï¼Œå¯èƒ½ä¼šåœ¨å°†æ¥æ¶ˆå¤±ã€‚<code>WeakMap</code>ç»“æ„æœ‰åŠ©äºé˜²æ­¢å†…å­˜æ³„æ¼ã€‚</p>
<p>ä¸‹é¢æ˜¯<code>WeakMap</code>ç»“æ„çš„ä¸€ä¸ªä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°ç”¨æ³•ä¸Šä¸<code>Map</code>å‡ ä¹ä¸€æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line"><span class="keyword">var</span> element = <span class="built_in">document</span>.querySelector(<span class="string">".element"</span>);</div><div class="line"></div><div class="line">wm.set(element, <span class="string">"Original"</span>);</div><div class="line">wm.get(element) <span class="comment">// "Original"</span></div><div class="line"></div><div class="line">element.parentNode.removeChild(element);</div><div class="line">element = <span class="literal">null</span>;</div><div class="line">wm.get(element) <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>wm</code>æ˜¯ä¸€ä¸ª<code>WeakMap</code>å®ä¾‹ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ª<code>DOM</code>èŠ‚ç‚¹<code>element</code>ä½œä¸ºé”®åï¼Œç„¶åé”€æ¯è¿™ä¸ªèŠ‚ç‚¹ï¼Œ<code>element</code>å¯¹åº”çš„é”®å°±è‡ªåŠ¨æ¶ˆå¤±äº†ï¼Œå†å¼•ç”¨è¿™ä¸ªé”®åå°±è¿”å›<code>undefined</code>ã€‚</p>
<p>WeakMapä¸Mapåœ¨APIä¸Šçš„åŒºåˆ«ä¸»è¦æ˜¯ä¸¤ä¸ªï¼Œä¸€æ˜¯æ²¡æœ‰éå†æ“ä½œï¼ˆå³æ²¡æœ‰<code>key()</code>ã€<code>values()</code>å’Œ<code>entries()</code>æ–¹æ³•ï¼‰ï¼Œä¹Ÿæ²¡æœ‰<code>size</code>å±æ€§ï¼›äºŒæ˜¯æ— æ³•æ¸…ç©ºï¼Œå³ä¸æ”¯æŒ<code>clear</code>æ–¹æ³•ã€‚è¿™ä¸<code>WeakMap</code>çš„é”®ä¸è¢«è®¡å…¥å¼•ç”¨ã€è¢«åƒåœ¾å›æ”¶æœºåˆ¶å¿½ç•¥æœ‰å…³ã€‚å› æ­¤ï¼Œ<code>WeakMap</code>åªæœ‰å››ä¸ªæ–¹æ³•å¯ç”¨ï¼š<code>get()</code>ã€<code>set()</code>ã€<code>has()</code>ã€<code>delete()</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> wm = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line"></div><div class="line">wm.size</div><div class="line"><span class="comment">// undefined</span></div><div class="line"></div><div class="line">wm.forEach</div><div class="line"><span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>å‰æ–‡è¯´è¿‡ï¼ŒWeakMapåº”ç”¨çš„å…¸å‹åœºåˆå°±æ˜¯DOMèŠ‚ç‚¹ä½œä¸ºé”®åã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> myElement = <span class="built_in">document</span>.getElementById(<span class="string">'logo'</span>);</div><div class="line"><span class="keyword">let</span> myWeakmap = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line"></div><div class="line">myWeakmap.set(myElement, &#123;<span class="attr">timesClicked</span>: <span class="number">0</span>&#125;);</div><div class="line"></div><div class="line">myElement.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> logoData = myWeakmap.get(myElement);</div><div class="line">  logoData.timesClicked++;</div><div class="line">&#125;, <span class="literal">false</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>myElement</code>æ˜¯ä¸€ä¸ª DOM èŠ‚ç‚¹ï¼Œæ¯å½“å‘ç”Ÿ<code>click</code>äº‹ä»¶ï¼Œå°±æ›´æ–°ä¸€ä¸‹çŠ¶æ€ã€‚æˆ‘ä»¬å°†è¿™ä¸ªçŠ¶æ€ä½œä¸ºé”®å€¼æ”¾åœ¨ WeakMap é‡Œï¼Œå¯¹åº”çš„é”®åå°±æ˜¯<code>myElement</code>ã€‚ä¸€æ—¦è¿™ä¸ª DOM èŠ‚ç‚¹åˆ é™¤ï¼Œè¯¥çŠ¶æ€å°±ä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼Œä¸å­˜åœ¨å†…å­˜æ³„æ¼é£é™©ã€‚</p>
<p>WeakMap çš„å¦ä¸€ä¸ªç”¨å¤„æ˜¯éƒ¨ç½²ç§æœ‰å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> _counter = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line"><span class="keyword">let</span> _action = <span class="keyword">new</span> <span class="built_in">WeakMap</span>();</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Countdown</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(counter, action) &#123;</div><div class="line">    _counter.set(<span class="keyword">this</span>, counter);</div><div class="line">    _action.set(<span class="keyword">this</span>, action);</div><div class="line">  &#125;</div><div class="line">  dec() &#123;</div><div class="line">    <span class="keyword">let</span> counter = _counter.get(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">if</span> (counter &lt; <span class="number">1</span>) <span class="keyword">return</span>;</div><div class="line">    counter--;</div><div class="line">    _counter.set(<span class="keyword">this</span>, counter);</div><div class="line">    <span class="keyword">if</span> (counter === <span class="number">0</span>) &#123;</div><div class="line">      _action.get(<span class="keyword">this</span>)();</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> c = <span class="keyword">new</span> Countdown(<span class="number">2</span>, () =&gt; <span class="built_in">console</span>.log(<span class="string">'DONE'</span>));</div><div class="line"></div><div class="line">c.dec()</div><div class="line">c.dec()</div><div class="line"><span class="comment">// DONE</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒCountdownç±»çš„ä¸¤ä¸ªå†…éƒ¨å±æ€§<code>_counter</code>å’Œ<code>_action</code>ï¼Œæ˜¯å®ä¾‹çš„å¼±å¼•ç”¨ï¼Œæ‰€ä»¥å¦‚æœåˆ é™¤å®ä¾‹ï¼Œå®ƒä»¬ä¹Ÿå°±éšä¹‹æ¶ˆå¤±ï¼Œä¸ä¼šé€ æˆå†…å­˜æ³„æ¼ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Setå’ŒMapæ•°æ®ç»“æ„&quot;&gt;&lt;a href=&quot;#Setå’ŒMapæ•°æ®ç»“æ„&quot; class=&quot;headerlink&quot; title=&quot;Setå’ŒMapæ•°æ®ç»“æ„&quot;&gt;&lt;/a&gt;Setå’ŒMapæ•°æ®ç»“æ„&lt;/h1&gt;&lt;h2 id=&quot;Set&quot;&gt;&lt;a href=&quot;#Set&quot; class=&quot;he
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Set" scheme="http://microzz.com/tags/Set/"/>
    
      <category term="Map" scheme="http://microzz.com/tags/Map/"/>
    
  </entry>
  
  <entry>
    <title>Symbol</title>
    <link href="http://microzz.com/2017/01/01/symbol/"/>
    <id>http://microzz.com/2017/01/01/symbol/</id>
    <published>2017-01-01T05:43:19.000Z</published>
    <updated>2017-01-12T08:14:04.571Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Symbol"><a href="#Symbol" class="headerlink" title="Symbol"></a>Symbol</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ES5çš„å¯¹è±¡å±æ€§åéƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™å®¹æ˜“é€ æˆå±æ€§åçš„å†²çªã€‚æ¯”å¦‚ï¼Œä½ ä½¿ç”¨äº†ä¸€ä¸ªä»–äººæä¾›çš„å¯¹è±¡ï¼Œä½†åˆæƒ³ä¸ºè¿™ä¸ªå¯¹è±¡æ·»åŠ æ–°çš„æ–¹æ³•ï¼ˆmixinæ¨¡å¼ï¼‰ï¼Œæ–°æ–¹æ³•çš„åå­—å°±æœ‰å¯èƒ½ä¸ç°æœ‰æ–¹æ³•äº§ç”Ÿå†²çªã€‚å¦‚æœæœ‰ä¸€ç§æœºåˆ¶ï¼Œä¿è¯æ¯ä¸ªå±æ€§çš„åå­—éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„å°±å¥½äº†ï¼Œè¿™æ ·å°±ä»æ ¹æœ¬ä¸Šé˜²æ­¢å±æ€§åçš„å†²çªã€‚è¿™å°±æ˜¯ES6å¼•å…¥Symbolçš„åŸå› ã€‚</p>
<p>ES6å¼•å…¥äº†ä¸€ç§æ–°çš„åŸå§‹æ•°æ®ç±»å‹Symbolï¼Œè¡¨ç¤ºç‹¬ä¸€æ— äºŒçš„å€¼ã€‚å®ƒæ˜¯JavaScriptè¯­è¨€çš„ç¬¬ä¸ƒç§æ•°æ®ç±»å‹ï¼Œå‰å…­ç§æ˜¯ï¼šUndefinedã€Nullã€å¸ƒå°”å€¼ï¼ˆBooleanï¼‰ã€å­—ç¬¦ä¸²ï¼ˆStringï¼‰ã€æ•°å€¼ï¼ˆNumberï¼‰ã€å¯¹è±¡ï¼ˆObjectï¼‰ã€‚</p>
<p>Symbolå€¼é€šè¿‡<code>Symbol</code>å‡½æ•°ç”Ÿæˆã€‚è¿™å°±æ˜¯è¯´ï¼Œå¯¹è±¡çš„å±æ€§åç°åœ¨å¯ä»¥æœ‰ä¸¤ç§ç±»å‹ï¼Œä¸€ç§æ˜¯åŸæ¥å°±æœ‰çš„å­—ç¬¦ä¸²ï¼Œå¦ä¸€ç§å°±æ˜¯æ–°å¢çš„Symbolç±»å‹ã€‚å‡¡æ˜¯å±æ€§åå±äºSymbolç±»å‹ï¼Œå°±éƒ½æ˜¯ç‹¬ä¸€æ— äºŒçš„ï¼Œå¯ä»¥ä¿è¯ä¸ä¼šä¸å…¶ä»–å±æ€§åäº§ç”Ÿå†²çªã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s = <span class="built_in">Symbol</span>();</div><div class="line"></div><div class="line"><span class="keyword">typeof</span> s</div><div class="line"><span class="comment">// "symbol"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>s</code>å°±æ˜¯ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å€¼ã€‚<code>typeof</code>è¿ç®—ç¬¦çš„ç»“æœï¼Œè¡¨æ˜å˜é‡<code>s</code>æ˜¯Symbolæ•°æ®ç±»å‹ï¼Œè€Œä¸æ˜¯å­—ç¬¦ä¸²ä¹‹ç±»çš„å…¶ä»–ç±»å‹ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>Symbol</code>å‡½æ•°å‰ä¸èƒ½ä½¿ç”¨<code>new</code>å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å› ä¸ºç”Ÿæˆçš„Symbolæ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¸æ˜¯å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œç”±äºSymbolå€¼ä¸æ˜¯å¯¹è±¡ï¼Œæ‰€ä»¥ä¸èƒ½æ·»åŠ å±æ€§ã€‚åŸºæœ¬ä¸Šï¼Œå®ƒæ˜¯ä¸€ç§ç±»ä¼¼äºå­—ç¬¦ä¸²çš„æ•°æ®ç±»å‹ã€‚</p>
<p><code>Symbol</code>å‡½æ•°å¯ä»¥æ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œè¡¨ç¤ºå¯¹Symbolå®ä¾‹çš„æè¿°ï¼Œä¸»è¦æ˜¯ä¸ºäº†åœ¨æ§åˆ¶å°æ˜¾ç¤ºï¼Œæˆ–è€…è½¬ä¸ºå­—ç¬¦ä¸²æ—¶ï¼Œæ¯”è¾ƒå®¹æ˜“åŒºåˆ†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s1 = <span class="built_in">Symbol</span>(<span class="string">'foo'</span>);</div><div class="line"><span class="keyword">var</span> s2 = <span class="built_in">Symbol</span>(<span class="string">'bar'</span>);</div><div class="line"></div><div class="line">s1 <span class="comment">// Symbol(foo)</span></div><div class="line">s2 <span class="comment">// Symbol(bar)</span></div><div class="line"></div><div class="line">s1.toString() <span class="comment">// "Symbol(foo)"</span></div><div class="line">s2.toString() <span class="comment">// "Symbol(bar)"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>s1</code>å’Œ<code>s2</code>æ˜¯ä¸¤ä¸ªSymbolå€¼ã€‚å¦‚æœä¸åŠ å‚æ•°ï¼Œå®ƒä»¬åœ¨æ§åˆ¶å°çš„è¾“å‡ºéƒ½æ˜¯<code>Symbol()</code>ï¼Œä¸åˆ©äºåŒºåˆ†ã€‚æœ‰äº†å‚æ•°ä»¥åï¼Œå°±ç­‰äºä¸ºå®ƒä»¬åŠ ä¸Šäº†æè¿°ï¼Œè¾“å‡ºçš„æ—¶å€™å°±èƒ½å¤Ÿåˆ†æ¸…ï¼Œåˆ°åº•æ˜¯å“ªä¸€ä¸ªå€¼ã€‚</p>
<p>å¦‚æœ Symbol çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šè°ƒç”¨è¯¥å¯¹è±¡çš„<code>toString</code>æ–¹æ³•ï¼Œå°†å…¶è½¬ä¸ºå­—ç¬¦ä¸²ï¼Œç„¶åæ‰ç”Ÿæˆä¸€ä¸ª Symbol å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">  toString() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'abc'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">const</span> sym = <span class="built_in">Symbol</span>(obj);</div><div class="line">sym <span class="comment">// Symbol(abc)</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œ<code>Symbol</code>å‡½æ•°çš„å‚æ•°åªæ˜¯è¡¨ç¤ºå¯¹å½“å‰ Symbol å€¼çš„æè¿°ï¼Œå› æ­¤ç›¸åŒå‚æ•°çš„<code>Symbol</code>å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸ç›¸ç­‰çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ²¡æœ‰å‚æ•°çš„æƒ…å†µ</span></div><div class="line"><span class="keyword">var</span> s1 = <span class="built_in">Symbol</span>();</div><div class="line"><span class="keyword">var</span> s2 = <span class="built_in">Symbol</span>();</div><div class="line"></div><div class="line">s1 === s2 <span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="comment">// æœ‰å‚æ•°çš„æƒ…å†µ</span></div><div class="line"><span class="keyword">var</span> s1 = <span class="built_in">Symbol</span>(<span class="string">'foo'</span>);</div><div class="line"><span class="keyword">var</span> s2 = <span class="built_in">Symbol</span>(<span class="string">'foo'</span>);</div><div class="line"></div><div class="line">s1 === s2 <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>s1</code>å’Œ<code>s2</code>éƒ½æ˜¯<code>Symbol</code>å‡½æ•°çš„è¿”å›å€¼ï¼Œè€Œä¸”å‚æ•°ç›¸åŒï¼Œä½†æ˜¯å®ƒä»¬æ˜¯ä¸ç›¸ç­‰çš„ã€‚</p>
<p>Symbolå€¼ä¸èƒ½ä¸å…¶ä»–ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—ï¼Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sym = <span class="built_in">Symbol</span>(<span class="string">'My symbol'</span>);</div><div class="line"></div><div class="line"><span class="string">"your symbol is "</span> + sym</div><div class="line"><span class="comment">// TypeError: can't convert symbol to string</span></div><div class="line"><span class="string">`your symbol is <span class="subst">$&#123;sym&#125;</span>`</span></div><div class="line"><span class="comment">// TypeError: can't convert symbol to string</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼ŒSymbolå€¼å¯ä»¥æ˜¾å¼è½¬ä¸ºå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sym = <span class="built_in">Symbol</span>(<span class="string">'My symbol'</span>);</div><div class="line"></div><div class="line"><span class="built_in">String</span>(sym) <span class="comment">// 'Symbol(My symbol)'</span></div><div class="line">sym.toString() <span class="comment">// 'Symbol(My symbol)'</span></div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼ŒSymbolå€¼ä¹Ÿå¯ä»¥è½¬ä¸ºå¸ƒå°”å€¼ï¼Œä½†æ˜¯ä¸èƒ½è½¬ä¸ºæ•°å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sym = <span class="built_in">Symbol</span>();</div><div class="line"><span class="built_in">Boolean</span>(sym) <span class="comment">// true</span></div><div class="line">!sym  <span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> (sym) &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">Number</span>(sym) <span class="comment">// TypeError</span></div><div class="line">sym + <span class="number">2</span> <span class="comment">// TypeError</span></div></pre></td></tr></table></figure>
<h2 id="ä½œä¸ºå±æ€§åçš„Symbol"><a href="#ä½œä¸ºå±æ€§åçš„Symbol" class="headerlink" title="ä½œä¸ºå±æ€§åçš„Symbol"></a>ä½œä¸ºå±æ€§åçš„Symbol</h2><p>ç”±äºæ¯ä¸€ä¸ªSymbolå€¼éƒ½æ˜¯ä¸ç›¸ç­‰çš„ï¼Œè¿™æ„å‘³ç€Symbolå€¼å¯ä»¥ä½œä¸ºæ ‡è¯†ç¬¦ï¼Œç”¨äºå¯¹è±¡çš„å±æ€§åï¼Œå°±èƒ½ä¿è¯ä¸ä¼šå‡ºç°åŒåçš„å±æ€§ã€‚è¿™å¯¹äºä¸€ä¸ªå¯¹è±¡ç”±å¤šä¸ªæ¨¡å—æ„æˆçš„æƒ…å†µéå¸¸æœ‰ç”¨ï¼Œèƒ½é˜²æ­¢æŸä¸€ä¸ªé”®è¢«ä¸å°å¿ƒæ”¹å†™æˆ–è¦†ç›–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mySymbol = <span class="built_in">Symbol</span>();</div><div class="line"></div><div class="line"><span class="comment">// ç¬¬ä¸€ç§å†™æ³•</span></div><div class="line"><span class="keyword">var</span> a = &#123;&#125;;</div><div class="line">a[mySymbol] = <span class="string">'Hello!'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ç¬¬äºŒç§å†™æ³•</span></div><div class="line"><span class="keyword">var</span> a = &#123;</div><div class="line">  [mySymbol]: <span class="string">'Hello!'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ç¬¬ä¸‰ç§å†™æ³•</span></div><div class="line"><span class="keyword">var</span> a = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.defineProperty(a, mySymbol, &#123; <span class="attr">value</span>: <span class="string">'Hello!'</span> &#125;);</div><div class="line"></div><div class="line"><span class="comment">// ä»¥ä¸Šå†™æ³•éƒ½å¾—åˆ°åŒæ ·ç»“æœ</span></div><div class="line">a[mySymbol] <span class="comment">// "Hello!"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç é€šè¿‡æ–¹æ‹¬å·ç»“æ„å’Œ<code>Object.defineProperty</code>ï¼Œå°†å¯¹è±¡çš„å±æ€§åæŒ‡å®šä¸ºä¸€ä¸ªSymbolå€¼ã€‚</p>
<p>æ³¨æ„ï¼ŒSymbolå€¼ä½œä¸ºå¯¹è±¡å±æ€§åæ—¶ï¼Œä¸èƒ½ç”¨ç‚¹è¿ç®—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mySymbol = <span class="built_in">Symbol</span>();</div><div class="line"><span class="keyword">var</span> a = &#123;&#125;;</div><div class="line"></div><div class="line">a.mySymbol = <span class="string">'Hello!'</span>;</div><div class="line">a[mySymbol] <span class="comment">// undefined</span></div><div class="line">a[<span class="string">'mySymbol'</span>] <span class="comment">// "Hello!"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå› ä¸ºç‚¹è¿ç®—ç¬¦åé¢æ€»æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸ä¼šè¯»å–<code>mySymbol</code>ä½œä¸ºæ ‡è¯†åæ‰€æŒ‡ä»£çš„é‚£ä¸ªå€¼ï¼Œå¯¼è‡´<code>a</code>çš„å±æ€§åå®é™…ä¸Šæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªSymbolå€¼ã€‚</p>
<p>åŒç†ï¼Œåœ¨å¯¹è±¡çš„å†…éƒ¨ï¼Œä½¿ç”¨Symbolå€¼å®šä¹‰å±æ€§æ—¶ï¼ŒSymbolå€¼å¿…é¡»æ”¾åœ¨æ–¹æ‹¬å·ä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> s = <span class="built_in">Symbol</span>();</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  [s]: <span class="function"><span class="keyword">function</span> (<span class="params">arg</span>) </span>&#123; ... &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj[s](<span class="number">123</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ<code>s</code>ä¸æ”¾åœ¨æ–¹æ‹¬å·ä¸­ï¼Œè¯¥å±æ€§çš„é”®åå°±æ˜¯å­—ç¬¦ä¸²<code>s</code>ï¼Œè€Œä¸æ˜¯<code>s</code>æ‰€ä»£è¡¨çš„é‚£ä¸ªSymbolå€¼ã€‚</p>
<p>é‡‡ç”¨å¢å¼ºçš„å¯¹è±¡å†™æ³•ï¼Œä¸Šé¢ä»£ç çš„<code>obj</code>å¯¹è±¡å¯ä»¥å†™å¾—æ›´ç®€æ´ä¸€äº›ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  [s](arg) &#123; ... &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>Symbolç±»å‹è¿˜å¯ä»¥ç”¨äºå®šä¹‰ä¸€ç»„å¸¸é‡ï¼Œä¿è¯è¿™ç»„å¸¸é‡çš„å€¼éƒ½æ˜¯ä¸ç›¸ç­‰çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">log.levels = &#123;</div><div class="line">  <span class="attr">DEBUG</span>: <span class="built_in">Symbol</span>(<span class="string">'debug'</span>),</div><div class="line">  <span class="attr">INFO</span>: <span class="built_in">Symbol</span>(<span class="string">'info'</span>),</div><div class="line">  <span class="attr">WARN</span>: <span class="built_in">Symbol</span>(<span class="string">'warn'</span>)</div><div class="line">&#125;;</div><div class="line">log(log.levels.DEBUG, <span class="string">'debug message'</span>);</div><div class="line">log(log.levels.INFO, <span class="string">'info message'</span>);</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> COLOR_RED    = <span class="built_in">Symbol</span>();</div><div class="line"><span class="keyword">const</span> COLOR_GREEN  = <span class="built_in">Symbol</span>();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getComplement</span>(<span class="params">color</span>) </span>&#123;</div><div class="line">  <span class="keyword">switch</span> (color) &#123;</div><div class="line">    <span class="keyword">case</span> COLOR_RED:</div><div class="line">      <span class="keyword">return</span> COLOR_GREEN;</div><div class="line">    <span class="keyword">case</span> COLOR_GREEN:</div><div class="line">      <span class="keyword">return</span> COLOR_RED;</div><div class="line">    <span class="keyword">default</span>:</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Undefined color'</span>);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¸¸é‡ä½¿ç”¨Symbolå€¼æœ€å¤§çš„å¥½å¤„ï¼Œå°±æ˜¯å…¶ä»–ä»»ä½•å€¼éƒ½ä¸å¯èƒ½æœ‰ç›¸åŒçš„å€¼äº†ï¼Œå› æ­¤å¯ä»¥ä¿è¯ä¸Šé¢çš„<code>switch</code>è¯­å¥ä¼šæŒ‰è®¾è®¡çš„æ–¹å¼å·¥ä½œã€‚</p>
<p>è¿˜æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„ï¼ŒSymbolå€¼ä½œä¸ºå±æ€§åæ—¶ï¼Œè¯¥å±æ€§è¿˜æ˜¯å…¬å¼€å±æ€§ï¼Œä¸æ˜¯ç§æœ‰å±æ€§ã€‚</p>
<h2 id="å®ä¾‹ï¼šæ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²"><a href="#å®ä¾‹ï¼šæ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²" class="headerlink" title="å®ä¾‹ï¼šæ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²"></a>å®ä¾‹ï¼šæ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²</h2><p>é­”æœ¯å­—ç¬¦ä¸²æŒ‡çš„æ˜¯ï¼Œåœ¨ä»£ç ä¹‹ä¸­å¤šæ¬¡å‡ºç°ã€ä¸ä»£ç å½¢æˆå¼ºè€¦åˆçš„æŸä¸€ä¸ªå…·ä½“çš„å­—ç¬¦ä¸²æˆ–è€…æ•°å€¼ã€‚é£æ ¼è‰¯å¥½çš„ä»£ç ï¼Œåº”è¯¥å°½é‡æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²ï¼Œè¯¥ç”±å«ä¹‰æ¸…æ™°çš„å˜é‡ä»£æ›¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArea</span>(<span class="params">shape, options</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> area = <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">switch</span> (shape) &#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">'Triangle'</span>: <span class="comment">// é­”æœ¯å­—ç¬¦ä¸²</span></div><div class="line">      area = <span class="number">.5</span> * options.width * options.height;</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">    <span class="comment">/* ... more code ... */</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> area;</div><div class="line">&#125;</div><div class="line"></div><div class="line">getArea(<span class="string">'Triangle'</span>, &#123; <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">height</span>: <span class="number">100</span> &#125;); <span class="comment">// é­”æœ¯å­—ç¬¦ä¸²</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²â€œTriangleâ€å°±æ˜¯ä¸€ä¸ªé­”æœ¯å­—ç¬¦ä¸²ã€‚å®ƒå¤šæ¬¡å‡ºç°ï¼Œä¸ä»£ç å½¢æˆâ€œå¼ºè€¦åˆâ€ï¼Œä¸åˆ©äºå°†æ¥çš„ä¿®æ”¹å’Œç»´æŠ¤ã€‚</p>
<p>å¸¸ç”¨çš„æ¶ˆé™¤é­”æœ¯å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œå°±æ˜¯æŠŠå®ƒå†™æˆä¸€ä¸ªå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> shapeType = &#123;</div><div class="line">  <span class="attr">triangle</span>: <span class="string">'Triangle'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getArea</span>(<span class="params">shape, options</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> area = <span class="number">0</span>;</div><div class="line">  <span class="keyword">switch</span> (shape) &#123;</div><div class="line">    <span class="keyword">case</span> shapeType.triangle:</div><div class="line">      area = <span class="number">.5</span> * options.width * options.height;</div><div class="line">      <span class="keyword">break</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> area;</div><div class="line">&#125;</div><div class="line"></div><div class="line">getArea(shapeType.triangle, &#123; <span class="attr">width</span>: <span class="number">100</span>, <span class="attr">height</span>: <span class="number">100</span> &#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠâ€œTriangleâ€å†™æˆ<code>shapeType</code>å¯¹è±¡çš„<code>triangle</code>å±æ€§ï¼Œè¿™æ ·å°±æ¶ˆé™¤äº†å¼ºè€¦åˆã€‚</p>
<p>å¦‚æœä»”ç»†åˆ†æï¼Œå¯ä»¥å‘ç°<code>shapeType.triangle</code>ç­‰äºå“ªä¸ªå€¼å¹¶ä¸é‡è¦ï¼Œåªè¦ç¡®ä¿ä¸ä¼šè·Ÿå…¶ä»–<code>shapeType</code>å±æ€§çš„å€¼å†²çªå³å¯ã€‚å› æ­¤ï¼Œè¿™é‡Œå°±å¾ˆé€‚åˆæ”¹ç”¨Symbolå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> shapeType = &#123;</div><div class="line">  <span class="attr">triangle</span>: <span class="built_in">Symbol</span>()</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œé™¤äº†å°†<code>shapeType.triangle</code>çš„å€¼è®¾ä¸ºä¸€ä¸ªSymbolï¼Œå…¶ä»–åœ°æ–¹éƒ½ä¸ç”¨ä¿®æ”¹ã€‚</p>
<h2 id="å±æ€§åçš„éå†"><a href="#å±æ€§åçš„éå†" class="headerlink" title="å±æ€§åçš„éå†"></a>å±æ€§åçš„éå†</h2><p>Symbol ä½œä¸ºå±æ€§åï¼Œè¯¥å±æ€§ä¸ä¼šå‡ºç°åœ¨<code>for...in</code>ã€<code>for...of</code>å¾ªç¯ä¸­ï¼Œä¹Ÿä¸ä¼šè¢«<code>Object.keys()</code>ã€<code>Object.getOwnPropertyNames()</code>ã€<code>JSON.stringify()</code>è¿”å›ã€‚ä½†æ˜¯ï¼Œå®ƒä¹Ÿä¸æ˜¯ç§æœ‰å±æ€§ï¼Œæœ‰ä¸€ä¸ª<code>Object.getOwnPropertySymbols</code>æ–¹æ³•ï¼Œå¯ä»¥è·å–æŒ‡å®šå¯¹è±¡çš„æ‰€æœ‰ Symbol å±æ€§åã€‚</p>
<p><code>Object.getOwnPropertySymbols</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å½“å‰å¯¹è±¡çš„æ‰€æœ‰ç”¨ä½œå±æ€§åçš„ Symbol å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> a = <span class="built_in">Symbol</span>(<span class="string">'a'</span>);</div><div class="line"><span class="keyword">var</span> b = <span class="built_in">Symbol</span>(<span class="string">'b'</span>);</div><div class="line"></div><div class="line">obj[a] = <span class="string">'Hello'</span>;</div><div class="line">obj[b] = <span class="string">'World'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> objectSymbols = <span class="built_in">Object</span>.getOwnPropertySymbols(obj);</div><div class="line"></div><div class="line">objectSymbols</div><div class="line"><span class="comment">// [Symbol(a), Symbol(b)]</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ï¼Œ<code>Object.getOwnPropertySymbols</code>æ–¹æ³•ä¸<code>for...in</code>å¾ªç¯ã€<code>Object.getOwnPropertyNames</code>æ–¹æ³•è¿›è¡Œå¯¹æ¯”çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> foo = <span class="built_in">Symbol</span>(<span class="string">"foo"</span>);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.defineProperty(obj, foo, &#123;</div><div class="line">  <span class="attr">value</span>: <span class="string">"foobar"</span>,</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> obj) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i); <span class="comment">// æ— è¾“å‡º</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(obj)</div><div class="line"><span class="comment">// []</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertySymbols(obj)</div><div class="line"><span class="comment">// [Symbol(foo)]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä½¿ç”¨<code>Object.getOwnPropertyNames</code>æ–¹æ³•å¾—ä¸åˆ°<code>Symbol</code>å±æ€§åï¼Œéœ€è¦ä½¿ç”¨<code>Object.getOwnPropertySymbols</code>æ–¹æ³•ã€‚</p>
<p>å¦ä¸€ä¸ªæ–°çš„APIï¼Œ<code>Reflect.ownKeys</code>æ–¹æ³•å¯ä»¥è¿”å›æ‰€æœ‰ç±»å‹çš„é”®åï¼ŒåŒ…æ‹¬å¸¸è§„é”®åå’Œ Symbol é”®åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  [<span class="built_in">Symbol</span>(<span class="string">'my_key'</span>)]: <span class="number">1</span>,</div><div class="line">  <span class="attr">enum</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">nonEnum</span>: <span class="number">3</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Reflect</span>.ownKeys(obj)</div><div class="line"><span class="comment">//  ["enum", "nonEnum", Symbol(my_key)]</span></div></pre></td></tr></table></figure>
<p>ç”±äºä»¥ Symbol å€¼ä½œä¸ºåç§°çš„å±æ€§ï¼Œä¸ä¼šè¢«å¸¸è§„æ–¹æ³•éå†å¾—åˆ°ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œä¸ºå¯¹è±¡å®šä¹‰ä¸€äº›éç§æœ‰çš„ã€ä½†åˆå¸Œæœ›åªç”¨äºå†…éƒ¨çš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> size = <span class="built_in">Symbol</span>(<span class="string">'size'</span>);</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Collection</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>() &#123;</div><div class="line">    <span class="keyword">this</span>[size] = <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  add(item) &#123;</div><div class="line">    <span class="keyword">this</span>[<span class="keyword">this</span>[size]] = item;</div><div class="line">    <span class="keyword">this</span>[size]++;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">static</span> sizeOf(instance) &#123;</div><div class="line">    <span class="keyword">return</span> instance[size];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> Collection();</div><div class="line">Collection.sizeOf(x) <span class="comment">// 0</span></div><div class="line"></div><div class="line">x.add(<span class="string">'foo'</span>);</div><div class="line">Collection.sizeOf(x) <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.keys(x) <span class="comment">// ['0']</span></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyNames(x) <span class="comment">// ['0']</span></div><div class="line"><span class="built_in">Object</span>.getOwnPropertySymbols(x) <span class="comment">// [Symbol(size)]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡<code>x</code>çš„<code>size</code>å±æ€§æ˜¯ä¸€ä¸ª Symbol å€¼ï¼Œæ‰€ä»¥<code>Object.keys(x)</code>ã€<code>Object.getOwnPropertyNames(x)</code>éƒ½æ— æ³•è·å–å®ƒã€‚è¿™å°±é€ æˆäº†ä¸€ç§éç§æœ‰çš„å†…éƒ¨æ–¹æ³•çš„æ•ˆæœã€‚</p>
<h2 id="Symbol-for-ï¼ŒSymbol-keyFor"><a href="#Symbol-for-ï¼ŒSymbol-keyFor" class="headerlink" title="Symbol.for()ï¼ŒSymbol.keyFor()"></a>Symbol.for()ï¼ŒSymbol.keyFor()</h2><p>æœ‰æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›é‡æ–°ä½¿ç”¨åŒä¸€ä¸ªSymbolå€¼ï¼Œ<code>Symbol.for</code>æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚å®ƒæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„Symbolå€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ªSymbolå€¼ï¼Œå¦åˆ™å°±æ–°å»ºå¹¶è¿”å›ä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„Symbolå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s1 = <span class="built_in">Symbol</span>.for(<span class="string">'foo'</span>);</div><div class="line"><span class="keyword">var</span> s2 = <span class="built_in">Symbol</span>.for(<span class="string">'foo'</span>);</div><div class="line"></div><div class="line">s1 === s2 <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>s1</code>å’Œ<code>s2</code>éƒ½æ˜¯ Symbol å€¼ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æ˜¯åŒæ ·å‚æ•°çš„<code>Symbol.for</code>æ–¹æ³•ç”Ÿæˆçš„ï¼Œæ‰€ä»¥å®é™…ä¸Šæ˜¯åŒä¸€ä¸ªå€¼ã€‚</p>
<p><code>Symbol.for()</code>ä¸<code>Symbol()</code>è¿™ä¸¤ç§å†™æ³•ï¼Œéƒ½ä¼šç”Ÿæˆæ–°çš„Symbolã€‚å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼Œå‰è€…ä¼šè¢«ç™»è®°åœ¨å…¨å±€ç¯å¢ƒä¸­ä¾›æœç´¢ï¼Œåè€…ä¸ä¼šã€‚<code>Symbol.for()</code>ä¸ä¼šæ¯æ¬¡è°ƒç”¨å°±è¿”å›ä¸€ä¸ªæ–°çš„ Symbol ç±»å‹çš„å€¼ï¼Œè€Œæ˜¯ä¼šå…ˆæ£€æŸ¥ç»™å®šçš„<code>key</code>æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨æ‰ä¼šæ–°å»ºä¸€ä¸ªå€¼ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ è°ƒç”¨<code>Symbol.for(&quot;cat&quot;)</code>30æ¬¡ï¼Œæ¯æ¬¡éƒ½ä¼šè¿”å›åŒä¸€ä¸ª Symbol å€¼ï¼Œä½†æ˜¯è°ƒç”¨<code>Symbol(&quot;cat&quot;)</code>30æ¬¡ï¼Œä¼šè¿”å›30ä¸ªä¸åŒçš„Symbolå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Symbol</span>.for(<span class="string">"bar"</span>) === <span class="built_in">Symbol</span>.for(<span class="string">"bar"</span>)</div><div class="line"><span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="built_in">Symbol</span>(<span class="string">"bar"</span>) === <span class="built_in">Symbol</span>(<span class="string">"bar"</span>)</div><div class="line"><span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äº<code>Symbol()</code>å†™æ³•æ²¡æœ‰ç™»è®°æœºåˆ¶ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨éƒ½ä¼šè¿”å›ä¸€ä¸ªä¸åŒçš„å€¼ã€‚</p>
<p><code>Symbol.keyFor</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå·²ç™»è®°çš„ Symbol ç±»å‹å€¼çš„<code>key</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s1 = <span class="built_in">Symbol</span>.for(<span class="string">"foo"</span>);</div><div class="line"><span class="built_in">Symbol</span>.keyFor(s1) <span class="comment">// "foo"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> s2 = <span class="built_in">Symbol</span>(<span class="string">"foo"</span>);</div><div class="line"><span class="built_in">Symbol</span>.keyFor(s2) <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>s2</code>å±äºæœªç™»è®°çš„Symbolå€¼ï¼Œæ‰€ä»¥è¿”å›<code>undefined</code>ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code>Symbol.for</code>ä¸ºSymbolå€¼ç™»è®°çš„åå­—ï¼Œæ˜¯å…¨å±€ç¯å¢ƒçš„ï¼Œå¯ä»¥åœ¨ä¸åŒçš„ iframe æˆ– service worker ä¸­å–åˆ°åŒä¸€ä¸ªå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">iframe = <span class="built_in">document</span>.createElement(<span class="string">'iframe'</span>);</div><div class="line">iframe.src = <span class="built_in">String</span>(<span class="built_in">window</span>.location);</div><div class="line"><span class="built_in">document</span>.body.appendChild(iframe);</div><div class="line"></div><div class="line">iframe.contentWindow.Symbol.for(<span class="string">'foo'</span>) === <span class="built_in">Symbol</span>.for(<span class="string">'foo'</span>)</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œiframe çª—å£ç”Ÿæˆçš„ Symbol å€¼ï¼Œå¯ä»¥åœ¨ä¸»é¡µé¢å¾—åˆ°ã€‚</p>
<h2 id="å®ä¾‹ï¼šæ¨¡å—çš„-Singleton-æ¨¡å¼"><a href="#å®ä¾‹ï¼šæ¨¡å—çš„-Singleton-æ¨¡å¼" class="headerlink" title="å®ä¾‹ï¼šæ¨¡å—çš„ Singleton æ¨¡å¼"></a>å®ä¾‹ï¼šæ¨¡å—çš„ Singleton æ¨¡å¼</h2><p>Singletonæ¨¡å¼æŒ‡çš„æ˜¯è°ƒç”¨ä¸€ä¸ªç±»ï¼Œä»»ä½•æ—¶å€™è¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹ã€‚</p>
<p>å¯¹äºNodeæ¥è¯´ï¼Œæ¨¡å—æ–‡ä»¶å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªç±»ã€‚æ€ä¹ˆä¿è¯æ¯æ¬¡æ‰§è¡Œè¿™ä¸ªæ¨¡å—æ–‡ä»¶ï¼Œè¿”å›çš„éƒ½æ˜¯åŒä¸€ä¸ªå®ä¾‹å‘¢ï¼Ÿ</p>
<p>å¾ˆå®¹æ˜“æƒ³åˆ°ï¼Œå¯ä»¥æŠŠå®ä¾‹æ”¾åˆ°é¡¶å±‚å¯¹è±¡<code>global</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mod.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.foo = <span class="string">'hello'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!global._foo) &#123;</div><div class="line">  global._foo = <span class="keyword">new</span> A();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = global._foo;</div></pre></td></tr></table></figure>
<p>ç„¶åï¼ŒåŠ è½½ä¸Šé¢çš„<code>mod.js</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./mod.js'</span>);</div><div class="line"><span class="built_in">console</span>.log(a.foo);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>a</code>ä»»ä½•æ—¶å€™åŠ è½½çš„éƒ½æ˜¯<code>A</code>çš„åŒä¸€ä¸ªå®ä¾‹ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå…¨å±€å˜é‡<code>global._foo</code>æ˜¯å¯å†™çš„ï¼Œä»»ä½•æ–‡ä»¶éƒ½å¯ä»¥ä¿®æ”¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./mod.js'</span>);</div><div class="line">global._foo = <span class="number">123</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ï¼Œä¼šä½¿å¾—åˆ«çš„è„šæœ¬åŠ è½½<code>mod.js</code>éƒ½å¤±çœŸã€‚</p>
<p>ä¸ºäº†é˜²æ­¢è¿™ç§æƒ…å†µå‡ºç°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨Symbolã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mod.js</span></div><div class="line"><span class="keyword">const</span> FOO_KEY = <span class="built_in">Symbol</span>.for(<span class="string">'foo'</span>);</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">A</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.foo = <span class="string">'hello'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!global[FOO_KEY]) &#123;</div><div class="line">  global[FOO_KEY] = <span class="keyword">new</span> A();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = global[FOO_KEY];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯ä»¥ä¿è¯<code>global[FOO_KEY]</code>ä¸ä¼šè¢«æ— æ„é—´è¦†ç›–ï¼Œä½†è¿˜æ˜¯å¯ä»¥è¢«æ”¹å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'./mod.js'</span>);</div><div class="line">global[<span class="built_in">Symbol</span>.for(<span class="string">'foo'</span>)] = <span class="number">123</span>;</div></pre></td></tr></table></figure>
<p>å¦‚æœé”®åä½¿ç”¨<code>Symbol</code>æ–¹æ³•ç”Ÿæˆï¼Œé‚£ä¹ˆå¤–éƒ¨å°†æ— æ³•å¼•ç”¨è¿™ä¸ªå€¼ï¼Œå½“ç„¶ä¹Ÿå°±æ— æ³•æ”¹å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mod.js</span></div><div class="line"><span class="keyword">const</span> FOO_KEY = <span class="built_in">Symbol</span>(<span class="string">'foo'</span>);</div><div class="line"></div><div class="line"><span class="comment">// åé¢ä»£ç ç›¸åŒ â€¦â€¦</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†å¯¼è‡´å…¶ä»–è„šæœ¬éƒ½æ— æ³•å¼•ç”¨<code>FOO_KEY</code>ã€‚ä½†è¿™æ ·ä¹Ÿæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœå¤šæ¬¡æ‰§è¡Œè¿™ä¸ªè„šæœ¬ï¼Œæ¯æ¬¡å¾—åˆ°çš„<code>FOO_KEY</code>éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚è™½ç„¶Nodeä¼šå°†è„šæœ¬çš„æ‰§è¡Œç»“æœç¼“å­˜ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸ä¼šå¤šæ¬¡æ‰§è¡ŒåŒä¸€ä¸ªè„šæœ¬ï¼Œä½†æ˜¯ç”¨æˆ·å¯ä»¥æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜ï¼Œæ‰€ä»¥ä¹Ÿä¸æ˜¯å®Œå…¨å¯é ã€‚</p>
<h2 id="å†…ç½®çš„Symbolå€¼"><a href="#å†…ç½®çš„Symbolå€¼" class="headerlink" title="å†…ç½®çš„Symbolå€¼"></a>å†…ç½®çš„Symbolå€¼</h2><p>é™¤äº†å®šä¹‰è‡ªå·±ä½¿ç”¨çš„Symbolå€¼ä»¥å¤–ï¼ŒES6è¿˜æä¾›äº†11ä¸ªå†…ç½®çš„Symbolå€¼ï¼ŒæŒ‡å‘è¯­è¨€å†…éƒ¨ä½¿ç”¨çš„æ–¹æ³•ã€‚</p>
<h3 id="Symbol-hasInstance"><a href="#Symbol-hasInstance" class="headerlink" title="Symbol.hasInstance"></a>Symbol.hasInstance</h3><p>å¯¹è±¡çš„<code>Symbol.hasInstance</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå†…éƒ¨æ–¹æ³•ã€‚å½“å…¶ä»–å¯¹è±¡ä½¿ç”¨<code>instanceof</code>è¿ç®—ç¬¦ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºè¯¥å¯¹è±¡çš„å®ä¾‹æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚æ¯”å¦‚ï¼Œ<code>foo instanceof Foo</code>åœ¨è¯­è¨€å†…éƒ¨ï¼Œå®é™…è°ƒç”¨çš„æ˜¯<code>Foo[Symbol.hasInstance](foo)</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</div><div class="line">  [<span class="built_in">Symbol</span>.hasInstance](foo) &#123;</div><div class="line">    <span class="keyword">return</span> foo <span class="keyword">instanceof</span> <span class="built_in">Array</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] <span class="keyword">instanceof</span> <span class="keyword">new</span> MyClass() <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>MyClass</code>æ˜¯ä¸€ä¸ªç±»ï¼Œ<code>new MyClass()</code>ä¼šè¿”å›ä¸€ä¸ªå®ä¾‹ã€‚è¯¥å®ä¾‹çš„<code>Symbol.hasInstance</code>æ–¹æ³•ï¼Œä¼šåœ¨è¿›è¡Œ<code>instanceof</code>è¿ç®—æ—¶è‡ªåŠ¨è°ƒç”¨ï¼Œåˆ¤æ–­å·¦ä¾§çš„è¿ç®—å­æ˜¯å¦ä¸º<code>Array</code>çš„å®ä¾‹ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Even</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> [<span class="built_in">Symbol</span>.hasInstance](obj) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Number</span>(obj) % <span class="number">2</span> === <span class="number">0</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="number">1</span> <span class="keyword">instanceof</span> Even <span class="comment">// false</span></div><div class="line"><span class="number">2</span> <span class="keyword">instanceof</span> Even <span class="comment">// true</span></div><div class="line"><span class="number">12345</span> <span class="keyword">instanceof</span> Even <span class="comment">// false</span></div></pre></td></tr></table></figure>
<h3 id="Symbol-isConcatSpreadable"><a href="#Symbol-isConcatSpreadable" class="headerlink" title="Symbol.isConcatSpreadable"></a>Symbol.isConcatSpreadable</h3><p>å¯¹è±¡çš„<code>Symbol.isConcatSpreadable</code>å±æ€§ç­‰äºä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥å¯¹è±¡ä½¿ç”¨<code>Array.prototype.concat()</code>æ—¶ï¼Œæ˜¯å¦å¯ä»¥å±•å¼€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arr1 = [<span class="string">'c'</span>, <span class="string">'d'</span>];</div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>].concat(arr1, <span class="string">'e'</span>) <span class="comment">// ['a', 'b', 'c', 'd', 'e']</span></div><div class="line">arr1[<span class="built_in">Symbol</span>.isConcatSpreadable] <span class="comment">// undefined</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> arr2 = [<span class="string">'c'</span>, <span class="string">'d'</span>];</div><div class="line">arr2[<span class="built_in">Symbol</span>.isConcatSpreadable] = <span class="literal">false</span>;</div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>].concat(arr2, <span class="string">'e'</span>) <span class="comment">// ['a', 'b', ['c','d'], 'e']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼Œæ•°ç»„çš„é»˜è®¤è¡Œä¸ºæ˜¯å¯ä»¥å±•å¼€ã€‚<code>Symbol.isConcatSpreadable</code>å±æ€§ç­‰äº<code>true</code>æˆ–<code>undefined</code>ï¼Œéƒ½æœ‰è¿™ä¸ªæ•ˆæœã€‚</p>
<p>ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ä¹Ÿå¯ä»¥å±•å¼€ï¼Œä½†å®ƒçš„<code>Symbol.isConcatSpreadable</code>å±æ€§é»˜è®¤ä¸º<code>false</code>ï¼Œå¿…é¡»æ‰‹åŠ¨æ‰“å¼€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">length</span>: <span class="number">2</span>, <span class="number">0</span>: <span class="string">'c'</span>, <span class="number">1</span>: <span class="string">'d'</span>&#125;;</div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>].concat(obj, <span class="string">'e'</span>) <span class="comment">// ['a', 'b', obj, 'e']</span></div><div class="line"></div><div class="line">obj[<span class="built_in">Symbol</span>.isConcatSpreadable] = <span class="literal">true</span>;</div><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>].concat(obj, <span class="string">'e'</span>) <span class="comment">// ['a', 'b', 'c', 'd', 'e']</span></div></pre></td></tr></table></figure>
<p>å¯¹äºä¸€ä¸ªç±»æ¥è¯´ï¼Œ<code>Symbol.isConcatSpreadable</code>å±æ€§å¿…é¡»å†™æˆå®ä¾‹çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A1</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(args) &#123;</div><div class="line">    <span class="keyword">super</span>(args);</div><div class="line">    <span class="keyword">this</span>[<span class="built_in">Symbol</span>.isConcatSpreadable] = <span class="literal">true</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">A2</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(args) &#123;</div><div class="line">    <span class="keyword">super</span>(args);</div><div class="line">    <span class="keyword">this</span>[<span class="built_in">Symbol</span>.isConcatSpreadable] = <span class="literal">false</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">let</span> a1 = <span class="keyword">new</span> A1();</div><div class="line">a1[<span class="number">0</span>] = <span class="number">3</span>;</div><div class="line">a1[<span class="number">1</span>] = <span class="number">4</span>;</div><div class="line"><span class="keyword">let</span> a2 = <span class="keyword">new</span> A2();</div><div class="line">a2[<span class="number">0</span>] = <span class="number">5</span>;</div><div class="line">a2[<span class="number">1</span>] = <span class="number">6</span>;</div><div class="line">[<span class="number">1</span>, <span class="number">2</span>].concat(a1).concat(a2)</div><div class="line"><span class="comment">// [1, 2, 3, 4, [5, 6]]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç±»<code>A1</code>æ˜¯å¯å±•å¼€çš„ï¼Œç±»<code>A2</code>æ˜¯ä¸å¯å±•å¼€çš„ï¼Œæ‰€ä»¥ä½¿ç”¨<code>concat</code>æ—¶æœ‰ä¸ä¸€æ ·çš„ç»“æœã€‚</p>
<h3 id="Symbol-species"><a href="#Symbol-species" class="headerlink" title="Symbol.species"></a>Symbol.species</h3><p>å¯¹è±¡çš„<code>Symbol.species</code>å±æ€§ï¼ŒæŒ‡å‘å½“å‰å¯¹è±¡çš„æ„é€ å‡½æ•°ã€‚åˆ›é€ å®ä¾‹æ—¶ï¼Œé»˜è®¤ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œå³ä½¿ç”¨è¿™ä¸ªå±æ€§è¿”å›çš„å‡½æ•°å½“ä½œæ„é€ å‡½æ•°ï¼Œæ¥åˆ›é€ æ–°çš„å®ä¾‹å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyArray</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</div><div class="line">  <span class="comment">// è¦†ç›–çˆ¶ç±» Array çš„æ„é€ å‡½æ•°</span></div><div class="line">  <span class="keyword">static</span> get [<span class="built_in">Symbol</span>.species]() &#123; <span class="keyword">return</span> <span class="built_in">Array</span>; &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­ç±»<code>MyArray</code>ç»§æ‰¿äº†çˆ¶ç±»<code>Array</code>ã€‚åˆ›å»º<code>MyArray</code>çš„å®ä¾‹å¯¹è±¡æ—¶ï¼Œæœ¬æ¥ä¼šè°ƒç”¨å®ƒè‡ªå·±çš„æ„é€ å‡½æ•°ï¼ˆæœ¬ä¾‹ä¸­è¢«çœç•¥äº†ï¼‰ï¼Œä½†æ˜¯ç”±äºå®šä¹‰äº†<code>Symbol.species</code>å±æ€§ï¼Œæ‰€ä»¥ä¼šä½¿ç”¨è¿™ä¸ªå±æ€§è¿”å›çš„çš„å‡½æ•°ï¼Œåˆ›å»º<code>MyArray</code>çš„å®ä¾‹ã€‚</p>
<p>è¿™ä¸ªä¾‹å­ä¹Ÿè¯´æ˜ï¼Œå®šä¹‰<code>Symbol.species</code>å±æ€§è¦é‡‡ç”¨<code>get</code>è¯»å–å™¨ã€‚é»˜è®¤çš„<code>Symbol.species</code>å±æ€§ç­‰åŒäºä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> get [<span class="built_in">Symbol</span>.species]() &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyArray</span> <span class="keyword">extends</span> <span class="title">Array</span> </span>&#123;</div><div class="line">  <span class="keyword">static</span> get [<span class="built_in">Symbol</span>.species]() &#123; <span class="keyword">return</span> <span class="built_in">Array</span>; &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> a = <span class="keyword">new</span> MyArray(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</div><div class="line"><span class="keyword">var</span> mapped = a.map(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</div><div class="line"></div><div class="line">mapped <span class="keyword">instanceof</span> MyArray <span class="comment">// false</span></div><div class="line">mapped <span class="keyword">instanceof</span> <span class="built_in">Array</span> <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºæ„é€ å‡½æ•°è¢«æ›¿æ¢æˆäº†<code>Array</code>ã€‚æ‰€ä»¥ï¼Œ<code>mapped</code>å¯¹è±¡ä¸æ˜¯<code>MyArray</code>çš„å®ä¾‹ï¼Œè€Œæ˜¯<code>Array</code>çš„å®ä¾‹ã€‚</p>
<h3 id="Symbol-match"><a href="#Symbol-match" class="headerlink" title="Symbol.match"></a>Symbol.match</h3><p>å¯¹è±¡çš„<code>Symbol.match</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå‡½æ•°ã€‚å½“æ‰§è¡Œ<code>str.match(myObject)</code>æ—¶ï¼Œå¦‚æœè¯¥å±æ€§å­˜åœ¨ï¼Œä¼šè°ƒç”¨å®ƒï¼Œè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.prototype.match(regexp)</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">regexp[<span class="built_in">Symbol</span>.match](<span class="keyword">this</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyMatcher</span> </span>&#123;</div><div class="line">  [<span class="built_in">Symbol</span>.match](string) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'hello world'</span>.indexOf(string);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="string">'e'</span>.match(<span class="keyword">new</span> MyMatcher()) <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<h3 id="Symbol-replace"><a href="#Symbol-replace" class="headerlink" title="Symbol.replace"></a>Symbol.replace</h3><p>å¯¹è±¡çš„<code>Symbol.replace</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œå½“è¯¥å¯¹è±¡è¢«<code>String.prototype.replace</code>æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.prototype.replace(searchValue, replaceValue)</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">searchValue[<span class="built_in">Symbol</span>.replace](<span class="keyword">this</span>, replaceValue)</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> x = &#123;&#125;;</div><div class="line">x[<span class="built_in">Symbol</span>.replace] = <span class="function">(<span class="params">...s</span>) =&gt;</span> <span class="built_in">console</span>.log(s);</div><div class="line"></div><div class="line"><span class="string">'Hello'</span>.replace(x, <span class="string">'World'</span>) <span class="comment">// ["Hello", "World"]</span></div></pre></td></tr></table></figure>
<p><code>Symbol.replace</code>æ–¹æ³•ä¼šæ”¶åˆ°ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>replace</code>æ–¹æ³•æ­£åœ¨ä½œç”¨çš„å¯¹è±¡ï¼Œä¸Šé¢ä¾‹å­æ˜¯<code>Hello</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ›¿æ¢åçš„å€¼ï¼Œä¸Šé¢ä¾‹å­æ˜¯<code>World</code>ã€‚</p>
<h3 id="Symbol-search"><a href="#Symbol-search" class="headerlink" title="Symbol.search"></a>Symbol.search</h3><p>å¯¹è±¡çš„<code>Symbol.search</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œå½“è¯¥å¯¹è±¡è¢«<code>String.prototype.search</code>æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.prototype.search(regexp)</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">regexp[<span class="built_in">Symbol</span>.search](<span class="keyword">this</span>)</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySearch</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(value) &#123;</div><div class="line">    <span class="keyword">this</span>.value = value;</div><div class="line">  &#125;</div><div class="line">  [<span class="built_in">Symbol</span>.search](string) &#123;</div><div class="line">    <span class="keyword">return</span> string.indexOf(<span class="keyword">this</span>.value);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="string">'foobar'</span>.search(<span class="keyword">new</span> MySearch(<span class="string">'foo'</span>)) <span class="comment">// 0</span></div></pre></td></tr></table></figure>
<h3 id="Symbol-split"><a href="#Symbol-split" class="headerlink" title="Symbol.split"></a>Symbol.split</h3><p>å¯¹è±¡çš„<code>Symbol.split</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ï¼Œå½“è¯¥å¯¹è±¡è¢«<code>String.prototype.split</code>æ–¹æ³•è°ƒç”¨æ—¶ï¼Œä¼šè¿”å›è¯¥æ–¹æ³•çš„è¿”å›å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.prototype.split(separator, limit)</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">separator[<span class="built_in">Symbol</span>.split](<span class="keyword">this</span>, limit)</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MySplitter</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(value) &#123;</div><div class="line">    <span class="keyword">this</span>.value = value;</div><div class="line">  &#125;</div><div class="line">  [<span class="built_in">Symbol</span>.split](string) &#123;</div><div class="line">    <span class="keyword">var</span> index = string.indexOf(<span class="keyword">this</span>.value);</div><div class="line">    <span class="keyword">if</span> (index === <span class="number">-1</span>) &#123;</div><div class="line">      <span class="keyword">return</span> string;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> [</div><div class="line">      string.substr(<span class="number">0</span>, index),</div><div class="line">      string.substr(index + <span class="keyword">this</span>.value.length)</div><div class="line">    ];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="string">'foobar'</span>.split(<span class="keyword">new</span> MySplitter(<span class="string">'foo'</span>))</div><div class="line"><span class="comment">// ['', 'bar']</span></div><div class="line"></div><div class="line"><span class="string">'foobar'</span>.split(<span class="keyword">new</span> MySplitter(<span class="string">'bar'</span>))</div><div class="line"><span class="comment">// ['foo', '']</span></div><div class="line"></div><div class="line"><span class="string">'foobar'</span>.split(<span class="keyword">new</span> MySplitter(<span class="string">'baz'</span>))</div><div class="line"><span class="comment">// 'foobar'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢æ–¹æ³•ä½¿ç”¨<code>Symbol.split</code>æ–¹æ³•ï¼Œé‡æ–°å®šä¹‰äº†å­—ç¬¦ä¸²å¯¹è±¡çš„<code>split</code>æ–¹æ³•çš„è¡Œä¸ºï¼Œ</p>
<h3 id="Symbol-iterator"><a href="#Symbol-iterator" class="headerlink" title="Symbol.iterator"></a>Symbol.iterator</h3><p>å¯¹è±¡çš„<code>Symbol.iterator</code>å±æ€§ï¼ŒæŒ‡å‘è¯¥å¯¹è±¡çš„é»˜è®¤éå†å™¨æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myIterable = &#123;&#125;;</div><div class="line">myIterable[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">[...myIterable] <span class="comment">// [1, 2, 3]</span></div></pre></td></tr></table></figure>
<p>å¯¹è±¡è¿›è¡Œ<code>for...of</code>å¾ªç¯æ—¶ï¼Œä¼šè°ƒç”¨<code>Symbol.iterator</code>æ–¹æ³•ï¼Œè¿”å›è¯¥å¯¹è±¡çš„é»˜è®¤éå†å™¨ï¼Œè¯¦ç»†ä»‹ç»å‚è§ã€ŠIteratorå’Œforâ€¦ofå¾ªç¯ã€‹ä¸€ç« ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Collection</span> </span>&#123;</div><div class="line">  *[<span class="built_in">Symbol</span>.iterator]() &#123;</div><div class="line">    <span class="keyword">let</span> i = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(<span class="keyword">this</span>[i] !== <span class="literal">undefined</span>) &#123;</div><div class="line">      <span class="keyword">yield</span> <span class="keyword">this</span>[i];</div><div class="line">      ++i;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> myCollection = <span class="keyword">new</span> Collection();</div><div class="line">myCollection[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">myCollection[<span class="number">1</span>] = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span>(<span class="keyword">let</span> value <span class="keyword">of</span> myCollection) &#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1</span></div><div class="line"><span class="comment">// 2</span></div></pre></td></tr></table></figure>
<h3 id="Symbol-toPrimitive"><a href="#Symbol-toPrimitive" class="headerlink" title="Symbol.toPrimitive"></a>Symbol.toPrimitive</h3><p>å¯¹è±¡çš„<code>Symbol.toPrimitive</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ã€‚è¯¥å¯¹è±¡è¢«è½¬ä¸ºåŸå§‹ç±»å‹çš„å€¼æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼Œè¿”å›è¯¥å¯¹è±¡å¯¹åº”çš„åŸå§‹ç±»å‹å€¼ã€‚</p>
<p><code>Symbol.toPrimitive</code>è¢«è°ƒç”¨æ—¶ï¼Œä¼šæ¥å—ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºå½“å‰è¿ç®—çš„æ¨¡å¼ï¼Œä¸€å…±æœ‰ä¸‰ç§æ¨¡å¼ã€‚</p>
<ul>
<li>Numberï¼šè¯¥åœºåˆéœ€è¦è½¬æˆæ•°å€¼</li>
<li>Stringï¼šè¯¥åœºåˆéœ€è¦è½¬æˆå­—ç¬¦ä¸²</li>
<li>Defaultï¼šè¯¥åœºåˆå¯ä»¥è½¬æˆæ•°å€¼ï¼Œä¹Ÿå¯ä»¥è½¬æˆå­—ç¬¦ä¸²</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  [<span class="built_in">Symbol</span>.toPrimitive](hint) &#123;</div><div class="line">    <span class="keyword">switch</span> (hint) &#123;</div><div class="line">      <span class="keyword">case</span> <span class="string">'number'</span>:</div><div class="line">        <span class="keyword">return</span> <span class="number">123</span>;</div><div class="line">      <span class="keyword">case</span> <span class="string">'string'</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'str'</span>;</div><div class="line">      <span class="keyword">case</span> <span class="string">'default'</span>:</div><div class="line">        <span class="keyword">return</span> <span class="string">'default'</span>;</div><div class="line">      <span class="keyword">default</span>:</div><div class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>();</div><div class="line">     &#125;</div><div class="line">   &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="number">2</span> * obj <span class="comment">// 246</span></div><div class="line"><span class="number">3</span> + obj <span class="comment">// '3default'</span></div><div class="line">obj == <span class="string">'default'</span> <span class="comment">// true</span></div><div class="line"><span class="built_in">String</span>(obj) <span class="comment">// 'str'</span></div></pre></td></tr></table></figure>
<h3 id="Symbol-toStringTag"><a href="#Symbol-toStringTag" class="headerlink" title="Symbol.toStringTag"></a>Symbol.toStringTag</h3><p>å¯¹è±¡çš„<code>Symbol.toStringTag</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªæ–¹æ³•ã€‚åœ¨è¯¥å¯¹è±¡ä¸Šé¢è°ƒç”¨<code>Object.prototype.toString</code>æ–¹æ³•æ—¶ï¼Œå¦‚æœè¿™ä¸ªå±æ€§å­˜åœ¨ï¼Œå®ƒçš„è¿”å›å€¼ä¼šå‡ºç°åœ¨<code>toString</code>æ–¹æ³•è¿”å›çš„å­—ç¬¦ä¸²ä¹‹ä¸­ï¼Œè¡¨ç¤ºå¯¹è±¡çš„ç±»å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå±æ€§å¯ä»¥ç”¨æ¥å®šåˆ¶<code>[object Object]</code>æˆ–<code>[object Array]</code>ä¸­<code>object</code>åé¢çš„é‚£ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¾‹ä¸€</span></div><div class="line">(&#123;[<span class="built_in">Symbol</span>.toStringTag]: <span class="string">'Foo'</span>&#125;.toString())</div><div class="line"><span class="comment">// "[object Foo]"</span></div><div class="line"></div><div class="line"><span class="comment">// ä¾‹äºŒ</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Collection</span> </span>&#123;</div><div class="line">  get [<span class="built_in">Symbol</span>.toStringTag]() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'xxx'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> Collection();</div><div class="line"><span class="built_in">Object</span>.prototype.toString.call(x) <span class="comment">// "[object xxx]"</span></div></pre></td></tr></table></figure>
<p>ES6æ–°å¢å†…ç½®å¯¹è±¡çš„<code>Symbol.toStringTag</code>å±æ€§å€¼å¦‚ä¸‹ã€‚</p>
<ul>
<li><code>JSON[Symbol.toStringTag]</code>ï¼šâ€™JSONâ€™</li>
<li><code>Math[Symbol.toStringTag]</code>ï¼šâ€™Mathâ€™</li>
<li>Moduleå¯¹è±¡<code>M[Symbol.toStringTag]</code>ï¼šâ€™Moduleâ€™</li>
<li><code>ArrayBuffer.prototype[Symbol.toStringTag]</code>ï¼šâ€™ArrayBufferâ€™</li>
<li><code>DataView.prototype[Symbol.toStringTag]</code>ï¼šâ€™DataViewâ€™</li>
<li><code>Map.prototype[Symbol.toStringTag]</code>ï¼šâ€™Mapâ€™</li>
<li><code>Promise.prototype[Symbol.toStringTag]</code>ï¼šâ€™Promiseâ€™</li>
<li><code>Set.prototype[Symbol.toStringTag]</code>ï¼šâ€™Setâ€™</li>
<li><code>%TypedArray%.prototype[Symbol.toStringTag]</code>ï¼šâ€™Uint8Arrayâ€™ç­‰</li>
<li><code>WeakMap.prototype[Symbol.toStringTag]</code>ï¼šâ€™WeakMapâ€™</li>
<li><code>WeakSet.prototype[Symbol.toStringTag]</code>ï¼šâ€™WeakSetâ€™</li>
<li><code>%MapIteratorPrototype%[Symbol.toStringTag]</code>ï¼šâ€™Map Iteratorâ€™</li>
<li><code>%SetIteratorPrototype%[Symbol.toStringTag]</code>ï¼šâ€™Set Iteratorâ€™</li>
<li><code>%StringIteratorPrototype%[Symbol.toStringTag]</code>ï¼šâ€™String Iteratorâ€™</li>
<li><code>Symbol.prototype[Symbol.toStringTag]</code>ï¼šâ€™Symbolâ€™</li>
<li><code>Generator.prototype[Symbol.toStringTag]</code>ï¼šâ€™Generatorâ€™</li>
<li><code>GeneratorFunction.prototype[Symbol.toStringTag]</code>ï¼šâ€™GeneratorFunctionâ€™</li>
</ul>
<h3 id="Symbol-unscopables"><a href="#Symbol-unscopables" class="headerlink" title="Symbol.unscopables"></a>Symbol.unscopables</h3><p>å¯¹è±¡çš„<code>Symbol.unscopables</code>å±æ€§ï¼ŒæŒ‡å‘ä¸€ä¸ªå¯¹è±¡ã€‚è¯¥å¯¹è±¡æŒ‡å®šäº†ä½¿ç”¨<code>with</code>å…³é”®å­—æ—¶ï¼Œå“ªäº›å±æ€§ä¼šè¢«<code>with</code>ç¯å¢ƒæ’é™¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.unscopables]</div><div class="line"><span class="comment">// &#123;</span></div><div class="line"><span class="comment">//   copyWithin: true,</span></div><div class="line"><span class="comment">//   entries: true,</span></div><div class="line"><span class="comment">//   fill: true,</span></div><div class="line"><span class="comment">//   find: true,</span></div><div class="line"><span class="comment">//   findIndex: true,</span></div><div class="line"><span class="comment">//   keys: true</span></div><div class="line"><span class="comment">// &#125;</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.keys(<span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.unscopables])</div><div class="line"><span class="comment">// ['copyWithin', 'entries', 'fill', 'find', 'findIndex', 'keys']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼Œæ•°ç»„æœ‰6ä¸ªå±æ€§ï¼Œä¼šè¢«withå‘½ä»¤æ’é™¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ²¡æœ‰unscopablesæ—¶</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</div><div class="line">  foo() &#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;;</div><div class="line"></div><div class="line"><span class="keyword">with</span> (MyClass.prototype) &#123;</div><div class="line">  foo(); <span class="comment">// 1</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æœ‰unscopablesæ—¶</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> </span>&#123;</div><div class="line">  foo() &#123; <span class="keyword">return</span> <span class="number">1</span>; &#125;</div><div class="line">  get [<span class="built_in">Symbol</span>.unscopables]() &#123;</div><div class="line">    <span class="keyword">return</span> &#123; <span class="attr">foo</span>: <span class="literal">true</span> &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> foo = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">2</span>; &#125;;</div><div class="line"></div><div class="line"><span class="keyword">with</span> (MyClass.prototype) &#123;</div><div class="line">  foo(); <span class="comment">// 2</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Symbol&quot;&gt;&lt;a href=&quot;#Symbol&quot; class=&quot;headerlink&quot; title=&quot;Symbol&quot;&gt;&lt;/a&gt;Symbol&lt;/h1&gt;&lt;h2 id=&quot;æ¦‚è¿°&quot;&gt;&lt;a href=&quot;#æ¦‚è¿°&quot; class=&quot;headerlink&quot; title=&quot;æ¦‚è¿°&quot;&gt;&lt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Symbol" scheme="http://microzz.com/tags/Symbol/"/>
    
  </entry>
  
  <entry>
    <title>å¯¹è±¡çš„æ‰©å±•(Object)</title>
    <link href="http://microzz.com/2016/12/25/object/"/>
    <id>http://microzz.com/2016/12/25/object/</id>
    <published>2016-12-25T04:45:19.000Z</published>
    <updated>2017-01-12T08:11:32.965Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å¯¹è±¡çš„æ‰©å±•"><a href="#å¯¹è±¡çš„æ‰©å±•" class="headerlink" title="å¯¹è±¡çš„æ‰©å±•"></a>å¯¹è±¡çš„æ‰©å±•</h1><h2 id="å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•"><a href="#å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•" class="headerlink" title="å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•"></a>å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•</h2><p>ES6å…è®¸ç›´æ¥å†™å…¥å˜é‡å’Œå‡½æ•°ï¼Œä½œä¸ºå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚è¿™æ ·çš„ä¹¦å†™æ›´åŠ ç®€æ´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> foo = <span class="string">'bar'</span>;</div><div class="line"><span class="keyword">var</span> baz = &#123;foo&#125;;</div><div class="line">baz <span class="comment">// &#123;foo: "bar"&#125;</span></div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">var</span> baz = &#123;<span class="attr">foo</span>: foo&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨æ˜ï¼ŒES6 å…è®¸åœ¨å¯¹è±¡ä¹‹ä¸­ï¼Œç›´æ¥å†™å˜é‡ã€‚è¿™æ—¶ï¼Œå±æ€§åä¸ºå˜é‡å, å±æ€§å€¼ä¸ºå˜é‡çš„å€¼ã€‚ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;x, y&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;<span class="attr">x</span>: x, <span class="attr">y</span>: y&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">f(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// Object &#123;x: 1, y: 2&#125;</span></div></pre></td></tr></table></figure>
<p>é™¤äº†å±æ€§ç®€å†™ï¼Œæ–¹æ³•ä¹Ÿå¯ä»¥ç®€å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = &#123;</div><div class="line">  method() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"Hello!"</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> o = &#123;</div><div class="line">  <span class="attr">method</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">"Hello!"</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®é™…çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> birth = <span class="string">'2000/01/01'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> Person = &#123;</div><div class="line"></div><div class="line">  <span class="attr">name</span>: <span class="string">'å¼ ä¸‰'</span>,</div><div class="line"></div><div class="line">  <span class="comment">//ç­‰åŒäºbirth: birth</span></div><div class="line">  birth,</div><div class="line"></div><div class="line">  <span class="comment">// ç­‰åŒäºhello: function ()...</span></div><div class="line">  hello() &#123; <span class="built_in">console</span>.log(<span class="string">'æˆ‘çš„åå­—æ˜¯'</span>, <span class="keyword">this</span>.name); &#125;</div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>è¿™ç§å†™æ³•ç”¨äºå‡½æ•°çš„è¿”å›å€¼ï¼Œå°†ä¼šéå¸¸æ–¹ä¾¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPoint</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> x = <span class="number">1</span>;</div><div class="line">  <span class="keyword">var</span> y = <span class="number">10</span>;</div><div class="line">  <span class="keyword">return</span> &#123;x, y&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">getPoint()</div><div class="line"><span class="comment">// &#123;x:1, y:10&#125;</span></div></pre></td></tr></table></figure>
<p>CommonJSæ¨¡å—è¾“å‡ºå˜é‡ï¼Œå°±éå¸¸åˆé€‚ä½¿ç”¨ç®€æ´å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> ms = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getItem</span> (<span class="params">key</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> key <span class="keyword">in</span> ms ? ms[key] : <span class="literal">null</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">setItem</span> (<span class="params">key, value</span>) </span>&#123;</div><div class="line">  ms[key] = value;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clear</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  ms = &#123;&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123; getItem, setItem, clear &#125;;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">getItem</span>: getItem,</div><div class="line">  <span class="attr">setItem</span>: setItem,</div><div class="line">  <span class="attr">clear</span>: clear</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å±æ€§çš„èµ‹å€¼å™¨ï¼ˆsetterï¼‰å’Œå–å€¼å™¨ï¼ˆgetterï¼‰ï¼Œäº‹å®ä¸Šä¹Ÿæ˜¯é‡‡ç”¨è¿™ç§å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> cart = &#123;</div><div class="line">  <span class="attr">_wheels</span>: <span class="number">4</span>,</div><div class="line"></div><div class="line">  get wheels () &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._wheels;</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  set wheels (value) &#123;</div><div class="line">    <span class="keyword">if</span> (value &lt; <span class="keyword">this</span>._wheels) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'æ•°å€¼å¤ªå°äº†ï¼'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">this</span>._wheels = value;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œç®€æ´å†™æ³•çš„å±æ€§åæ€»æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™ä¼šå¯¼è‡´ä¸€äº›çœ‹ä¸Šå»æ¯”è¾ƒå¥‡æ€ªçš„ç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="class"><span class="keyword">class</span> () </span>&#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="string">'class'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>class</code>æ˜¯å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸ä¼šå› ä¸ºå®ƒå±äºå…³é”®å­—ï¼Œè€Œå¯¼è‡´è¯­æ³•è§£ææŠ¥é”™ã€‚</p>
<p>å¦‚æœæŸä¸ªæ–¹æ³•çš„å€¼æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ï¼Œå‰é¢éœ€è¦åŠ ä¸Šæ˜Ÿå·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  * m()&#123;</div><div class="line">    <span class="keyword">yield</span> <span class="string">'hello world'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h2 id="å±æ€§åè¡¨è¾¾å¼"><a href="#å±æ€§åè¡¨è¾¾å¼" class="headerlink" title="å±æ€§åè¡¨è¾¾å¼"></a>å±æ€§åè¡¨è¾¾å¼</h2><p>JavaScriptè¯­è¨€å®šä¹‰å¯¹è±¡çš„å±æ€§ï¼Œæœ‰ä¸¤ç§æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ–¹æ³•ä¸€</span></div><div class="line">obj.foo = <span class="literal">true</span>;</div><div class="line"></div><div class="line"><span class="comment">// æ–¹æ³•äºŒ</span></div><div class="line">obj[<span class="string">'a'</span> + <span class="string">'bc'</span>] = <span class="number">123</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„æ–¹æ³•ä¸€æ˜¯ç›´æ¥ç”¨æ ‡è¯†ç¬¦ä½œä¸ºå±æ€§åï¼Œæ–¹æ³•äºŒæ˜¯ç”¨è¡¨è¾¾å¼ä½œä¸ºå±æ€§åï¼Œè¿™æ—¶è¦å°†è¡¨è¾¾å¼æ”¾åœ¨æ–¹æ‹¬å·ä¹‹å†…ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœä½¿ç”¨å­—é¢é‡æ–¹å¼å®šä¹‰å¯¹è±¡ï¼ˆä½¿ç”¨å¤§æ‹¬å·ï¼‰ï¼Œåœ¨ ES5 ä¸­åªèƒ½ä½¿ç”¨æ–¹æ³•ä¸€ï¼ˆæ ‡è¯†ç¬¦ï¼‰å®šä¹‰å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">abc</span>: <span class="number">123</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ES6 å…è®¸å­—é¢é‡å®šä¹‰å¯¹è±¡æ—¶ï¼Œç”¨æ–¹æ³•äºŒï¼ˆè¡¨è¾¾å¼ï¼‰ä½œä¸ºå¯¹è±¡çš„å±æ€§åï¼Œå³æŠŠè¡¨è¾¾å¼æ”¾åœ¨æ–¹æ‹¬å·å†…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> propKey = <span class="string">'foo'</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  [propKey]: <span class="literal">true</span>,</div><div class="line">  [<span class="string">'a'</span> + <span class="string">'bc'</span>]: <span class="number">123</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> lastWord = <span class="string">'last word'</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = &#123;</div><div class="line">  <span class="string">'first word'</span>: <span class="string">'hello'</span>,</div><div class="line">  [lastWord]: <span class="string">'world'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">a[<span class="string">'first word'</span>] <span class="comment">// "hello"</span></div><div class="line">a[lastWord] <span class="comment">// "world"</span></div><div class="line">a[<span class="string">'last word'</span>] <span class="comment">// "world"</span></div></pre></td></tr></table></figure>
<p>è¡¨è¾¾å¼è¿˜å¯ä»¥ç”¨äºå®šä¹‰æ–¹æ³•åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  [<span class="string">'h'</span> + <span class="string">'ello'</span>]() &#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">'hi'</span>;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj.hello() <span class="comment">// hi</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œå±æ€§åè¡¨è¾¾å¼ä¸ç®€æ´è¡¨ç¤ºæ³•ï¼Œä¸èƒ½åŒæ—¶ä½¿ç”¨ï¼Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">var</span> foo = <span class="string">'bar'</span>;</div><div class="line"><span class="keyword">var</span> bar = <span class="string">'abc'</span>;</div><div class="line"><span class="keyword">var</span> baz = &#123; [foo] &#125;;</div><div class="line"></div><div class="line"><span class="comment">// æ­£ç¡®</span></div><div class="line"><span class="keyword">var</span> foo = <span class="string">'bar'</span>;</div><div class="line"><span class="keyword">var</span> baz = &#123; [foo]: <span class="string">'abc'</span>&#125;;</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œå±æ€§åè¡¨è¾¾å¼å¦‚æœæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šè‡ªåŠ¨å°†å¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²<code>[object Object]</code>ï¼Œè¿™ä¸€ç‚¹è¦ç‰¹åˆ«å°å¿ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> keyA = &#123;<span class="attr">a</span>: <span class="number">1</span>&#125;;</div><div class="line"><span class="keyword">const</span> keyB = &#123;<span class="attr">b</span>: <span class="number">2</span>&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> myObject = &#123;</div><div class="line">  [keyA]: <span class="string">'valueA'</span>,</div><div class="line">  [keyB]: <span class="string">'valueB'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line">myObject <span class="comment">// Object &#123;[object Object]: "valueB"&#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>[keyA]</code>å’Œ<code>[keyB]</code>å¾—åˆ°çš„éƒ½æ˜¯<code>[object Object]</code>ï¼Œæ‰€ä»¥<code>[keyB]</code>ä¼šæŠŠ<code>[keyA]</code>è¦†ç›–æ‰ï¼Œè€Œ<code>myObject</code>æœ€ååªæœ‰ä¸€ä¸ª<code>[object Object]</code>å±æ€§ã€‚</p>
<h2 id="æ–¹æ³•çš„-name-å±æ€§"><a href="#æ–¹æ³•çš„-name-å±æ€§" class="headerlink" title="æ–¹æ³•çš„ name å±æ€§"></a>æ–¹æ³•çš„ name å±æ€§</h2><p>å‡½æ•°çš„<code>name</code>å±æ€§ï¼Œè¿”å›å‡½æ•°åã€‚å¯¹è±¡æ–¹æ³•ä¹Ÿæ˜¯å‡½æ•°ï¼Œå› æ­¤ä¹Ÿæœ‰<code>name</code>å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> person = &#123;</div><div class="line">  sayName() &#123;</div><div class="line"> Â  Â <span class="built_in">console</span>.log(<span class="string">'hello!'</span>);</div><div class="line">  &#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line">person.sayName.name   <span class="comment">// "sayName"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ–¹æ³•çš„<code>name</code>å±æ€§è¿”å›å‡½æ•°åï¼ˆå³æ–¹æ³•åï¼‰ã€‚</p>
<p>å¦‚æœå¯¹è±¡çš„æ–¹æ³•ä½¿ç”¨äº†å–å€¼å‡½æ•°ï¼ˆ<code>getter</code>ï¼‰å’Œå­˜å€¼å‡½æ•°ï¼ˆ<code>setter</code>ï¼‰ï¼Œåˆ™<code>name</code>å±æ€§ä¸æ˜¯åœ¨è¯¥æ–¹æ³•ä¸Šé¢ï¼Œè€Œæ˜¯è¯¥æ–¹æ³•çš„å±æ€§çš„æè¿°å¯¹è±¡çš„<code>get</code>å’Œ<code>set</code>å±æ€§ä¸Šé¢ï¼Œè¿”å›å€¼æ˜¯æ–¹æ³•åå‰åŠ ä¸Š<code>get</code>å’Œ<code>set</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">  get foo() &#123;&#125;,</div><div class="line">  set foo(x) &#123;&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">obj.foo.name</div><div class="line"><span class="comment">// TypeError: Cannot read property 'name' of undefined</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> descriptor = <span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'foo'</span>);</div><div class="line"></div><div class="line">descriptor.get.name <span class="comment">// "get foo"</span></div><div class="line">descriptor.set.name <span class="comment">// "set foo"</span></div></pre></td></tr></table></figure>
<p>æœ‰ä¸¤ç§ç‰¹æ®Šæƒ…å†µï¼š<code>bind</code>æ–¹æ³•åˆ›é€ çš„å‡½æ•°ï¼Œ<code>name</code>å±æ€§è¿”å›<code>bound</code>åŠ ä¸ŠåŸå‡½æ•°çš„åå­—ï¼›<code>Function</code>æ„é€ å‡½æ•°åˆ›é€ çš„å‡½æ•°ï¼Œ<code>name</code>å±æ€§è¿”å›<code>anonymous</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">new</span> <span class="built_in">Function</span>()).name <span class="comment">// "anonymous"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> doSomething = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;;</div><div class="line">doSomething.bind().name <span class="comment">// "bound doSomething"</span></div></pre></td></tr></table></figure>
<p>å¦‚æœå¯¹è±¡çš„æ–¹æ³•æ˜¯ä¸€ä¸ª Symbol å€¼ï¼Œé‚£ä¹ˆ<code>name</code>å±æ€§è¿”å›çš„æ˜¯è¿™ä¸ª Symbol å€¼çš„æè¿°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> key1 = <span class="built_in">Symbol</span>(<span class="string">'description'</span>);</div><div class="line"><span class="keyword">const</span> key2 = <span class="built_in">Symbol</span>();</div><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  [key1]() &#123;&#125;,</div><div class="line">  [key2]() &#123;&#125;,</div><div class="line">&#125;;</div><div class="line">obj[key1].name <span class="comment">// "[description]"</span></div><div class="line">obj[key2].name <span class="comment">// ""</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>key1</code>å¯¹åº”çš„ Symbol å€¼æœ‰æè¿°ï¼Œ<code>key2</code>æ²¡æœ‰ã€‚</p>
<h2 id="Object-is"><a href="#Object-is" class="headerlink" title="Object.is()"></a>Object.is()</h2><p>ES5æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œåªæœ‰ä¸¤ä¸ªè¿ç®—ç¬¦ï¼šç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ<code>==</code>ï¼‰å’Œä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ<code>===</code>ï¼‰ã€‚å®ƒä»¬éƒ½æœ‰ç¼ºç‚¹ï¼Œå‰è€…ä¼šè‡ªåŠ¨è½¬æ¢æ•°æ®ç±»å‹ï¼Œåè€…çš„<code>NaN</code>ä¸ç­‰äºè‡ªèº«ï¼Œä»¥åŠ<code>+0</code>ç­‰äº<code>-0</code>ã€‚JavaScriptç¼ºä¹ä¸€ç§è¿ç®—ï¼Œåœ¨æ‰€æœ‰ç¯å¢ƒä¸­ï¼Œåªè¦ä¸¤ä¸ªå€¼æ˜¯ä¸€æ ·çš„ï¼Œå®ƒä»¬å°±åº”è¯¥ç›¸ç­‰ã€‚</p>
<p>ES6æå‡ºâ€œSame-value equalityâ€ï¼ˆåŒå€¼ç›¸ç­‰ï¼‰ç®—æ³•ï¼Œç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚<code>Object.is</code>å°±æ˜¯éƒ¨ç½²è¿™ä¸ªç®—æ³•çš„æ–°æ–¹æ³•ã€‚å®ƒç”¨æ¥æ¯”è¾ƒä¸¤ä¸ªå€¼æ˜¯å¦ä¸¥æ ¼ç›¸ç­‰ï¼Œä¸ä¸¥æ ¼æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ===ï¼‰çš„è¡Œä¸ºåŸºæœ¬ä¸€è‡´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.is(<span class="string">'foo'</span>, <span class="string">'foo'</span>)</div><div class="line"><span class="comment">// true</span></div><div class="line"><span class="built_in">Object</span>.is(&#123;&#125;, &#123;&#125;)</div><div class="line"><span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸åŒä¹‹å¤„åªæœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯<code>+0</code>ä¸ç­‰äº<code>-0</code>ï¼ŒäºŒæ˜¯<code>NaN</code>ç­‰äºè‡ªèº«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+<span class="number">0</span> === <span class="number">-0</span> <span class="comment">//true</span></div><div class="line"><span class="literal">NaN</span> === <span class="literal">NaN</span> <span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.is(+<span class="number">0</span>, <span class="number">-0</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Object</span>.is(<span class="literal">NaN</span>, <span class="literal">NaN</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ES5å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œéƒ¨ç½²<code>Object.is</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">Object</span>, <span class="string">'is'</span>, &#123;</div><div class="line">  <span class="attr">value</span>: <span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">    <span class="keyword">if</span> (x === y) &#123;</div><div class="line">      <span class="comment">// é’ˆå¯¹+0 ä¸ç­‰äº -0çš„æƒ…å†µ</span></div><div class="line">      <span class="keyword">return</span> x !== <span class="number">0</span> || <span class="number">1</span> / x === <span class="number">1</span> / y;</div><div class="line">    &#125;</div><div class="line">    <span class="comment">// é’ˆå¯¹NaNçš„æƒ…å†µ</span></div><div class="line">    <span class="keyword">return</span> x !== x &amp;&amp; y !== y;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">configurable</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">enumerable</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">writable</span>: <span class="literal">true</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="Object-assign"><a href="#Object-assign" class="headerlink" title="Object.assign()"></a>Object.assign()</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p><code>Object.assign</code>æ–¹æ³•ç”¨äºå¯¹è±¡çš„åˆå¹¶ï¼Œå°†æºå¯¹è±¡ï¼ˆsourceï¼‰çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼Œå¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ï¼ˆtargetï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> source1 = &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;;</div><div class="line"><span class="keyword">var</span> source2 = &#123; <span class="attr">c</span>: <span class="number">3</span> &#125;;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.assign(target, source1, source2);</div><div class="line">target <span class="comment">// &#123;a:1, b:2, c:3&#125;</span></div></pre></td></tr></table></figure>
<p><code>Object.assign</code>æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œåé¢çš„å‚æ•°éƒ½æ˜¯æºå¯¹è±¡ã€‚</p>
<p>æ³¨æ„ï¼Œå¦‚æœç›®æ ‡å¯¹è±¡ä¸æºå¯¹è±¡æœ‰åŒåå±æ€§ï¼Œæˆ–å¤šä¸ªæºå¯¹è±¡æœ‰åŒåå±æ€§ï¼Œåˆ™åé¢çš„å±æ€§ä¼šè¦†ç›–å‰é¢çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">1</span> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> source1 = &#123; <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">2</span> &#125;;</div><div class="line"><span class="keyword">var</span> source2 = &#123; <span class="attr">c</span>: <span class="number">3</span> &#125;;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.assign(target, source1, source2);</div><div class="line">target <span class="comment">// &#123;a:1, b:2, c:3&#125;</span></div></pre></td></tr></table></figure>
<p>å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œ<code>Object.assign</code>ä¼šç›´æ¥è¿”å›è¯¥å‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>: <span class="number">1</span>&#125;;</div><div class="line"><span class="built_in">Object</span>.assign(obj) === obj <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè¯¥å‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œåˆ™ä¼šå…ˆè½¬æˆå¯¹è±¡ï¼Œç„¶åè¿”å›ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> <span class="built_in">Object</span>.assign(<span class="number">2</span>) <span class="comment">// "object"</span></div></pre></td></tr></table></figure>
<p>ç”±äº<code>undefined</code>å’Œ<code>null</code>æ— æ³•è½¬æˆå¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æœå®ƒä»¬ä½œä¸ºå‚æ•°ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.assign(<span class="literal">undefined</span>) <span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="built_in">Object</span>.assign(<span class="literal">null</span>) <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>å¦‚æœéå¯¹è±¡å‚æ•°å‡ºç°åœ¨æºå¯¹è±¡çš„ä½ç½®ï¼ˆå³éé¦–å‚æ•°ï¼‰ï¼Œé‚£ä¹ˆå¤„ç†è§„åˆ™æœ‰æ‰€ä¸åŒã€‚é¦–å…ˆï¼Œè¿™äº›å‚æ•°éƒ½ä¼šè½¬æˆå¯¹è±¡ï¼Œå¦‚æœæ— æ³•è½¬æˆå¯¹è±¡ï¼Œå°±ä¼šè·³è¿‡ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœ<code>undefined</code>å’Œ<code>null</code>ä¸åœ¨é¦–å‚æ•°ï¼Œå°±ä¸ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="number">1</span>&#125;;</div><div class="line"><span class="built_in">Object</span>.assign(obj, <span class="literal">undefined</span>) === obj <span class="comment">// true</span></div><div class="line"><span class="built_in">Object</span>.assign(obj, <span class="literal">null</span>) === obj <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å…¶ä»–ç±»å‹çš„å€¼ï¼ˆå³æ•°å€¼ã€å­—ç¬¦ä¸²å’Œå¸ƒå°”å€¼ï¼‰ä¸åœ¨é¦–å‚æ•°ï¼Œä¹Ÿä¸ä¼šæŠ¥é”™ã€‚ä½†æ˜¯ï¼Œé™¤äº†å­—ç¬¦ä¸²ä¼šä»¥æ•°ç»„å½¢å¼ï¼Œæ‹·è´å…¥ç›®æ ‡å¯¹è±¡ï¼Œå…¶ä»–å€¼éƒ½ä¸ä¼šäº§ç”Ÿæ•ˆæœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> v1 = <span class="string">'abc'</span>;</div><div class="line"><span class="keyword">var</span> v2 = <span class="literal">true</span>;</div><div class="line"><span class="keyword">var</span> v3 = <span class="number">10</span>;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.assign(&#123;&#125;, v1, v2, v3);</div><div class="line"><span class="built_in">console</span>.log(obj); <span class="comment">// &#123; "0": "a", "1": "b", "2": "c" &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>v1</code>ã€<code>v2</code>ã€<code>v3</code>åˆ†åˆ«æ˜¯å­—ç¬¦ä¸²ã€å¸ƒå°”å€¼å’Œæ•°å€¼ï¼Œç»“æœåªæœ‰å­—ç¬¦ä¸²åˆå…¥ç›®æ ‡å¯¹è±¡ï¼ˆä»¥å­—ç¬¦æ•°ç»„çš„å½¢å¼ï¼‰ï¼Œæ•°å€¼å’Œå¸ƒå°”å€¼éƒ½ä¼šè¢«å¿½ç•¥ã€‚è¿™æ˜¯å› ä¸ºåªæœ‰å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡ï¼Œä¼šäº§ç”Ÿå¯æšä¸¾å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>(<span class="literal">true</span>) <span class="comment">// &#123;[[PrimitiveValue]]: true&#125;</span></div><div class="line"><span class="built_in">Object</span>(<span class="number">10</span>)  <span class="comment">//  &#123;[[PrimitiveValue]]: 10&#125;</span></div><div class="line"><span class="built_in">Object</span>(<span class="string">'abc'</span>) <span class="comment">// &#123;0: "a", 1: "b", 2: "c", length: 3, [[PrimitiveValue]]: "abc"&#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¸ƒå°”å€¼ã€æ•°å€¼ã€å­—ç¬¦ä¸²åˆ†åˆ«è½¬æˆå¯¹åº”çš„åŒ…è£…å¯¹è±¡ï¼Œå¯ä»¥çœ‹åˆ°å®ƒä»¬çš„åŸå§‹å€¼éƒ½åœ¨åŒ…è£…å¯¹è±¡çš„å†…éƒ¨å±æ€§<code>[[PrimitiveValue]]</code>ä¸Šé¢ï¼Œè¿™ä¸ªå±æ€§æ˜¯ä¸ä¼šè¢«<code>Object.assign</code>æ‹·è´çš„ã€‚åªæœ‰å­—ç¬¦ä¸²çš„åŒ…è£…å¯¹è±¡ï¼Œä¼šäº§ç”Ÿå¯æšä¸¾çš„å®ä¹‰å±æ€§ï¼Œé‚£äº›å±æ€§åˆ™ä¼šè¢«æ‹·è´ã€‚</p>
<p><code>Object.assign</code>æ‹·è´çš„å±æ€§æ˜¯æœ‰é™åˆ¶çš„ï¼Œåªæ‹·è´æºå¯¹è±¡çš„è‡ªèº«å±æ€§ï¼ˆä¸æ‹·è´ç»§æ‰¿å±æ€§ï¼‰ï¼Œä¹Ÿä¸æ‹·è´ä¸å¯æšä¸¾çš„å±æ€§ï¼ˆ<code>enumerable: false</code>ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.assign(&#123;<span class="attr">b</span>: <span class="string">'c'</span>&#125;,</div><div class="line">  <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'invisible'</span>, &#123;</div><div class="line">    <span class="attr">enumerable</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">value</span>: <span class="string">'hello'</span></div><div class="line">  &#125;)</div><div class="line">)</div><div class="line"><span class="comment">// &#123; b: 'c' &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Object.assign</code>è¦æ‹·è´çš„å¯¹è±¡åªæœ‰ä¸€ä¸ªä¸å¯æšä¸¾å±æ€§<code>invisible</code>ï¼Œè¿™ä¸ªå±æ€§å¹¶æ²¡æœ‰è¢«æ‹·è´è¿›å»ã€‚</p>
<p>å±æ€§åä¸ºSymbolå€¼çš„å±æ€§ï¼Œä¹Ÿä¼šè¢«<code>Object.assign</code>æ‹·è´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.assign(&#123; <span class="attr">a</span>: <span class="string">'b'</span> &#125;, &#123; [<span class="built_in">Symbol</span>(<span class="string">'c'</span>)]: <span class="string">'d'</span> &#125;)</div><div class="line"><span class="comment">// &#123; a: 'b', Symbol(c): 'd' &#125;</span></div></pre></td></tr></table></figure>
<h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><p><code>Object.assign</code>æ–¹æ³•å®è¡Œçš„æ˜¯æµ…æ‹·è´ï¼Œè€Œä¸æ˜¯æ·±æ‹·è´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæºå¯¹è±¡æŸä¸ªå±æ€§çš„å€¼æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç›®æ ‡å¯¹è±¡æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj1 = &#123;<span class="attr">a</span>: &#123;<span class="attr">b</span>: <span class="number">1</span>&#125;&#125;;</div><div class="line"><span class="keyword">var</span> obj2 = <span class="built_in">Object</span>.assign(&#123;&#125;, obj1);</div><div class="line"></div><div class="line">obj1.a.b = <span class="number">2</span>;</div><div class="line">obj2.a.b <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæºå¯¹è±¡<code>obj1</code>çš„<code>a</code>å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œ<code>Object.assign</code>æ‹·è´å¾—åˆ°çš„æ˜¯è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚è¿™ä¸ªå¯¹è±¡çš„ä»»ä½•å˜åŒ–ï¼Œéƒ½ä¼šåæ˜ åˆ°ç›®æ ‡å¯¹è±¡ä¸Šé¢ã€‚</p>
<p>å¯¹äºè¿™ç§åµŒå¥—çš„å¯¹è±¡ï¼Œä¸€æ—¦é‡åˆ°åŒåå±æ€§ï¼Œ<code>Object.assign</code>çš„å¤„ç†æ–¹æ³•æ˜¯æ›¿æ¢ï¼Œè€Œä¸æ˜¯æ·»åŠ ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> target = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="string">'c'</span>, <span class="attr">d</span>: <span class="string">'e'</span> &#125; &#125;</div><div class="line"><span class="keyword">var</span> source = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="string">'hello'</span> &#125; &#125;</div><div class="line"><span class="built_in">Object</span>.assign(target, source)</div><div class="line"><span class="comment">// &#123; a: &#123; b: 'hello' &#125; &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>target</code>å¯¹è±¡çš„<code>a</code>å±æ€§è¢«<code>source</code>å¯¹è±¡çš„<code>a</code>å±æ€§æ•´ä¸ªæ›¿æ¢æ‰äº†ï¼Œè€Œä¸ä¼šå¾—åˆ°<code>{ a: { b: &#39;hello&#39;, d: &#39;e&#39; } }</code>çš„ç»“æœã€‚è¿™é€šå¸¸ä¸æ˜¯å¼€å‘è€…æƒ³è¦çš„ï¼Œéœ€è¦ç‰¹åˆ«å°å¿ƒã€‚</p>
<p>æœ‰ä¸€äº›å‡½æ•°åº“æä¾›<code>Object.assign</code>çš„å®šåˆ¶ç‰ˆæœ¬ï¼ˆæ¯”å¦‚Lodashçš„<code>_.defaultsDeep</code>æ–¹æ³•ï¼‰ï¼Œå¯ä»¥è§£å†³æµ…æ‹·è´çš„é—®é¢˜ï¼Œå¾—åˆ°æ·±æ‹·è´çš„åˆå¹¶ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>Object.assign</code>å¯ä»¥ç”¨æ¥å¤„ç†æ•°ç»„ï¼Œä½†æ˜¯ä¼šæŠŠæ•°ç»„è§†ä¸ºå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.assign([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>])</div><div class="line"><span class="comment">// [4, 5, 3]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Object.assign</code>æŠŠæ•°ç»„è§†ä¸ºå±æ€§åä¸º0ã€1ã€2çš„å¯¹è±¡ï¼Œå› æ­¤æºæ•°ç»„çš„0å·å±æ€§<code>4</code>è¦†ç›–äº†ç›®æ ‡æ•°ç»„çš„0å·å±æ€§<code>1</code>ã€‚</p>
<h3 id="å¸¸è§ç”¨é€”"><a href="#å¸¸è§ç”¨é€”" class="headerlink" title="å¸¸è§ç”¨é€”"></a>å¸¸è§ç”¨é€”</h3><p><code>Object.assign</code>æ–¹æ³•æœ‰å¾ˆå¤šç”¨å¤„ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰ä¸ºå¯¹è±¡æ·»åŠ å±æ€§</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(x, y) &#123;</div><div class="line">    <span class="built_in">Object</span>.assign(<span class="keyword">this</span>, &#123;x, y&#125;);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢æ–¹æ³•é€šè¿‡<code>Object.assign</code>æ–¹æ³•ï¼Œå°†<code>x</code>å±æ€§å’Œ<code>y</code>å±æ€§æ·»åŠ åˆ°<code>Point</code>ç±»çš„å¯¹è±¡å®ä¾‹ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰ä¸ºå¯¹è±¡æ·»åŠ æ–¹æ³•</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.assign(SomeClass.prototype, &#123;</div><div class="line">  someMethod(arg1, arg2) &#123;</div><div class="line">    Â·Â·Â·</div><div class="line">  &#125;,</div><div class="line">  anotherMethod() &#123;</div><div class="line">    Â·Â·Â·</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäºä¸‹é¢çš„å†™æ³•</span></div><div class="line">SomeClass.prototype.someMethod = <span class="function"><span class="keyword">function</span> (<span class="params">arg1, arg2</span>) </span>&#123;</div><div class="line">  Â·Â·Â·</div><div class="line">&#125;;</div><div class="line">SomeClass.prototype.anotherMethod = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  Â·Â·Â·</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨äº†å¯¹è±¡å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•ï¼Œç›´æ¥å°†ä¸¤ä¸ªå‡½æ•°æ”¾åœ¨å¤§æ‹¬å·ä¸­ï¼Œå†ä½¿ç”¨assignæ–¹æ³•æ·»åŠ åˆ°SomeClass.prototypeä¹‹ä¸­ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰å…‹éš†å¯¹è±¡</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span>(<span class="params">origin</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(&#123;&#125;, origin);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†åŸå§‹å¯¹è±¡æ‹·è´åˆ°ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œå°±å¾—åˆ°äº†åŸå§‹å¯¹è±¡çš„å…‹éš†ã€‚</p>
<p>ä¸è¿‡ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ³•å…‹éš†ï¼Œåªèƒ½å…‹éš†åŸå§‹å¯¹è±¡è‡ªèº«çš„å€¼ï¼Œä¸èƒ½å…‹éš†å®ƒç»§æ‰¿çš„å€¼ã€‚å¦‚æœæƒ³è¦ä¿æŒç»§æ‰¿é“¾ï¼Œå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clone</span>(<span class="params">origin</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> originProto = <span class="built_in">Object</span>.getPrototypeOf(origin);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(<span class="built_in">Object</span>.create(originProto), origin);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰åˆå¹¶å¤šä¸ªå¯¹è±¡</strong></p>
<p>å°†å¤šä¸ªå¯¹è±¡åˆå¹¶åˆ°æŸä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> merge =</div><div class="line">  <span class="function">(<span class="params">target, ...sources</span>) =&gt;</span> <span class="built_in">Object</span>.assign(target, ...sources);</div></pre></td></tr></table></figure>
<p>å¦‚æœå¸Œæœ›åˆå¹¶åè¿”å›ä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¯ä»¥æ”¹å†™ä¸Šé¢å‡½æ•°ï¼Œå¯¹ä¸€ä¸ªç©ºå¯¹è±¡åˆå¹¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> merge =</div><div class="line">  <span class="function">(<span class="params">...sources</span>) =&gt;</span> <span class="built_in">Object</span>.assign(&#123;&#125;, ...sources);</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ5ï¼‰ä¸ºå±æ€§æŒ‡å®šé»˜è®¤å€¼</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> DEFAULTS = &#123;</div><div class="line">  <span class="attr">logLevel</span>: <span class="number">0</span>,</div><div class="line">  <span class="attr">outputFormat</span>: <span class="string">'html'</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">processContent</span>(<span class="params">options</span>) </span>&#123;</div><div class="line">  options = <span class="built_in">Object</span>.assign(&#123;&#125;, DEFAULTS, options);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>DEFAULTS</code>å¯¹è±¡æ˜¯é»˜è®¤å€¼ï¼Œ<code>options</code>å¯¹è±¡æ˜¯ç”¨æˆ·æä¾›çš„å‚æ•°ã€‚<code>Object.assign</code>æ–¹æ³•å°†<code>DEFAULTS</code>å’Œ<code>options</code>åˆå¹¶æˆä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¦‚æœä¸¤è€…æœ‰åŒåå±æ€§ï¼Œåˆ™<code>option</code>çš„å±æ€§å€¼ä¼šè¦†ç›–<code>DEFAULTS</code>çš„å±æ€§å€¼ã€‚</p>
<p>æ³¨æ„ï¼Œç”±äºå­˜åœ¨æ·±æ‹·è´çš„é—®é¢˜ï¼Œ<code>DEFAULTS</code>å¯¹è±¡å’Œ<code>options</code>å¯¹è±¡çš„æ‰€æœ‰å±æ€§çš„å€¼ï¼Œéƒ½åªèƒ½æ˜¯ç®€å•ç±»å‹ï¼Œè€Œä¸èƒ½æŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ã€‚å¦åˆ™ï¼Œå°†å¯¼è‡´<code>DEFAULTS</code>å¯¹è±¡çš„è¯¥å±æ€§ä¸èµ·ä½œç”¨ã€‚</p>
<h2 id="å±æ€§çš„å¯æšä¸¾æ€§"><a href="#å±æ€§çš„å¯æšä¸¾æ€§" class="headerlink" title="å±æ€§çš„å¯æšä¸¾æ€§"></a>å±æ€§çš„å¯æšä¸¾æ€§</h2><p>å¯¹è±¡çš„æ¯ä¸ªå±æ€§éƒ½æœ‰ä¸€ä¸ªæè¿°å¯¹è±¡ï¼ˆDescriptorï¼‰ï¼Œç”¨æ¥æ§åˆ¶è¯¥å±æ€§çš„è¡Œä¸ºã€‚<code>Object.getOwnPropertyDescriptor</code>æ–¹æ³•å¯ä»¥è·å–è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">foo</span>: <span class="number">123</span> &#125;;</div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'foo'</span>)</div><div class="line"><span class="comment">//  &#123;</span></div><div class="line"><span class="comment">//    value: 123,</span></div><div class="line"><span class="comment">//    writable: true,</span></div><div class="line"><span class="comment">//    enumerable: true,</span></div><div class="line"><span class="comment">//    configurable: true</span></div><div class="line"><span class="comment">//  &#125;</span></div></pre></td></tr></table></figure>
<p>æè¿°å¯¹è±¡çš„<code>enumerable</code>å±æ€§ï¼Œç§°ä¸ºâ€å¯æšä¸¾æ€§â€œï¼Œå¦‚æœè¯¥å±æ€§ä¸º<code>false</code>ï¼Œå°±è¡¨ç¤ºæŸäº›æ“ä½œä¼šå¿½ç•¥å½“å‰å±æ€§ã€‚</p>
<p>ES5æœ‰ä¸‰ä¸ªæ“ä½œä¼šå¿½ç•¥<code>enumerable</code>ä¸º<code>false</code>çš„å±æ€§ã€‚</p>
<ul>
<li><code>for...in</code>å¾ªç¯ï¼šåªéå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾çš„å±æ€§</li>
<li><code>Object.keys()</code>ï¼šè¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å¯æšä¸¾çš„å±æ€§çš„é”®å</li>
<li><code>JSON.stringify()</code>ï¼šåªä¸²è¡ŒåŒ–å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾çš„å±æ€§</li>
</ul>
<p>ES6æ–°å¢äº†ä¸€ä¸ªæ“ä½œ<code>Object.assign()</code>ï¼Œä¼šå¿½ç•¥<code>enumerable</code>ä¸º<code>false</code>çš„å±æ€§ï¼Œåªæ‹·è´å¯¹è±¡è‡ªèº«çš„å¯æšä¸¾çš„å±æ€§ã€‚</p>
<p>è¿™å››ä¸ªæ“ä½œä¹‹ä¸­ï¼Œåªæœ‰<code>for...in</code>ä¼šè¿”å›ç»§æ‰¿çš„å±æ€§ã€‚å®é™…ä¸Šï¼Œå¼•å…¥<code>enumerable</code>çš„æœ€åˆç›®çš„ï¼Œå°±æ˜¯è®©æŸäº›å±æ€§å¯ä»¥è§„é¿æ‰<code>for...in</code>æ“ä½œã€‚æ¯”å¦‚ï¼Œå¯¹è±¡åŸå‹çš„<code>toString</code>æ–¹æ³•ï¼Œä»¥åŠæ•°ç»„çš„<code>length</code>å±æ€§ï¼Œå°±é€šè¿‡è¿™ç§æ‰‹æ®µï¼Œä¸ä¼šè¢«<code>for...in</code>éå†åˆ°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="built_in">Object</span>.prototype, <span class="string">'toString'</span>).enumerable</div><div class="line"><span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor([], <span class="string">'length'</span>).enumerable</div><div class="line"><span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>toString</code>å’Œ<code>length</code>å±æ€§çš„<code>enumerable</code>éƒ½æ˜¯<code>false</code>ï¼Œå› æ­¤<code>for...in</code>ä¸ä¼šéå†åˆ°è¿™ä¸¤ä¸ªç»§æ‰¿è‡ªåŸå‹çš„å±æ€§ã€‚</p>
<p>å¦å¤–ï¼ŒES6è§„å®šï¼Œæ‰€æœ‰Classçš„åŸå‹çš„æ–¹æ³•éƒ½æ˜¯ä¸å¯æšä¸¾çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(<span class="class"><span class="keyword">class</span> </span>&#123;foo() &#123;&#125;&#125;.prototype, <span class="string">'foo'</span>).enumerable</div><div class="line"><span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>æ€»çš„æ¥è¯´ï¼Œæ“ä½œä¸­å¼•å…¥ç»§æ‰¿çš„å±æ€§ä¼šè®©é—®é¢˜å¤æ‚åŒ–ï¼Œå¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬åªå…³å¿ƒå¯¹è±¡è‡ªèº«çš„å±æ€§ã€‚æ‰€ä»¥ï¼Œå°½é‡ä¸è¦ç”¨<code>for...in</code>å¾ªç¯ï¼Œè€Œç”¨<code>Object.keys()</code>ä»£æ›¿ã€‚</p>
<h2 id="å±æ€§çš„éå†"><a href="#å±æ€§çš„éå†" class="headerlink" title="å±æ€§çš„éå†"></a>å±æ€§çš„éå†</h2><p>ES6ä¸€å…±æœ‰5ç§æ–¹æ³•å¯ä»¥éå†å¯¹è±¡çš„å±æ€§ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰forâ€¦in</strong></p>
<p><code>for...in</code>å¾ªç¯éå†å¯¹è±¡è‡ªèº«çš„å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼ˆä¸å«Symbolå±æ€§ï¼‰ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰Object.keys(obj)</strong></p>
<p><code>Object.keys</code>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…æ‹¬å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ˆä¸å«Symbolå±æ€§ï¼‰ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰Object.getOwnPropertyNames(obj)</strong></p>
<p><code>Object.getOwnPropertyNames</code>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼ˆä¸å«Symbolå±æ€§ï¼Œä½†æ˜¯åŒ…æ‹¬ä¸å¯æšä¸¾å±æ€§ï¼‰ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰Object.getOwnPropertySymbols(obj)</strong></p>
<p><code>Object.getOwnPropertySymbols</code>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰Symbolå±æ€§ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰Reflect.ownKeys(obj)</strong></p>
<p><code>Reflect.ownKeys</code>è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼Œä¸ç®¡æ˜¯å±æ€§åæ˜¯Symbolæˆ–å­—ç¬¦ä¸²ï¼Œä¹Ÿä¸ç®¡æ˜¯å¦å¯æšä¸¾ã€‚</p>
<p>ä»¥ä¸Šçš„5ç§æ–¹æ³•éå†å¯¹è±¡çš„å±æ€§ï¼Œéƒ½éµå®ˆåŒæ ·çš„å±æ€§éå†çš„æ¬¡åºè§„åˆ™ã€‚</p>
<ul>
<li>é¦–å…ˆéå†æ‰€æœ‰å±æ€§åä¸ºæ•°å€¼çš„å±æ€§ï¼ŒæŒ‰ç…§æ•°å­—æ’åºã€‚</li>
<li>å…¶æ¬¡éå†æ‰€æœ‰å±æ€§åä¸ºå­—ç¬¦ä¸²çš„å±æ€§ï¼ŒæŒ‰ç…§ç”Ÿæˆæ—¶é—´æ’åºã€‚</li>
<li>æœ€åéå†æ‰€æœ‰å±æ€§åä¸ºSymbolå€¼çš„å±æ€§ï¼ŒæŒ‰ç…§ç”Ÿæˆæ—¶é—´æ’åºã€‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Reflect</span>.ownKeys(&#123; [<span class="built_in">Symbol</span>()]:<span class="number">0</span>, <span class="attr">b</span>:<span class="number">0</span>, <span class="number">10</span>:<span class="number">0</span>, <span class="number">2</span>:<span class="number">0</span>, <span class="attr">a</span>:<span class="number">0</span> &#125;)</div><div class="line"><span class="comment">// ['2', '10', 'b', 'a', Symbol()]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Reflect.ownKeys</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†å‚æ•°å¯¹è±¡çš„æ‰€æœ‰å±æ€§ã€‚è¿™ä¸ªæ•°ç»„çš„å±æ€§æ¬¡åºæ˜¯è¿™æ ·çš„ï¼Œé¦–å…ˆæ˜¯æ•°å€¼å±æ€§<code>2</code>å’Œ<code>10</code>ï¼Œå…¶æ¬¡æ˜¯å­—ç¬¦ä¸²å±æ€§<code>b</code>å’Œ<code>a</code>ï¼Œæœ€åæ˜¯Symbolå±æ€§ã€‚</p>
<h2 id="proto-å±æ€§ï¼ŒObject-setPrototypeOf-ï¼ŒObject-getPrototypeOf"><a href="#proto-å±æ€§ï¼ŒObject-setPrototypeOf-ï¼ŒObject-getPrototypeOf" class="headerlink" title="__proto__å±æ€§ï¼ŒObject.setPrototypeOf()ï¼ŒObject.getPrototypeOf()"></a><code>__proto__</code>å±æ€§ï¼ŒObject.setPrototypeOf()ï¼ŒObject.getPrototypeOf()</h2><p><strong>ï¼ˆ1ï¼‰<code>__proto__</code>å±æ€§</strong></p>
<p><code>__proto__</code>å±æ€§ï¼ˆå‰åå„ä¸¤ä¸ªä¸‹åˆ’çº¿ï¼‰ï¼Œç”¨æ¥è¯»å–æˆ–è®¾ç½®å½“å‰å¯¹è±¡çš„<code>prototype</code>å¯¹è±¡ã€‚ç›®å‰ï¼Œæ‰€æœ‰æµè§ˆå™¨ï¼ˆåŒ…æ‹¬IE11ï¼‰éƒ½éƒ¨ç½²äº†è¿™ä¸ªå±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// es6çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">method</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; ... &#125;</div><div class="line">&#125;;</div><div class="line">obj.__proto__ = someOtherObj;</div><div class="line"></div><div class="line"><span class="comment">// es5çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(someOtherObj);</div><div class="line">obj.method = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; ... &#125;;</div></pre></td></tr></table></figure>
<p>è¯¥å±æ€§æ²¡æœ‰å†™å…¥ES6çš„æ­£æ–‡ï¼Œè€Œæ˜¯å†™å…¥äº†é™„å½•ï¼ŒåŸå› æ˜¯<code>__proto__</code>å‰åçš„åŒä¸‹åˆ’çº¿ï¼Œè¯´æ˜å®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå†…éƒ¨å±æ€§ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªæ­£å¼çš„å¯¹å¤–çš„APIï¼Œåªæ˜¯ç”±äºæµè§ˆå™¨å¹¿æ³›æ”¯æŒï¼Œæ‰è¢«åŠ å…¥äº†ES6ã€‚æ ‡å‡†æ˜ç¡®è§„å®šï¼Œåªæœ‰æµè§ˆå™¨å¿…é¡»éƒ¨ç½²è¿™ä¸ªå±æ€§ï¼Œå…¶ä»–è¿è¡Œç¯å¢ƒä¸ä¸€å®šéœ€è¦éƒ¨ç½²ï¼Œè€Œä¸”æ–°çš„ä»£ç æœ€å¥½è®¤ä¸ºè¿™ä¸ªå±æ€§æ˜¯ä¸å­˜åœ¨çš„ã€‚å› æ­¤ï¼Œæ— è®ºä»è¯­ä¹‰çš„è§’åº¦ï¼Œè¿˜æ˜¯ä»å…¼å®¹æ€§çš„è§’åº¦ï¼Œéƒ½ä¸è¦ä½¿ç”¨è¿™ä¸ªå±æ€§ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸‹é¢çš„<code>Object.setPrototypeOf()</code>ï¼ˆå†™æ“ä½œï¼‰ã€<code>Object.getPrototypeOf()</code>ï¼ˆè¯»æ“ä½œï¼‰ã€<code>Object.create()</code>ï¼ˆç”Ÿæˆæ“ä½œï¼‰ä»£æ›¿ã€‚</p>
<p>åœ¨å®ç°ä¸Šï¼Œ<code>__proto__</code>è°ƒç”¨çš„æ˜¯<code>Object.prototype.__proto__</code>ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.defineProperty(<span class="built_in">Object</span>.prototype, <span class="string">'__proto__'</span>, &#123;</div><div class="line">  get() &#123;</div><div class="line">    <span class="keyword">let</span> _thisObj = <span class="built_in">Object</span>(<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Object</span>.getPrototypeOf(_thisObj);</div><div class="line">  &#125;,</div><div class="line">  set(proto) &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span> === <span class="literal">undefined</span> || <span class="keyword">this</span> === <span class="literal">null</span>) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!isObject(<span class="keyword">this</span>)) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!isObject(proto)) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="literal">undefined</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> status = <span class="built_in">Reflect</span>.setPrototypeOf(<span class="keyword">this</span>, proto);</div><div class="line">    <span class="keyword">if</span> (!status) &#123;</div><div class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">TypeError</span>();</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">isObject</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>(value) === value;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœä¸€ä¸ªå¯¹è±¡æœ¬èº«éƒ¨ç½²äº†<code>__proto__</code>å±æ€§ï¼Œåˆ™è¯¥å±æ€§çš„å€¼å°±æ˜¯å¯¹è±¡çš„åŸå‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.getPrototypeOf(&#123; <span class="attr">__proto__</span>: <span class="literal">null</span> &#125;)</div><div class="line"><span class="comment">// null</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰Object.setPrototypeOf()</strong></p>
<p><code>Object.setPrototypeOf</code>æ–¹æ³•çš„ä½œç”¨ä¸<code>__proto__</code>ç›¸åŒï¼Œç”¨æ¥è®¾ç½®ä¸€ä¸ªå¯¹è±¡çš„<code>prototype</code>å¯¹è±¡ã€‚å®ƒæ˜¯ES6æ­£å¼æ¨èçš„è®¾ç½®åŸå‹å¯¹è±¡çš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ ¼å¼</span></div><div class="line"><span class="built_in">Object</span>.setPrototypeOf(object, prototype)</div><div class="line"></div><div class="line"><span class="comment">// ç”¨æ³•</span></div><div class="line"><span class="keyword">var</span> o = <span class="built_in">Object</span>.setPrototypeOf(&#123;&#125;, <span class="literal">null</span>);</div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•ç­‰åŒäºä¸‹é¢çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params">obj, proto</span>) </span>&#123;</div><div class="line">  obj.__proto__ = proto;</div><div class="line">  <span class="keyword">return</span> obj;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> proto = &#123;&#125;;</div><div class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">x</span>: <span class="number">10</span> &#125;;</div><div class="line"><span class="built_in">Object</span>.setPrototypeOf(obj, proto);</div><div class="line"></div><div class="line">proto.y = <span class="number">20</span>;</div><div class="line">proto.z = <span class="number">40</span>;</div><div class="line"></div><div class="line">obj.x <span class="comment">// 10</span></div><div class="line">obj.y <span class="comment">// 20</span></div><div class="line">obj.z <span class="comment">// 40</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†protoå¯¹è±¡è®¾ä¸ºobjå¯¹è±¡çš„åŸå‹ï¼Œæ‰€ä»¥ä»objå¯¹è±¡å¯ä»¥è¯»å–protoå¯¹è±¡çš„å±æ€§ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰Object.getPrototypeOf()</strong></p>
<p>è¯¥æ–¹æ³•ä¸setPrototypeOfæ–¹æ³•é…å¥—ï¼Œç”¨äºè¯»å–ä¸€ä¸ªå¯¹è±¡çš„prototypeå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.getPrototypeOf(obj);</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rectangle</span>(<span class="params"></span>) </span>&#123;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> rec = <span class="keyword">new</span> Rectangle();</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getPrototypeOf(rec) === Rectangle.prototype</div><div class="line"><span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="built_in">Object</span>.setPrototypeOf(rec, <span class="built_in">Object</span>.prototype);</div><div class="line"><span class="built_in">Object</span>.getPrototypeOf(rec) === Rectangle.prototype</div><div class="line"><span class="comment">// false</span></div></pre></td></tr></table></figure>
<h2 id="Object-keys-ï¼ŒObject-values-ï¼ŒObject-entries"><a href="#Object-keys-ï¼ŒObject-values-ï¼ŒObject-entries" class="headerlink" title="Object.keys()ï¼ŒObject.values()ï¼ŒObject.entries()"></a>Object.keys()ï¼ŒObject.values()ï¼ŒObject.entries()</h2><h3 id="Object-keys"><a href="#Object-keys" class="headerlink" title="Object.keys()"></a>Object.keys()</h3><p>ES5 å¼•å…¥äº†<code>Object.keys</code>æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†ï¼ˆenumerableï¼‰å±æ€§çš„é”®åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">foo</span>: <span class="string">'bar'</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</div><div class="line"><span class="built_in">Object</span>.keys(obj)</div><div class="line"><span class="comment">// ["foo", "baz"]</span></div></pre></td></tr></table></figure>
<p>ES2017 <a href="https://github.com/tc39/proposal-object-values-entries" target="_blank" rel="external">å¼•å…¥</a>äº†è·Ÿ<code>Object.keys</code>é…å¥—çš„<code>Object.values</code>å’Œ<code>Object.entries</code>ï¼Œä½œä¸ºéå†ä¸€ä¸ªå¯¹è±¡çš„è¡¥å……æ‰‹æ®µã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123;keys, values, entries&#125; = <span class="built_in">Object</span>;</div><div class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> keys(obj)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key); <span class="comment">// 'a', 'b', 'c'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> values(obj)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(value); <span class="comment">// 1, 2, 3</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> entries(obj)) &#123;</div><div class="line">  <span class="built_in">console</span>.log([key, value]); <span class="comment">// ['a', 1], ['b', 2], ['c', 3]</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Object-values"><a href="#Object-values" class="headerlink" title="Object.values()"></a>Object.values()</h3><p><code>Object.values</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†ï¼ˆenumerableï¼‰å±æ€§çš„é”®å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">foo</span>: <span class="string">'bar'</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</div><div class="line"><span class="built_in">Object</span>.values(obj)</div><div class="line"><span class="comment">// ["bar", 42]</span></div></pre></td></tr></table></figure>
<p>è¿”å›æ•°ç»„çš„æˆå‘˜é¡ºåºï¼Œä¸æœ¬ç« çš„ã€Šå±æ€§çš„éå†ã€‹éƒ¨åˆ†ä»‹ç»çš„æ’åˆ—è§„åˆ™ä¸€è‡´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123; <span class="number">100</span>: <span class="string">'a'</span>, <span class="number">2</span>: <span class="string">'b'</span>, <span class="number">7</span>: <span class="string">'c'</span> &#125;;</div><div class="line"><span class="built_in">Object</span>.values(obj)</div><div class="line"><span class="comment">// ["b", "c", "a"]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå±æ€§åä¸ºæ•°å€¼çš„å±æ€§ï¼Œæ˜¯æŒ‰ç…§æ•°å€¼å¤§å°ï¼Œä»å°åˆ°å¤§éå†çš„ï¼Œå› æ­¤è¿”å›çš„é¡ºåºæ˜¯<code>b</code>ã€<code>c</code>ã€<code>a</code>ã€‚</p>
<p><code>Object.values</code>åªè¿”å›å¯¹è±¡è‡ªèº«çš„å¯éå†å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = <span class="built_in">Object</span>.create(&#123;&#125;, &#123;<span class="attr">p</span>: &#123;<span class="attr">value</span>: <span class="number">42</span>&#125;&#125;);</div><div class="line"><span class="built_in">Object</span>.values(obj) <span class="comment">// []</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Object.create</code>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ·»åŠ çš„å¯¹è±¡å±æ€§ï¼ˆå±æ€§<code>p</code>ï¼‰ï¼Œå¦‚æœä¸æ˜¾å¼å£°æ˜ï¼Œé»˜è®¤æ˜¯ä¸å¯éå†çš„ï¼Œå› ä¸º<code>p</code>æ˜¯ç»§æ‰¿çš„å±æ€§ï¼Œè€Œä¸æ˜¯å¯¹è±¡è‡ªèº«çš„å±æ€§ã€‚<code>Object.values</code>ä¸ä¼šè¿”å›è¿™ä¸ªå±æ€§ã€‚</p>
<p><code>Object.values</code>ä¼šè¿‡æ»¤å±æ€§åä¸º Symbol å€¼çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.values(&#123; [<span class="built_in">Symbol</span>()]: <span class="number">123</span>, <span class="attr">foo</span>: <span class="string">'abc'</span> &#125;);</div><div class="line"><span class="comment">// ['abc']</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>Object.values</code>æ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¼šè¿”å›å„ä¸ªå­—ç¬¦ç»„æˆçš„ä¸€ä¸ªæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.values(<span class="string">'foo'</span>)</div><div class="line"><span class="comment">// ['f', 'o', 'o']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²ä¼šå…ˆè½¬æˆä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦ï¼Œå°±æ˜¯è¯¥å¯¹è±¡çš„ä¸€ä¸ªå±æ€§ã€‚å› æ­¤ï¼Œ<code>Object.values</code>è¿”å›æ¯ä¸ªå±æ€§çš„é”®å€¼ï¼Œå°±æ˜¯å„ä¸ªå­—ç¬¦ç»„æˆçš„ä¸€ä¸ªæ•°ç»„ã€‚</p>
<p>å¦‚æœå‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œ<code>Object.values</code>ä¼šå…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äºæ•°å€¼å’Œå¸ƒå°”å€¼çš„åŒ…è£…å¯¹è±¡ï¼Œéƒ½ä¸ä¼šä¸ºå®ä¾‹æ·»åŠ éç»§æ‰¿çš„å±æ€§ã€‚æ‰€ä»¥ï¼Œ<code>Object.values</code>ä¼šè¿”å›ç©ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.values(<span class="number">42</span>) <span class="comment">// []</span></div><div class="line"><span class="built_in">Object</span>.values(<span class="literal">true</span>) <span class="comment">// []</span></div></pre></td></tr></table></figure>
<h3 id="Object-entries"><a href="#Object-entries" class="headerlink" title="Object.entries"></a>Object.entries</h3><p><code>Object.entries</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‚æ•°å¯¹è±¡è‡ªèº«çš„ï¼ˆä¸å«ç»§æ‰¿çš„ï¼‰æ‰€æœ‰å¯éå†ï¼ˆenumerableï¼‰å±æ€§çš„é”®å€¼å¯¹æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">foo</span>: <span class="string">'bar'</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</div><div class="line"><span class="built_in">Object</span>.entries(obj)</div><div class="line"><span class="comment">// [ ["foo", "bar"], ["baz", 42] ]</span></div></pre></td></tr></table></figure>
<p>é™¤äº†è¿”å›å€¼ä¸ä¸€æ ·ï¼Œè¯¥æ–¹æ³•çš„è¡Œä¸ºä¸<code>Object.values</code>åŸºæœ¬ä¸€è‡´ã€‚</p>
<p>å¦‚æœåŸå¯¹è±¡çš„å±æ€§åæ˜¯ä¸€ä¸ªSymbolå€¼ï¼Œè¯¥å±æ€§ä¼šè¢«çœç•¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Object</span>.entries(&#123; [<span class="built_in">Symbol</span>()]: <span class="number">123</span>, <span class="attr">foo</span>: <span class="string">'abc'</span> &#125;);</div><div class="line"><span class="comment">// [ [ 'foo', 'abc' ] ]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸå¯¹è±¡æœ‰ä¸¤ä¸ªå±æ€§ï¼Œ<code>Object.entries</code>åªè¾“å‡ºå±æ€§åéSymbolå€¼çš„å±æ€§ã€‚å°†æ¥å¯èƒ½ä¼šæœ‰<code>Reflect.ownEntries()</code>æ–¹æ³•ï¼Œè¿”å›å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ã€‚</p>
<p><code>Object.entries</code>çš„åŸºæœ¬ç”¨é€”æ˜¯éå†å¯¹è±¡çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">one</span>: <span class="number">1</span>, <span class="attr">two</span>: <span class="number">2</span> &#125;;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [k, v] <span class="keyword">of</span> <span class="built_in">Object</span>.entries(obj)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">`<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(k)&#125;</span>: <span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(v)&#125;</span>`</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "one": 1</span></div><div class="line"><span class="comment">// "two": 2</span></div></pre></td></tr></table></figure>
<p><code>Object.entries</code>æ–¹æ³•çš„ä¸€ä¸ªç”¨å¤„æ˜¯ï¼Œå°†å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„<code>Map</code>ç»“æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">foo</span>: <span class="string">'bar'</span>, <span class="attr">baz</span>: <span class="number">42</span> &#125;;</div><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(<span class="built_in">Object</span>.entries(obj));</div><div class="line">map <span class="comment">// Map &#123; foo: "bar", baz: 42 &#125;</span></div></pre></td></tr></table></figure>
<p>è‡ªå·±å®ç°<code>Object.entries</code>æ–¹æ³•ï¼Œéå¸¸ç®€å•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Generatorå‡½æ•°çš„ç‰ˆæœ¬</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">entries</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(obj)) &#123;</div><div class="line">    <span class="keyword">yield</span> [key, obj[key]];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// éGeneratorå‡½æ•°çš„ç‰ˆæœ¬</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">entries</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> arr = [];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Object</span>.keys(obj)) &#123;</div><div class="line">    arr.push([key, obj[key]]);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> arr;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦"><a href="#å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦" class="headerlink" title="å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦"></a>å¯¹è±¡çš„æ‰©å±•è¿ç®—ç¬¦</h2><p>ç›®å‰ï¼ŒES7æœ‰ä¸€ä¸ª<a href="https://github.com/sebmarkbage/ecmascript-rest-spread" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œå°†Restè¿ç®—ç¬¦ï¼ˆè§£æ„èµ‹å€¼ï¼‰/æ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰å¼•å…¥å¯¹è±¡ã€‚Babelè½¬ç å™¨å·²ç»æ”¯æŒè¿™é¡¹åŠŸèƒ½ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰è§£æ„èµ‹å€¼</strong></p>
<p>å¯¹è±¡çš„è§£æ„èµ‹å€¼ç”¨äºä»ä¸€ä¸ªå¯¹è±¡å–å€¼ï¼Œç›¸å½“äºå°†æ‰€æœ‰å¯éå†çš„ã€ä½†å°šæœªè¢«è¯»å–çš„å±æ€§ï¼Œåˆ†é…åˆ°æŒ‡å®šçš„å¯¹è±¡ä¸Šé¢ã€‚æ‰€æœ‰çš„é”®å’Œå®ƒä»¬çš„å€¼ï¼Œéƒ½ä¼šæ‹·è´åˆ°æ–°å¯¹è±¡ä¸Šé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;;</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// 2</span></div><div class="line">z <span class="comment">// &#123; a: 3, b: 4 &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>z</code>æ˜¯è§£æ„èµ‹å€¼æ‰€åœ¨çš„å¯¹è±¡ã€‚å®ƒè·å–ç­‰å·å³è¾¹çš„æ‰€æœ‰å°šæœªè¯»å–çš„é”®ï¼ˆ<code>a</code>å’Œ<code>b</code>ï¼‰ï¼Œå°†å®ƒä»¬è¿åŒå€¼ä¸€èµ·æ‹·è´è¿‡æ¥ã€‚</p>
<p>ç”±äºè§£æ„èµ‹å€¼è¦æ±‚ç­‰å·å³è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥å¦‚æœç­‰å·å³è¾¹æ˜¯<code>undefined</code>æˆ–<code>null</code>ï¼Œå°±ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®ƒä»¬æ— æ³•è½¬ä¸ºå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = <span class="literal">null</span>; <span class="comment">// è¿è¡Œæ—¶é”™è¯¯</span></div><div class="line"><span class="keyword">let</span> &#123; x, y, ...z &#125; = <span class="literal">undefined</span>; <span class="comment">// è¿è¡Œæ—¶é”™è¯¯</span></div></pre></td></tr></table></figure>
<p>è§£æ„èµ‹å€¼å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; ...x, y, z &#125; = obj; <span class="comment">// å¥æ³•é”™è¯¯</span></div><div class="line"><span class="keyword">let</span> &#123; x, ...y, ...z &#125; = obj; <span class="comment">// å¥æ³•é”™è¯¯</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè§£æ„èµ‹å€¼ä¸æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚</p>
<p>æ³¨æ„ï¼Œè§£æ„èµ‹å€¼çš„æ‹·è´æ˜¯æµ…æ‹·è´ï¼Œå³å¦‚æœä¸€ä¸ªé”®çš„å€¼æ˜¯å¤åˆç±»å‹çš„å€¼ï¼ˆæ•°ç»„ã€å¯¹è±¡ã€å‡½æ•°ï¼‰ã€é‚£ä¹ˆè§£æ„èµ‹å€¼æ‹·è´çš„æ˜¯è¿™ä¸ªå€¼çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯è¿™ä¸ªå€¼çš„å‰¯æœ¬ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">a</span>: &#123; <span class="attr">b</span>: <span class="number">1</span> &#125; &#125;;</div><div class="line"><span class="keyword">let</span> &#123; ...x &#125; = obj;</div><div class="line">obj.a.b = <span class="number">2</span>;</div><div class="line">x.a.b <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>x</code>æ˜¯è§£æ„èµ‹å€¼æ‰€åœ¨çš„å¯¹è±¡ï¼Œæ‹·è´äº†å¯¹è±¡<code>obj</code>çš„<code>a</code>å±æ€§ã€‚<code>a</code>å±æ€§å¼•ç”¨äº†ä¸€ä¸ªå¯¹è±¡ï¼Œä¿®æ”¹è¿™ä¸ªå¯¹è±¡çš„å€¼ï¼Œä¼šå½±å“åˆ°è§£æ„èµ‹å€¼å¯¹å®ƒçš„å¼•ç”¨ã€‚</p>
<p>å¦å¤–ï¼Œè§£æ„èµ‹å€¼ä¸ä¼šæ‹·è´ç»§æ‰¿è‡ªåŸå‹å¯¹è±¡çš„å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> o1 = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</div><div class="line"><span class="keyword">let</span> o2 = &#123; <span class="attr">b</span>: <span class="number">2</span> &#125;;</div><div class="line">o2.__proto__ = o1;</div><div class="line"><span class="keyword">let</span> o3 = &#123; ...o2 &#125;;</div><div class="line">o3 <span class="comment">// &#123; b: 2 &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡<code>o3</code>æ˜¯<code>o2</code>çš„æ‹·è´ï¼Œä½†æ˜¯åªå¤åˆ¶äº†<code>o2</code>è‡ªèº«çš„å±æ€§ï¼Œæ²¡æœ‰å¤åˆ¶å®ƒçš„åŸå‹å¯¹è±¡<code>o1</code>çš„å±æ€§ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> o = <span class="built_in">Object</span>.create(&#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;);</div><div class="line">o.z = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="keyword">let</span> &#123; x, ...&#123; y, z &#125; &#125; = o;</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// undefined</span></div><div class="line">z <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>x</code>æ˜¯å•çº¯çš„è§£æ„èµ‹å€¼ï¼Œæ‰€ä»¥å¯ä»¥è¯»å–ç»§æ‰¿çš„å±æ€§ï¼›è§£æ„èµ‹å€¼äº§ç”Ÿçš„å˜é‡<code>y</code>å’Œ<code>z</code>ï¼Œåªèƒ½è¯»å–å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œæ‰€ä»¥åªæœ‰å˜é‡<code>z</code>å¯ä»¥èµ‹å€¼æˆåŠŸã€‚</p>
<p>è§£æ„èµ‹å€¼çš„ä¸€ä¸ªç”¨å¤„ï¼Œæ˜¯æ‰©å±•æŸä¸ªå‡½æ•°çš„å‚æ•°ï¼Œå¼•å…¥å…¶ä»–æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">baseFunction</span>(<span class="params">&#123; a, b &#125;</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">wrapperFunction</span>(<span class="params">&#123; x, y, ...restConfig &#125;</span>) </span>&#123;</div><div class="line">  <span class="comment">// ä½¿ç”¨xå’Œyå‚æ•°è¿›è¡Œæ“ä½œ</span></div><div class="line">  <span class="comment">// å…¶ä½™å‚æ•°ä¼ ç»™åŸå§‹å‡½æ•°</span></div><div class="line">  <span class="keyword">return</span> baseFunction(restConfig);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸå§‹å‡½æ•°<code>baseFunction</code>æ¥å—<code>a</code>å’Œ<code>b</code>ä½œä¸ºå‚æ•°ï¼Œå‡½æ•°<code>wrapperFunction</code>åœ¨<code>baseFunction</code>çš„åŸºç¡€ä¸Šè¿›è¡Œäº†æ‰©å±•ï¼Œèƒ½å¤Ÿæ¥å—å¤šä½™çš„å‚æ•°ï¼Œå¹¶ä¸”ä¿ç•™åŸå§‹å‡½æ•°çš„è¡Œä¸ºã€‚</p>
<p><strong>ï¼ˆ2ï¼‰æ‰©å±•è¿ç®—ç¬¦</strong></p>
<p>æ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰ç”¨äºå–å‡ºå‚æ•°å¯¹è±¡çš„æ‰€æœ‰å¯éå†å±æ€§ï¼Œæ‹·è´åˆ°å½“å‰å¯¹è±¡ä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> z = &#123; <span class="attr">a</span>: <span class="number">3</span>, <span class="attr">b</span>: <span class="number">4</span> &#125;;</div><div class="line"><span class="keyword">let</span> n = &#123; ...z &#125;;</div><div class="line">n <span class="comment">// &#123; a: 3, b: 4 &#125;</span></div></pre></td></tr></table></figure>
<p>è¿™ç­‰åŒäºä½¿ç”¨<code>Object.assign</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> aClone = &#123; ...a &#125;;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">let</span> aClone = <span class="built_in">Object</span>.assign(&#123;&#125;, a);</div></pre></td></tr></table></figure>
<p>æ‰©å±•è¿ç®—ç¬¦å¯ä»¥ç”¨äºåˆå¹¶ä¸¤ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> ab = &#123; ...a, ...b &#125;;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">let</span> ab = <span class="built_in">Object</span>.assign(&#123;&#125;, a, b);</div></pre></td></tr></table></figure>
<p>å¦‚æœç”¨æˆ·è‡ªå®šä¹‰çš„å±æ€§ï¼Œæ”¾åœ¨æ‰©å±•è¿ç®—ç¬¦åé¢ï¼Œåˆ™æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨çš„åŒåå±æ€§ä¼šè¢«è¦†ç›–æ‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> aWithOverrides = &#123; ...a, <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">let</span> aWithOverrides = &#123; ...a, ...&#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125; &#125;;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">let</span> x = <span class="number">1</span>, y = <span class="number">2</span>, aWithOverrides = &#123; ...a, x, y &#125;;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">let</span> aWithOverrides = <span class="built_in">Object</span>.assign(&#123;&#125;, a, &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>a</code>å¯¹è±¡çš„<code>x</code>å±æ€§å’Œ<code>y</code>å±æ€§ï¼Œæ‹·è´åˆ°æ–°å¯¹è±¡åä¼šè¢«è¦†ç›–æ‰ã€‚</p>
<p>è¿™ç”¨æ¥ä¿®æ”¹ç°æœ‰å¯¹è±¡éƒ¨åˆ†çš„éƒ¨åˆ†å±æ€§å°±å¾ˆæ–¹ä¾¿äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> newVersion = &#123;</div><div class="line">  ...previousVersion,</div><div class="line">  <span class="attr">name</span>: <span class="string">'New Name'</span> <span class="comment">// Override the name property</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>newVersion</code>å¯¹è±¡è‡ªå®šä¹‰äº†<code>name</code>å±æ€§ï¼Œå…¶ä»–å±æ€§å…¨éƒ¨å¤åˆ¶è‡ª<code>previousVersion</code>å¯¹è±¡ã€‚</p>
<p>å¦‚æœæŠŠè‡ªå®šä¹‰å±æ€§æ”¾åœ¨æ‰©å±•è¿ç®—ç¬¦å‰é¢ï¼Œå°±å˜æˆäº†è®¾ç½®æ–°å¯¹è±¡çš„é»˜è®¤å±æ€§å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> aWithDefaults = &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>, ...a &#125;;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">let</span> aWithDefaults = <span class="built_in">Object</span>.assign(&#123;&#125;, &#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;, a);</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">let</span> aWithDefaults = <span class="built_in">Object</span>.assign(&#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;, a);</div></pre></td></tr></table></figure>
<p>æ‰©å±•è¿ç®—ç¬¦çš„å‚æ•°å¯¹è±¡ä¹‹ä¸­ï¼Œå¦‚æœæœ‰å–å€¼å‡½æ•°<code>get</code>ï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¼šæ‰§è¡Œçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å¹¶ä¸ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå› ä¸ºxå±æ€§åªæ˜¯è¢«å®šä¹‰ï¼Œä½†æ²¡æ‰§è¡Œ</span></div><div class="line"><span class="keyword">let</span> aWithXGetter = &#123;</div><div class="line">  ...a,</div><div class="line">  get x() &#123;</div><div class="line">    throws <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'not thrown yet'</span>);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ä¼šæŠ›å‡ºé”™è¯¯ï¼Œå› ä¸ºxå±æ€§è¢«æ‰§è¡Œäº†</span></div><div class="line"><span class="keyword">let</span> runtimeError = &#123;</div><div class="line">  ...a,</div><div class="line">  ...&#123;</div><div class="line">    get x() &#123;</div><div class="line">      throws <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'thrown now'</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å¦‚æœæ‰©å±•è¿ç®—ç¬¦çš„å‚æ•°æ˜¯<code>null</code>æˆ–<code>undefined</code>ï¼Œè¿™ä¸ªä¸¤ä¸ªå€¼ä¼šè¢«å¿½ç•¥ï¼Œä¸ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> emptyObject = &#123; ...null, ...undefined &#125;; <span class="comment">// ä¸æŠ¥é”™</span></div></pre></td></tr></table></figure>
<h2 id="Object-getOwnPropertyDescriptors"><a href="#Object-getOwnPropertyDescriptors" class="headerlink" title="Object.getOwnPropertyDescriptors()"></a>Object.getOwnPropertyDescriptors()</h2><p>ES5æœ‰ä¸€ä¸ª<code>Object.getOwnPropertyDescriptor</code>æ–¹æ³•ï¼Œè¿”å›æŸä¸ªå¯¹è±¡å±æ€§çš„æè¿°å¯¹è±¡ï¼ˆdescriptorï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">p</span>: <span class="string">'a'</span> &#125;;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, <span class="string">'p'</span>)</div><div class="line"><span class="comment">// Object &#123; value: "a",</span></div><div class="line"><span class="comment">//   writable: true,</span></div><div class="line"><span class="comment">//   enumerable: true,</span></div><div class="line"><span class="comment">//   configurable: true</span></div><div class="line"><span class="comment">// &#125;</span></div></pre></td></tr></table></figure>
<p>ES7æœ‰ä¸€ä¸ªææ¡ˆï¼Œæå‡ºäº†<code>Object.getOwnPropertyDescriptors</code>æ–¹æ³•ï¼Œè¿”å›æŒ‡å®šå¯¹è±¡æ‰€æœ‰è‡ªèº«å±æ€§ï¼ˆéç»§æ‰¿å±æ€§ï¼‰çš„æè¿°å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">  <span class="attr">foo</span>: <span class="number">123</span>,</div><div class="line">  get bar() &#123; <span class="keyword">return</span> <span class="string">'abc'</span> &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptors(obj)</div><div class="line"><span class="comment">// &#123; foo:</span></div><div class="line"><span class="comment">//    &#123; value: 123,</span></div><div class="line"><span class="comment">//      writable: true,</span></div><div class="line"><span class="comment">//      enumerable: true,</span></div><div class="line"><span class="comment">//      configurable: true &#125;,</span></div><div class="line"><span class="comment">//   bar:</span></div><div class="line"><span class="comment">//    &#123; get: [Function: bar],</span></div><div class="line"><span class="comment">//      set: undefined,</span></div><div class="line"><span class="comment">//      enumerable: true,</span></div><div class="line"><span class="comment">//      configurable: true &#125; &#125;</span></div></pre></td></tr></table></figure>
<p><code>Object.getOwnPropertyDescriptors</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæ‰€æœ‰åŸå¯¹è±¡çš„å±æ€§åéƒ½æ˜¯è¯¥å¯¹è±¡çš„å±æ€§åï¼Œå¯¹åº”çš„å±æ€§å€¼å°±æ˜¯è¯¥å±æ€§çš„æè¿°å¯¹è±¡ã€‚</p>
<p>è¯¥æ–¹æ³•çš„å®ç°éå¸¸å®¹æ˜“ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getOwnPropertyDescriptors</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">  <span class="keyword">const</span> result = &#123;&#125;;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="built_in">Reflect</span>.ownKeys(obj)) &#123;</div><div class="line">    result[key] = <span class="built_in">Object</span>.getOwnPropertyDescriptor(obj, key);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•çš„æå‡ºç›®çš„ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³<code>Object.assign()</code>æ— æ³•æ­£ç¡®æ‹·è´<code>get</code>å±æ€§å’Œ<code>set</code>å±æ€§çš„é—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> source = &#123;</div><div class="line">  set foo(value) &#123;</div><div class="line">    <span class="built_in">console</span>.log(value);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> target1 = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.assign(target1, source);</div><div class="line"></div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(target1, <span class="string">'foo'</span>)</div><div class="line"><span class="comment">// &#123; value: undefined,</span></div><div class="line"><span class="comment">//   writable: true,</span></div><div class="line"><span class="comment">//   enumerable: true,</span></div><div class="line"><span class="comment">//   configurable: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>source</code>å¯¹è±¡çš„<code>foo</code>å±æ€§çš„å€¼æ˜¯ä¸€ä¸ªèµ‹å€¼å‡½æ•°ï¼Œ<code>Object.assign</code>æ–¹æ³•å°†è¿™ä¸ªå±æ€§æ‹·è´ç»™<code>target1</code>å¯¹è±¡ï¼Œç»“æœè¯¥å±æ€§çš„å€¼å˜æˆäº†<code>undefined</code>ã€‚è¿™æ˜¯å› ä¸º<code>Object.assign</code>æ–¹æ³•æ€»æ˜¯æ‹·è´ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œè€Œä¸ä¼šæ‹·è´å®ƒèƒŒåçš„èµ‹å€¼æ–¹æ³•æˆ–å–å€¼æ–¹æ³•ã€‚</p>
<p>è¿™æ—¶ï¼Œ<code>Object.getOwnPropertyDescriptors</code>æ–¹æ³•é…åˆ<code>Object.defineProperties</code>æ–¹æ³•ï¼Œå°±å¯ä»¥å®ç°æ­£ç¡®æ‹·è´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> source = &#123;</div><div class="line">  set foo(value) &#123;</div><div class="line">    <span class="built_in">console</span>.log(value);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> target2 = &#123;&#125;;</div><div class="line"><span class="built_in">Object</span>.defineProperties(target2, <span class="built_in">Object</span>.getOwnPropertyDescriptors(source));</div><div class="line"><span class="built_in">Object</span>.getOwnPropertyDescriptor(target2, <span class="string">'foo'</span>)</div><div class="line"><span class="comment">// &#123; get: undefined,</span></div><div class="line"><span class="comment">//   set: [Function: foo],</span></div><div class="line"><span class="comment">//   enumerable: true,</span></div><div class="line"><span class="comment">//   configurable: true &#125;</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå°†ä¸¤ä¸ªå¯¹è±¡åˆå¹¶çš„é€»è¾‘æç‚¼å‡ºæ¥ï¼Œå°±æ˜¯ä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> shallowMerge = <span class="function">(<span class="params">target, source</span>) =&gt;</span> <span class="built_in">Object</span>.defineProperties(</div><div class="line">  target,</div><div class="line">  <span class="built_in">Object</span>.getOwnPropertyDescriptors(source)</div><div class="line">);</div></pre></td></tr></table></figure>
<p><code>Object.getOwnPropertyDescriptors</code>æ–¹æ³•çš„å¦ä¸€ä¸ªç”¨å¤„ï¼Œæ˜¯é…åˆ<code>Object.create</code>æ–¹æ³•ï¼Œå°†å¯¹è±¡å±æ€§å…‹éš†åˆ°ä¸€ä¸ªæ–°å¯¹è±¡ã€‚è¿™å±äºæµ…æ‹·è´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> clone = <span class="built_in">Object</span>.create(<span class="built_in">Object</span>.getPrototypeOf(obj),</div><div class="line">  <span class="built_in">Object</span>.getOwnPropertyDescriptors(obj));</div><div class="line"></div><div class="line"><span class="comment">// æˆ–è€…</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> shallowClone = <span class="function">(<span class="params">obj</span>) =&gt;</span> <span class="built_in">Object</span>.create(</div><div class="line">  <span class="built_in">Object</span>.getPrototypeOf(obj),</div><div class="line">  <span class="built_in">Object</span>.getOwnPropertyDescriptors(obj)</div><div class="line">);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¼šå…‹éš†å¯¹è±¡<code>obj</code>ã€‚</p>
<p>å¦å¤–ï¼Œ<code>Object.getOwnPropertyDescriptors</code>æ–¹æ³•å¯ä»¥å®ç°ï¼Œä¸€ä¸ªå¯¹è±¡ç»§æ‰¿å¦ä¸€ä¸ªå¯¹è±¡ã€‚ä»¥å‰ï¼Œç»§æ‰¿å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå¸¸å¸¸å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">  <span class="attr">__proto__</span>: prot,</div><div class="line">  <span class="attr">foo</span>: <span class="number">123</span>,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ES6è§„å®š<code>__proto__</code>åªæœ‰æµè§ˆå™¨è¦éƒ¨ç½²ï¼Œå…¶ä»–ç¯å¢ƒä¸ç”¨éƒ¨ç½²ã€‚å¦‚æœå»é™¤<code>__proto__</code>ï¼Œä¸Šé¢ä»£ç å°±è¦æ”¹æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> obj = <span class="built_in">Object</span>.create(prot);</div><div class="line">obj.foo = <span class="number">123</span>;</div><div class="line"></div><div class="line"><span class="comment">// æˆ–è€…</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> obj = <span class="built_in">Object</span>.assign(</div><div class="line">  <span class="built_in">Object</span>.create(prot),</div><div class="line">  &#123;</div><div class="line">    <span class="attr">foo</span>: <span class="number">123</span>,</div><div class="line">  &#125;</div><div class="line">);</div></pre></td></tr></table></figure>
<p>æœ‰äº†<code>Object.getOwnPropertyDescriptors</code>ï¼Œæˆ‘ä»¬å°±æœ‰äº†å¦ä¸€ç§å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> obj = <span class="built_in">Object</span>.create(</div><div class="line">  prot,</div><div class="line">  <span class="built_in">Object</span>.getOwnPropertyDescriptors(&#123;</div><div class="line">    <span class="attr">foo</span>: <span class="number">123</span>,</div><div class="line">  &#125;)</div><div class="line">);</div></pre></td></tr></table></figure>
<p><code>Object.getOwnPropertyDescriptors</code>ä¹Ÿå¯ä»¥ç”¨æ¥å®ç°Mixinï¼ˆæ··å…¥ï¼‰æ¨¡å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> mix = <span class="function">(<span class="params">object</span>) =&gt;</span> (&#123;</div><div class="line">  <span class="attr">with</span>: <span class="function">(<span class="params">...mixins</span>) =&gt;</span> mixins.reduce(</div><div class="line">    <span class="function">(<span class="params">c, mixin</span>) =&gt;</span> <span class="built_in">Object</span>.create(</div><div class="line">      c, <span class="built_in">Object</span>.getOwnPropertyDescriptors(mixin)</div><div class="line">    ), object)</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// multiple mixins example</span></div><div class="line"><span class="keyword">let</span> a = &#123;<span class="attr">a</span>: <span class="string">'a'</span>&#125;;</div><div class="line"><span class="keyword">let</span> b = &#123;<span class="attr">b</span>: <span class="string">'b'</span>&#125;;</div><div class="line"><span class="keyword">let</span> c = &#123;<span class="attr">c</span>: <span class="string">'c'</span>&#125;;</div><div class="line"><span class="keyword">let</span> d = mix(c).with(a, b);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯¹è±¡<code>a</code>å’Œ<code>b</code>è¢«æ··å…¥äº†å¯¹è±¡<code>c</code>ã€‚</p>
<p>å‡ºäºå®Œæ•´æ€§çš„è€ƒè™‘ï¼Œ<code>Object.getOwnPropertyDescriptors</code>è¿›å…¥æ ‡å‡†ä»¥åï¼Œè¿˜ä¼šæœ‰<code>Reflect.getOwnPropertyDescriptors</code>æ–¹æ³•ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å¯¹è±¡çš„æ‰©å±•&quot;&gt;&lt;a href=&quot;#å¯¹è±¡çš„æ‰©å±•&quot; class=&quot;headerlink&quot; title=&quot;å¯¹è±¡çš„æ‰©å±•&quot;&gt;&lt;/a&gt;å¯¹è±¡çš„æ‰©å±•&lt;/h1&gt;&lt;h2 id=&quot;å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•&quot;&gt;&lt;a href=&quot;#å±æ€§çš„ç®€æ´è¡¨ç¤ºæ³•&quot; class=&quot;headerlink&quot; titl
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Object" scheme="http://microzz.com/tags/Object/"/>
    
  </entry>
  
  <entry>
    <title>å‡½æ•°çš„æ‰©å±•(Function)</title>
    <link href="http://microzz.com/2016/12/10/function/"/>
    <id>http://microzz.com/2016/12/10/function/</id>
    <published>2016-12-10T07:45:19.000Z</published>
    <updated>2017-01-12T08:08:02.539Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‡½æ•°çš„æ‰©å±•"><a href="#å‡½æ•°çš„æ‰©å±•" class="headerlink" title="å‡½æ•°çš„æ‰©å±•"></a>å‡½æ•°çš„æ‰©å±•</h1><h2 id="å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼"><a href="#å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼" class="headerlink" title="å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼"></a>å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>åœ¨ES6ä¹‹å‰ï¼Œä¸èƒ½ç›´æ¥ä¸ºå‡½æ•°çš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œåªèƒ½é‡‡ç”¨å˜é€šçš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  y = y || <span class="string">'World'</span>;</div><div class="line">  <span class="built_in">console</span>.log(x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">log(<span class="string">'Hello'</span>) <span class="comment">// Hello World</span></div><div class="line">log(<span class="string">'Hello'</span>, <span class="string">'China'</span>) <span class="comment">// Hello China</span></div><div class="line">log(<span class="string">'Hello'</span>, <span class="string">''</span>) <span class="comment">// Hello World</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ£€æŸ¥å‡½æ•°<code>log</code>çš„å‚æ•°<code>y</code>æœ‰æ²¡æœ‰èµ‹å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æŒ‡å®šé»˜è®¤å€¼ä¸º<code>World</code>ã€‚è¿™ç§å†™æ³•çš„ç¼ºç‚¹åœ¨äºï¼Œå¦‚æœå‚æ•°<code>y</code>èµ‹å€¼äº†ï¼Œä½†æ˜¯å¯¹åº”çš„å¸ƒå°”å€¼ä¸º<code>false</code>ï¼Œåˆ™è¯¥èµ‹å€¼ä¸èµ·ä½œç”¨ã€‚å°±åƒä¸Šé¢ä»£ç çš„æœ€åä¸€è¡Œï¼Œå‚æ•°<code>y</code>ç­‰äºç©ºå­—ç¬¦ï¼Œç»“æœè¢«æ”¹ä¸ºé»˜è®¤å€¼ã€‚</p>
<p>ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œé€šå¸¸éœ€è¦å…ˆåˆ¤æ–­ä¸€ä¸‹å‚æ•°<code>y</code>æ˜¯å¦è¢«èµ‹å€¼ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå†ç­‰äºé»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> y === <span class="string">'undefined'</span>) &#123;</div><div class="line">  y = <span class="string">'World'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ES6å…è®¸ä¸ºå‡½æ•°çš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå³ç›´æ¥å†™åœ¨å‚æ•°å®šä¹‰çš„åé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">x, y = <span class="string">'World'</span></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">log(<span class="string">'Hello'</span>) <span class="comment">// Hello World</span></div><div class="line">log(<span class="string">'Hello'</span>, <span class="string">'China'</span>) <span class="comment">// Hello China</span></div><div class="line">log(<span class="string">'Hello'</span>, <span class="string">''</span>) <span class="comment">// Hello</span></div></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒES6çš„å†™æ³•æ¯”ES5ç®€æ´è®¸å¤šï¼Œè€Œä¸”éå¸¸è‡ªç„¶ã€‚ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Point</span>(<span class="params">x = <span class="number">0</span>, y = <span class="number">0</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.x = x;</div><div class="line">  <span class="keyword">this</span>.y = y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Point();</div><div class="line">p <span class="comment">// &#123; x: 0, y: 0 &#125;</span></div></pre></td></tr></table></figure>
<p>é™¤äº†ç®€æ´ï¼ŒES6çš„å†™æ³•è¿˜æœ‰ä¸¤ä¸ªå¥½å¤„ï¼šé¦–å…ˆï¼Œé˜…è¯»ä»£ç çš„äººï¼Œå¯ä»¥ç«‹åˆ»æ„è¯†åˆ°å“ªäº›å‚æ•°æ˜¯å¯ä»¥çœç•¥çš„ï¼Œä¸ç”¨æŸ¥çœ‹å‡½æ•°ä½“æˆ–æ–‡æ¡£ï¼›å…¶æ¬¡ï¼Œæœ‰åˆ©äºå°†æ¥çš„ä»£ç ä¼˜åŒ–ï¼Œå³ä½¿æœªæ¥çš„ç‰ˆæœ¬åœ¨å¯¹å¤–æ¥å£ä¸­ï¼Œå½»åº•æ‹¿æ‰è¿™ä¸ªå‚æ•°ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´ä»¥å‰çš„ä»£ç æ— æ³•è¿è¡Œã€‚</p>
<p>å‚æ•°å˜é‡æ˜¯é»˜è®¤å£°æ˜çš„ï¼Œæ‰€ä»¥ä¸èƒ½ç”¨<code>let</code>æˆ–<code>const</code>å†æ¬¡å£°æ˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x = <span class="number">5</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> x = <span class="number">1</span>; <span class="comment">// error</span></div><div class="line">  <span class="keyword">const</span> x = <span class="number">2</span>; <span class="comment">// error</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°å˜é‡<code>x</code>æ˜¯é»˜è®¤å£°æ˜çš„ï¼Œåœ¨å‡½æ•°ä½“ä¸­ï¼Œä¸èƒ½ç”¨<code>let</code>æˆ–<code>const</code>å†æ¬¡å£°æ˜ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<h3 id="ä¸è§£æ„èµ‹å€¼é»˜è®¤å€¼ç»“åˆä½¿ç”¨"><a href="#ä¸è§£æ„èµ‹å€¼é»˜è®¤å€¼ç»“åˆä½¿ç”¨" class="headerlink" title="ä¸è§£æ„èµ‹å€¼é»˜è®¤å€¼ç»“åˆä½¿ç”¨"></a>ä¸è§£æ„èµ‹å€¼é»˜è®¤å€¼ç»“åˆä½¿ç”¨</h3><p>å‚æ•°é»˜è®¤å€¼å¯ä»¥ä¸è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ï¼Œç»“åˆèµ·æ¥ä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">&#123;x, y = <span class="number">5</span>&#125;</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(&#123;&#125;) <span class="comment">// undefined, 5</span></div><div class="line">foo(&#123;<span class="attr">x</span>: <span class="number">1</span>&#125;) <span class="comment">// 1, 5</span></div><div class="line">foo(&#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;) <span class="comment">// 1, 2</span></div><div class="line">foo() <span class="comment">// TypeError: Cannot read property 'x' of undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨äº†å¯¹è±¡çš„è§£æ„èµ‹å€¼é»˜è®¤å€¼ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚åªæœ‰å½“å‡½æ•°<code>foo</code>çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå˜é‡<code>x</code>å’Œ<code>y</code>æ‰ä¼šé€šè¿‡è§£æ„èµ‹å€¼è€Œç”Ÿæˆã€‚å¦‚æœå‡½æ•°<code>foo</code>è°ƒç”¨æ—¶å‚æ•°ä¸æ˜¯å¯¹è±¡ï¼Œå˜é‡<code>x</code>å’Œ<code>y</code>å°±ä¸ä¼šç”Ÿæˆï¼Œä»è€ŒæŠ¥é”™ã€‚å¦‚æœå‚æ•°å¯¹è±¡æ²¡æœ‰<code>y</code>å±æ€§ï¼Œ<code>y</code>çš„é»˜è®¤å€¼5æ‰ä¼šç”Ÿæ•ˆã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªå¯¹è±¡çš„è§£æ„èµ‹å€¼é»˜è®¤å€¼çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetch</span>(<span class="params">url, &#123; body = <span class="string">''</span>, method = <span class="string">'GET'</span>, headers = &#123;&#125; &#125;</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(method);</div><div class="line">&#125;</div><div class="line"></div><div class="line">fetch(<span class="string">'http://example.com'</span>, &#123;&#125;)</div><div class="line"><span class="comment">// "GET"</span></div><div class="line"></div><div class="line">fetch(<span class="string">'http://example.com'</span>)</div><div class="line"><span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå‡½æ•°<code>fetch</code>çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°±å¯ä»¥ä¸ºå®ƒçš„ä¸‰ä¸ªå±æ€§è®¾ç½®é»˜è®¤å€¼ã€‚</p>
<p>ä¸Šé¢çš„å†™æ³•ä¸èƒ½çœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœç»“åˆå‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ï¼Œå°±å¯ä»¥çœç•¥ç¬¬äºŒä¸ªå‚æ•°ã€‚è¿™æ—¶ï¼Œå°±å‡ºç°äº†åŒé‡é»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetch</span>(<span class="params">url, &#123; method = <span class="string">'GET'</span> &#125; = &#123;&#125;</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(method);</div><div class="line">&#125;</div><div class="line"></div><div class="line">fetch(<span class="string">'http://example.com'</span>)</div><div class="line"><span class="comment">// "GET"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>fetch</code>æ²¡æœ‰ç¬¬äºŒä¸ªå‚æ•°æ—¶ï¼Œå‡½æ•°å‚æ•°çš„é»˜è®¤å€¼å°±ä¼šç”Ÿæ•ˆï¼Œç„¶åæ‰æ˜¯è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ç”Ÿæ•ˆï¼Œå˜é‡<code>method</code>æ‰ä¼šå–åˆ°é»˜è®¤å€¼<code>GET</code>ã€‚</p>
<p>å†è¯·é—®ä¸‹é¢ä¸¤ç§å†™æ³•æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å†™æ³•ä¸€</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">m1</span>(<span class="params">&#123;x = <span class="number">0</span>, y = <span class="number">0</span>&#125; = &#123;&#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å†™æ³•äºŒ</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">m2</span>(<span class="params">&#123;x, y&#125; = &#123; x: <span class="number">0</span>, y: <span class="number">0</span> &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ç§å†™æ³•éƒ½å¯¹å‡½æ•°çš„å‚æ•°è®¾å®šäº†é»˜è®¤å€¼ï¼ŒåŒºåˆ«æ˜¯å†™æ³•ä¸€å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼æ˜¯ç©ºå¯¹è±¡ï¼Œä½†æ˜¯è®¾ç½®äº†å¯¹è±¡è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ï¼›å†™æ³•äºŒå‡½æ•°å‚æ•°çš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªæœ‰å…·ä½“å±æ€§çš„å¯¹è±¡ï¼Œä½†æ˜¯æ²¡æœ‰è®¾ç½®å¯¹è±¡è§£æ„èµ‹å€¼çš„é»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‡½æ•°æ²¡æœ‰å‚æ•°çš„æƒ…å†µ</span></div><div class="line">m1() <span class="comment">// [0, 0]</span></div><div class="line">m2() <span class="comment">// [0, 0]</span></div><div class="line"></div><div class="line"><span class="comment">// xå’Œyéƒ½æœ‰å€¼çš„æƒ…å†µ</span></div><div class="line">m1(&#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span>&#125;) <span class="comment">// [3, 8]</span></div><div class="line">m2(&#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span>&#125;) <span class="comment">// [3, 8]</span></div><div class="line"></div><div class="line"><span class="comment">// xæœ‰å€¼ï¼Œyæ— å€¼çš„æƒ…å†µ</span></div><div class="line">m1(&#123;<span class="attr">x</span>: <span class="number">3</span>&#125;) <span class="comment">// [3, 0]</span></div><div class="line">m2(&#123;<span class="attr">x</span>: <span class="number">3</span>&#125;) <span class="comment">// [3, undefined]</span></div><div class="line"></div><div class="line"><span class="comment">// xå’Œyéƒ½æ— å€¼çš„æƒ…å†µ</span></div><div class="line">m1(&#123;&#125;) <span class="comment">// [0, 0];</span></div><div class="line">m2(&#123;&#125;) <span class="comment">// [undefined, undefined]</span></div><div class="line"></div><div class="line">m1(&#123;<span class="attr">z</span>: <span class="number">3</span>&#125;) <span class="comment">// [0, 0]</span></div><div class="line">m2(&#123;<span class="attr">z</span>: <span class="number">3</span>&#125;) <span class="comment">// [undefined, undefined]</span></div></pre></td></tr></table></figure>
<h3 id="å‚æ•°é»˜è®¤å€¼çš„ä½ç½®"><a href="#å‚æ•°é»˜è®¤å€¼çš„ä½ç½®" class="headerlink" title="å‚æ•°é»˜è®¤å€¼çš„ä½ç½®"></a>å‚æ•°é»˜è®¤å€¼çš„ä½ç½®</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå®šä¹‰äº†é»˜è®¤å€¼çš„å‚æ•°ï¼Œåº”è¯¥æ˜¯å‡½æ•°çš„å°¾å‚æ•°ã€‚å› ä¸ºè¿™æ ·æ¯”è¾ƒå®¹æ˜“çœ‹å‡ºæ¥ï¼Œåˆ°åº•çœç•¥äº†å“ªäº›å‚æ•°ã€‚å¦‚æœéå°¾éƒ¨çš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå®é™…ä¸Šè¿™ä¸ªå‚æ•°æ˜¯æ²¡æ³•çœç•¥çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¾‹ä¸€</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x = <span class="number">1</span>, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">f() <span class="comment">// [1, undefined]</span></div><div class="line">f(<span class="number">2</span>) <span class="comment">// [2, undefined])</span></div><div class="line">f(, <span class="number">1</span>) <span class="comment">// æŠ¥é”™</span></div><div class="line">f(<span class="literal">undefined</span>, <span class="number">1</span>) <span class="comment">// [1, 1]</span></div><div class="line"></div><div class="line"><span class="comment">// ä¾‹äºŒ</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y = <span class="number">5</span>, z</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y, z];</div><div class="line">&#125;</div><div class="line"></div><div class="line">f() <span class="comment">// [undefined, 5, undefined]</span></div><div class="line">f(<span class="number">1</span>) <span class="comment">// [1, 5, undefined]</span></div><div class="line">f(<span class="number">1</span>, ,<span class="number">2</span>) <span class="comment">// æŠ¥é”™</span></div><div class="line">f(<span class="number">1</span>, <span class="literal">undefined</span>, <span class="number">2</span>) <span class="comment">// [1, 5, 2]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæœ‰é»˜è®¤å€¼çš„å‚æ•°éƒ½ä¸æ˜¯å°¾å‚æ•°ã€‚è¿™æ—¶ï¼Œæ— æ³•åªçœç•¥è¯¥å‚æ•°ï¼Œè€Œä¸çœç•¥å®ƒåé¢çš„å‚æ•°ï¼Œé™¤éæ˜¾å¼è¾“å…¥<code>undefined</code>ã€‚</p>
<p>å¦‚æœä¼ å…¥<code>undefined</code>ï¼Œå°†è§¦å‘è¯¥å‚æ•°ç­‰äºé»˜è®¤å€¼ï¼Œ<code>null</code>åˆ™æ²¡æœ‰è¿™ä¸ªæ•ˆæœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x = <span class="number">5</span>, y = <span class="number">6</span></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(x, y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(<span class="literal">undefined</span>, <span class="literal">null</span>)</div><div class="line"><span class="comment">// 5 null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>x</code>å‚æ•°å¯¹åº”<code>undefined</code>ï¼Œç»“æœè§¦å‘äº†é»˜è®¤å€¼ï¼Œ<code>y</code>å‚æ•°ç­‰äº<code>null</code>ï¼Œå°±æ²¡æœ‰è§¦å‘é»˜è®¤å€¼ã€‚</p>
<h3 id="å‡½æ•°çš„lengthå±æ€§"><a href="#å‡½æ•°çš„lengthå±æ€§" class="headerlink" title="å‡½æ•°çš„lengthå±æ€§"></a>å‡½æ•°çš„lengthå±æ€§</h3><p>æŒ‡å®šäº†é»˜è®¤å€¼ä»¥åï¼Œå‡½æ•°çš„<code>length</code>å±æ€§ï¼Œå°†è¿”å›æ²¡æœ‰æŒ‡å®šé»˜è®¤å€¼çš„å‚æ•°ä¸ªæ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæŒ‡å®šäº†é»˜è®¤å€¼åï¼Œ<code>length</code>å±æ€§å°†å¤±çœŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;&#125;).length <span class="comment">// 1</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a = <span class="number">5</span></span>) </span>&#123;&#125;).length <span class="comment">// 0</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a, b, c = <span class="number">5</span></span>) </span>&#123;&#125;).length <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>length</code>å±æ€§çš„è¿”å›å€¼ï¼Œç­‰äºå‡½æ•°çš„å‚æ•°ä¸ªæ•°å‡å»æŒ‡å®šäº†é»˜è®¤å€¼çš„å‚æ•°ä¸ªæ•°ã€‚æ¯”å¦‚ï¼Œä¸Šé¢æœ€åä¸€ä¸ªå‡½æ•°ï¼Œå®šä¹‰äº†3ä¸ªå‚æ•°ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå‚æ•°<code>c</code>æŒ‡å®šäº†é»˜è®¤å€¼ï¼Œå› æ­¤<code>length</code>å±æ€§ç­‰äº<code>3</code>å‡å»<code>1</code>ï¼Œæœ€åå¾—åˆ°<code>2</code>ã€‚</p>
<p>è¿™æ˜¯å› ä¸º<code>length</code>å±æ€§çš„å«ä¹‰æ˜¯ï¼Œè¯¥å‡½æ•°é¢„æœŸä¼ å…¥çš„å‚æ•°ä¸ªæ•°ã€‚æŸä¸ªå‚æ•°æŒ‡å®šé»˜è®¤å€¼ä»¥åï¼Œé¢„æœŸä¼ å…¥çš„å‚æ•°ä¸ªæ•°å°±ä¸åŒ…æ‹¬è¿™ä¸ªå‚æ•°äº†ã€‚åŒç†ï¼Œrestå‚æ•°ä¹Ÿä¸ä¼šè®¡å…¥<code>length</code>å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">...args</span>) </span>&#123;&#125;).length <span class="comment">// 0</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè®¾ç½®äº†é»˜è®¤å€¼çš„å‚æ•°ä¸æ˜¯å°¾å‚æ•°ï¼Œé‚£ä¹ˆ<code>length</code>å±æ€§ä¹Ÿä¸å†è®¡å…¥åé¢çš„å‚æ•°äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a = <span class="number">0</span>, b, c</span>) </span>&#123;&#125;).length <span class="comment">// 0</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">a, b = <span class="number">1</span>, c</span>) </span>&#123;&#125;).length <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<h3 id="ä½œç”¨åŸŸ"><a href="#ä½œç”¨åŸŸ" class="headerlink" title="ä½œç”¨åŸŸ"></a>ä½œç”¨åŸŸ</h3><p>ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œå¦‚æœå‚æ•°é»˜è®¤å€¼æ˜¯ä¸€ä¸ªå˜é‡ï¼Œåˆ™è¯¥å˜é‡æ‰€å¤„çš„ä½œç”¨åŸŸï¼Œä¸å…¶ä»–å˜é‡çš„ä½œç”¨åŸŸè§„åˆ™æ˜¯ä¸€æ ·çš„ï¼Œå³å…ˆæ˜¯å½“å‰å‡½æ•°çš„ä½œç”¨åŸŸï¼Œç„¶åæ‰æ˜¯å…¨å±€ä½œç”¨åŸŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y = x</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f(<span class="number">2</span>) <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°<code>y</code>çš„é»˜è®¤å€¼ç­‰äº<code>x</code>ã€‚è°ƒç”¨æ—¶ï¼Œç”±äºå‡½æ•°ä½œç”¨åŸŸå†…éƒ¨çš„å˜é‡<code>x</code>å·²ç»ç”Ÿæˆï¼Œæ‰€ä»¥<code>y</code>ç­‰äºå‚æ•°<code>x</code>ï¼Œè€Œä¸æ˜¯å…¨å±€å˜é‡<code>x</code>ã€‚</p>
<p>å¦‚æœè°ƒç”¨æ—¶ï¼Œå‡½æ•°ä½œç”¨åŸŸå†…éƒ¨çš„å˜é‡<code>x</code>æ²¡æœ‰ç”Ÿæˆï¼Œç»“æœå°±ä¼šä¸ä¸€æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> x = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">y = x</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> x = <span class="number">2</span>;</div><div class="line">  <span class="built_in">console</span>.log(y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f() <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°è°ƒç”¨æ—¶ï¼Œ<code>y</code>çš„é»˜è®¤å€¼å˜é‡<code>x</code>å°šæœªåœ¨å‡½æ•°å†…éƒ¨ç”Ÿæˆï¼Œæ‰€ä»¥<code>x</code>æŒ‡å‘å…¨å±€å˜é‡ã€‚</p>
<p>å¦‚æœæ­¤æ—¶ï¼Œå…¨å±€å˜é‡<code>x</code>ä¸å­˜åœ¨ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">y = x</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> x = <span class="number">2</span>;</div><div class="line">  <span class="built_in">console</span>.log(y);</div><div class="line">&#125;</div><div class="line"></div><div class="line">f() <span class="comment">// ReferenceError: x is not defined</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢è¿™æ ·å†™ï¼Œä¹Ÿä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x = x</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">foo() <span class="comment">// ReferenceError: x is not defined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>foo</code>çš„å‚æ•°<code>x</code>çš„é»˜è®¤å€¼ä¹Ÿæ˜¯<code>x</code>ã€‚è¿™æ—¶ï¼Œé»˜è®¤å€¼<code>x</code>çš„ä½œç”¨åŸŸæ˜¯å‡½æ•°ä½œç”¨åŸŸï¼Œè€Œä¸æ˜¯å…¨å±€ä½œç”¨åŸŸã€‚ç”±äºåœ¨å‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œå­˜åœ¨å˜é‡<code>x</code>ï¼Œä½†æ˜¯é»˜è®¤å€¼åœ¨<code>x</code>èµ‹å€¼ä¹‹å‰å…ˆæ‰§è¡Œäº†ï¼Œæ‰€ä»¥è¿™æ—¶å±äºæš‚æ—¶æ€§æ­»åŒºï¼ˆå‚è§ã€Šletå’Œconstå‘½ä»¤ã€‹ä¸€ç« ï¼‰ï¼Œä»»ä½•å¯¹<code>x</code>çš„æ“ä½œéƒ½ä¼šæŠ¥é”™ã€‚</p>
<p>å¦‚æœå‚æ•°çš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°çš„ä½œç”¨åŸŸæ˜¯å…¶å£°æ˜æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸã€‚è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> foo = <span class="string">'outer'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">func = x =&gt; foo</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> foo = <span class="string">'inner'</span>;</div><div class="line">  <span class="built_in">console</span>.log(func()); <span class="comment">// outer</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">bar();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>bar</code>çš„å‚æ•°<code>func</code>çš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè¿”å›å€¼ä¸ºå˜é‡<code>foo</code>ã€‚è¿™ä¸ªåŒ¿åå‡½æ•°å£°æ˜æ—¶ï¼Œ<code>bar</code>å‡½æ•°çš„ä½œç”¨åŸŸè¿˜æ²¡æœ‰å½¢æˆï¼Œæ‰€ä»¥åŒ¿åå‡½æ•°é‡Œé¢çš„<code>foo</code>æŒ‡å‘å¤–å±‚ä½œç”¨åŸŸçš„<code>foo</code>ï¼Œè¾“å‡º<code>outer</code>ã€‚</p>
<p>å¦‚æœå†™æˆä¸‹é¢è¿™æ ·ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">func = (</span>) =&gt; <span class="title">foo</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> foo = <span class="string">'inner'</span>;</div><div class="line">  <span class="built_in">console</span>.log(func());</div><div class="line">&#125;</div><div class="line"></div><div class="line">bar() <span class="comment">// ReferenceError: foo is not defined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒåŒ¿åå‡½æ•°é‡Œé¢çš„<code>foo</code>æŒ‡å‘å‡½æ•°å¤–å±‚ï¼Œä½†æ˜¯å‡½æ•°å¤–å±‚å¹¶æ²¡æœ‰å£°æ˜<code>foo</code>ï¼Œæ‰€ä»¥å°±æŠ¥é”™äº†ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y = function(</span>) </span>&#123; x = <span class="number">2</span>; &#125;) &#123;</div><div class="line">  <span class="keyword">var</span> x = <span class="number">3</span>;</div><div class="line">  y();</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo() <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>foo</code>çš„å‚æ•°<code>y</code>çš„é»˜è®¤å€¼æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ã€‚å‡½æ•°<code>foo</code>è°ƒç”¨æ—¶ï¼Œå®ƒçš„å‚æ•°<code>x</code>çš„å€¼ä¸º<code>undefined</code>ï¼Œæ‰€ä»¥<code>y</code>å‡½æ•°å†…éƒ¨çš„<code>x</code>ä¸€å¼€å§‹æ˜¯<code>undefined</code>ï¼Œåæ¥è¢«é‡æ–°èµ‹å€¼<code>2</code>ã€‚ä½†æ˜¯ï¼Œå‡½æ•°<code>foo</code>å†…éƒ¨é‡æ–°å£°æ˜äº†ä¸€ä¸ª<code>x</code>ï¼Œå€¼ä¸º<code>3</code>ï¼Œè¿™ä¸¤ä¸ª<code>x</code>æ˜¯ä¸ä¸€æ ·çš„ï¼Œäº’ç›¸ä¸äº§ç”Ÿå½±å“ï¼Œå› æ­¤æœ€åè¾“å‡º<code>3</code>ã€‚</p>
<p>å¦‚æœå°†<code>var x = 3</code>çš„<code>var</code>å»é™¤ï¼Œä¸¤ä¸ª<code>x</code>å°±æ˜¯ä¸€æ ·çš„ï¼Œæœ€åè¾“å‡ºçš„å°±æ˜¯<code>2</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">x, y = function(</span>) </span>&#123; x = <span class="number">2</span>; &#125;) &#123;</div><div class="line">  x = <span class="number">3</span>;</div><div class="line">  y();</div><div class="line">  <span class="built_in">console</span>.log(x);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo() <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<h3 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h3><p>åˆ©ç”¨å‚æ•°é»˜è®¤å€¼ï¼Œå¯ä»¥æŒ‡å®šæŸä¸€ä¸ªå‚æ•°ä¸å¾—çœç•¥ï¼Œå¦‚æœçœç•¥å°±æŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">throwIfMissing</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Missing parameter'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">mustBeProvided = throwIfMissing(</span>)) </span>&#123;</div><div class="line">  <span class="keyword">return</span> mustBeProvided;</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo()</div><div class="line"><span class="comment">// Error: Missing parameter</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>foo</code>å‡½æ•°ï¼Œå¦‚æœè°ƒç”¨çš„æ—¶å€™æ²¡æœ‰å‚æ•°ï¼Œå°±ä¼šè°ƒç”¨é»˜è®¤å€¼<code>throwIfMissing</code>å‡½æ•°ï¼Œä»è€ŒæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>ä»ä¸Šé¢ä»£ç è¿˜å¯ä»¥çœ‹åˆ°ï¼Œå‚æ•°<code>mustBeProvided</code>çš„é»˜è®¤å€¼ç­‰äº<code>throwIfMissing</code>å‡½æ•°çš„è¿è¡Œç»“æœï¼ˆå³å‡½æ•°åä¹‹åæœ‰ä¸€å¯¹åœ†æ‹¬å·ï¼‰ï¼Œè¿™è¡¨æ˜å‚æ•°çš„é»˜è®¤å€¼ä¸æ˜¯åœ¨å®šä¹‰æ—¶æ‰§è¡Œï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶æ‰§è¡Œï¼ˆå³å¦‚æœå‚æ•°å·²ç»èµ‹å€¼ï¼Œé»˜è®¤å€¼ä¸­çš„å‡½æ•°å°±ä¸ä¼šè¿è¡Œï¼‰ï¼Œè¿™ä¸pythonè¯­è¨€ä¸ä¸€æ ·ã€‚</p>
<p>å¦å¤–ï¼Œå¯ä»¥å°†å‚æ•°é»˜è®¤å€¼è®¾ä¸º<code>undefined</code>ï¼Œè¡¨æ˜è¿™ä¸ªå‚æ•°æ˜¯å¯ä»¥çœç•¥çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">optional = undefined</span>) </span>&#123; Â·Â·Â· &#125;</div></pre></td></tr></table></figure>
<h2 id="restå‚æ•°"><a href="#restå‚æ•°" class="headerlink" title="restå‚æ•°"></a>restå‚æ•°</h2><p>ES6å¼•å…¥restå‚æ•°ï¼ˆå½¢å¼ä¸ºâ€œâ€¦å˜é‡åâ€ï¼‰ï¼Œç”¨äºè·å–å‡½æ•°çš„å¤šä½™å‚æ•°ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä½¿ç”¨argumentså¯¹è±¡äº†ã€‚restå‚æ•°æ­é…çš„å˜é‡æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥å˜é‡å°†å¤šä½™çš„å‚æ•°æ”¾å…¥æ•°ç»„ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">...values</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> sum = <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> val <span class="keyword">of</span> values) &#123;</div><div class="line">    sum += val;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> sum;</div><div class="line">&#125;</div><div class="line"></div><div class="line">add(<span class="number">2</span>, <span class="number">5</span>, <span class="number">3</span>) <span class="comment">// 10</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„addå‡½æ•°æ˜¯ä¸€ä¸ªæ±‚å’Œå‡½æ•°ï¼Œåˆ©ç”¨restå‚æ•°ï¼Œå¯ä»¥å‘è¯¥å‡½æ•°ä¼ å…¥ä»»æ„æ•°ç›®çš„å‚æ•°ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªrestå‚æ•°ä»£æ›¿argumentså˜é‡çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// argumentså˜é‡çš„å†™æ³•</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sortNumbers</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>).sort();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// restå‚æ•°çš„å†™æ³•</span></div><div class="line"><span class="keyword">const</span> sortNumbers = <span class="function">(<span class="params">...numbers</span>) =&gt;</span> numbers.sort();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„ä¸¤ç§å†™æ³•ï¼Œæ¯”è¾ƒåå¯ä»¥å‘ç°ï¼Œrestå‚æ•°çš„å†™æ³•æ›´è‡ªç„¶ä¹Ÿæ›´ç®€æ´ã€‚</p>
<p>restå‚æ•°ä¸­çš„å˜é‡ä»£è¡¨ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥æ•°ç»„ç‰¹æœ‰çš„æ–¹æ³•éƒ½å¯ä»¥ç”¨äºè¿™ä¸ªå˜é‡ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ©ç”¨restå‚æ•°æ”¹å†™æ•°ç»„pushæ–¹æ³•çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">array, ...items</span>) </span>&#123;</div><div class="line">  items.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>) </span>&#123;</div><div class="line">    array.push(item);</div><div class="line">    <span class="built_in">console</span>.log(item);</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = [];</div><div class="line">push(a, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œrestå‚æ•°ä¹‹åä¸èƒ½å†æœ‰å…¶ä»–å‚æ•°ï¼ˆå³åªèƒ½æ˜¯æœ€åä¸€ä¸ªå‚æ•°ï¼‰ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">a, ...b, c</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å‡½æ•°çš„lengthå±æ€§ï¼Œä¸åŒ…æ‹¬restå‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">a</span>) </span>&#123;&#125;).length  <span class="comment">// 1</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">...a</span>) </span>&#123;&#125;).length  <span class="comment">// 0</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">a, ...b</span>) </span>&#123;&#125;).length  <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<h2 id="æ‰©å±•è¿ç®—ç¬¦"><a href="#æ‰©å±•è¿ç®—ç¬¦" class="headerlink" title="æ‰©å±•è¿ç®—ç¬¦"></a>æ‰©å±•è¿ç®—ç¬¦</h2><h3 id="å«ä¹‰"><a href="#å«ä¹‰" class="headerlink" title="å«ä¹‰"></a>å«ä¹‰</h3><p>æ‰©å±•è¿ç®—ç¬¦ï¼ˆspreadï¼‰æ˜¯ä¸‰ä¸ªç‚¹ï¼ˆ<code>...</code>ï¼‰ã€‚å®ƒå¥½æ¯”restå‚æ•°çš„é€†è¿ç®—ï¼Œå°†ä¸€ä¸ªæ•°ç»„è½¬ä¸ºç”¨é€—å·åˆ†éš”çš„å‚æ•°åºåˆ—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log(...[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="comment">// 1 2 3</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="number">1</span>, ...[<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="number">5</span>)</div><div class="line"><span class="comment">// 1 2 3 4 5</span></div><div class="line"></div><div class="line">[...document.querySelectorAll(<span class="string">'div'</span>)]</div><div class="line"><span class="comment">// [&lt;div&gt;, &lt;div&gt;, &lt;div&gt;]</span></div></pre></td></tr></table></figure>
<p>è¯¥è¿ç®—ç¬¦ä¸»è¦ç”¨äºå‡½æ•°è°ƒç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">push</span>(<span class="params">array, ...items</span>) </span>&#123;</div><div class="line">  array.push(...items);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x + y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> numbers = [<span class="number">4</span>, <span class="number">38</span>];</div><div class="line">add(...numbers) <span class="comment">// 42</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>array.push(...items)</code>å’Œ<code>add(...numbers)</code>è¿™ä¸¤è¡Œï¼Œéƒ½æ˜¯å‡½æ•°çš„è°ƒç”¨ï¼Œå®ƒä»¬çš„éƒ½ä½¿ç”¨äº†æ‰©å±•è¿ç®—ç¬¦ã€‚è¯¥è¿ç®—ç¬¦å°†ä¸€ä¸ªæ•°ç»„ï¼Œå˜ä¸ºå‚æ•°åºåˆ—ã€‚</p>
<p>æ‰©å±•è¿ç®—ç¬¦ä¸æ­£å¸¸çš„å‡½æ•°å‚æ•°å¯ä»¥ç»“åˆä½¿ç”¨ï¼Œéå¸¸çµæ´»ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">v, w, x, y, z</span>) </span>&#123; &#125;</div><div class="line"><span class="keyword">var</span> args = [<span class="number">0</span>, <span class="number">1</span>];</div><div class="line">f(<span class="number">-1</span>, ...args, <span class="number">2</span>, ...[<span class="number">3</span>]);</div></pre></td></tr></table></figure>
<h3 id="æ›¿ä»£æ•°ç»„çš„applyæ–¹æ³•"><a href="#æ›¿ä»£æ•°ç»„çš„applyæ–¹æ³•" class="headerlink" title="æ›¿ä»£æ•°ç»„çš„applyæ–¹æ³•"></a>æ›¿ä»£æ•°ç»„çš„applyæ–¹æ³•</h3><p>ç”±äºæ‰©å±•è¿ç®—ç¬¦å¯ä»¥å±•å¼€æ•°ç»„ï¼Œæ‰€ä»¥ä¸å†éœ€è¦<code>apply</code>æ–¹æ³•ï¼Œå°†æ•°ç»„è½¬ä¸ºå‡½æ•°çš„å‚æ•°äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5çš„å†™æ³•</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y, z</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> args = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</div><div class="line">f.apply(<span class="literal">null</span>, args);</div><div class="line"></div><div class="line"><span class="comment">// ES6çš„å†™æ³•</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x, y, z</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> args = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</div><div class="line">f(...args);</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯æ‰©å±•è¿ç®—ç¬¦å–ä»£<code>apply</code>æ–¹æ³•çš„ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œåº”ç”¨<code>Math.max</code>æ–¹æ³•ï¼Œç®€åŒ–æ±‚å‡ºä¸€ä¸ªæ•°ç»„æœ€å¤§å…ƒç´ çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5çš„å†™æ³•</span></div><div class="line"><span class="built_in">Math</span>.max.apply(<span class="literal">null</span>, [<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>])</div><div class="line"></div><div class="line"><span class="comment">// ES6çš„å†™æ³•</span></div><div class="line"><span class="built_in">Math</span>.max(...[<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>])</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="built_in">Math</span>.max(<span class="number">14</span>, <span class="number">3</span>, <span class="number">77</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œç”±äºJavaScriptä¸æä¾›æ±‚æ•°ç»„æœ€å¤§å…ƒç´ çš„å‡½æ•°ï¼Œæ‰€ä»¥åªèƒ½å¥—ç”¨<code>Math.max</code>å‡½æ•°ï¼Œå°†æ•°ç»„è½¬ä¸ºä¸€ä¸ªå‚æ•°åºåˆ—ï¼Œç„¶åæ±‚æœ€å¤§å€¼ã€‚æœ‰äº†æ‰©å±•è¿ç®—ç¬¦ä»¥åï¼Œå°±å¯ä»¥ç›´æ¥ç”¨<code>Math.max</code>äº†ã€‚</p>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯é€šè¿‡<code>push</code>å‡½æ•°ï¼Œå°†ä¸€ä¸ªæ•°ç»„æ·»åŠ åˆ°å¦ä¸€ä¸ªæ•°ç»„çš„å°¾éƒ¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> arr1 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</div><div class="line"><span class="keyword">var</span> arr2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line"><span class="built_in">Array</span>.prototype.push.apply(arr1, arr2);</div><div class="line"></div><div class="line"><span class="comment">// ES6çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> arr1 = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>];</div><div class="line"><span class="keyword">var</span> arr2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line">arr1.push(...arr2);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„ES5å†™æ³•ä¸­ï¼Œ<code>push</code>æ–¹æ³•çš„å‚æ•°ä¸èƒ½æ˜¯æ•°ç»„ï¼Œæ‰€ä»¥åªå¥½é€šè¿‡<code>apply</code>æ–¹æ³•å˜é€šä½¿ç”¨<code>push</code>æ–¹æ³•ã€‚æœ‰äº†æ‰©å±•è¿ç®—ç¬¦ï¼Œå°±å¯ä»¥ç›´æ¥å°†æ•°ç»„ä¼ å…¥<code>push</code>æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦å¤–ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5</span></div><div class="line"><span class="keyword">new</span> (<span class="built_in">Date</span>.bind.apply(<span class="built_in">Date</span>, [<span class="literal">null</span>, <span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>]))</div><div class="line"><span class="comment">// ES6</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">Date</span>(...[<span class="number">2015</span>, <span class="number">1</span>, <span class="number">1</span>]);</div></pre></td></tr></table></figure>
<h3 id="æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨"><a href="#æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨" class="headerlink" title="æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨"></a>æ‰©å±•è¿ç®—ç¬¦çš„åº”ç”¨</h3><p><strong>ï¼ˆ1ï¼‰åˆå¹¶æ•°ç»„</strong></p>
<p>æ‰©å±•è¿ç®—ç¬¦æä¾›äº†æ•°ç»„åˆå¹¶çš„æ–°å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>].concat(more)</div><div class="line"><span class="comment">// ES6</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, ...more]</div><div class="line"></div><div class="line"><span class="keyword">var</span> arr1 = [<span class="string">'a'</span>, <span class="string">'b'</span>];</div><div class="line"><span class="keyword">var</span> arr2 = [<span class="string">'c'</span>];</div><div class="line"><span class="keyword">var</span> arr3 = [<span class="string">'d'</span>, <span class="string">'e'</span>];</div><div class="line"></div><div class="line"><span class="comment">// ES5çš„åˆå¹¶æ•°ç»„</span></div><div class="line">arr1.concat(arr2, arr3);</div><div class="line"><span class="comment">// [ 'a', 'b', 'c', 'd', 'e' ]</span></div><div class="line"></div><div class="line"><span class="comment">// ES6çš„åˆå¹¶æ•°ç»„</span></div><div class="line">[...arr1, ...arr2, ...arr3]</div><div class="line"><span class="comment">// [ 'a', 'b', 'c', 'd', 'e' ]</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰ä¸è§£æ„èµ‹å€¼ç»“åˆ</strong></p>
<p>æ‰©å±•è¿ç®—ç¬¦å¯ä»¥ä¸è§£æ„èµ‹å€¼ç»“åˆèµ·æ¥ï¼Œç”¨äºç”Ÿæˆæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5</span></div><div class="line">a = list[<span class="number">0</span>], rest = list.slice(<span class="number">1</span>)</div><div class="line"><span class="comment">// ES6</span></div><div class="line">[a, ...rest] = list</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å¦å¤–ä¸€äº›ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line">first <span class="comment">// 1</span></div><div class="line">rest  <span class="comment">// [2, 3, 4, 5]</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> [first, ...rest] = [];</div><div class="line">first <span class="comment">// undefined</span></div><div class="line">rest  <span class="comment">// []:</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> [first, ...rest] = [<span class="string">"foo"</span>];</div><div class="line">first  <span class="comment">// "foo"</span></div><div class="line">rest   <span class="comment">// []</span></div></pre></td></tr></table></figure>
<p>å¦‚æœå°†æ‰©å±•è¿ç®—ç¬¦ç”¨äºæ•°ç»„èµ‹å€¼ï¼Œåªèƒ½æ”¾åœ¨å‚æ•°çš„æœ€åä¸€ä½ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> [...butLast, last] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> [first, ...middle, last] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</div><div class="line"><span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰å‡½æ•°çš„è¿”å›å€¼</strong></p>
<p>JavaScriptçš„å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚æœéœ€è¦è¿”å›å¤šä¸ªå€¼ï¼Œåªèƒ½è¿”å›æ•°ç»„æˆ–å¯¹è±¡ã€‚æ‰©å±•è¿ç®—ç¬¦æä¾›äº†è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§å˜é€šæ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> dateFields = readDateFields(database);</div><div class="line"><span class="keyword">var</span> d = <span class="keyword">new</span> <span class="built_in">Date</span>(...dateFields);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä»æ•°æ®åº“å–å‡ºä¸€è¡Œæ•°æ®ï¼Œé€šè¿‡æ‰©å±•è¿ç®—ç¬¦ï¼Œç›´æ¥å°†å…¶ä¼ å…¥æ„é€ å‡½æ•°<code>Date</code>ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰å­—ç¬¦ä¸²</strong></p>
<p>æ‰©å±•è¿ç®—ç¬¦è¿˜å¯ä»¥å°†å­—ç¬¦ä¸²è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[...<span class="string">'hello'</span>]</div><div class="line"><span class="comment">// [ "h", "e", "l", "l", "o" ]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„å†™æ³•ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„å¥½å¤„ï¼Œé‚£å°±æ˜¯èƒ½å¤Ÿæ­£ç¡®è¯†åˆ«32ä½çš„Unicodeå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'x\uD83D\uDE80y'</span>.length <span class="comment">// 4</span></div><div class="line">[...<span class="string">'x\uD83D\uDE80y'</span>].length <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„ç¬¬ä¸€ç§å†™æ³•ï¼ŒJavaScriptä¼šå°†32ä½Unicodeå­—ç¬¦ï¼Œè¯†åˆ«ä¸º2ä¸ªå­—ç¬¦ï¼Œé‡‡ç”¨æ‰©å±•è¿ç®—ç¬¦å°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚å› æ­¤ï¼Œæ­£ç¡®è¿”å›å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°ï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">length</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [...str].length;</div><div class="line">&#125;</div><div class="line"></div><div class="line">length(<span class="string">'x\uD83D\uDE80y'</span>) <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>å‡¡æ˜¯æ¶‰åŠåˆ°æ“ä½œ32ä½Unicodeå­—ç¬¦çš„å‡½æ•°ï¼Œéƒ½æœ‰è¿™ä¸ªé—®é¢˜ã€‚å› æ­¤ï¼Œæœ€å¥½éƒ½ç”¨æ‰©å±•è¿ç®—ç¬¦æ”¹å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> str = <span class="string">'x\uD83D\uDE80y'</span>;</div><div class="line"></div><div class="line">str.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</div><div class="line"><span class="comment">// 'y\uDE80\uD83Dx'</span></div><div class="line"></div><div class="line">[...str].reverse().join(<span class="string">''</span>)</div><div class="line"><span class="comment">// 'y\uD83D\uDE80x'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœä¸ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œå­—ç¬¦ä¸²çš„<code>reverse</code>æ“ä½œå°±ä¸æ­£ç¡®ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰å®ç°äº†Iteratoræ¥å£çš„å¯¹è±¡</strong></p>
<p>ä»»ä½•Iteratoræ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨æ‰©å±•è¿ç®—ç¬¦è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> nodeList = <span class="built_in">document</span>.querySelectorAll(<span class="string">'div'</span>);</div><div class="line"><span class="keyword">var</span> array = [...nodeList];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>querySelectorAll</code>æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª<code>nodeList</code>å¯¹è±¡ã€‚å®ƒä¸æ˜¯æ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚è¿™æ—¶ï¼Œæ‰©å±•è¿ç®—ç¬¦å¯ä»¥å°†å…¶è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼ŒåŸå› å°±åœ¨äº<code>NodeList</code>å¯¹è±¡å®ç°äº†Iteratoræ¥å£ã€‚</p>
<p>å¯¹äºé‚£äº›æ²¡æœ‰éƒ¨ç½²Iteratoræ¥å£çš„ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•å°†å…¶è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arrayLike = &#123;</div><div class="line">  <span class="string">'0'</span>: <span class="string">'a'</span>,</div><div class="line">  <span class="string">'1'</span>: <span class="string">'b'</span>,</div><div class="line">  <span class="string">'2'</span>: <span class="string">'c'</span>,</div><div class="line">  <span class="attr">length</span>: <span class="number">3</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// TypeError: Cannot spread non-iterable object.</span></div><div class="line"><span class="keyword">let</span> arr = [...arrayLike];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>arrayLike</code>æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œä½†æ˜¯æ²¡æœ‰éƒ¨ç½²Iteratoræ¥å£ï¼Œæ‰©å±•è¿ç®—ç¬¦å°±ä¼šæŠ¥é”™ã€‚è¿™æ—¶ï¼Œå¯ä»¥æ”¹ä¸ºä½¿ç”¨<code>Array.from</code>æ–¹æ³•å°†<code>arrayLike</code>è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</p>
<p><strong>ï¼ˆ6ï¼‰Mapå’ŒSetç»“æ„ï¼ŒGeneratorå‡½æ•°</strong></p>
<p>æ‰©å±•è¿ç®—ç¬¦å†…éƒ¨è°ƒç”¨çš„æ˜¯æ•°æ®ç»“æ„çš„Iteratoræ¥å£ï¼Œå› æ­¤åªè¦å…·æœ‰Iteratoræ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œæ¯”å¦‚Mapç»“æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</div><div class="line">  [<span class="number">1</span>, <span class="string">'one'</span>],</div><div class="line">  [<span class="number">2</span>, <span class="string">'two'</span>],</div><div class="line">  [<span class="number">3</span>, <span class="string">'three'</span>],</div><div class="line">]);</div><div class="line"></div><div class="line"><span class="keyword">let</span> arr = [...map.keys()]; <span class="comment">// [1, 2, 3]</span></div></pre></td></tr></table></figure>
<p>Generatorå‡½æ•°è¿è¡Œåï¼Œè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå› æ­¤ä¹Ÿå¯ä»¥ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> go = <span class="function"><span class="keyword">function</span>*(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">[...go()] <span class="comment">// [1, 2, 3]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>go</code>æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ï¼Œæ‰§è¡Œåè¿”å›çš„æ˜¯ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œå¯¹è¿™ä¸ªéå†å™¨å¯¹è±¡æ‰§è¡Œæ‰©å±•è¿ç®—ç¬¦ï¼Œå°±ä¼šå°†å†…éƒ¨éå†å¾—åˆ°çš„å€¼ï¼Œè½¬ä¸ºä¸€ä¸ªæ•°ç»„ã€‚</p>
<p>å¦‚æœå¯¹æ²¡æœ‰<code>iterator</code>æ¥å£çš„å¯¹è±¡ï¼Œä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦ï¼Œå°†ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>&#125;;</div><div class="line"><span class="keyword">let</span> arr = [...obj]; <span class="comment">// TypeError: Cannot spread non-iterable object</span></div></pre></td></tr></table></figure>
<h2 id="ä¸¥æ ¼æ¨¡å¼"><a href="#ä¸¥æ ¼æ¨¡å¼" class="headerlink" title="ä¸¥æ ¼æ¨¡å¼"></a>ä¸¥æ ¼æ¨¡å¼</h2><p>ä»ES5å¼€å§‹ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è®¾å®šä¸ºä¸¥æ ¼æ¨¡å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line">  <span class="comment">// code</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ã€ŠECMAScript 2016æ ‡å‡†ã€‹åšäº†ä¸€ç‚¹ä¿®æ”¹ï¼Œè§„å®šåªè¦å‡½æ•°å‚æ•°ä½¿ç”¨äº†é»˜è®¤å€¼ã€è§£æ„èµ‹å€¼ã€æˆ–è€…æ‰©å±•è¿ç®—ç¬¦ï¼Œé‚£ä¹ˆå‡½æ•°å†…éƒ¨å°±ä¸èƒ½æ˜¾å¼è®¾å®šä¸ºä¸¥æ ¼æ¨¡å¼ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">a, b = a</span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line">  <span class="comment">// code</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">const</span> doSomething = <span class="function"><span class="keyword">function</span> (<span class="params">&#123;a, b&#125;</span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line">  <span class="comment">// code</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">const</span> doSomething = <span class="function">(<span class="params">...a</span>) =&gt;</span> &#123;</div><div class="line">  <span class="string">'use strict'</span>;</div><div class="line">  <span class="comment">// code</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> obj = &#123;</div><div class="line">  <span class="comment">// æŠ¥é”™</span></div><div class="line">  doSomething(&#123;a, b&#125;) &#123;</div><div class="line">    <span class="string">'use strict'</span>;</div><div class="line">    <span class="comment">// code</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>è¿™æ ·è§„å®šçš„åŸå› æ˜¯ï¼Œå‡½æ•°å†…éƒ¨çš„ä¸¥æ ¼æ¨¡å¼ï¼ŒåŒæ—¶é€‚ç”¨äºå‡½æ•°ä½“ä»£ç å’Œå‡½æ•°å‚æ•°ä»£ç ã€‚ä½†æ˜¯ï¼Œå‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œå…ˆæ‰§è¡Œå‡½æ•°å‚æ•°ä»£ç ï¼Œç„¶åå†æ‰§è¡Œå‡½æ•°ä½“ä»£ç ã€‚è¿™æ ·å°±æœ‰ä¸€ä¸ªä¸åˆç†çš„åœ°æ–¹ï¼Œåªæœ‰ä»å‡½æ•°ä½“ä»£ç ä¹‹ä¸­ï¼Œæ‰èƒ½çŸ¥é“å‚æ•°ä»£ç æ˜¯å¦åº”è¯¥ä»¥ä¸¥æ ¼æ¨¡å¼æ‰§è¡Œï¼Œä½†æ˜¯å‚æ•°ä»£ç å´åº”è¯¥å…ˆäºå‡½æ•°ä½“ä»£ç æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">value = <span class="number">070</span></span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line">  <span class="keyword">return</span> value;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•°<code>value</code>çš„é»˜è®¤å€¼æ˜¯å…«è¿›åˆ¶æ•°<code>070</code>ï¼Œä½†æ˜¯ä¸¥æ ¼æ¨¡å¼ä¸‹ä¸èƒ½ç”¨å‰ç¼€<code>0</code>è¡¨ç¤ºå…«è¿›åˆ¶ï¼Œæ‰€ä»¥åº”è¯¥æŠ¥é”™ã€‚ä½†æ˜¯å®é™…ä¸Šï¼ŒJavaScriptå¼•æ“ä¼šå…ˆæˆåŠŸæ‰§è¡Œ<code>value = 070</code>ï¼Œç„¶åè¿›å…¥å‡½æ•°ä½“å†…éƒ¨ï¼Œå‘ç°éœ€è¦ç”¨ä¸¥æ ¼æ¨¡å¼æ‰§è¡Œï¼Œè¿™æ—¶æ‰ä¼šæŠ¥é”™ã€‚</p>
<p>è™½ç„¶å¯ä»¥å…ˆè§£æå‡½æ•°ä½“ä»£ç ï¼Œå†æ‰§è¡Œå‚æ•°ä»£ç ï¼Œä½†æ˜¯è¿™æ ·æ— ç–‘å°±å¢åŠ äº†å¤æ‚æ€§ã€‚å› æ­¤ï¼Œæ ‡å‡†ç´¢æ€§ç¦æ­¢äº†è¿™ç§ç”¨æ³•ï¼Œåªè¦å‚æ•°ä½¿ç”¨äº†é»˜è®¤å€¼ã€è§£æ„èµ‹å€¼ã€æˆ–è€…æ‰©å±•è¿ç®—ç¬¦ï¼Œå°±ä¸èƒ½æ˜¾å¼æŒ‡å®šä¸¥æ ¼æ¨¡å¼ã€‚</p>
<p>ä¸¤ç§æ–¹æ³•å¯ä»¥è§„é¿è¿™ç§é™åˆ¶ã€‚ç¬¬ä¸€ç§æ˜¯è®¾å®šå…¨å±€æ€§çš„ä¸¥æ ¼æ¨¡å¼ï¼Œè¿™æ˜¯åˆæ³•çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span>(<span class="params">a, b = a</span>) </span>&#123;</div><div class="line">  <span class="comment">// code</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æ˜¯æŠŠå‡½æ•°åŒ…åœ¨ä¸€ä¸ªæ— å‚æ•°çš„ç«‹å³æ‰§è¡Œå‡½æ•°é‡Œé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> doSomething = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">value = <span class="number">42</span></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> value;</div><div class="line">  &#125;;</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<h2 id="name-å±æ€§"><a href="#name-å±æ€§" class="headerlink" title="name å±æ€§"></a>name å±æ€§</h2><p>å‡½æ•°çš„<code>name</code>å±æ€§ï¼Œè¿”å›è¯¥å‡½æ•°çš„å‡½æ•°åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">foo.name <span class="comment">// "foo"</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå±æ€§æ—©å°±è¢«æµè§ˆå™¨å¹¿æ³›æ”¯æŒï¼Œä½†æ˜¯ç›´åˆ° ES6ï¼Œæ‰å°†å…¶å†™å…¥äº†æ ‡å‡†ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒES6 å¯¹è¿™ä¸ªå±æ€§çš„è¡Œä¸ºåšå‡ºäº†ä¸€äº›ä¿®æ”¹ã€‚å¦‚æœå°†ä¸€ä¸ªåŒ¿åå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼ŒES5 çš„<code>name</code>å±æ€§ï¼Œä¼šè¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œè€Œ ES6 çš„<code>name</code>å±æ€§ä¼šè¿”å›å®é™…çš„å‡½æ•°åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ES5</span></div><div class="line">f.name <span class="comment">// ""</span></div><div class="line"></div><div class="line"><span class="comment">// ES6</span></div><div class="line">f.name <span class="comment">// "f"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>f</code>ç­‰äºä¸€ä¸ªåŒ¿åå‡½æ•°ï¼ŒES5 å’Œ ES6 çš„<code>name</code>å±æ€§è¿”å›çš„å€¼ä¸ä¸€æ ·ã€‚</p>
<p>å¦‚æœå°†ä¸€ä¸ªå…·åå‡½æ•°èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œåˆ™ ES5 å’Œ ES6 çš„<code>name</code>å±æ€§éƒ½è¿”å›è¿™ä¸ªå…·åå‡½æ•°åŸæœ¬çš„åå­—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> bar = <span class="function"><span class="keyword">function</span> <span class="title">baz</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ES5</span></div><div class="line">bar.name <span class="comment">// "baz"</span></div><div class="line"></div><div class="line"><span class="comment">// ES6</span></div><div class="line">bar.name <span class="comment">// "baz"</span></div></pre></td></tr></table></figure>
<p><code>Function</code>æ„é€ å‡½æ•°è¿”å›çš„å‡½æ•°å®ä¾‹ï¼Œ<code>name</code>å±æ€§çš„å€¼ä¸º<code>anonymous</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(<span class="keyword">new</span> <span class="built_in">Function</span>).name <span class="comment">// "anonymous"</span></div></pre></td></tr></table></figure>
<p><code>bind</code>è¿”å›çš„å‡½æ•°ï¼Œ<code>name</code>å±æ€§å€¼ä¼šåŠ ä¸Š<code>bound</code>å‰ç¼€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;&#125;;</div><div class="line">foo.bind(&#123;&#125;).name <span class="comment">// "bound foo"</span></div><div class="line"></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;).bind(&#123;&#125;).name <span class="comment">// "bound "</span></div></pre></td></tr></table></figure>
<h2 id="ç®­å¤´å‡½æ•°"><a href="#ç®­å¤´å‡½æ•°" class="headerlink" title="ç®­å¤´å‡½æ•°"></a>ç®­å¤´å‡½æ•°</h2><h3 id="åŸºæœ¬ç”¨æ³•-1"><a href="#åŸºæœ¬ç”¨æ³•-1" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>ES6å…è®¸ä½¿ç”¨â€œç®­å¤´â€ï¼ˆ<code>=&gt;</code>ï¼‰å®šä¹‰å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f = <span class="function"><span class="params">v</span> =&gt;</span> v;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ç®­å¤´å‡½æ•°ç­‰åŒäºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span>(<span class="params">v</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> v;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å¦‚æœç®­å¤´å‡½æ•°ä¸éœ€è¦å‚æ•°æˆ–éœ€è¦å¤šä¸ªå‚æ•°ï¼Œå°±ä½¿ç”¨ä¸€ä¸ªåœ†æ‹¬å·ä»£è¡¨å‚æ•°éƒ¨åˆ†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f = <span class="function"><span class="params">()</span> =&gt;</span> <span class="number">5</span>;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">var</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; <span class="keyword">return</span> <span class="number">5</span> &#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> num1 + num2;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">var</span> sum = <span class="function"><span class="keyword">function</span>(<span class="params">num1, num2</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> num1 + num2;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å¦‚æœç®­å¤´å‡½æ•°çš„ä»£ç å—éƒ¨åˆ†å¤šäºä¸€æ¡è¯­å¥ï¼Œå°±è¦ä½¿ç”¨å¤§æ‹¬å·å°†å®ƒä»¬æ‹¬èµ·æ¥ï¼Œå¹¶ä¸”ä½¿ç”¨<code>return</code>è¯­å¥è¿”å›ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sum = <span class="function">(<span class="params">num1, num2</span>) =&gt;</span> &#123; <span class="keyword">return</span> num1 + num2; &#125;</div></pre></td></tr></table></figure>
<p>ç”±äºå¤§æ‹¬å·è¢«è§£é‡Šä¸ºä»£ç å—ï¼Œæ‰€ä»¥å¦‚æœç®­å¤´å‡½æ•°ç›´æ¥è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œå¿…é¡»åœ¨å¯¹è±¡å¤–é¢åŠ ä¸Šæ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> getTempItem = <span class="function"><span class="params">id</span> =&gt;</span> (&#123; <span class="attr">id</span>: id, <span class="attr">name</span>: <span class="string">"Temp"</span> &#125;);</div></pre></td></tr></table></figure>
<p>ç®­å¤´å‡½æ•°å¯ä»¥ä¸å˜é‡è§£æ„ç»“åˆä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> full = <span class="function">(<span class="params">&#123; first, last &#125;</span>) =&gt;</span> first + <span class="string">' '</span> + last;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">full</span>(<span class="params">person</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> person.first + <span class="string">' '</span> + person.last;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç®­å¤´å‡½æ•°ä½¿å¾—è¡¨è¾¾æ›´åŠ ç®€æ´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> isEven = <span class="function"><span class="params">n</span> =&gt;</span> n % <span class="number">2</span> == <span class="number">0</span>;</div><div class="line"><span class="keyword">const</span> square = <span class="function"><span class="params">n</span> =&gt;</span> n * n;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åªç”¨äº†ä¸¤è¡Œï¼Œå°±å®šä¹‰äº†ä¸¤ä¸ªç®€å•çš„å·¥å…·å‡½æ•°ã€‚å¦‚æœä¸ç”¨ç®­å¤´å‡½æ•°ï¼Œå¯èƒ½å°±è¦å ç”¨å¤šè¡Œï¼Œè€Œä¸”è¿˜ä¸å¦‚ç°åœ¨è¿™æ ·å†™é†’ç›®ã€‚</p>
<p>ç®­å¤´å‡½æ•°çš„ä¸€ä¸ªç”¨å¤„æ˜¯ç®€åŒ–å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ­£å¸¸å‡½æ•°å†™æ³•</span></div><div class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].map(<span class="function"><span class="keyword">function</span> (<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x * x;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// ç®­å¤´å‡½æ•°å†™æ³•</span></div><div class="line">[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].map(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</div></pre></td></tr></table></figure>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ­£å¸¸å‡½æ•°å†™æ³•</span></div><div class="line"><span class="keyword">var</span> result = values.sort(<span class="function"><span class="keyword">function</span> (<span class="params">a, b</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a - b;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// ç®­å¤´å‡½æ•°å†™æ³•</span></div><div class="line"><span class="keyword">var</span> result = values.sort(<span class="function">(<span class="params">a, b</span>) =&gt;</span> a - b);</div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯restå‚æ•°ä¸ç®­å¤´å‡½æ•°ç»“åˆçš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> numbers = <span class="function">(<span class="params">...nums</span>) =&gt;</span> nums;</div><div class="line"></div><div class="line">numbers(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</div><div class="line"><span class="comment">// [1,2,3,4,5]</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> headAndTail = <span class="function">(<span class="params">head, ...tail</span>) =&gt;</span> [head, tail];</div><div class="line"></div><div class="line">headAndTail(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</div><div class="line"><span class="comment">// [1,[2,3,4,5]]</span></div></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨æ³¨æ„ç‚¹"><a href="#ä½¿ç”¨æ³¨æ„ç‚¹" class="headerlink" title="ä½¿ç”¨æ³¨æ„ç‚¹"></a>ä½¿ç”¨æ³¨æ„ç‚¹</h3><p>ç®­å¤´å‡½æ•°æœ‰å‡ ä¸ªä½¿ç”¨æ³¨æ„ç‚¹ã€‚</p>
<p>ï¼ˆ1ï¼‰å‡½æ•°ä½“å†…çš„<code>this</code>å¯¹è±¡ï¼Œå°±æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚</p>
<p>ï¼ˆ2ï¼‰ä¸å¯ä»¥å½“ä½œæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥ä½¿ç”¨<code>new</code>å‘½ä»¤ï¼Œå¦åˆ™ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>ï¼ˆ3ï¼‰ä¸å¯ä»¥ä½¿ç”¨<code>arguments</code>å¯¹è±¡ï¼Œè¯¥å¯¹è±¡åœ¨å‡½æ•°ä½“å†…ä¸å­˜åœ¨ã€‚å¦‚æœè¦ç”¨ï¼Œå¯ä»¥ç”¨Restå‚æ•°ä»£æ›¿ã€‚</p>
<p>ï¼ˆ4ï¼‰ä¸å¯ä»¥ä½¿ç”¨<code>yield</code>å‘½ä»¤ï¼Œå› æ­¤ç®­å¤´å‡½æ•°ä¸èƒ½ç”¨ä½œGeneratorå‡½æ•°ã€‚</p>
<p>ä¸Šé¢å››ç‚¹ä¸­ï¼Œç¬¬ä¸€ç‚¹å°¤å…¶å€¼å¾—æ³¨æ„ã€‚<code>this</code>å¯¹è±¡çš„æŒ‡å‘æ˜¯å¯å˜çš„ï¼Œä½†æ˜¯åœ¨ç®­å¤´å‡½æ•°ä¸­ï¼Œå®ƒæ˜¯å›ºå®šçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'id:'</span>, <span class="keyword">this</span>.id);</div><div class="line">  &#125;, <span class="number">100</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> id = <span class="number">21</span>;</div><div class="line"></div><div class="line">foo.call(&#123; <span class="attr">id</span>: <span class="number">42</span> &#125;);</div><div class="line"><span class="comment">// id: 42</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>setTimeout</code>çš„å‚æ•°æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œè¿™ä¸ªç®­å¤´å‡½æ•°çš„å®šä¹‰ç”Ÿæ•ˆæ˜¯åœ¨<code>foo</code>å‡½æ•°ç”Ÿæˆæ—¶ï¼Œè€Œå®ƒçš„çœŸæ­£æ‰§è¡Œè¦ç­‰åˆ°100æ¯«ç§’åã€‚å¦‚æœæ˜¯æ™®é€šå‡½æ•°ï¼Œæ‰§è¡Œæ—¶<code>this</code>åº”è¯¥æŒ‡å‘å…¨å±€å¯¹è±¡<code>window</code>ï¼Œè¿™æ—¶åº”è¯¥è¾“å‡º<code>21</code>ã€‚ä½†æ˜¯ï¼Œç®­å¤´å‡½æ•°å¯¼è‡´<code>this</code>æ€»æ˜¯æŒ‡å‘å‡½æ•°å®šä¹‰ç”Ÿæ•ˆæ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼ˆæœ¬ä¾‹æ˜¯<code>{id: 42}</code>ï¼‰ï¼Œæ‰€ä»¥è¾“å‡ºçš„æ˜¯<code>42</code>ã€‚</p>
<p>ç®­å¤´å‡½æ•°å¯ä»¥è®©<code>setTimeout</code>é‡Œé¢çš„<code>this</code>ï¼Œç»‘å®šå®šä¹‰æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼Œè€Œä¸æ˜¯æŒ‡å‘è¿è¡Œæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸã€‚ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Timer</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">this</span>.s1 = <span class="number">0</span>;</div><div class="line">  <span class="keyword">this</span>.s2 = <span class="number">0</span>;</div><div class="line">  <span class="comment">// ç®­å¤´å‡½æ•°</span></div><div class="line">  setInterval(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.s1++, <span class="number">1000</span>);</div><div class="line">  <span class="comment">// æ™®é€šå‡½æ•°</span></div><div class="line">  setInterval(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.s2++;</div><div class="line">  &#125;, <span class="number">1000</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> timer = <span class="keyword">new</span> Timer();</div><div class="line"></div><div class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'s1: '</span>, timer.s1), <span class="number">3100</span>);</div><div class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(<span class="string">'s2: '</span>, timer.s2), <span class="number">3100</span>);</div><div class="line"><span class="comment">// s1: 3</span></div><div class="line"><span class="comment">// s2: 0</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Timer</code>å‡½æ•°å†…éƒ¨è®¾ç½®äº†ä¸¤ä¸ªå®šæ—¶å™¨ï¼Œåˆ†åˆ«ä½¿ç”¨äº†ç®­å¤´å‡½æ•°å’Œæ™®é€šå‡½æ•°ã€‚å‰è€…çš„<code>this</code>ç»‘å®šå®šä¹‰æ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼ˆå³<code>Timer</code>å‡½æ•°ï¼‰ï¼Œåè€…çš„<code>this</code>æŒ‡å‘è¿è¡Œæ—¶æ‰€åœ¨çš„ä½œç”¨åŸŸï¼ˆå³å…¨å±€å¯¹è±¡ï¼‰ã€‚æ‰€ä»¥ï¼Œ3100æ¯«ç§’ä¹‹åï¼Œ<code>timer.s1</code>è¢«æ›´æ–°äº†3æ¬¡ï¼Œè€Œ<code>timer.s2</code>ä¸€æ¬¡éƒ½æ²¡æ›´æ–°ã€‚</p>
<p>ç®­å¤´å‡½æ•°å¯ä»¥è®©<code>this</code>æŒ‡å‘å›ºå®šåŒ–ï¼Œè¿™ç§ç‰¹æ€§å¾ˆæœ‰åˆ©äºå°è£…å›è°ƒå‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­ï¼ŒDOMäº‹ä»¶çš„å›è°ƒå‡½æ•°å°è£…åœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> handler = &#123;</div><div class="line">  <span class="attr">id</span>: <span class="string">'123456'</span>,</div><div class="line"></div><div class="line">  <span class="attr">init</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">document</span>.addEventListener(<span class="string">'click'</span>,</div><div class="line">      event =&gt; <span class="keyword">this</span>.doSomething(event.type), <span class="literal">false</span>);</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">doSomething</span>: <span class="function"><span class="keyword">function</span>(<span class="params">type</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Handling '</span> + type  + <span class="string">' for '</span> + <span class="keyword">this</span>.id);</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>init</code>æ–¹æ³•ä¸­ï¼Œä½¿ç”¨äº†ç®­å¤´å‡½æ•°ï¼Œè¿™å¯¼è‡´è¿™ä¸ªç®­å¤´å‡½æ•°é‡Œé¢çš„<code>this</code>ï¼Œæ€»æ˜¯æŒ‡å‘<code>handler</code>å¯¹è±¡ã€‚å¦åˆ™ï¼Œå›è°ƒå‡½æ•°è¿è¡Œæ—¶ï¼Œ<code>this.doSomething</code>è¿™ä¸€è¡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºæ­¤æ—¶<code>this</code>æŒ‡å‘<code>document</code>å¯¹è±¡ã€‚</p>
<p><code>this</code>æŒ‡å‘çš„å›ºå®šåŒ–ï¼Œå¹¶ä¸æ˜¯å› ä¸ºç®­å¤´å‡½æ•°å†…éƒ¨æœ‰ç»‘å®š<code>this</code>çš„æœºåˆ¶ï¼Œå®é™…åŸå› æ˜¯ç®­å¤´å‡½æ•°æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„<code>this</code>ï¼Œå¯¼è‡´å†…éƒ¨çš„<code>this</code>å°±æ˜¯å¤–å±‚ä»£ç å—çš„<code>this</code>ã€‚æ­£æ˜¯å› ä¸ºå®ƒæ²¡æœ‰<code>this</code>ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸èƒ½ç”¨ä½œæ„é€ å‡½æ•°ã€‚</p>
<p>æ‰€ä»¥ï¼Œç®­å¤´å‡½æ•°è½¬æˆES5çš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'id:'</span>, <span class="keyword">this</span>.id);</div><div class="line">  &#125;, <span class="number">100</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ES5</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> _this = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">  setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'id:'</span>, _this.id);</div><div class="line">  &#125;, <span class="number">100</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè½¬æ¢åçš„ES5ç‰ˆæœ¬æ¸…æ¥šåœ°è¯´æ˜äº†ï¼Œç®­å¤´å‡½æ•°é‡Œé¢æ ¹æœ¬æ²¡æœ‰è‡ªå·±çš„<code>this</code>ï¼Œè€Œæ˜¯å¼•ç”¨å¤–å±‚çš„<code>this</code>ã€‚</p>
<p>è¯·é—®ä¸‹é¢çš„ä»£ç ä¹‹ä¸­æœ‰å‡ ä¸ª<code>this</code>ï¼Ÿ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'id:'</span>, <span class="keyword">this</span>.id);</div><div class="line">      &#125;;</div><div class="line">    &#125;;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> f = foo.call(&#123;<span class="attr">id</span>: <span class="number">1</span>&#125;);</div><div class="line"></div><div class="line"><span class="keyword">var</span> t1 = f.call(&#123;<span class="attr">id</span>: <span class="number">2</span>&#125;)()(); <span class="comment">// id: 1</span></div><div class="line"><span class="keyword">var</span> t2 = f().call(&#123;<span class="attr">id</span>: <span class="number">3</span>&#125;)(); <span class="comment">// id: 1</span></div><div class="line"><span class="keyword">var</span> t3 = f()().call(&#123;<span class="attr">id</span>: <span class="number">4</span>&#125;); <span class="comment">// id: 1</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¹‹ä¸­ï¼Œåªæœ‰ä¸€ä¸ª<code>this</code>ï¼Œå°±æ˜¯å‡½æ•°<code>foo</code>çš„<code>this</code>ï¼Œæ‰€ä»¥<code>t1</code>ã€<code>t2</code>ã€<code>t3</code>éƒ½è¾“å‡ºåŒæ ·çš„ç»“æœã€‚å› ä¸ºæ‰€æœ‰çš„å†…å±‚å‡½æ•°éƒ½æ˜¯ç®­å¤´å‡½æ•°ï¼Œéƒ½æ²¡æœ‰è‡ªå·±çš„<code>this</code>ï¼Œå®ƒä»¬çš„<code>this</code>å…¶å®éƒ½æ˜¯æœ€å¤–å±‚<code>foo</code>å‡½æ•°çš„<code>this</code>ã€‚</p>
<p>é™¤äº†<code>this</code>ï¼Œä»¥ä¸‹ä¸‰ä¸ªå˜é‡åœ¨ç®­å¤´å‡½æ•°ä¹‹ä¸­ä¹Ÿæ˜¯ä¸å­˜åœ¨çš„ï¼ŒæŒ‡å‘å¤–å±‚å‡½æ•°çš„å¯¹åº”å˜é‡ï¼š<code>arguments</code>ã€<code>super</code>ã€<code>new.target</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'args:'</span>, <span class="built_in">arguments</span>);</div><div class="line">  &#125;, <span class="number">100</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">foo(<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>)</div><div class="line"><span class="comment">// args: [2, 4, 6, 8]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç®­å¤´å‡½æ•°å†…éƒ¨çš„å˜é‡<code>arguments</code>ï¼Œå…¶å®æ˜¯å‡½æ•°<code>foo</code>çš„<code>arguments</code>å˜é‡ã€‚</p>
<p>å¦å¤–ï¼Œç”±äºç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„<code>this</code>ï¼Œæ‰€ä»¥å½“ç„¶ä¹Ÿå°±ä¸èƒ½ç”¨<code>call()</code>ã€<code>apply()</code>ã€<code>bind()</code>è¿™äº›æ–¹æ³•å»æ”¹å˜<code>this</code>çš„æŒ‡å‘ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [</div><div class="line">    <span class="function">(<span class="params">(</span>) =&gt;</span> <span class="keyword">this</span>.x).bind(&#123; <span class="attr">x</span>: <span class="string">'inner'</span> &#125;)()</div><div class="line">  ];</div><div class="line">&#125;).call(&#123; <span class="attr">x</span>: <span class="string">'outer'</span> &#125;);</div><div class="line"><span class="comment">// ['outer']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„<code>this</code>ï¼Œæ‰€ä»¥<code>bind</code>æ–¹æ³•æ— æ•ˆï¼Œå†…éƒ¨çš„<code>this</code>æŒ‡å‘å¤–éƒ¨çš„<code>this</code>ã€‚</p>
<p>é•¿æœŸä»¥æ¥ï¼ŒJavaScriptè¯­è¨€çš„<code>this</code>å¯¹è±¡ä¸€ç›´æ˜¯ä¸€ä¸ªä»¤äººå¤´ç—›çš„é—®é¢˜ï¼Œåœ¨å¯¹è±¡æ–¹æ³•ä¸­ä½¿ç”¨<code>this</code>ï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚ç®­å¤´å‡½æ•°â€ç»‘å®šâ€<code>this</code>ï¼Œå¾ˆå¤§ç¨‹åº¦ä¸Šè§£å†³äº†è¿™ä¸ªå›°æ‰°ã€‚</p>
<h3 id="åµŒå¥—çš„ç®­å¤´å‡½æ•°"><a href="#åµŒå¥—çš„ç®­å¤´å‡½æ•°" class="headerlink" title="åµŒå¥—çš„ç®­å¤´å‡½æ•°"></a>åµŒå¥—çš„ç®­å¤´å‡½æ•°</h3><p>ç®­å¤´å‡½æ•°å†…éƒ¨ï¼Œè¿˜å¯ä»¥å†ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªES5è¯­æ³•çš„å¤šé‡åµŒå¥—å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">insert</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;<span class="attr">into</span>: <span class="function"><span class="keyword">function</span> (<span class="params">array</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;<span class="attr">after</span>: <span class="function"><span class="keyword">function</span> (<span class="params">afterValue</span>) </span>&#123;</div><div class="line">      array.splice(array.indexOf(afterValue) + <span class="number">1</span>, <span class="number">0</span>, value);</div><div class="line">      <span class="keyword">return</span> array;</div><div class="line">    &#125;&#125;;</div><div class="line">  &#125;&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">insert(<span class="number">2</span>).into([<span class="number">1</span>, <span class="number">3</span>]).after(<span class="number">1</span>); <span class="comment">//[1, 2, 3]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ç®­å¤´å‡½æ•°æ”¹å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> insert = <span class="function">(<span class="params">value</span>) =&gt;</span> (&#123;<span class="attr">into</span>: <span class="function">(<span class="params">array</span>) =&gt;</span> (&#123;<span class="attr">after</span>: <span class="function">(<span class="params">afterValue</span>) =&gt;</span> &#123;</div><div class="line">  array.splice(array.indexOf(afterValue) + <span class="number">1</span>, <span class="number">0</span>, value);</div><div class="line">  <span class="keyword">return</span> array;</div><div class="line">&#125;&#125;)&#125;);</div><div class="line"></div><div class="line">insert(<span class="number">2</span>).into([<span class="number">1</span>, <span class="number">3</span>]).after(<span class="number">1</span>); <span class="comment">//[1, 2, 3]</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªéƒ¨ç½²ç®¡é“æœºåˆ¶ï¼ˆpipelineï¼‰çš„ä¾‹å­ï¼Œå³å‰ä¸€ä¸ªå‡½æ•°çš„è¾“å‡ºæ˜¯åä¸€ä¸ªå‡½æ•°çš„è¾“å…¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> pipeline = <span class="function">(<span class="params">...funcs</span>) =&gt;</span></div><div class="line">  val =&gt; funcs.reduce(<span class="function">(<span class="params">a, b</span>) =&gt;</span> b(a), val);</div><div class="line"></div><div class="line"><span class="keyword">const</span> plus1 = <span class="function"><span class="params">a</span> =&gt;</span> a + <span class="number">1</span>;</div><div class="line"><span class="keyword">const</span> mult2 = <span class="function"><span class="params">a</span> =&gt;</span> a * <span class="number">2</span>;</div><div class="line"><span class="keyword">const</span> addThenMult = pipeline(plus1, mult2);</div><div class="line"></div><div class="line">addThenMult(<span class="number">5</span>)</div><div class="line"><span class="comment">// 12</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè§‰å¾—ä¸Šé¢çš„å†™æ³•å¯è¯»æ€§æ¯”è¾ƒå·®ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨ä¸‹é¢çš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> plus1 = <span class="function"><span class="params">a</span> =&gt;</span> a + <span class="number">1</span>;</div><div class="line"><span class="keyword">const</span> mult2 = <span class="function"><span class="params">a</span> =&gt;</span> a * <span class="number">2</span>;</div><div class="line"></div><div class="line">mult2(plus1(<span class="number">5</span>))</div><div class="line"><span class="comment">// 12</span></div></pre></td></tr></table></figure>
<p>ç®­å¤´å‡½æ•°è¿˜æœ‰ä¸€ä¸ªåŠŸèƒ½ï¼Œå°±æ˜¯å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ”¹å†™Î»æ¼”ç®—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Î»æ¼”ç®—çš„å†™æ³•</span></div><div class="line">fix = Î»f.(Î»x.f(Î»v.x(x)(v)))(Î»x.f(Î»v.x(x)(v)))</div><div class="line"></div><div class="line"><span class="comment">// ES6çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> fix = <span class="function"><span class="params">f</span> =&gt;</span> (<span class="function"><span class="params">x</span> =&gt;</span> f(<span class="function"><span class="params">v</span> =&gt;</span> x(x)(v)))</div><div class="line">               (<span class="function"><span class="params">x</span> =&gt;</span> f(<span class="function"><span class="params">v</span> =&gt;</span> x(x)(v)));</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ç§å†™æ³•ï¼Œå‡ ä¹æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚ç”±äºÎ»æ¼”ç®—å¯¹äºè®¡ç®—æœºç§‘å­¦éå¸¸é‡è¦ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥ç”¨ES6ä½œä¸ºæ›¿ä»£å·¥å…·ï¼Œæ¢ç´¢è®¡ç®—æœºç§‘å­¦ã€‚</p>
<h2 id="ç»‘å®š-this"><a href="#ç»‘å®š-this" class="headerlink" title="ç»‘å®š this"></a>ç»‘å®š this</h2><p>ç®­å¤´å‡½æ•°å¯ä»¥ç»‘å®š<code>this</code>å¯¹è±¡ï¼Œå¤§å¤§å‡å°‘äº†æ˜¾å¼ç»‘å®š<code>this</code>å¯¹è±¡çš„å†™æ³•ï¼ˆ<code>call</code>ã€<code>apply</code>ã€<code>bind</code>ï¼‰ã€‚ä½†æ˜¯ï¼Œç®­å¤´å‡½æ•°å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰åœºåˆï¼Œæ‰€ä»¥ES7æå‡ºäº†â€œå‡½æ•°ç»‘å®šâ€ï¼ˆfunction bindï¼‰è¿ç®—ç¬¦ï¼Œç”¨æ¥å–ä»£<code>call</code>ã€<code>apply</code>ã€<code>bind</code>è°ƒç”¨ã€‚è™½ç„¶è¯¥è¯­æ³•è¿˜æ˜¯ES7çš„ä¸€ä¸ª<a href="https://github.com/zenparsing/es-function-bind" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œä½†æ˜¯Babelè½¬ç å™¨å·²ç»æ”¯æŒã€‚</p>
<p>å‡½æ•°ç»‘å®šè¿ç®—ç¬¦æ˜¯å¹¶æ’çš„ä¸¤ä¸ªåŒå†’å·ï¼ˆ::ï¼‰ï¼ŒåŒå†’å·å·¦è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå³è¾¹æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚è¯¥è¿ç®—ç¬¦ä¼šè‡ªåŠ¨å°†å·¦è¾¹çš„å¯¹è±¡ï¼Œä½œä¸ºä¸Šä¸‹æ–‡ç¯å¢ƒï¼ˆå³thiså¯¹è±¡ï¼‰ï¼Œç»‘å®šåˆ°å³è¾¹çš„å‡½æ•°ä¸Šé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">foo::bar;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">bar.bind(foo);</div><div class="line"></div><div class="line">foo::bar(...arguments);</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">bar.apply(foo, <span class="built_in">arguments</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> hasOwnProperty = <span class="built_in">Object</span>.prototype.hasOwnProperty;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hasOwn</span>(<span class="params">obj, key</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> obj::hasOwnProperty(key);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦‚æœåŒå†’å·å·¦è¾¹ä¸ºç©ºï¼Œå³è¾¹æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ï¼Œåˆ™ç­‰äºå°†è¯¥æ–¹æ³•ç»‘å®šåœ¨è¯¥å¯¹è±¡ä¸Šé¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> method = obj::obj.foo;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">var</span> method = ::obj.foo;</div><div class="line"></div><div class="line"><span class="keyword">let</span> log = ::<span class="built_in">console</span>.log;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="keyword">var</span> log = <span class="built_in">console</span>.log.bind(<span class="built_in">console</span>);</div></pre></td></tr></table></figure>
<p>ç”±äºåŒå†’å·è¿ç®—ç¬¦è¿”å›çš„è¿˜æ˜¯åŸå¯¹è±¡ï¼Œå› æ­¤å¯ä»¥é‡‡ç”¨é“¾å¼å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¾‹ä¸€</span></div><div class="line"><span class="keyword">import</span> &#123; map, takeWhile, forEach &#125; <span class="keyword">from</span> <span class="string">"iterlib"</span>;</div><div class="line"></div><div class="line">getPlayers()</div><div class="line">::map(<span class="function"><span class="params">x</span> =&gt;</span> x.character())</div><div class="line">::takeWhile(<span class="function"><span class="params">x</span> =&gt;</span> x.strength &gt; <span class="number">100</span>)</div><div class="line">::forEach(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">console</span>.log(x));</div><div class="line"></div><div class="line"><span class="comment">// ä¾‹äºŒ</span></div><div class="line"><span class="keyword">let</span> &#123; find, html &#125; = jake;</div><div class="line"></div><div class="line"><span class="built_in">document</span>.querySelectorAll(<span class="string">"div.myClass"</span>)</div><div class="line">::find(<span class="string">"p"</span>)</div><div class="line">::html(<span class="string">"hahaha"</span>);</div></pre></td></tr></table></figure>
<h2 id="å°¾è°ƒç”¨ä¼˜åŒ–"><a href="#å°¾è°ƒç”¨ä¼˜åŒ–" class="headerlink" title="å°¾è°ƒç”¨ä¼˜åŒ–"></a>å°¾è°ƒç”¨ä¼˜åŒ–</h2><h3 id="ä»€ä¹ˆæ˜¯å°¾è°ƒç”¨ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯å°¾è°ƒç”¨ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯å°¾è°ƒç”¨ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯å°¾è°ƒç”¨ï¼Ÿ</h3><p>å°¾è°ƒç”¨ï¼ˆTail Callï¼‰æ˜¯å‡½æ•°å¼ç¼–ç¨‹çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæœ¬èº«éå¸¸ç®€å•ï¼Œä¸€å¥è¯å°±èƒ½è¯´æ¸…æ¥šï¼Œå°±æ˜¯æŒ‡æŸä¸ªå‡½æ•°çš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> g(x);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fçš„æœ€åä¸€æ­¥æ˜¯è°ƒç”¨å‡½æ•°gï¼Œè¿™å°±å«å°¾è°ƒç”¨ã€‚</p>
<p>ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼Œéƒ½ä¸å±äºå°¾è°ƒç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æƒ…å†µä¸€</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> y = g(x);</div><div class="line">  <span class="keyword">return</span> y;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æƒ…å†µäºŒ</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> g(x) + <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æƒ…å†µä¸‰</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">  g(x);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæƒ…å†µä¸€æ˜¯è°ƒç”¨å‡½æ•°gä¹‹åï¼Œè¿˜æœ‰èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥ä¸å±äºå°¾è°ƒç”¨ï¼Œå³ä½¿è¯­ä¹‰å®Œå…¨ä¸€æ ·ã€‚æƒ…å†µäºŒä¹Ÿå±äºè°ƒç”¨åè¿˜æœ‰æ“ä½œï¼Œå³ä½¿å†™åœ¨ä¸€è¡Œå†…ã€‚æƒ…å†µä¸‰ç­‰åŒäºä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>)</span>&#123;</div><div class="line">  g(x);</div><div class="line">  <span class="keyword">return</span> <span class="literal">undefined</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å°¾è°ƒç”¨ä¸ä¸€å®šå‡ºç°åœ¨å‡½æ•°å°¾éƒ¨ï¼Œåªè¦æ˜¯æœ€åä¸€æ­¥æ“ä½œå³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (x &gt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> m(x)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> n(x);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°må’Œnéƒ½å±äºå°¾è°ƒç”¨ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯å‡½æ•°fçš„æœ€åä¸€æ­¥æ“ä½œã€‚</p>
<h3 id="å°¾è°ƒç”¨ä¼˜åŒ–-1"><a href="#å°¾è°ƒç”¨ä¼˜åŒ–-1" class="headerlink" title="å°¾è°ƒç”¨ä¼˜åŒ–"></a>å°¾è°ƒç”¨ä¼˜åŒ–</h3><p>å°¾è°ƒç”¨ä¹‹æ‰€ä»¥ä¸å…¶ä»–è°ƒç”¨ä¸åŒï¼Œå°±åœ¨äºå®ƒçš„ç‰¹æ®Šçš„è°ƒç”¨ä½ç½®ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜å½¢æˆä¸€ä¸ªâ€œè°ƒç”¨è®°å½•â€ï¼Œåˆç§°â€œè°ƒç”¨å¸§â€ï¼ˆcall frameï¼‰ï¼Œä¿å­˜è°ƒç”¨ä½ç½®å’Œå†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨å‡½æ•°Açš„å†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œé‚£ä¹ˆåœ¨Açš„è°ƒç”¨å¸§ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ªBçš„è°ƒç”¨å¸§ã€‚ç­‰åˆ°Bè¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ°Aï¼ŒBçš„è°ƒç”¨å¸§æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•°Bå†…éƒ¨è¿˜è°ƒç”¨å‡½æ•°Cï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªCçš„è°ƒç”¨å¸§ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨å¸§ï¼Œå°±å½¢æˆä¸€ä¸ªâ€œè°ƒç”¨æ ˆâ€ï¼ˆcall stackï¼‰ã€‚</p>
<p>å°¾è°ƒç”¨ç”±äºæ˜¯å‡½æ•°çš„æœ€åä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå› ä¸ºè°ƒç”¨ä½ç½®ã€å†…éƒ¨å˜é‡ç­‰ä¿¡æ¯éƒ½ä¸ä¼šå†ç”¨åˆ°äº†ï¼Œåªè¦ç›´æ¥ç”¨å†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§å°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> m = <span class="number">1</span>;</div><div class="line">  <span class="keyword">let</span> n = <span class="number">2</span>;</div><div class="line">  <span class="keyword">return</span> g(m + n);</div><div class="line">&#125;</div><div class="line">f();</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> g(<span class="number">3</span>);</div><div class="line">&#125;</div><div class="line">f();</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">g(<span class="number">3</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå‡½æ•°gä¸æ˜¯å°¾è°ƒç”¨ï¼Œå‡½æ•°få°±éœ€è¦ä¿å­˜å†…éƒ¨å˜é‡må’Œnçš„å€¼ã€gçš„è°ƒç”¨ä½ç½®ç­‰ä¿¡æ¯ã€‚ä½†ç”±äºè°ƒç”¨gä¹‹åï¼Œå‡½æ•°få°±ç»“æŸäº†ï¼Œæ‰€ä»¥æ‰§è¡Œåˆ°æœ€åä¸€æ­¥ï¼Œå®Œå…¨å¯ä»¥åˆ é™¤ f(x) çš„è°ƒç”¨å¸§ï¼Œåªä¿ç•™ g(3) çš„è°ƒç”¨å¸§ã€‚</p>
<p>è¿™å°±å«åšâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€ï¼ˆTail call optimizationï¼‰ï¼Œå³åªä¿ç•™å†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§ã€‚å¦‚æœæ‰€æœ‰å‡½æ•°éƒ½æ˜¯å°¾è°ƒç”¨ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥åšåˆ°æ¯æ¬¡æ‰§è¡Œæ—¶ï¼Œè°ƒç”¨å¸§åªæœ‰ä¸€é¡¹ï¼Œè¿™å°†å¤§å¤§èŠ‚çœå†…å­˜ã€‚è¿™å°±æ˜¯â€œå°¾è°ƒç”¨ä¼˜åŒ–â€çš„æ„ä¹‰ã€‚</p>
<p>æ³¨æ„ï¼Œåªæœ‰ä¸å†ç”¨åˆ°å¤–å±‚å‡½æ•°çš„å†…éƒ¨å˜é‡ï¼Œå†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§æ‰ä¼šå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå¦åˆ™å°±æ— æ³•è¿›è¡Œâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addOne</span>(<span class="params">a</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> one = <span class="number">1</span>;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">inner</span>(<span class="params">b</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> b + one;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> inner(a);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„å‡½æ•°ä¸ä¼šè¿›è¡Œå°¾è°ƒç”¨ä¼˜åŒ–ï¼Œå› ä¸ºå†…å±‚å‡½æ•°<code>inner</code>ç”¨åˆ°äº†å¤–å±‚å‡½æ•°<code>addOne</code>çš„å†…éƒ¨å˜é‡<code>one</code>ã€‚</p>
<h3 id="å°¾é€’å½’"><a href="#å°¾é€’å½’" class="headerlink" title="å°¾é€’å½’"></a>å°¾é€’å½’</h3><p>å‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œç§°ä¸ºé€’å½’ã€‚å¦‚æœå°¾è°ƒç”¨è‡ªèº«ï¼Œå°±ç§°ä¸ºå°¾é€’å½’ã€‚</p>
<p>é€’å½’éå¸¸è€—è´¹å†…å­˜ï¼Œå› ä¸ºéœ€è¦åŒæ—¶ä¿å­˜æˆåƒä¸Šç™¾ä¸ªè°ƒç”¨å¸§ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿâ€œæ ˆæº¢å‡ºâ€é”™è¯¯ï¼ˆstack overflowï¼‰ã€‚ä½†å¯¹äºå°¾é€’å½’æ¥è¯´ï¼Œç”±äºåªå­˜åœ¨ä¸€ä¸ªè°ƒç”¨å¸§ï¼Œæ‰€ä»¥æ°¸è¿œä¸ä¼šå‘ç”Ÿâ€œæ ˆæº¢å‡ºâ€é”™è¯¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">return</span> n * factorial(n - <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">factorial(<span class="number">5</span>) <span class="comment">// 120</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œè®¡ç®—nçš„é˜¶ä¹˜ï¼Œæœ€å¤šéœ€è¦ä¿å­˜nä¸ªè°ƒç”¨è®°å½•ï¼Œå¤æ‚åº¦ O(n) ã€‚</p>
<p>å¦‚æœæ”¹å†™æˆå°¾é€’å½’ï¼Œåªä¿ç•™ä¸€ä¸ªè°ƒç”¨è®°å½•ï¼Œå¤æ‚åº¦ O(1) ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n, total</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</div><div class="line">  <span class="keyword">return</span> factorial(n - <span class="number">1</span>, n * total);</div><div class="line">&#125;</div><div class="line"></div><div class="line">factorial(<span class="number">5</span>, <span class="number">1</span>) <span class="comment">// 120</span></div></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒè‘—åçš„ä¾‹å­ï¼Œå°±æ˜¯è®¡ç®—fibonacci æ•°åˆ—ï¼Œä¹Ÿèƒ½å……åˆ†è¯´æ˜å°¾é€’å½’ä¼˜åŒ–çš„é‡è¦æ€§</p>
<p>å¦‚æœæ˜¯éå°¾é€’å½’çš„fibonacci é€’å½’æ–¹æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fibonacci</span> (<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> ( n &lt;= <span class="number">1</span> ) &#123;<span class="keyword">return</span> <span class="number">1</span>&#125;;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> Fibonacci(n - <span class="number">1</span>) + Fibonacci(n - <span class="number">2</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">Fibonacci(<span class="number">10</span>); <span class="comment">// 89</span></div><div class="line"><span class="comment">// Fibonacci(100)</span></div><div class="line"><span class="comment">// Fibonacci(500)</span></div><div class="line"><span class="comment">// å †æ ˆæº¢å‡ºäº†</span></div></pre></td></tr></table></figure>
<p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨å°¾é€’å½’ä¼˜åŒ–è¿‡çš„fibonacci é€’å½’ç®—æ³•</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Fibonacci2</span> (<span class="params">n , ac1 = <span class="number">1</span> , ac2 = <span class="number">1</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span>( n &lt;= <span class="number">1</span> ) &#123;<span class="keyword">return</span> ac2&#125;;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> Fibonacci2 (n - <span class="number">1</span>, ac2, ac1 + ac2);</div><div class="line">&#125;</div><div class="line"></div><div class="line">Fibonacci2(<span class="number">100</span>) <span class="comment">// 573147844013817200000</span></div><div class="line">Fibonacci2(<span class="number">1000</span>) <span class="comment">// 7.0330367711422765e+208</span></div><div class="line">Fibonacci2(<span class="number">10000</span>) <span class="comment">// Infinity</span></div></pre></td></tr></table></figure>
<p>ç”±æ­¤å¯è§ï¼Œâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€å¯¹é€’å½’æ“ä½œæ„ä¹‰é‡å¤§ï¼Œæ‰€ä»¥ä¸€äº›å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€å°†å…¶å†™å…¥äº†è¯­è¨€è§„æ ¼ã€‚ES6ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œç¬¬ä¸€æ¬¡æ˜ç¡®è§„å®šï¼Œæ‰€æœ‰ECMAScriptçš„å®ç°ï¼Œéƒ½å¿…é¡»éƒ¨ç½²â€œå°¾è°ƒç”¨ä¼˜åŒ–â€ã€‚è¿™å°±æ˜¯è¯´ï¼Œåœ¨ES6ä¸­ï¼Œåªè¦ä½¿ç”¨å°¾é€’å½’ï¼Œå°±ä¸ä¼šå‘ç”Ÿæ ˆæº¢å‡ºï¼Œç›¸å¯¹èŠ‚çœå†…å­˜ã€‚</p>
<h3 id="é€’å½’å‡½æ•°çš„æ”¹å†™"><a href="#é€’å½’å‡½æ•°çš„æ”¹å†™" class="headerlink" title="é€’å½’å‡½æ•°çš„æ”¹å†™"></a>é€’å½’å‡½æ•°çš„æ”¹å†™</h3><p>å°¾é€’å½’çš„å®ç°ï¼Œå¾€å¾€éœ€è¦æ”¹å†™é€’å½’å‡½æ•°ï¼Œç¡®ä¿æœ€åä¸€æ­¥åªè°ƒç”¨è‡ªèº«ã€‚åšåˆ°è¿™ä¸€ç‚¹çš„æ–¹æ³•ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰ç”¨åˆ°çš„å†…éƒ¨å˜é‡æ”¹å†™æˆå‡½æ•°çš„å‚æ•°ã€‚æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œé˜¶ä¹˜å‡½æ•° factorial éœ€è¦ç”¨åˆ°ä¸€ä¸ªä¸­é—´å˜é‡ total ï¼Œé‚£å°±æŠŠè¿™ä¸ªä¸­é—´å˜é‡æ”¹å†™æˆå‡½æ•°çš„å‚æ•°ã€‚è¿™æ ·åšçš„ç¼ºç‚¹å°±æ˜¯ä¸å¤ªç›´è§‚ï¼Œç¬¬ä¸€çœ¼å¾ˆéš¾çœ‹å‡ºæ¥ï¼Œä¸ºä»€ä¹ˆè®¡ç®—5çš„é˜¶ä¹˜ï¼Œéœ€è¦ä¼ å…¥ä¸¤ä¸ªå‚æ•°5å’Œ1ï¼Ÿ</p>
<p>ä¸¤ä¸ªæ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æ–¹æ³•ä¸€æ˜¯åœ¨å°¾é€’å½’å‡½æ•°ä¹‹å¤–ï¼Œå†æä¾›ä¸€ä¸ªæ­£å¸¸å½¢å¼çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tailFactorial</span>(<span class="params">n, total</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</div><div class="line">  <span class="keyword">return</span> tailFactorial(n - <span class="number">1</span>, n * total);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> tailFactorial(n, <span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">factorial(<span class="number">5</span>) <span class="comment">// 120</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç é€šè¿‡ä¸€ä¸ªæ­£å¸¸å½¢å¼çš„é˜¶ä¹˜å‡½æ•° factorial ï¼Œè°ƒç”¨å°¾é€’å½’å‡½æ•° tailFactorial ï¼Œçœ‹èµ·æ¥å°±æ­£å¸¸å¤šäº†ã€‚</p>
<p>å‡½æ•°å¼ç¼–ç¨‹æœ‰ä¸€ä¸ªæ¦‚å¿µï¼Œå«åšæŸ¯é‡ŒåŒ–ï¼ˆcurryingï¼‰ï¼Œæ„æ€æ˜¯å°†å¤šå‚æ•°çš„å‡½æ•°è½¬æ¢æˆå•å‚æ•°çš„å½¢å¼ã€‚è¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨æŸ¯é‡ŒåŒ–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">currying</span>(<span class="params">fn, n</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params">m</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> fn.call(<span class="keyword">this</span>, m, n);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tailFactorial</span>(<span class="params">n, total</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</div><div class="line">  <span class="keyword">return</span> tailFactorial(n - <span class="number">1</span>, n * total);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> factorial = currying(tailFactorial, <span class="number">1</span>);</div><div class="line"></div><div class="line">factorial(<span class="number">5</span>) <span class="comment">// 120</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç é€šè¿‡æŸ¯é‡ŒåŒ–ï¼Œå°†å°¾é€’å½’å‡½æ•° tailFactorial å˜ä¸ºåªæ¥å—1ä¸ªå‚æ•°çš„ factorial ã€‚</p>
<p>ç¬¬äºŒç§æ–¹æ³•å°±ç®€å•å¤šäº†ï¼Œå°±æ˜¯é‡‡ç”¨ES6çš„å‡½æ•°é»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">factorial</span>(<span class="params">n, total = <span class="number">1</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (n === <span class="number">1</span>) <span class="keyword">return</span> total;</div><div class="line">  <span class="keyword">return</span> factorial(n - <span class="number">1</span>, n * total);</div><div class="line">&#125;</div><div class="line"></div><div class="line">factorial(<span class="number">5</span>) <span class="comment">// 120</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‚æ•° total æœ‰é»˜è®¤å€¼1ï¼Œæ‰€ä»¥è°ƒç”¨æ—¶ä¸ç”¨æä¾›è¿™ä¸ªå€¼ã€‚</p>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œé€’å½’æœ¬è´¨ä¸Šæ˜¯ä¸€ç§å¾ªç¯æ“ä½œã€‚çº¯ç²¹çš„å‡½æ•°å¼ç¼–ç¨‹è¯­è¨€æ²¡æœ‰å¾ªç¯æ“ä½œå‘½ä»¤ï¼Œæ‰€æœ‰çš„å¾ªç¯éƒ½ç”¨é€’å½’å®ç°ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆå°¾é€’å½’å¯¹è¿™äº›è¯­è¨€æå…¶é‡è¦ã€‚å¯¹äºå…¶ä»–æ”¯æŒâ€œå°¾è°ƒç”¨ä¼˜åŒ–â€çš„è¯­è¨€ï¼ˆæ¯”å¦‚Luaï¼ŒES6ï¼‰ï¼Œåªéœ€è¦çŸ¥é“å¾ªç¯å¯ä»¥ç”¨é€’å½’ä»£æ›¿ï¼Œè€Œä¸€æ—¦ä½¿ç”¨é€’å½’ï¼Œå°±æœ€å¥½ä½¿ç”¨å°¾é€’å½’ã€‚</p>
<h3 id="ä¸¥æ ¼æ¨¡å¼-1"><a href="#ä¸¥æ ¼æ¨¡å¼-1" class="headerlink" title="ä¸¥æ ¼æ¨¡å¼"></a>ä¸¥æ ¼æ¨¡å¼</h3><p>ES6çš„å°¾è°ƒç”¨ä¼˜åŒ–åªåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹å¼€å¯ï¼Œæ­£å¸¸æ¨¡å¼æ˜¯æ— æ•ˆçš„ã€‚</p>
<p>è¿™æ˜¯å› ä¸ºåœ¨æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œå‡½æ•°å†…éƒ¨æœ‰ä¸¤ä¸ªå˜é‡ï¼Œå¯ä»¥è·Ÿè¸ªå‡½æ•°çš„è°ƒç”¨æ ˆã€‚</p>
<ul>
<li><code>func.arguments</code>ï¼šè¿”å›è°ƒç”¨æ—¶å‡½æ•°çš„å‚æ•°ã€‚</li>
<li><code>func.caller</code>ï¼šè¿”å›è°ƒç”¨å½“å‰å‡½æ•°çš„é‚£ä¸ªå‡½æ•°ã€‚</li>
</ul>
<p>å°¾è°ƒç”¨ä¼˜åŒ–å‘ç”Ÿæ—¶ï¼Œå‡½æ•°çš„è°ƒç”¨æ ˆä¼šæ”¹å†™ï¼Œå› æ­¤ä¸Šé¢ä¸¤ä¸ªå˜é‡å°±ä¼šå¤±çœŸã€‚ä¸¥æ ¼æ¨¡å¼ç¦ç”¨è¿™ä¸¤ä¸ªå˜é‡ï¼Œæ‰€ä»¥å°¾è°ƒç”¨æ¨¡å¼ä»…åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ç”Ÿæ•ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">restricted</span>(<span class="params"></span>) </span>&#123;</div><div class="line"><span class="meta">  "use strict"</span>;</div><div class="line">  restricted.caller;    <span class="comment">// æŠ¥é”™</span></div><div class="line">  restricted.arguments; <span class="comment">// æŠ¥é”™</span></div><div class="line">&#125;</div><div class="line">restricted();</div></pre></td></tr></table></figure>
<h3 id="å°¾é€’å½’ä¼˜åŒ–çš„å®ç°"><a href="#å°¾é€’å½’ä¼˜åŒ–çš„å®ç°" class="headerlink" title="å°¾é€’å½’ä¼˜åŒ–çš„å®ç°"></a>å°¾é€’å½’ä¼˜åŒ–çš„å®ç°</h3><p>å°¾é€’å½’ä¼˜åŒ–åªåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ç”Ÿæ•ˆï¼Œé‚£ä¹ˆæ­£å¸¸æ¨¡å¼ä¸‹ï¼Œæˆ–è€…é‚£äº›ä¸æ”¯æŒè¯¥åŠŸèƒ½çš„ç¯å¢ƒä¸­ï¼Œæœ‰æ²¡æœ‰åŠæ³•ä¹Ÿä½¿ç”¨å°¾é€’å½’ä¼˜åŒ–å‘¢ï¼Ÿå›ç­”æ˜¯å¯ä»¥çš„ï¼Œå°±æ˜¯è‡ªå·±å®ç°å°¾é€’å½’ä¼˜åŒ–ã€‚</p>
<p>å®ƒçš„åŸç†éå¸¸ç®€å•ã€‚å°¾é€’å½’ä¹‹æ‰€ä»¥éœ€è¦ä¼˜åŒ–ï¼ŒåŸå› æ˜¯è°ƒç”¨æ ˆå¤ªå¤šï¼Œé€ æˆæº¢å‡ºï¼Œé‚£ä¹ˆåªè¦å‡å°‘è°ƒç”¨æ ˆï¼Œå°±ä¸ä¼šæº¢å‡ºã€‚æ€ä¹ˆåšå¯ä»¥å‡å°‘è°ƒç”¨æ ˆå‘¢ï¼Ÿå°±æ˜¯é‡‡ç”¨â€œå¾ªç¯â€æ¢æ‰â€œé€’å½’â€ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ­£å¸¸çš„é€’å½’å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (y &gt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> sum(x + <span class="number">1</span>, y - <span class="number">1</span>);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">sum(<span class="number">1</span>, <span class="number">100000</span>)</div><div class="line"><span class="comment">// Uncaught RangeError: Maximum call stack size exceeded(â€¦)</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>sum</code>æ˜¯ä¸€ä¸ªé€’å½’å‡½æ•°ï¼Œå‚æ•°<code>x</code>æ˜¯éœ€è¦ç´¯åŠ çš„å€¼ï¼Œå‚æ•°<code>y</code>æ§åˆ¶é€’å½’æ¬¡æ•°ã€‚ä¸€æ—¦æŒ‡å®š<code>sum</code>é€’å½’100000æ¬¡ï¼Œå°±ä¼šæŠ¥é”™ï¼Œæç¤ºè¶…å‡ºè°ƒç”¨æ ˆçš„æœ€å¤§æ¬¡æ•°ã€‚</p>
<p>è¹¦åºŠå‡½æ•°ï¼ˆtrampolineï¼‰å¯ä»¥å°†é€’å½’æ‰§è¡Œè½¬ä¸ºå¾ªç¯æ‰§è¡Œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">trampoline</span>(<span class="params">f</span>) </span>&#123;</div><div class="line">  <span class="keyword">while</span> (f &amp;&amp; f <span class="keyword">instanceof</span> <span class="built_in">Function</span>) &#123;</div><div class="line">    f = f();</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> f;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢å°±æ˜¯è¹¦åºŠå‡½æ•°çš„ä¸€ä¸ªå®ç°ï¼Œå®ƒæ¥å—ä¸€ä¸ªå‡½æ•°<code>f</code>ä½œä¸ºå‚æ•°ã€‚åªè¦<code>f</code>æ‰§è¡Œåè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œå°±ç»§ç»­æ‰§è¡Œã€‚æ³¨æ„ï¼Œè¿™é‡Œæ˜¯è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åæ‰§è¡Œè¯¥å‡½æ•°ï¼Œè€Œä¸æ˜¯å‡½æ•°é‡Œé¢è°ƒç”¨å‡½æ•°ï¼Œè¿™æ ·å°±é¿å…äº†é€’å½’æ‰§è¡Œï¼Œä»è€Œå°±æ¶ˆé™¤äº†è°ƒç”¨æ ˆè¿‡å¤§çš„é—®é¢˜ã€‚</p>
<p>ç„¶åï¼Œè¦åšçš„å°±æ˜¯å°†åŸæ¥çš„é€’å½’å‡½æ•°ï¼Œæ”¹å†™ä¸ºæ¯ä¸€æ­¥è¿”å›å¦ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (y &gt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> sum.bind(<span class="literal">null</span>, x + <span class="number">1</span>, y - <span class="number">1</span>);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>sum</code>å‡½æ•°çš„æ¯æ¬¡æ‰§è¡Œï¼Œéƒ½ä¼šè¿”å›è‡ªèº«çš„å¦ä¸€ä¸ªç‰ˆæœ¬ã€‚</p>
<p>ç°åœ¨ï¼Œä½¿ç”¨è¹¦åºŠå‡½æ•°æ‰§è¡Œ<code>sum</code>ï¼Œå°±ä¸ä¼šå‘ç”Ÿè°ƒç”¨æ ˆæº¢å‡ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">trampoline(sum(<span class="number">1</span>, <span class="number">100000</span>))</div><div class="line"><span class="comment">// 100001</span></div></pre></td></tr></table></figure>
<p>è¹¦åºŠå‡½æ•°å¹¶ä¸æ˜¯çœŸæ­£çš„å°¾é€’å½’ä¼˜åŒ–ï¼Œä¸‹é¢çš„å®ç°æ‰æ˜¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tco</span>(<span class="params">f</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> value;</div><div class="line">  <span class="keyword">var</span> active = <span class="literal">false</span>;</div><div class="line">  <span class="keyword">var</span> accumulated = [];</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">accumulator</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    accumulated.push(<span class="built_in">arguments</span>);</div><div class="line">    <span class="keyword">if</span> (!active) &#123;</div><div class="line">      active = <span class="literal">true</span>;</div><div class="line">      <span class="keyword">while</span> (accumulated.length) &#123;</div><div class="line">        value = f.apply(<span class="keyword">this</span>, accumulated.shift());</div><div class="line">      &#125;</div><div class="line">      active = <span class="literal">false</span>;</div><div class="line">      <span class="keyword">return</span> value;</div><div class="line">    &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> sum = tco(<span class="function"><span class="keyword">function</span>(<span class="params">x, y</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (y &gt; <span class="number">0</span>) &#123;</div><div class="line">    <span class="keyword">return</span> sum(x + <span class="number">1</span>, y - <span class="number">1</span>)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">return</span> x</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">sum(<span class="number">1</span>, <span class="number">100000</span>)</div><div class="line"><span class="comment">// 100001</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>tco</code>å‡½æ•°æ˜¯å°¾é€’å½’ä¼˜åŒ–çš„å®ç°ï¼Œå®ƒçš„å¥¥å¦™å°±åœ¨äºçŠ¶æ€å˜é‡<code>active</code>ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå˜é‡æ˜¯ä¸æ¿€æ´»çš„ã€‚ä¸€æ—¦è¿›å…¥å°¾é€’å½’ä¼˜åŒ–çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªå˜é‡å°±æ¿€æ´»äº†ã€‚ç„¶åï¼Œæ¯ä¸€è½®é€’å½’<code>sum</code>è¿”å›çš„éƒ½æ˜¯<code>undefined</code>ï¼Œæ‰€ä»¥å°±é¿å…äº†é€’å½’æ‰§è¡Œï¼›è€Œ<code>accumulated</code>æ•°ç»„å­˜æ”¾æ¯ä¸€è½®<code>sum</code>æ‰§è¡Œçš„å‚æ•°ï¼Œæ€»æ˜¯æœ‰å€¼çš„ï¼Œè¿™å°±ä¿è¯äº†<code>accumulator</code>å‡½æ•°å†…éƒ¨çš„<code>while</code>å¾ªç¯æ€»æ˜¯ä¼šæ‰§è¡Œã€‚è¿™æ ·å°±å¾ˆå·§å¦™åœ°å°†â€œé€’å½’â€æ”¹æˆäº†â€œå¾ªç¯â€ï¼Œè€Œåä¸€è½®çš„å‚æ•°ä¼šå–ä»£å‰ä¸€è½®çš„å‚æ•°ï¼Œä¿è¯äº†è°ƒç”¨æ ˆåªæœ‰ä¸€å±‚ã€‚</p>
<h2 id="å‡½æ•°å‚æ•°çš„å°¾é€—å·"><a href="#å‡½æ•°å‚æ•°çš„å°¾é€—å·" class="headerlink" title="å‡½æ•°å‚æ•°çš„å°¾é€—å·"></a>å‡½æ•°å‚æ•°çš„å°¾é€—å·</h2><p>ECMAScript 2017å°†<a href="https://github.com/jeffmo/es-trailing-function-commas" target="_blank" rel="external">å…è®¸</a>å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æœ‰å°¾é€—å·ï¼ˆtrailing commaï¼‰ã€‚</p>
<p>æ­¤å‰ï¼Œå‡½æ•°å®šä¹‰å’Œè°ƒç”¨æ—¶ï¼Œéƒ½ä¸å…è®¸æœ€åä¸€ä¸ªå‚æ•°åé¢å‡ºç°é€—å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clownsEverywhere</span>(<span class="params"></span></span></div><div class="line">  param1,</div><div class="line">  param2</div><div class="line">) &#123; <span class="comment">/* ... */</span> &#125;</div><div class="line"></div><div class="line">clownsEverywhere(</div><div class="line">  <span class="string">'foo'</span>,</div><div class="line">  <span class="string">'bar'</span></div><div class="line">);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœåœ¨<code>param2</code>æˆ–<code>bar</code>åé¢åŠ ä¸€ä¸ªé€—å·ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p>è¿™æ ·çš„è¯ï¼Œå¦‚æœä»¥åä¿®æ”¹ä»£ç ï¼Œæƒ³ä¸ºå‡½æ•°<code>clownsEverywhere</code>æ·»åŠ ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œå°±åŠ¿å¿…è¦åœ¨ç¬¬äºŒä¸ªå‚æ•°åé¢æ·»åŠ ä¸€ä¸ªé€—å·ã€‚è¿™å¯¹ç‰ˆæœ¬ç®¡ç†ç³»ç»Ÿæ¥è¯´ï¼Œå°±ä¼šæ˜¾ç¤ºï¼Œæ·»åŠ é€—å·çš„é‚£ä¸€è¡Œä¹Ÿå‘ç”Ÿäº†å˜åŠ¨ã€‚è¿™çœ‹ä¸Šå»æœ‰ç‚¹å†—ä½™ï¼Œå› æ­¤æ–°çš„è¯­æ³•å…è®¸å®šä¹‰å’Œè°ƒç”¨æ—¶ï¼Œå°¾éƒ¨ç›´æ¥æœ‰ä¸€ä¸ªé€—å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">clownsEverywhere</span>(<span class="params"></span></span></div><div class="line">  param1,</div><div class="line">  param2,</div><div class="line">) &#123; <span class="comment">/* ... */</span> &#125;</div><div class="line"></div><div class="line">clownsEverywhere(</div><div class="line">  <span class="string">'foo'</span>,</div><div class="line">  <span class="string">'bar'</span>,</div><div class="line">);</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å‡½æ•°çš„æ‰©å±•&quot;&gt;&lt;a href=&quot;#å‡½æ•°çš„æ‰©å±•&quot; class=&quot;headerlink&quot; title=&quot;å‡½æ•°çš„æ‰©å±•&quot;&gt;&lt;/a&gt;å‡½æ•°çš„æ‰©å±•&lt;/h1&gt;&lt;h2 id=&quot;å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼&quot;&gt;&lt;a href=&quot;#å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼&quot; class=&quot;headerlink&quot; titl
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Function" scheme="http://microzz.com/tags/Function/"/>
    
  </entry>
  
  <entry>
    <title>æ•°ç»„çš„æ‰©å±•(Array)</title>
    <link href="http://microzz.com/2016/11/30/array/"/>
    <id>http://microzz.com/2016/11/30/array/</id>
    <published>2016-11-30T04:45:19.000Z</published>
    <updated>2017-01-12T08:08:33.306Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ•°ç»„çš„æ‰©å±•"><a href="#æ•°ç»„çš„æ‰©å±•" class="headerlink" title="æ•°ç»„çš„æ‰©å±•"></a>æ•°ç»„çš„æ‰©å±•</h1><h2 id="Array-from"><a href="#Array-from" class="headerlink" title="Array.from()"></a>Array.from()</h2><p><code>Array.from</code>æ–¹æ³•ç”¨äºå°†ä¸¤ç±»å¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼šç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼ˆarray-like objectï¼‰å’Œå¯éå†ï¼ˆiterableï¼‰çš„å¯¹è±¡ï¼ˆåŒ…æ‹¬ES6æ–°å¢çš„æ•°æ®ç»“æ„Setå’ŒMapï¼‰ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œ<code>Array.from</code>å°†å®ƒè½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arrayLike = &#123;</div><div class="line">    <span class="string">'0'</span>: <span class="string">'a'</span>,</div><div class="line">    <span class="string">'1'</span>: <span class="string">'b'</span>,</div><div class="line">    <span class="string">'2'</span>: <span class="string">'c'</span>,</div><div class="line">    <span class="attr">length</span>: <span class="number">3</span></div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// ES5çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> arr1 = [].slice.call(arrayLike); <span class="comment">// ['a', 'b', 'c']</span></div><div class="line"></div><div class="line"><span class="comment">// ES6çš„å†™æ³•</span></div><div class="line"><span class="keyword">let</span> arr2 = <span class="built_in">Array</span>.from(arrayLike); <span class="comment">// ['a', 'b', 'c']</span></div></pre></td></tr></table></figure>
<p>å®é™…åº”ç”¨ä¸­ï¼Œå¸¸è§çš„ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡æ˜¯DOMæ“ä½œè¿”å›çš„NodeListé›†åˆï¼Œä»¥åŠå‡½æ•°å†…éƒ¨çš„<code>arguments</code>å¯¹è±¡ã€‚<code>Array.from</code>éƒ½å¯ä»¥å°†å®ƒä»¬è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// NodeListå¯¹è±¡</span></div><div class="line"><span class="keyword">let</span> ps = <span class="built_in">document</span>.querySelectorAll(<span class="string">'p'</span>);</div><div class="line"><span class="built_in">Array</span>.from(ps).forEach(<span class="function"><span class="keyword">function</span> (<span class="params">p</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(p);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// argumentså¯¹è±¡</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> args = <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>);</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>querySelectorAll</code>æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œåªæœ‰å°†è¿™ä¸ªå¯¹è±¡è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Œæ‰èƒ½ä½¿ç”¨<code>forEach</code>æ–¹æ³•ã€‚</p>
<p>åªè¦æ˜¯éƒ¨ç½²äº†Iteratoræ¥å£çš„æ•°æ®ç»“æ„ï¼Œ<code>Array.from</code>éƒ½èƒ½å°†å…¶è½¬ä¸ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.from(<span class="string">'hello'</span>)</div><div class="line"><span class="comment">// ['h', 'e', 'l', 'l', 'o']</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> namesSet = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">'a'</span>, <span class="string">'b'</span>])</div><div class="line"><span class="built_in">Array</span>.from(namesSet) <span class="comment">// ['a', 'b']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²å’ŒSetç»“æ„éƒ½å…·æœ‰Iteratoræ¥å£ï¼Œå› æ­¤å¯ä»¥è¢«<code>Array.from</code>è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ã€‚</p>
<p>å¦‚æœå‚æ•°æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ï¼Œ<code>Array.from</code>ä¼šè¿”å›ä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„æ–°æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.from([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</div><div class="line"><span class="comment">// [1, 2, 3]</span></div></pre></td></tr></table></figure>
<p>å€¼å¾—æé†’çš„æ˜¯ï¼Œæ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰ä¹Ÿå¯ä»¥å°†æŸäº›æ•°æ®ç»“æ„è½¬ä¸ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// argumentså¯¹è±¡</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> args = [...arguments];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// NodeListå¯¹è±¡</span></div><div class="line">[...document.querySelectorAll(<span class="string">'div'</span>)]</div></pre></td></tr></table></figure>
<p>æ‰©å±•è¿ç®—ç¬¦èƒŒåè°ƒç”¨çš„æ˜¯éå†å™¨æ¥å£ï¼ˆ<code>Symbol.iterator</code>ï¼‰ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ¥å£ï¼Œå°±æ— æ³•è½¬æ¢ã€‚<code>Array.from</code>æ–¹æ³•åˆ™æ˜¯è¿˜æ”¯æŒç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚æ‰€è°“ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œæœ¬è´¨ç‰¹å¾åªæœ‰ä¸€ç‚¹ï¼Œå³å¿…é¡»æœ‰<code>length</code>å±æ€§ã€‚å› æ­¤ï¼Œä»»ä½•æœ‰<code>length</code>å±æ€§çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥é€šè¿‡<code>Array.from</code>æ–¹æ³•è½¬ä¸ºæ•°ç»„ï¼Œè€Œæ­¤æ—¶æ‰©å±•è¿ç®—ç¬¦å°±æ— æ³•è½¬æ¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">3</span> &#125;);</div><div class="line"><span class="comment">// [ undefined, undefined, undefined ]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Array.from</code>è¿”å›äº†ä¸€ä¸ªå…·æœ‰ä¸‰ä¸ªæˆå‘˜çš„æ•°ç»„ï¼Œæ¯ä¸ªä½ç½®çš„å€¼éƒ½æ˜¯<code>undefined</code>ã€‚æ‰©å±•è¿ç®—ç¬¦è½¬æ¢ä¸äº†è¿™ä¸ªå¯¹è±¡ã€‚</p>
<p>å¯¹äºè¿˜æ²¡æœ‰éƒ¨ç½²è¯¥æ–¹æ³•çš„æµè§ˆå™¨ï¼Œå¯ä»¥ç”¨<code>Array.prototype.slice</code>æ–¹æ³•æ›¿ä»£ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> toArray = <span class="function">(<span class="params">(</span>) =&gt;</span></div><div class="line">  <span class="built_in">Array</span>.from ? <span class="built_in">Array</span>.from : <span class="function"><span class="params">obj</span> =&gt;</span> [].slice.call(obj)</div><div class="line">)();</div></pre></td></tr></table></figure>
<p><code>Array.from</code>è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œä½œç”¨ç±»ä¼¼äºæ•°ç»„çš„<code>map</code>æ–¹æ³•ï¼Œç”¨æ¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œå¤„ç†ï¼Œå°†å¤„ç†åçš„å€¼æ”¾å…¥è¿”å›çš„æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.from(arrayLike, x =&gt; x * x);</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="built_in">Array</span>.from(arrayLike).map(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</div><div class="line"></div><div class="line"><span class="built_in">Array</span>.from([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], (x) =&gt; x * x)</div><div class="line"><span class="comment">// [1, 4, 9]</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„ä¾‹å­æ˜¯å–å‡ºä¸€ç»„DOMèŠ‚ç‚¹çš„æ–‡æœ¬å†…å®¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> spans = <span class="built_in">document</span>.querySelectorAll(<span class="string">'span.name'</span>);</div><div class="line"></div><div class="line"><span class="comment">// map()</span></div><div class="line"><span class="keyword">let</span> names1 = <span class="built_in">Array</span>.prototype.map.call(spans, s =&gt; s.textContent);</div><div class="line"></div><div class="line"><span class="comment">// Array.from()</span></div><div class="line"><span class="keyword">let</span> names2 = <span class="built_in">Array</span>.from(spans, s =&gt; s.textContent)</div></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„ä¾‹å­å°†æ•°ç»„ä¸­å¸ƒå°”å€¼ä¸º<code>false</code>çš„æˆå‘˜è½¬ä¸º<code>0</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.from([<span class="number">1</span>, , <span class="number">2</span>, , <span class="number">3</span>], (n) =&gt; n || <span class="number">0</span>)</div><div class="line"><span class="comment">// [1, 0, 2, 0, 3]</span></div></pre></td></tr></table></figure>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯è¿”å›å„ç§æ•°æ®çš„ç±»å‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">typesOf</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(<span class="built_in">arguments</span>, value =&gt; <span class="keyword">typeof</span> value)</div><div class="line">&#125;</div><div class="line">typesOf(<span class="literal">null</span>, [], <span class="literal">NaN</span>)</div><div class="line"><span class="comment">// ['object', 'object', 'number']</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>map</code>å‡½æ•°é‡Œé¢ç”¨åˆ°äº†<code>this</code>å…³é”®å­—ï¼Œè¿˜å¯ä»¥ä¼ å…¥<code>Array.from</code>çš„ç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®š<code>this</code>ã€‚</p>
<p><code>Array.from()</code>å¯ä»¥å°†å„ç§å€¼è½¬ä¸ºçœŸæ­£çš„æ•°ç»„ï¼Œå¹¶ä¸”è¿˜æä¾›<code>map</code>åŠŸèƒ½ã€‚è¿™å®é™…ä¸Šæ„å‘³ç€ï¼Œåªè¦æœ‰ä¸€ä¸ªåŸå§‹çš„æ•°æ®ç»“æ„ï¼Œä½ å°±å¯ä»¥å…ˆå¯¹å®ƒçš„å€¼è¿›è¡Œå¤„ç†ï¼Œç„¶åè½¬æˆè§„èŒƒçš„æ•°ç»„ç»“æ„ï¼Œè¿›è€Œå°±å¯ä»¥ä½¿ç”¨æ•°é‡ä¼—å¤šçš„æ•°ç»„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.from(&#123; <span class="attr">length</span>: <span class="number">2</span> &#125;, () =&gt; <span class="string">'jack'</span>)</div><div class="line"><span class="comment">// ['jack', 'jack']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Array.from</code>çš„ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šäº†ç¬¬äºŒä¸ªå‚æ•°è¿è¡Œçš„æ¬¡æ•°ã€‚è¿™ç§ç‰¹æ€§å¯ä»¥è®©è¯¥æ–¹æ³•çš„ç”¨æ³•å˜å¾—éå¸¸çµæ´»ã€‚</p>
<p><code>Array.from()</code>çš„å¦ä¸€ä¸ªåº”ç”¨æ˜¯ï¼Œå°†å­—ç¬¦ä¸²è½¬ä¸ºæ•°ç»„ï¼Œç„¶åè¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚å› ä¸ºå®ƒèƒ½æ­£ç¡®å¤„ç†å„ç§Unicodeå­—ç¬¦ï¼Œå¯ä»¥é¿å…JavaScriptå°†å¤§äº<code>\uFFFF</code>çš„Unicodeå­—ç¬¦ï¼Œç®—ä½œä¸¤ä¸ªå­—ç¬¦çš„bugã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">countSymbols</span>(<span class="params">string</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.from(string).length;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Array-of"><a href="#Array-of" class="headerlink" title="Array.of()"></a>Array.of()</h2><p><code>Array.of</code>æ–¹æ³•ç”¨äºå°†ä¸€ç»„å€¼ï¼Œè½¬æ¢ä¸ºæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.of(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3,11,8]</span></div><div class="line"><span class="built_in">Array</span>.of(<span class="number">3</span>) <span class="comment">// [3]</span></div><div class="line"><span class="built_in">Array</span>.of(<span class="number">3</span>).length <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯å¼¥è¡¥æ•°ç»„æ„é€ å‡½æ•°<code>Array()</code>çš„ä¸è¶³ã€‚å› ä¸ºå‚æ•°ä¸ªæ•°çš„ä¸åŒï¼Œä¼šå¯¼è‡´<code>Array()</code>çš„è¡Œä¸ºæœ‰å·®å¼‚ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>() <span class="comment">// []</span></div><div class="line"><span class="built_in">Array</span>(<span class="number">3</span>) <span class="comment">// [, , ,]</span></div><div class="line"><span class="built_in">Array</span>(<span class="number">3</span>, <span class="number">11</span>, <span class="number">8</span>) <span class="comment">// [3, 11, 8]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Array</code>æ–¹æ³•æ²¡æœ‰å‚æ•°ã€ä¸€ä¸ªå‚æ•°ã€ä¸‰ä¸ªå‚æ•°æ—¶ï¼Œè¿”å›ç»“æœéƒ½ä¸ä¸€æ ·ã€‚åªæœ‰å½“å‚æ•°ä¸ªæ•°ä¸å°‘äº2ä¸ªæ—¶ï¼Œ<code>Array()</code>æ‰ä¼šè¿”å›ç”±å‚æ•°ç»„æˆçš„æ–°æ•°ç»„ã€‚å‚æ•°ä¸ªæ•°åªæœ‰ä¸€ä¸ªæ—¶ï¼Œå®é™…ä¸Šæ˜¯æŒ‡å®šæ•°ç»„çš„é•¿åº¦ã€‚</p>
<p><code>Array.of</code>åŸºæœ¬ä¸Šå¯ä»¥ç”¨æ¥æ›¿ä»£<code>Array()</code>æˆ–<code>new Array()</code>ï¼Œå¹¶ä¸”ä¸å­˜åœ¨ç”±äºå‚æ•°ä¸åŒè€Œå¯¼è‡´çš„é‡è½½ã€‚å®ƒçš„è¡Œä¸ºéå¸¸ç»Ÿä¸€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.of() <span class="comment">// []</span></div><div class="line"><span class="built_in">Array</span>.of(<span class="literal">undefined</span>) <span class="comment">// [undefined]</span></div><div class="line"><span class="built_in">Array</span>.of(<span class="number">1</span>) <span class="comment">// [1]</span></div><div class="line"><span class="built_in">Array</span>.of(<span class="number">1</span>, <span class="number">2</span>) <span class="comment">// [1, 2]</span></div></pre></td></tr></table></figure>
<p><code>Array.of</code>æ€»æ˜¯è¿”å›å‚æ•°å€¼ç»„æˆçš„æ•°ç»„ã€‚å¦‚æœæ²¡æœ‰å‚æ•°ï¼Œå°±è¿”å›ä¸€ä¸ªç©ºæ•°ç»„ã€‚</p>
<p><code>Array.of</code>æ–¹æ³•å¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿå®ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">ArrayOf</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> [].slice.call(<span class="built_in">arguments</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="æ•°ç»„å®ä¾‹çš„copyWithin"><a href="#æ•°ç»„å®ä¾‹çš„copyWithin" class="headerlink" title="æ•°ç»„å®ä¾‹çš„copyWithin()"></a>æ•°ç»„å®ä¾‹çš„copyWithin()</h2><p>æ•°ç»„å®ä¾‹çš„<code>copyWithin</code>æ–¹æ³•ï¼Œåœ¨å½“å‰æ•°ç»„å†…éƒ¨ï¼Œå°†æŒ‡å®šä½ç½®çš„æˆå‘˜å¤åˆ¶åˆ°å…¶ä»–ä½ç½®ï¼ˆä¼šè¦†ç›–åŸæœ‰æˆå‘˜ï¼‰ï¼Œç„¶åè¿”å›å½“å‰æ•°ç»„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œä¼šä¿®æ”¹å½“å‰æ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.prototype.copyWithin(target, start = <span class="number">0</span>, end = <span class="keyword">this</span>.length)</div></pre></td></tr></table></figure>
<p>å®ƒæ¥å—ä¸‰ä¸ªå‚æ•°ã€‚</p>
<ul>
<li>targetï¼ˆå¿…éœ€ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹æ›¿æ¢æ•°æ®ã€‚</li>
<li>startï¼ˆå¯é€‰ï¼‰ï¼šä»è¯¥ä½ç½®å¼€å§‹è¯»å–æ•°æ®ï¼Œé»˜è®¤ä¸º0ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚</li>
<li>endï¼ˆå¯é€‰ï¼‰ï¼šåˆ°è¯¥ä½ç½®å‰åœæ­¢è¯»å–æ•°æ®ï¼Œé»˜è®¤ç­‰äºæ•°ç»„é•¿åº¦ã€‚å¦‚æœä¸ºè´Ÿå€¼ï¼Œè¡¨ç¤ºå€’æ•°ã€‚</li>
</ul>
<p>è¿™ä¸‰ä¸ªå‚æ•°éƒ½åº”è¯¥æ˜¯æ•°å€¼ï¼Œå¦‚æœä¸æ˜¯ï¼Œä¼šè‡ªåŠ¨è½¬ä¸ºæ•°å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">3</span>)</div><div class="line"><span class="comment">// [4, 5, 3, 4, 5]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºå°†ä»3å·ä½ç›´åˆ°æ•°ç»„ç»“æŸçš„æˆå‘˜ï¼ˆ4å’Œ5ï¼‰ï¼Œå¤åˆ¶åˆ°ä»0å·ä½å¼€å§‹çš„ä½ç½®ï¼Œç»“æœè¦†ç›–äº†åŸæ¥çš„1å’Œ2ã€‚</p>
<p>ä¸‹é¢æ˜¯æ›´å¤šä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å°†3å·ä½å¤åˆ¶åˆ°0å·ä½</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>)</div><div class="line"><span class="comment">// [4, 2, 3, 4, 5]</span></div><div class="line"></div><div class="line"><span class="comment">// -2ç›¸å½“äº3å·ä½ï¼Œ-1ç›¸å½“äº4å·ä½</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>].copyWithin(<span class="number">0</span>, <span class="number">-2</span>, <span class="number">-1</span>)</div><div class="line"><span class="comment">// [4, 2, 3, 4, 5]</span></div><div class="line"></div><div class="line"><span class="comment">// å°†3å·ä½å¤åˆ¶åˆ°0å·ä½</span></div><div class="line">[].copyWithin.call(&#123;<span class="attr">length</span>: <span class="number">5</span>, <span class="number">3</span>: <span class="number">1</span>&#125;, <span class="number">0</span>, <span class="number">3</span>)</div><div class="line"><span class="comment">// &#123;0: 1, 3: 1, length: 5&#125;</span></div><div class="line"></div><div class="line"><span class="comment">// å°†2å·ä½åˆ°æ•°ç»„ç»“æŸï¼Œå¤åˆ¶åˆ°0å·ä½</span></div><div class="line"><span class="keyword">var</span> i32a = <span class="keyword">new</span> <span class="built_in">Int32Array</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]);</div><div class="line">i32a.copyWithin(<span class="number">0</span>, <span class="number">2</span>);</div><div class="line"><span class="comment">// Int32Array [3, 4, 5, 4, 5]</span></div><div class="line"></div><div class="line"><span class="comment">// å¯¹äºæ²¡æœ‰éƒ¨ç½²TypedArrayçš„copyWithinæ–¹æ³•çš„å¹³å°</span></div><div class="line"><span class="comment">// éœ€è¦é‡‡ç”¨ä¸‹é¢çš„å†™æ³•</span></div><div class="line">[].copyWithin.call(<span class="keyword">new</span> <span class="built_in">Int32Array</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]), <span class="number">0</span>, <span class="number">3</span>, <span class="number">4</span>);</div><div class="line"><span class="comment">// Int32Array [4, 2, 3, 4, 5]</span></div></pre></td></tr></table></figure>
<h2 id="æ•°ç»„å®ä¾‹çš„find-å’ŒfindIndex"><a href="#æ•°ç»„å®ä¾‹çš„find-å’ŒfindIndex" class="headerlink" title="æ•°ç»„å®ä¾‹çš„find()å’ŒfindIndex()"></a>æ•°ç»„å®ä¾‹çš„find()å’ŒfindIndex()</h2><p>æ•°ç»„å®ä¾‹çš„<code>find</code>æ–¹æ³•ï¼Œç”¨äºæ‰¾å‡ºç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜ã€‚å®ƒçš„å‚æ•°æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œæ‰€æœ‰æ•°ç»„æˆå‘˜ä¾æ¬¡æ‰§è¡Œè¯¥å›è°ƒå‡½æ•°ï¼Œç›´åˆ°æ‰¾å‡ºç¬¬ä¸€ä¸ªè¿”å›å€¼ä¸º<code>true</code>çš„æˆå‘˜ï¼Œç„¶åè¿”å›è¯¥æˆå‘˜ã€‚å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„æˆå‘˜ï¼Œåˆ™è¿”å›<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">-5</span>, <span class="number">10</span>].find(<span class="function">(<span class="params">n</span>) =&gt;</span> n &lt; <span class="number">0</span>)</div><div class="line"><span class="comment">// -5</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ‰¾å‡ºæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå°äº0çš„æˆå‘˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>].find(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> value &gt; <span class="number">9</span>;</div><div class="line">&#125;) <span class="comment">// 10</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>find</code>æ–¹æ³•çš„å›è°ƒå‡½æ•°å¯ä»¥æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œä¾æ¬¡ä¸ºå½“å‰çš„å€¼ã€å½“å‰çš„ä½ç½®å’ŒåŸæ•°ç»„ã€‚</p>
<p>æ•°ç»„å®ä¾‹çš„<code>findIndex</code>æ–¹æ³•çš„ç”¨æ³•ä¸<code>find</code>æ–¹æ³•éå¸¸ç±»ä¼¼ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„æ•°ç»„æˆå‘˜çš„ä½ç½®ï¼Œå¦‚æœæ‰€æœ‰æˆå‘˜éƒ½ä¸ç¬¦åˆæ¡ä»¶ï¼Œåˆ™è¿”å›<code>-1</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>].findIndex(<span class="function"><span class="keyword">function</span>(<span class="params">value, index, arr</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> value &gt; <span class="number">9</span>;</div><div class="line">&#125;) <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œç”¨æ¥ç»‘å®šå›è°ƒå‡½æ•°çš„<code>this</code>å¯¹è±¡ã€‚</p>
<p>å¦å¤–ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½å¯ä»¥å‘ç°<code>NaN</code>ï¼Œå¼¥è¡¥äº†æ•°ç»„çš„<code>IndexOf</code>æ–¹æ³•çš„ä¸è¶³ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[<span class="literal">NaN</span>].indexOf(<span class="literal">NaN</span>)</div><div class="line"><span class="comment">// -1</span></div><div class="line"></div><div class="line">[<span class="literal">NaN</span>].findIndex(<span class="function"><span class="params">y</span> =&gt;</span> <span class="built_in">Object</span>.is(<span class="literal">NaN</span>, y))</div><div class="line"><span class="comment">// 0</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>indexOf</code>æ–¹æ³•æ— æ³•è¯†åˆ«æ•°ç»„çš„<code>NaN</code>æˆå‘˜ï¼Œä½†æ˜¯<code>findIndex</code>æ–¹æ³•å¯ä»¥å€ŸåŠ©<code>Object.is</code>æ–¹æ³•åšåˆ°ã€‚</p>
<h2 id="æ•°ç»„å®ä¾‹çš„fill"><a href="#æ•°ç»„å®ä¾‹çš„fill" class="headerlink" title="æ•°ç»„å®ä¾‹çš„fill()"></a>æ•°ç»„å®ä¾‹çš„fill()</h2><p><code>fill</code>æ–¹æ³•ä½¿ç”¨ç»™å®šå€¼ï¼Œå¡«å……ä¸€ä¸ªæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].fill(<span class="number">7</span>)</div><div class="line"><span class="comment">// [7, 7, 7]</span></div><div class="line"></div><div class="line"><span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>).fill(<span class="number">7</span>)</div><div class="line"><span class="comment">// [7, 7, 7]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨æ˜ï¼Œ<code>fill</code>æ–¹æ³•ç”¨äºç©ºæ•°ç»„çš„åˆå§‹åŒ–éå¸¸æ–¹ä¾¿ã€‚æ•°ç»„ä¸­å·²æœ‰çš„å…ƒç´ ï¼Œä¼šè¢«å…¨éƒ¨æŠ¹å»ã€‚</p>
<p><code>fill</code>æ–¹æ³•è¿˜å¯ä»¥æ¥å—ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œç”¨äºæŒ‡å®šå¡«å……çš„èµ·å§‹ä½ç½®å’Œç»“æŸä½ç½®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>].fill(<span class="number">7</span>, <span class="number">1</span>, <span class="number">2</span>)</div><div class="line"><span class="comment">// ['a', 7, 'c']</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œ<code>fill</code>æ–¹æ³•ä»1å·ä½å¼€å§‹ï¼Œå‘åŸæ•°ç»„å¡«å……7ï¼Œåˆ°2å·ä½ä¹‹å‰ç»“æŸã€‚</p>
<h2 id="æ•°ç»„å®ä¾‹çš„entries-ï¼Œkeys-å’Œvalues"><a href="#æ•°ç»„å®ä¾‹çš„entries-ï¼Œkeys-å’Œvalues" class="headerlink" title="æ•°ç»„å®ä¾‹çš„entries()ï¼Œkeys()å’Œvalues()"></a>æ•°ç»„å®ä¾‹çš„entries()ï¼Œkeys()å’Œvalues()</h2><p>ES6æä¾›ä¸‰ä¸ªæ–°çš„æ–¹æ³•â€”â€”<code>entries()</code>ï¼Œ<code>keys()</code>å’Œ<code>values()</code>â€”â€”ç”¨äºéå†æ•°ç»„ã€‚å®ƒä»¬éƒ½è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼ˆè¯¦è§ã€ŠIteratorã€‹ä¸€ç« ï¼‰ï¼Œå¯ä»¥ç”¨<code>for...of</code>å¾ªç¯è¿›è¡Œéå†ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯<code>keys()</code>æ˜¯å¯¹é”®åçš„éå†ã€<code>values()</code>æ˜¯å¯¹é”®å€¼çš„éå†ï¼Œ<code>entries()</code>æ˜¯å¯¹é”®å€¼å¯¹çš„éå†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> index <span class="keyword">of</span> [<span class="string">'a'</span>, <span class="string">'b'</span>].keys()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(index);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 0</span></div><div class="line"><span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> elem <span class="keyword">of</span> [<span class="string">'a'</span>, <span class="string">'b'</span>].values()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(elem);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 'a'</span></div><div class="line"><span class="comment">// 'b'</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [index, elem] <span class="keyword">of</span> [<span class="string">'a'</span>, <span class="string">'b'</span>].entries()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(index, elem);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 0 "a"</span></div><div class="line"><span class="comment">// 1 "b"</span></div></pre></td></tr></table></figure>
<p>å¦‚æœä¸ä½¿ç”¨<code>for...of</code>å¾ªç¯ï¼Œå¯ä»¥æ‰‹åŠ¨è°ƒç”¨éå†å™¨å¯¹è±¡çš„<code>next</code>æ–¹æ³•ï¼Œè¿›è¡Œéå†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> letter = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>];</div><div class="line"><span class="keyword">let</span> entries = letter.entries();</div><div class="line"><span class="built_in">console</span>.log(entries.next().value); <span class="comment">// [0, 'a']</span></div><div class="line"><span class="built_in">console</span>.log(entries.next().value); <span class="comment">// [1, 'b']</span></div><div class="line"><span class="built_in">console</span>.log(entries.next().value); <span class="comment">// [2, 'c']</span></div></pre></td></tr></table></figure>
<h2 id="æ•°ç»„å®ä¾‹çš„includes"><a href="#æ•°ç»„å®ä¾‹çš„includes" class="headerlink" title="æ•°ç»„å®ä¾‹çš„includes()"></a>æ•°ç»„å®ä¾‹çš„includes()</h2><p><code>Array.prototype.includes</code>æ–¹æ³•è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªæ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šçš„å€¼ï¼Œä¸å­—ç¬¦ä¸²çš„<code>includes</code>æ–¹æ³•ç±»ä¼¼ã€‚è¯¥æ–¹æ³•å±äºES7ï¼Œä½†Babelè½¬ç å™¨å·²ç»æ”¯æŒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">2</span>);     <span class="comment">// true</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">4</span>);     <span class="comment">// false</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="literal">NaN</span>].includes(<span class="literal">NaN</span>); <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæœç´¢çš„èµ·å§‹ä½ç½®ï¼Œé»˜è®¤ä¸º0ã€‚å¦‚æœç¬¬äºŒä¸ªå‚æ•°ä¸ºè´Ÿæ•°ï¼Œåˆ™è¡¨ç¤ºå€’æ•°çš„ä½ç½®ï¼Œå¦‚æœè¿™æ—¶å®ƒå¤§äºæ•°ç»„é•¿åº¦ï¼ˆæ¯”å¦‚ç¬¬äºŒä¸ªå‚æ•°ä¸º-4ï¼Œä½†æ•°ç»„é•¿åº¦ä¸º3ï¼‰ï¼Œåˆ™ä¼šé‡ç½®ä¸ºä»0å¼€å§‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, <span class="number">3</span>);  <span class="comment">// false</span></div><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].includes(<span class="number">3</span>, <span class="number">-1</span>); <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>æ²¡æœ‰è¯¥æ–¹æ³•ä¹‹å‰ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨æ•°ç»„çš„<code>indexOf</code>æ–¹æ³•ï¼Œæ£€æŸ¥æ˜¯å¦åŒ…å«æŸä¸ªå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (arr.indexOf(el) !== <span class="number">-1</span>) &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>indexOf</code>æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºç‚¹ï¼Œä¸€æ˜¯ä¸å¤Ÿè¯­ä¹‰åŒ–ï¼Œå®ƒçš„å«ä¹‰æ˜¯æ‰¾åˆ°å‚æ•°å€¼çš„ç¬¬ä¸€ä¸ªå‡ºç°ä½ç½®ï¼Œæ‰€ä»¥è¦å»æ¯”è¾ƒæ˜¯å¦ä¸ç­‰äº-1ï¼Œè¡¨è¾¾èµ·æ¥ä¸å¤Ÿç›´è§‚ã€‚äºŒæ˜¯ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸å½“è¿ç®—ç¬¦ï¼ˆ===ï¼‰è¿›è¡Œåˆ¤æ–­ï¼Œè¿™ä¼šå¯¼è‡´å¯¹<code>NaN</code>çš„è¯¯åˆ¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="literal">NaN</span>].indexOf(<span class="literal">NaN</span>)</div><div class="line"><span class="comment">// -1</span></div></pre></td></tr></table></figure>
<p><code>includes</code>ä½¿ç”¨çš„æ˜¯ä¸ä¸€æ ·çš„åˆ¤æ–­ç®—æ³•ï¼Œå°±æ²¡æœ‰è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="literal">NaN</span>].includes(<span class="literal">NaN</span>)</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢ä»£ç ç”¨æ¥æ£€æŸ¥å½“å‰ç¯å¢ƒæ˜¯å¦æ”¯æŒè¯¥æ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒï¼Œéƒ¨ç½²ä¸€ä¸ªç®€æ˜“çš„æ›¿ä»£ç‰ˆæœ¬ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> contains = <span class="function">(<span class="params">(</span>) =&gt;</span></div><div class="line">  <span class="built_in">Array</span>.prototype.includes</div><div class="line">    ? <span class="function">(<span class="params">arr, value</span>) =&gt;</span> arr.includes(value)</div><div class="line">    : <span class="function">(<span class="params">arr, value</span>) =&gt;</span> arr.some(<span class="function"><span class="params">el</span> =&gt;</span> el === value)</div><div class="line">)();</div><div class="line">contains([<span class="string">"foo"</span>, <span class="string">"bar"</span>], <span class="string">"baz"</span>); <span class="comment">// =&gt; false</span></div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼ŒMapå’ŒSetæ•°æ®ç»“æ„æœ‰ä¸€ä¸ª<code>has</code>æ–¹æ³•ï¼Œéœ€è¦æ³¨æ„ä¸<code>includes</code>åŒºåˆ†ã€‚</p>
<ul>
<li>Mapç»“æ„çš„<code>has</code>æ–¹æ³•ï¼Œæ˜¯ç”¨æ¥æŸ¥æ‰¾é”®åçš„ï¼Œæ¯”å¦‚<code>Map.prototype.has(key)</code>ã€<code>WeakMap.prototype.has(key)</code>ã€<code>Reflect.has(target, propertyKey)</code>ã€‚</li>
<li>Setç»“æ„çš„<code>has</code>æ–¹æ³•ï¼Œæ˜¯ç”¨æ¥æŸ¥æ‰¾å€¼çš„ï¼Œæ¯”å¦‚<code>Set.prototype.has(value)</code>ã€<code>WeakSet.prototype.has(value)</code>ã€‚</li>
</ul>
<h2 id="æ•°ç»„çš„ç©ºä½"><a href="#æ•°ç»„çš„ç©ºä½" class="headerlink" title="æ•°ç»„çš„ç©ºä½"></a>æ•°ç»„çš„ç©ºä½</h2><p>æ•°ç»„çš„ç©ºä½æŒ‡ï¼Œæ•°ç»„çš„æŸä¸€ä¸ªä½ç½®æ²¡æœ‰ä»»ä½•å€¼ã€‚æ¯”å¦‚ï¼Œ<code>Array</code>æ„é€ å‡½æ•°è¿”å›çš„æ•°ç»„éƒ½æ˜¯ç©ºä½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>(<span class="number">3</span>) <span class="comment">// [, , ,]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>Array(3)</code>è¿”å›ä¸€ä¸ªå…·æœ‰3ä¸ªç©ºä½çš„æ•°ç»„ã€‚</p>
<p>æ³¨æ„ï¼Œç©ºä½ä¸æ˜¯<code>undefined</code>ï¼Œä¸€ä¸ªä½ç½®çš„å€¼ç­‰äº<code>undefined</code>ï¼Œä¾ç„¶æ˜¯æœ‰å€¼çš„ã€‚ç©ºä½æ˜¯æ²¡æœ‰ä»»ä½•å€¼ï¼Œ<code>in</code>è¿ç®—ç¬¦å¯ä»¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">0</span> <span class="keyword">in</span> [<span class="literal">undefined</span>, <span class="literal">undefined</span>, <span class="literal">undefined</span>] <span class="comment">// true</span></div><div class="line"><span class="number">0</span> <span class="keyword">in</span> [, , ,] <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼Œç¬¬ä¸€ä¸ªæ•°ç»„çš„0å·ä½ç½®æ˜¯æœ‰å€¼çš„ï¼Œç¬¬äºŒä¸ªæ•°ç»„çš„0å·ä½ç½®æ²¡æœ‰å€¼ã€‚</p>
<p>ES5å¯¹ç©ºä½çš„å¤„ç†ï¼Œå·²ç»å¾ˆä¸ä¸€è‡´äº†ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¼šå¿½ç•¥ç©ºä½ã€‚</p>
<ul>
<li><code>forEach()</code>, <code>filter()</code>, <code>every()</code> å’Œ<code>some()</code>éƒ½ä¼šè·³è¿‡ç©ºä½ã€‚</li>
<li><code>map()</code>ä¼šè·³è¿‡ç©ºä½ï¼Œä½†ä¼šä¿ç•™è¿™ä¸ªå€¼</li>
<li><code>join()</code>å’Œ<code>toString()</code>ä¼šå°†ç©ºä½è§†ä¸º<code>undefined</code>ï¼Œè€Œ<code>undefined</code>å’Œ<code>null</code>ä¼šè¢«å¤„ç†æˆç©ºå­—ç¬¦ä¸²ã€‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// forEachæ–¹æ³•</span></div><div class="line">[,<span class="string">'a'</span>].forEach(<span class="function">(<span class="params">x,i</span>) =&gt;</span> <span class="built_in">console</span>.log(i)); <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="comment">// filteræ–¹æ³•</span></div><div class="line">[<span class="string">'a'</span>,,<span class="string">'b'</span>].filter(<span class="function"><span class="params">x</span> =&gt;</span> <span class="literal">true</span>) <span class="comment">// ['a','b']</span></div><div class="line"></div><div class="line"><span class="comment">// everyæ–¹æ³•</span></div><div class="line">[,<span class="string">'a'</span>].every(<span class="function"><span class="params">x</span> =&gt;</span> x===<span class="string">'a'</span>) <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="comment">// someæ–¹æ³•</span></div><div class="line">[,<span class="string">'a'</span>].some(<span class="function"><span class="params">x</span> =&gt;</span> x !== <span class="string">'a'</span>) <span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="comment">// mapæ–¹æ³•</span></div><div class="line">[,<span class="string">'a'</span>].map(<span class="function"><span class="params">x</span> =&gt;</span> <span class="number">1</span>) <span class="comment">// [,1]</span></div><div class="line"></div><div class="line"><span class="comment">// joinæ–¹æ³•</span></div><div class="line">[,<span class="string">'a'</span>,<span class="literal">undefined</span>,<span class="literal">null</span>].join(<span class="string">'#'</span>) <span class="comment">// "#a##"</span></div><div class="line"></div><div class="line"><span class="comment">// toStringæ–¹æ³•</span></div><div class="line">[,<span class="string">'a'</span>,<span class="literal">undefined</span>,<span class="literal">null</span>].toString() <span class="comment">// ",a,,"</span></div></pre></td></tr></table></figure>
<p>ES6åˆ™æ˜¯æ˜ç¡®å°†ç©ºä½è½¬ä¸º<code>undefined</code>ã€‚</p>
<p><code>Array.from</code>æ–¹æ³•ä¼šå°†æ•°ç»„çš„ç©ºä½ï¼Œè½¬ä¸º<code>undefined</code>ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ–¹æ³•ä¸ä¼šå¿½ç•¥ç©ºä½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Array</span>.from([<span class="string">'a'</span>,,<span class="string">'b'</span>])</div><div class="line"><span class="comment">// [ "a", undefined, "b" ]</span></div></pre></td></tr></table></figure>
<p>æ‰©å±•è¿ç®—ç¬¦ï¼ˆ<code>...</code>ï¼‰ä¹Ÿä¼šå°†ç©ºä½è½¬ä¸º<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[...[<span class="string">'a'</span>,,<span class="string">'b'</span>]]</div><div class="line"><span class="comment">// [ "a", undefined, "b" ]</span></div></pre></td></tr></table></figure>
<p><code>copyWithin()</code>ä¼šè¿ç©ºä½ä¸€èµ·æ‹·è´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[,<span class="string">'a'</span>,<span class="string">'b'</span>,,].copyWithin(<span class="number">2</span>,<span class="number">0</span>) <span class="comment">// [,"a",,"a"]</span></div></pre></td></tr></table></figure>
<p><code>fill()</code>ä¼šå°†ç©ºä½è§†ä¸ºæ­£å¸¸çš„æ•°ç»„ä½ç½®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">3</span>).fill(<span class="string">'a'</span>) <span class="comment">// ["a","a","a"]</span></div></pre></td></tr></table></figure>
<p><code>for...of</code>å¾ªç¯ä¹Ÿä¼šéå†ç©ºä½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> arr = [, ,];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> arr) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1</span></div><div class="line"><span class="comment">// 1</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°ç»„<code>arr</code>æœ‰ä¸¤ä¸ªç©ºä½ï¼Œ<code>for...of</code>å¹¶æ²¡æœ‰å¿½ç•¥å®ƒä»¬ã€‚å¦‚æœæ”¹æˆ<code>map</code>æ–¹æ³•éå†ï¼Œç©ºä½æ˜¯ä¼šè·³è¿‡çš„ã€‚</p>
<p><code>entries()</code>ã€<code>keys()</code>ã€<code>values()</code>ã€<code>find()</code>å’Œ<code>findIndex()</code>ä¼šå°†ç©ºä½å¤„ç†æˆ<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// entries()</span></div><div class="line">[...[,<span class="string">'a'</span>].entries()] <span class="comment">// [[0,undefined], [1,"a"]]</span></div><div class="line"></div><div class="line"><span class="comment">// keys()</span></div><div class="line">[...[,<span class="string">'a'</span>].keys()] <span class="comment">// [0,1]</span></div><div class="line"></div><div class="line"><span class="comment">// values()</span></div><div class="line">[...[,<span class="string">'a'</span>].values()] <span class="comment">// [undefined,"a"]</span></div><div class="line"></div><div class="line"><span class="comment">// find()</span></div><div class="line">[,<span class="string">'a'</span>].find(<span class="function"><span class="params">x</span> =&gt;</span> <span class="literal">true</span>) <span class="comment">// undefined</span></div><div class="line"></div><div class="line"><span class="comment">// findIndex()</span></div><div class="line">[,<span class="string">'a'</span>].findIndex(<span class="function"><span class="params">x</span> =&gt;</span> <span class="literal">true</span>) <span class="comment">// 0</span></div></pre></td></tr></table></figure>
<p>ç”±äºç©ºä½çš„å¤„ç†è§„åˆ™éå¸¸ä¸ç»Ÿä¸€ï¼Œæ‰€ä»¥å»ºè®®é¿å…å‡ºç°ç©ºä½ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;æ•°ç»„çš„æ‰©å±•&quot;&gt;&lt;a href=&quot;#æ•°ç»„çš„æ‰©å±•&quot; class=&quot;headerlink&quot; title=&quot;æ•°ç»„çš„æ‰©å±•&quot;&gt;&lt;/a&gt;æ•°ç»„çš„æ‰©å±•&lt;/h1&gt;&lt;h2 id=&quot;Array-from&quot;&gt;&lt;a href=&quot;#Array-from&quot; class=&quot;headerlink&quot; 
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Array" scheme="http://microzz.com/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>æ•°å€¼çš„æ‰©å±•</title>
    <link href="http://microzz.com/2016/11/25/number/"/>
    <id>http://microzz.com/2016/11/25/number/</id>
    <published>2016-11-25T09:45:19.000Z</published>
    <updated>2017-01-12T07:59:12.253Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ•°å€¼çš„æ‰©å±•"><a href="#æ•°å€¼çš„æ‰©å±•" class="headerlink" title="æ•°å€¼çš„æ‰©å±•"></a>æ•°å€¼çš„æ‰©å±•</h1><h2 id="äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•"><a href="#äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•" class="headerlink" title="äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•"></a>äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•</h2><p>ES6æä¾›äº†äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶æ•°å€¼çš„æ–°çš„å†™æ³•ï¼Œåˆ†åˆ«ç”¨å‰ç¼€<code>0b</code>ï¼ˆæˆ–<code>0B</code>ï¼‰å’Œ<code>0o</code>ï¼ˆæˆ–<code>0O</code>ï¼‰è¡¨ç¤ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">0b111110111</span> === <span class="number">503</span> <span class="comment">// true</span></div><div class="line"><span class="number">0o767</span> === <span class="number">503</span> <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä»ES5å¼€å§‹ï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¹‹ä¸­ï¼Œå…«è¿›åˆ¶å°±ä¸å†å…è®¸ä½¿ç”¨å‰ç¼€<code>0</code>è¡¨ç¤ºï¼ŒES6è¿›ä¸€æ­¥æ˜ç¡®ï¼Œè¦ä½¿ç”¨å‰ç¼€<code>0o</code>è¡¨ç¤ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// éä¸¥æ ¼æ¨¡å¼</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">0o11</span> === <span class="number">011</span>);</div><div class="line">&#125;)() <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="comment">// ä¸¥æ ¼æ¨¡å¼</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="meta">  'use strict'</span>;</div><div class="line">  <span class="built_in">console</span>.log(<span class="number">0o11</span> === <span class="number">011</span>);</div><div class="line">&#125;)() <span class="comment">// Uncaught SyntaxError: Octal literals are not allowed in strict mode.</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè¦å°†<code>0b</code>å’Œ<code>0o</code>å‰ç¼€çš„å­—ç¬¦ä¸²æ•°å€¼è½¬ä¸ºåè¿›åˆ¶ï¼Œè¦ä½¿ç”¨<code>Number</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>(<span class="string">'0b111'</span>)  <span class="comment">// 7</span></div><div class="line"><span class="built_in">Number</span>(<span class="string">'0o10'</span>)  <span class="comment">// 8</span></div></pre></td></tr></table></figure>
<h2 id="Number-isFinite-Number-isNaN"><a href="#Number-isFinite-Number-isNaN" class="headerlink" title="Number.isFinite(), Number.isNaN()"></a>Number.isFinite(), Number.isNaN()</h2><p>ES6åœ¨Numberå¯¹è±¡ä¸Šï¼Œæ–°æä¾›äº†<code>Number.isFinite()</code>å’Œ<code>Number.isNaN()</code>ä¸¤ä¸ªæ–¹æ³•ã€‚</p>
<p><code>Number.isFinite()</code>ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªæ•°å€¼æ˜¯å¦ä¸ºæœ‰é™çš„ï¼ˆfiniteï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.isFinite(<span class="number">15</span>); <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isFinite(<span class="number">0.8</span>); <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">NaN</span>); <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">Infinity</span>); <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isFinite(-<span class="literal">Infinity</span>); <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isFinite(<span class="string">'foo'</span>); <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isFinite(<span class="string">'15'</span>); <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isFinite(<span class="literal">true</span>); <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ES5å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œéƒ¨ç½²<code>Number.isFinite</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> global_isFinite = global.isFinite;</div><div class="line"></div><div class="line">  <span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isFinite'</span>, &#123;</div><div class="line">    <span class="attr">value</span>: <span class="function"><span class="keyword">function</span> <span class="title">isFinite</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; global_isFinite(value);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">enumerable</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">writable</span>: <span class="literal">true</span></div><div class="line">  &#125;);</div><div class="line">&#125;)(<span class="keyword">this</span>);</div></pre></td></tr></table></figure>
<p><code>Number.isNaN()</code>ç”¨æ¥æ£€æŸ¥ä¸€ä¸ªå€¼æ˜¯å¦ä¸º<code>NaN</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">NaN</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isNaN(<span class="number">15</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'15'</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">true</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isNaN(<span class="number">9</span>/<span class="literal">NaN</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'true'</span>/<span class="number">0</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isNaN(<span class="string">'true'</span>/<span class="string">'true'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ES5é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œéƒ¨ç½²<code>Number.isNaN()</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> global_isNaN = global.isNaN;</div><div class="line"></div><div class="line">  <span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isNaN'</span>, &#123;</div><div class="line">    <span class="attr">value</span>: <span class="function"><span class="keyword">function</span> <span class="title">isNaN</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; global_isNaN(value);</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">enumerable</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">writable</span>: <span class="literal">true</span></div><div class="line">  &#125;);</div><div class="line">&#125;)(<span class="keyword">this</span>);</div></pre></td></tr></table></figure>
<p>å®ƒä»¬ä¸ä¼ ç»Ÿçš„å…¨å±€æ–¹æ³•<code>isFinite()</code>å’Œ<code>isNaN()</code>çš„åŒºåˆ«åœ¨äºï¼Œä¼ ç»Ÿæ–¹æ³•å…ˆè°ƒç”¨<code>Number()</code>å°†éæ•°å€¼çš„å€¼è½¬ä¸ºæ•°å€¼ï¼Œå†è¿›è¡Œåˆ¤æ–­ï¼Œè€Œè¿™ä¸¤ä¸ªæ–°æ–¹æ³•åªå¯¹æ•°å€¼æœ‰æ•ˆï¼Œéæ•°å€¼ä¸€å¾‹è¿”å›<code>false</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">isFinite</span>(<span class="number">25</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">isFinite</span>(<span class="string">"25"</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isFinite(<span class="number">25</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isFinite(<span class="string">"25"</span>) <span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="built_in">isNaN</span>(<span class="literal">NaN</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">isNaN</span>(<span class="string">"NaN"</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isNaN(<span class="literal">NaN</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isNaN(<span class="string">"NaN"</span>) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<h2 id="Number-parseInt-Number-parseFloat"><a href="#Number-parseInt-Number-parseFloat" class="headerlink" title="Number.parseInt(), Number.parseFloat()"></a>Number.parseInt(), Number.parseFloat()</h2><p>ES6å°†å…¨å±€æ–¹æ³•<code>parseInt()</code>å’Œ<code>parseFloat()</code>ï¼Œç§»æ¤åˆ°Numberå¯¹è±¡ä¸Šé¢ï¼Œè¡Œä¸ºå®Œå…¨ä¿æŒä¸å˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5çš„å†™æ³•</span></div><div class="line"><span class="built_in">parseInt</span>(<span class="string">'12.34'</span>) <span class="comment">// 12</span></div><div class="line"><span class="built_in">parseFloat</span>(<span class="string">'123.45#'</span>) <span class="comment">// 123.45</span></div><div class="line"></div><div class="line"><span class="comment">// ES6çš„å†™æ³•</span></div><div class="line"><span class="built_in">Number</span>.parseInt(<span class="string">'12.34'</span>) <span class="comment">// 12</span></div><div class="line"><span class="built_in">Number</span>.parseFloat(<span class="string">'123.45#'</span>) <span class="comment">// 123.45</span></div></pre></td></tr></table></figure>
<p>è¿™æ ·åšçš„ç›®çš„ï¼Œæ˜¯é€æ­¥å‡å°‘å…¨å±€æ€§æ–¹æ³•ï¼Œä½¿å¾—è¯­è¨€é€æ­¥æ¨¡å—åŒ–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.parseInt === <span class="built_in">parseInt</span> <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.parseFloat === <span class="built_in">parseFloat</span> <span class="comment">// true</span></div></pre></td></tr></table></figure>
<h2 id="Number-isInteger"><a href="#Number-isInteger" class="headerlink" title="Number.isInteger()"></a>Number.isInteger()</h2><p><code>Number.isInteger()</code>ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå€¼æ˜¯å¦ä¸ºæ•´æ•°ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨JavaScriptå†…éƒ¨ï¼Œæ•´æ•°å’Œæµ®ç‚¹æ•°æ˜¯åŒæ ·çš„å‚¨å­˜æ–¹æ³•ï¼Œæ‰€ä»¥3å’Œ3.0è¢«è§†ä¸ºåŒä¸€ä¸ªå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25.0</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isInteger(<span class="number">25.1</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isInteger(<span class="string">"15"</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isInteger(<span class="literal">true</span>) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ES5å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç ï¼Œéƒ¨ç½²<code>Number.isInteger()</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">global</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> floor = <span class="built_in">Math</span>.floor,</div><div class="line">    <span class="built_in">isFinite</span> = global.isFinite;</div><div class="line"></div><div class="line">  <span class="built_in">Object</span>.defineProperty(<span class="built_in">Number</span>, <span class="string">'isInteger'</span>, &#123;</div><div class="line">    <span class="attr">value</span>: <span class="function"><span class="keyword">function</span> <span class="title">isInteger</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'number'</span> &amp;&amp; <span class="built_in">isFinite</span>(value) &amp;&amp;</div><div class="line">        value &gt; <span class="number">-9007199254740992</span> &amp;&amp; value &lt; <span class="number">9007199254740992</span> &amp;&amp;</div><div class="line">        floor(value) === value;</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">configurable</span>: <span class="literal">true</span>,</div><div class="line">    <span class="attr">enumerable</span>: <span class="literal">false</span>,</div><div class="line">    <span class="attr">writable</span>: <span class="literal">true</span></div><div class="line">  &#125;);</div><div class="line">&#125;)(<span class="keyword">this</span>);</div></pre></td></tr></table></figure>
<h2 id="Number-EPSILON"><a href="#Number-EPSILON" class="headerlink" title="Number.EPSILON"></a>Number.EPSILON</h2><p>ES6åœ¨Numberå¯¹è±¡ä¸Šé¢ï¼Œæ–°å¢ä¸€ä¸ªæå°çš„å¸¸é‡<code>Number.EPSILON</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.EPSILON</div><div class="line"><span class="comment">// 2.220446049250313e-16</span></div><div class="line"><span class="built_in">Number</span>.EPSILON.toFixed(<span class="number">20</span>)</div><div class="line"><span class="comment">// '0.00000000000000022204'</span></div></pre></td></tr></table></figure>
<p>å¼•å…¥ä¸€ä¸ªè¿™ä¹ˆå°çš„é‡çš„ç›®çš„ï¼Œåœ¨äºä¸ºæµ®ç‚¹æ•°è®¡ç®—ï¼Œè®¾ç½®ä¸€ä¸ªè¯¯å·®èŒƒå›´ã€‚æˆ‘ä»¬çŸ¥é“æµ®ç‚¹æ•°è®¡ç®—æ˜¯ä¸ç²¾ç¡®çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="number">0.1</span> + <span class="number">0.2</span></div><div class="line"><span class="comment">// 0.30000000000000004</span></div><div class="line"></div><div class="line"><span class="number">0.1</span> + <span class="number">0.2</span> - <span class="number">0.3</span></div><div class="line"><span class="comment">// 5.551115123125783e-17</span></div><div class="line"></div><div class="line"><span class="number">5.551115123125783e-17</span>.toFixed(<span class="number">20</span>)</div><div class="line"><span class="comment">// '0.00000000000000005551'</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯å¦‚æœè¿™ä¸ªè¯¯å·®èƒ½å¤Ÿå°äº<code>Number.EPSILON</code>ï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºå¾—åˆ°äº†æ­£ç¡®ç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">5.551115123125783e-17</span> &lt; <span class="built_in">Number</span>.EPSILON</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œ<code>Number.EPSILON</code>çš„å®è´¨æ˜¯ä¸€ä¸ªå¯ä»¥æ¥å—çš„è¯¯å·®èŒƒå›´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">withinErrorMargin</span> (<span class="params">left, right</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.abs(left - right) &lt; <span class="built_in">Number</span>.EPSILON;</div><div class="line">&#125;</div><div class="line">withinErrorMargin(<span class="number">0.1</span> + <span class="number">0.2</span>, <span class="number">0.3</span>)</div><div class="line"><span class="comment">// true</span></div><div class="line">withinErrorMargin(<span class="number">0.2</span> + <span class="number">0.2</span>, <span class="number">0.3</span>)</div><div class="line"><span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç ä¸ºæµ®ç‚¹æ•°è¿ç®—ï¼Œéƒ¨ç½²äº†ä¸€ä¸ªè¯¯å·®æ£€æŸ¥å‡½æ•°ã€‚</p>
<h2 id="å®‰å…¨æ•´æ•°å’ŒNumber-isSafeInteger"><a href="#å®‰å…¨æ•´æ•°å’ŒNumber-isSafeInteger" class="headerlink" title="å®‰å…¨æ•´æ•°å’ŒNumber.isSafeInteger()"></a>å®‰å…¨æ•´æ•°å’ŒNumber.isSafeInteger()</h2><p>JavaScriptèƒ½å¤Ÿå‡†ç¡®è¡¨ç¤ºçš„æ•´æ•°èŒƒå›´åœ¨<code>-2^53</code>åˆ°<code>2^53</code>ä¹‹é—´ï¼ˆä¸å«ä¸¤ä¸ªç«¯ç‚¹ï¼‰ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºè¿™ä¸ªå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">53</span>) <span class="comment">// 9007199254740992</span></div><div class="line"></div><div class="line"><span class="number">9007199254740992</span>  <span class="comment">// 9007199254740992</span></div><div class="line"><span class="number">9007199254740993</span>  <span class="comment">// 9007199254740992</span></div><div class="line"></div><div class="line"><span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">53</span>) === <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">53</span>) + <span class="number">1</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè¶…å‡º2çš„53æ¬¡æ–¹ä¹‹åï¼Œä¸€ä¸ªæ•°å°±ä¸ç²¾ç¡®äº†ã€‚</p>
<p>ES6å¼•å…¥äº†<code>Number.MAX_SAFE_INTEGER</code>å’Œ<code>Number.MIN_SAFE_INTEGER</code>è¿™ä¸¤ä¸ªå¸¸é‡ï¼Œç”¨æ¥è¡¨ç¤ºè¿™ä¸ªèŒƒå›´çš„ä¸Šä¸‹é™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.MAX_SAFE_INTEGER === <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">53</span>) - <span class="number">1</span></div><div class="line"><span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.MAX_SAFE_INTEGER === <span class="number">9007199254740991</span></div><div class="line"><span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="built_in">Number</span>.MIN_SAFE_INTEGER === -<span class="built_in">Number</span>.MAX_SAFE_INTEGER</div><div class="line"><span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.MIN_SAFE_INTEGER === <span class="number">-9007199254740991</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¯ä»¥çœ‹åˆ°JavaScriptèƒ½å¤Ÿç²¾ç¡®è¡¨ç¤ºçš„æé™ã€‚</p>
<p><code>Number.isSafeInteger()</code>åˆ™æ˜¯ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•´æ•°æ˜¯å¦è½åœ¨è¿™ä¸ªèŒƒå›´ä¹‹å†…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="string">'a'</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">null</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">NaN</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="literal">Infinity</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(-<span class="literal">Infinity</span>) <span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">3</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">1.2</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">9007199254740990</span>) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">9007199254740992</span>) <span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MIN_SAFE_INTEGER - <span class="number">1</span>) <span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MIN_SAFE_INTEGER) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MAX_SAFE_INTEGER) <span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="built_in">Number</span>.MAX_SAFE_INTEGER + <span class="number">1</span>) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‡½æ•°çš„å®ç°å¾ˆç®€å•ï¼Œå°±æ˜¯è·Ÿå®‰å…¨æ•´æ•°çš„ä¸¤ä¸ªè¾¹ç•Œå€¼æ¯”è¾ƒä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.isSafeInteger = <span class="function"><span class="keyword">function</span> (<span class="params">n</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (<span class="keyword">typeof</span> n === <span class="string">'number'</span> &amp;&amp;</div><div class="line">    <span class="built_in">Math</span>.round(n) === n &amp;&amp;</div><div class="line">    <span class="built_in">Number</span>.MIN_SAFE_INTEGER &lt;= n &amp;&amp;</div><div class="line">    n &lt;= <span class="built_in">Number</span>.MAX_SAFE_INTEGER);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å®é™…ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ—¶ï¼Œéœ€è¦æ³¨æ„ã€‚éªŒè¯è¿ç®—ç»“æœæ˜¯å¦è½åœ¨å®‰å…¨æ•´æ•°çš„èŒƒå›´å†…ï¼Œä¸è¦åªéªŒè¯è¿ç®—ç»“æœï¼Œè€Œè¦åŒæ—¶éªŒè¯å‚ä¸è¿ç®—çš„æ¯ä¸ªå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">9007199254740993</span>)</div><div class="line"><span class="comment">// false</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">990</span>)</div><div class="line"><span class="comment">// true</span></div><div class="line"><span class="built_in">Number</span>.isSafeInteger(<span class="number">9007199254740993</span> - <span class="number">990</span>)</div><div class="line"><span class="comment">// true</span></div><div class="line"><span class="number">9007199254740993</span> - <span class="number">990</span></div><div class="line"><span class="comment">// è¿”å›ç»“æœ 9007199254740002</span></div><div class="line"><span class="comment">// æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯ 9007199254740003</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>9007199254740993</code>ä¸æ˜¯ä¸€ä¸ªå®‰å…¨æ•´æ•°ï¼Œä½†æ˜¯<code>Number.isSafeInteger</code>ä¼šè¿”å›ç»“æœï¼Œæ˜¾ç¤ºè®¡ç®—ç»“æœæ˜¯å®‰å…¨çš„ã€‚è¿™æ˜¯å› ä¸ºï¼Œè¿™ä¸ªæ•°è¶…å‡ºäº†ç²¾åº¦èŒƒå›´ï¼Œå¯¼è‡´åœ¨è®¡ç®—æœºå†…éƒ¨ï¼Œä»¥<code>9007199254740992</code>çš„å½¢å¼å‚¨å­˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">9007199254740993</span> === <span class="number">9007199254740992</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œå¦‚æœåªéªŒè¯è¿ç®—ç»“æœæ˜¯å¦ä¸ºå®‰å…¨æ•´æ•°ï¼Œå¾ˆå¯èƒ½å¾—åˆ°é”™è¯¯ç»“æœã€‚ä¸‹é¢çš„å‡½æ•°å¯ä»¥åŒæ—¶éªŒè¯ä¸¤ä¸ªè¿ç®—æ•°å’Œè¿ç®—ç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">trusty</span> (<span class="params">left, right, result</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (</div><div class="line">    <span class="built_in">Number</span>.isSafeInteger(left) &amp;&amp;</div><div class="line">    <span class="built_in">Number</span>.isSafeInteger(right) &amp;&amp;</div><div class="line">    <span class="built_in">Number</span>.isSafeInteger(result)</div><div class="line">  ) &#123;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">RangeError</span>(<span class="string">'Operation cannot be trusted!'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line">trusty(<span class="number">9007199254740993</span>, <span class="number">990</span>, <span class="number">9007199254740993</span> - <span class="number">990</span>)</div><div class="line"><span class="comment">// RangeError: Operation cannot be trusted!</span></div><div class="line"></div><div class="line">trusty(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</div><div class="line"><span class="comment">// 3</span></div></pre></td></tr></table></figure>
<h2 id="Mathå¯¹è±¡çš„æ‰©å±•"><a href="#Mathå¯¹è±¡çš„æ‰©å±•" class="headerlink" title="Mathå¯¹è±¡çš„æ‰©å±•"></a>Mathå¯¹è±¡çš„æ‰©å±•</h2><p>ES6åœ¨Mathå¯¹è±¡ä¸Šæ–°å¢äº†17ä¸ªä¸æ•°å­¦ç›¸å…³çš„æ–¹æ³•ã€‚æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½æ˜¯é™æ€æ–¹æ³•ï¼Œåªèƒ½åœ¨Mathå¯¹è±¡ä¸Šè°ƒç”¨ã€‚</p>
<h3 id="Math-trunc"><a href="#Math-trunc" class="headerlink" title="Math.trunc()"></a>Math.trunc()</h3><p><code>Math.trunc</code>æ–¹æ³•ç”¨äºå»é™¤ä¸€ä¸ªæ•°çš„å°æ•°éƒ¨åˆ†ï¼Œè¿”å›æ•´æ•°éƒ¨åˆ†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.trunc(<span class="number">4.1</span>) <span class="comment">// 4</span></div><div class="line"><span class="built_in">Math</span>.trunc(<span class="number">4.9</span>) <span class="comment">// 4</span></div><div class="line"><span class="built_in">Math</span>.trunc(<span class="number">-4.1</span>) <span class="comment">// -4</span></div><div class="line"><span class="built_in">Math</span>.trunc(<span class="number">-4.9</span>) <span class="comment">// -4</span></div><div class="line"><span class="built_in">Math</span>.trunc(<span class="number">-0.1234</span>) <span class="comment">// -0</span></div></pre></td></tr></table></figure>
<p>å¯¹äºéæ•°å€¼ï¼Œ<code>Math.trunc</code>å†…éƒ¨ä½¿ç”¨<code>Number</code>æ–¹æ³•å°†å…¶å…ˆè½¬ä¸ºæ•°å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.trunc(<span class="string">'123.456'</span>)</div><div class="line"><span class="comment">// 123</span></div></pre></td></tr></table></figure>
<p>å¯¹äºç©ºå€¼å’Œæ— æ³•æˆªå–æ•´æ•°çš„å€¼ï¼Œè¿”å›NaNã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.trunc(<span class="literal">NaN</span>);      <span class="comment">// NaN</span></div><div class="line"><span class="built_in">Math</span>.trunc(<span class="string">'foo'</span>);    <span class="comment">// NaN</span></div><div class="line"><span class="built_in">Math</span>.trunc();         <span class="comment">// NaN</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.trunc = <span class="built_in">Math</span>.trunc || <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> x &lt; <span class="number">0</span> ? <span class="built_in">Math</span>.ceil(x) : <span class="built_in">Math</span>.floor(x);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="Math-sign"><a href="#Math-sign" class="headerlink" title="Math.sign()"></a>Math.sign()</h3><p><code>Math.sign</code>æ–¹æ³•ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°åˆ°åº•æ˜¯æ­£æ•°ã€è´Ÿæ•°ã€è¿˜æ˜¯é›¶ã€‚</p>
<p>å®ƒä¼šè¿”å›äº”ç§å€¼ã€‚</p>
<ul>
<li>å‚æ•°ä¸ºæ­£æ•°ï¼Œè¿”å›+1ï¼›</li>
<li>å‚æ•°ä¸ºè´Ÿæ•°ï¼Œè¿”å›-1ï¼›</li>
<li>å‚æ•°ä¸º0ï¼Œè¿”å›0ï¼›</li>
<li>å‚æ•°ä¸º-0ï¼Œè¿”å›-0;</li>
<li>å…¶ä»–å€¼ï¼Œè¿”å›NaNã€‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.sign(<span class="number">-5</span>) <span class="comment">// -1</span></div><div class="line"><span class="built_in">Math</span>.sign(<span class="number">5</span>) <span class="comment">// +1</span></div><div class="line"><span class="built_in">Math</span>.sign(<span class="number">0</span>) <span class="comment">// +0</span></div><div class="line"><span class="built_in">Math</span>.sign(<span class="number">-0</span>) <span class="comment">// -0</span></div><div class="line"><span class="built_in">Math</span>.sign(<span class="literal">NaN</span>) <span class="comment">// NaN</span></div><div class="line"><span class="built_in">Math</span>.sign(<span class="string">'foo'</span>); <span class="comment">// NaN</span></div><div class="line"><span class="built_in">Math</span>.sign();      <span class="comment">// NaN</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.sign = <span class="built_in">Math</span>.sign || <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  x = +x; <span class="comment">// convert to a number</span></div><div class="line">  <span class="keyword">if</span> (x === <span class="number">0</span> || <span class="built_in">isNaN</span>(x)) &#123;</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> x &gt; <span class="number">0</span> ? <span class="number">1</span> : <span class="number">-1</span>;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="Math-cbrt"><a href="#Math-cbrt" class="headerlink" title="Math.cbrt()"></a>Math.cbrt()</h3><p><code>Math.cbrt</code>æ–¹æ³•ç”¨äºè®¡ç®—ä¸€ä¸ªæ•°çš„ç«‹æ–¹æ ¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.cbrt(<span class="number">-1</span>) <span class="comment">// -1</span></div><div class="line"><span class="built_in">Math</span>.cbrt(<span class="number">0</span>)  <span class="comment">// 0</span></div><div class="line"><span class="built_in">Math</span>.cbrt(<span class="number">1</span>)  <span class="comment">// 1</span></div><div class="line"><span class="built_in">Math</span>.cbrt(<span class="number">2</span>)  <span class="comment">// 1.2599210498948734</span></div></pre></td></tr></table></figure>
<p>å¯¹äºéæ•°å€¼ï¼Œ<code>Math.cbrt</code>æ–¹æ³•å†…éƒ¨ä¹Ÿæ˜¯å…ˆä½¿ç”¨<code>Number</code>æ–¹æ³•å°†å…¶è½¬ä¸ºæ•°å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.cbrt(<span class="string">'8'</span>) <span class="comment">// 2</span></div><div class="line"><span class="built_in">Math</span>.cbrt(<span class="string">'hello'</span>) <span class="comment">// NaN</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.cbrt = <span class="built_in">Math</span>.cbrt || <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> y = <span class="built_in">Math</span>.pow(<span class="built_in">Math</span>.abs(x), <span class="number">1</span>/<span class="number">3</span>);</div><div class="line">  <span class="keyword">return</span> x &lt; <span class="number">0</span> ? -y : y;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="Math-clz32"><a href="#Math-clz32" class="headerlink" title="Math.clz32()"></a>Math.clz32()</h3><p>JavaScriptçš„æ•´æ•°ä½¿ç”¨32ä½äºŒè¿›åˆ¶å½¢å¼è¡¨ç¤ºï¼Œ<code>Math.clz32</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ•°çš„32ä½æ— ç¬¦å·æ•´æ•°å½¢å¼æœ‰å¤šå°‘ä¸ªå‰å¯¼0ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">0</span>) <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">1</span>) <span class="comment">// 31</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">1000</span>) <span class="comment">// 22</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">0b01000000000000000000000000000000</span>) <span class="comment">// 1</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">0b00100000000000000000000000000000</span>) <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ0çš„äºŒè¿›åˆ¶å½¢å¼å…¨ä¸º0ï¼Œæ‰€ä»¥æœ‰32ä¸ªå‰å¯¼0ï¼›1çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯<code>0b1</code>ï¼Œåªå 1ä½ï¼Œæ‰€ä»¥32ä½ä¹‹ä¸­æœ‰31ä¸ªå‰å¯¼0ï¼›1000çš„äºŒè¿›åˆ¶å½¢å¼æ˜¯<code>0b1111101000</code>ï¼Œä¸€å…±æœ‰10ä½ï¼Œæ‰€ä»¥32ä½ä¹‹ä¸­æœ‰22ä¸ªå‰å¯¼0ã€‚</p>
<p><code>clz32</code>è¿™ä¸ªå‡½æ•°åå°±æ¥è‡ªâ€count leading zero bits in 32-bit binary representations of a numberâ€œï¼ˆè®¡ç®—32ä½æ•´æ•°çš„å‰å¯¼0ï¼‰çš„ç¼©å†™ã€‚</p>
<p>å·¦ç§»è¿ç®—ç¬¦ï¼ˆ<code>&lt;&lt;</code>ï¼‰ä¸<code>Math.clz32</code>æ–¹æ³•ç›´æ¥ç›¸å…³ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">0</span>) <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">1</span>) <span class="comment">// 31</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">1</span> &lt;&lt; <span class="number">1</span>) <span class="comment">// 30</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">1</span> &lt;&lt; <span class="number">2</span>) <span class="comment">// 29</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">1</span> &lt;&lt; <span class="number">29</span>) <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>å¯¹äºå°æ•°ï¼Œ<code>Math.clz32</code>æ–¹æ³•åªè€ƒè™‘æ•´æ•°éƒ¨åˆ†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">3.2</span>) <span class="comment">// 30</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="number">3.9</span>) <span class="comment">// 30</span></div></pre></td></tr></table></figure>
<p>å¯¹äºç©ºå€¼æˆ–å…¶ä»–ç±»å‹çš„å€¼ï¼Œ<code>Math.clz32</code>æ–¹æ³•ä¼šå°†å®ƒä»¬å…ˆè½¬ä¸ºæ•°å€¼ï¼Œç„¶åå†è®¡ç®—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.clz32() <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="literal">NaN</span>) <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="literal">Infinity</span>) <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="literal">null</span>) <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="string">'foo'</span>) <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32([]) <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32(&#123;&#125;) <span class="comment">// 32</span></div><div class="line"><span class="built_in">Math</span>.clz32(<span class="literal">true</span>) <span class="comment">// 31</span></div></pre></td></tr></table></figure>
<h3 id="Math-imul"><a href="#Math-imul" class="headerlink" title="Math.imul()"></a>Math.imul()</h3><p><code>Math.imul</code>æ–¹æ³•è¿”å›ä¸¤ä¸ªæ•°ä»¥32ä½å¸¦ç¬¦å·æ•´æ•°å½¢å¼ç›¸ä¹˜çš„ç»“æœï¼Œè¿”å›çš„ä¹Ÿæ˜¯ä¸€ä¸ª32ä½çš„å¸¦ç¬¦å·æ•´æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.imul(<span class="number">2</span>, <span class="number">4</span>)   <span class="comment">// 8</span></div><div class="line"><span class="built_in">Math</span>.imul(<span class="number">-1</span>, <span class="number">8</span>)  <span class="comment">// -8</span></div><div class="line"><span class="built_in">Math</span>.imul(<span class="number">-2</span>, <span class="number">-2</span>) <span class="comment">// 4</span></div></pre></td></tr></table></figure>
<p>å¦‚æœåªè€ƒè™‘æœ€å32ä½ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code>Math.imul(a, b)</code>ä¸<code>a * b</code>çš„ç»“æœæ˜¯ç›¸åŒçš„ï¼Œå³è¯¥æ–¹æ³•ç­‰åŒäº<code>(a * b)|0</code>çš„æ•ˆæœï¼ˆè¶…è¿‡32ä½çš„éƒ¨åˆ†æº¢å‡ºï¼‰ã€‚ä¹‹æ‰€ä»¥éœ€è¦éƒ¨ç½²è¿™ä¸ªæ–¹æ³•ï¼Œæ˜¯å› ä¸ºJavaScriptæœ‰ç²¾åº¦é™åˆ¶ï¼Œè¶…è¿‡2çš„53æ¬¡æ–¹çš„å€¼æ— æ³•ç²¾ç¡®è¡¨ç¤ºã€‚è¿™å°±æ˜¯è¯´ï¼Œå¯¹äºé‚£äº›å¾ˆå¤§çš„æ•°çš„ä¹˜æ³•ï¼Œä½ä½æ•°å€¼å¾€å¾€éƒ½æ˜¯ä¸ç²¾ç¡®çš„ï¼Œ<code>Math.imul</code>æ–¹æ³•å¯ä»¥è¿”å›æ­£ç¡®çš„ä½ä½æ•°å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(<span class="number">0x7fffffff</span> * <span class="number">0x7fffffff</span>)|<span class="number">0</span> <span class="comment">// 0</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸ªä¹˜æ³•ç®—å¼ï¼Œè¿”å›ç»“æœä¸º0ã€‚ä½†æ˜¯ç”±äºè¿™ä¸¤ä¸ªäºŒè¿›åˆ¶æ•°çš„æœ€ä½ä½éƒ½æ˜¯1ï¼Œæ‰€ä»¥è¿™ä¸ªç»“æœè‚¯å®šæ˜¯ä¸æ­£ç¡®çš„ï¼Œå› ä¸ºæ ¹æ®äºŒè¿›åˆ¶ä¹˜æ³•ï¼Œè®¡ç®—ç»“æœçš„äºŒè¿›åˆ¶æœ€ä½ä½åº”è¯¥ä¹Ÿæ˜¯1ã€‚è¿™ä¸ªé”™è¯¯å°±æ˜¯å› ä¸ºå®ƒä»¬çš„ä¹˜ç§¯è¶…è¿‡äº†2çš„53æ¬¡æ–¹ï¼ŒJavaScriptæ— æ³•ä¿å­˜é¢å¤–çš„ç²¾åº¦ï¼Œå°±æŠŠä½ä½çš„å€¼éƒ½å˜æˆäº†0ã€‚<code>Math.imul</code>æ–¹æ³•å¯ä»¥è¿”å›æ­£ç¡®çš„å€¼1ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.imul(<span class="number">0x7fffffff</span>, <span class="number">0x7fffffff</span>) <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<h3 id="Math-fround"><a href="#Math-fround" class="headerlink" title="Math.fround()"></a>Math.fround()</h3><p>Math.froundæ–¹æ³•è¿”å›ä¸€ä¸ªæ•°çš„å•ç²¾åº¦æµ®ç‚¹æ•°å½¢å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.fround(<span class="number">0</span>)     <span class="comment">// 0</span></div><div class="line"><span class="built_in">Math</span>.fround(<span class="number">1</span>)     <span class="comment">// 1</span></div><div class="line"><span class="built_in">Math</span>.fround(<span class="number">1.337</span>) <span class="comment">// 1.3370000123977661</span></div><div class="line"><span class="built_in">Math</span>.fround(<span class="number">1.5</span>)   <span class="comment">// 1.5</span></div><div class="line"><span class="built_in">Math</span>.fround(<span class="literal">NaN</span>)   <span class="comment">// NaN</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæ•´æ•°æ¥è¯´ï¼Œ<code>Math.fround</code>æ–¹æ³•è¿”å›ç»“æœä¸ä¼šæœ‰ä»»ä½•ä¸åŒï¼ŒåŒºåˆ«ä¸»è¦æ˜¯é‚£äº›æ— æ³•ç”¨64ä¸ªäºŒè¿›åˆ¶ä½ç²¾ç¡®è¡¨ç¤ºçš„å°æ•°ã€‚è¿™æ—¶ï¼Œ<code>Math.fround</code>æ–¹æ³•ä¼šè¿”å›æœ€æ¥è¿‘è¿™ä¸ªå°æ•°çš„å•ç²¾åº¦æµ®ç‚¹æ•°ã€‚</p>
<p>å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.fround = <span class="built_in">Math</span>.fround || <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Float32Array</span>([x])[<span class="number">0</span>];</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="Math-hypot"><a href="#Math-hypot" class="headerlink" title="Math.hypot()"></a>Math.hypot()</h3><p><code>Math.hypot</code>æ–¹æ³•è¿”å›æ‰€æœ‰å‚æ•°çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.hypot(<span class="number">3</span>, <span class="number">4</span>);        <span class="comment">// 5</span></div><div class="line"><span class="built_in">Math</span>.hypot(<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>);     <span class="comment">// 7.0710678118654755</span></div><div class="line"><span class="built_in">Math</span>.hypot();            <span class="comment">// 0</span></div><div class="line"><span class="built_in">Math</span>.hypot(<span class="literal">NaN</span>);         <span class="comment">// NaN</span></div><div class="line"><span class="built_in">Math</span>.hypot(<span class="number">3</span>, <span class="number">4</span>, <span class="string">'foo'</span>); <span class="comment">// NaN</span></div><div class="line"><span class="built_in">Math</span>.hypot(<span class="number">3</span>, <span class="number">4</span>, <span class="string">'5'</span>);   <span class="comment">// 7.0710678118654755</span></div><div class="line"><span class="built_in">Math</span>.hypot(<span class="number">-3</span>);          <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ3çš„å¹³æ–¹åŠ ä¸Š4çš„å¹³æ–¹ï¼Œç­‰äº5çš„å¹³æ–¹ã€‚</p>
<p>å¦‚æœå‚æ•°ä¸æ˜¯æ•°å€¼ï¼Œ<code>Math.hypot</code>æ–¹æ³•ä¼šå°†å…¶è½¬ä¸ºæ•°å€¼ã€‚åªè¦æœ‰ä¸€ä¸ªå‚æ•°æ— æ³•è½¬ä¸ºæ•°å€¼ï¼Œå°±ä¼šè¿”å›NaNã€‚</p>
<h3 id="å¯¹æ•°æ–¹æ³•"><a href="#å¯¹æ•°æ–¹æ³•" class="headerlink" title="å¯¹æ•°æ–¹æ³•"></a>å¯¹æ•°æ–¹æ³•</h3><p>ES6æ–°å¢äº†4ä¸ªå¯¹æ•°ç›¸å…³æ–¹æ³•ã€‚</p>
<p><strong>ï¼ˆ1ï¼‰ Math.expm1()</strong></p>
<p><code>Math.expm1(x)</code>è¿”å›e<sup>x</sup> - 1ï¼Œå³<code>Math.exp(x) - 1</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.expm1(<span class="number">-1</span>) <span class="comment">// -0.6321205588285577</span></div><div class="line"><span class="built_in">Math</span>.expm1(<span class="number">0</span>)  <span class="comment">// 0</span></div><div class="line"><span class="built_in">Math</span>.expm1(<span class="number">1</span>)  <span class="comment">// 1.718281828459045</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.expm1 = <span class="built_in">Math</span>.expm1 || <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.exp(x) - <span class="number">1</span>;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ2ï¼‰Math.log1p()</strong></p>
<p><code>Math.log1p(x)</code>æ–¹æ³•è¿”å›<code>1 + x</code>çš„è‡ªç„¶å¯¹æ•°ï¼Œå³<code>Math.log(1 + x)</code>ã€‚å¦‚æœ<code>x</code>å°äº-1ï¼Œè¿”å›<code>NaN</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.log1p(<span class="number">1</span>)  <span class="comment">// 0.6931471805599453</span></div><div class="line"><span class="built_in">Math</span>.log1p(<span class="number">0</span>)  <span class="comment">// 0</span></div><div class="line"><span class="built_in">Math</span>.log1p(<span class="number">-1</span>) <span class="comment">// -Infinity</span></div><div class="line"><span class="built_in">Math</span>.log1p(<span class="number">-2</span>) <span class="comment">// NaN</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.log1p = <span class="built_in">Math</span>.log1p || <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.log(<span class="number">1</span> + x);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰Math.log10()</strong></p>
<p><code>Math.log10(x)</code>è¿”å›ä»¥10ä¸ºåº•çš„<code>x</code>çš„å¯¹æ•°ã€‚å¦‚æœ<code>x</code>å°äº0ï¼Œåˆ™è¿”å›NaNã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.log10(<span class="number">2</span>)      <span class="comment">// 0.3010299956639812</span></div><div class="line"><span class="built_in">Math</span>.log10(<span class="number">1</span>)      <span class="comment">// 0</span></div><div class="line"><span class="built_in">Math</span>.log10(<span class="number">0</span>)      <span class="comment">// -Infinity</span></div><div class="line"><span class="built_in">Math</span>.log10(<span class="number">-2</span>)     <span class="comment">// NaN</span></div><div class="line"><span class="built_in">Math</span>.log10(<span class="number">100000</span>) <span class="comment">// 5</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.log10 = <span class="built_in">Math</span>.log10 || <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.log(x) / <span class="built_in">Math</span>.LN10;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰Math.log2()</strong></p>
<p><code>Math.log2(x)</code>è¿”å›ä»¥2ä¸ºåº•çš„<code>x</code>çš„å¯¹æ•°ã€‚å¦‚æœ<code>x</code>å°äº0ï¼Œåˆ™è¿”å›NaNã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.log2(<span class="number">3</span>)       <span class="comment">// 1.584962500721156</span></div><div class="line"><span class="built_in">Math</span>.log2(<span class="number">2</span>)       <span class="comment">// 1</span></div><div class="line"><span class="built_in">Math</span>.log2(<span class="number">1</span>)       <span class="comment">// 0</span></div><div class="line"><span class="built_in">Math</span>.log2(<span class="number">0</span>)       <span class="comment">// -Infinity</span></div><div class="line"><span class="built_in">Math</span>.log2(<span class="number">-2</span>)      <span class="comment">// NaN</span></div><div class="line"><span class="built_in">Math</span>.log2(<span class="number">1024</span>)    <span class="comment">// 10</span></div><div class="line"><span class="built_in">Math</span>.log2(<span class="number">1</span> &lt;&lt; <span class="number">29</span>) <span class="comment">// 29</span></div></pre></td></tr></table></figure>
<p>å¯¹äºæ²¡æœ‰éƒ¨ç½²è¿™ä¸ªæ–¹æ³•çš„ç¯å¢ƒï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ä»£ç æ¨¡æ‹Ÿã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Math</span>.log2 = <span class="built_in">Math</span>.log2 || <span class="function"><span class="keyword">function</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Math</span>.log(x) / <span class="built_in">Math</span>.LN2;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="ä¸‰è§’å‡½æ•°æ–¹æ³•"><a href="#ä¸‰è§’å‡½æ•°æ–¹æ³•" class="headerlink" title="ä¸‰è§’å‡½æ•°æ–¹æ³•"></a>ä¸‰è§’å‡½æ•°æ–¹æ³•</h3><p>ES6æ–°å¢äº†6ä¸ªä¸‰è§’å‡½æ•°æ–¹æ³•ã€‚</p>
<ul>
<li><code>Math.sinh(x)</code> è¿”å›<code>x</code>çš„åŒæ›²æ­£å¼¦ï¼ˆhyperbolic sineï¼‰</li>
<li><code>Math.cosh(x)</code> è¿”å›<code>x</code>çš„åŒæ›²ä½™å¼¦ï¼ˆhyperbolic cosineï¼‰</li>
<li><code>Math.tanh(x)</code> è¿”å›<code>x</code>çš„åŒæ›²æ­£åˆ‡ï¼ˆhyperbolic tangentï¼‰</li>
<li><code>Math.asinh(x)</code> è¿”å›<code>x</code>çš„ååŒæ›²æ­£å¼¦ï¼ˆinverse hyperbolic sineï¼‰</li>
<li><code>Math.acosh(x)</code> è¿”å›<code>x</code>çš„ååŒæ›²ä½™å¼¦ï¼ˆinverse hyperbolic cosineï¼‰</li>
<li><code>Math.atanh(x)</code> è¿”å›<code>x</code>çš„ååŒæ›²æ­£åˆ‡ï¼ˆinverse hyperbolic tangentï¼‰</li>
</ul>
<h2 id="æŒ‡æ•°è¿ç®—ç¬¦"><a href="#æŒ‡æ•°è¿ç®—ç¬¦" class="headerlink" title="æŒ‡æ•°è¿ç®—ç¬¦"></a>æŒ‡æ•°è¿ç®—ç¬¦</h2><p>ES7æ–°å¢äº†ä¸€ä¸ªæŒ‡æ•°è¿ç®—ç¬¦ï¼ˆ<code>**</code>ï¼‰ï¼Œç›®å‰Babelè½¬ç å™¨å·²ç»æ”¯æŒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="number">2</span> ** <span class="number">2</span> <span class="comment">// 4</span></div><div class="line"><span class="number">2</span> ** <span class="number">3</span> <span class="comment">// 8</span></div></pre></td></tr></table></figure>
<p>æŒ‡æ•°è¿ç®—ç¬¦å¯ä»¥ä¸ç­‰å·ç»“åˆï¼Œå½¢æˆä¸€ä¸ªæ–°çš„èµ‹å€¼è¿ç®—ç¬¦ï¼ˆ<code>**=</code>ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> a = <span class="number">2</span>;</div><div class="line">a **= <span class="number">2</span>;</div><div class="line"><span class="comment">// ç­‰åŒäº a = a * a;</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="number">3</span>;</div><div class="line">b **= <span class="number">3</span>;</div><div class="line"><span class="comment">// ç­‰åŒäº b = b * b * b;</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;æ•°å€¼çš„æ‰©å±•&quot;&gt;&lt;a href=&quot;#æ•°å€¼çš„æ‰©å±•&quot; class=&quot;headerlink&quot; title=&quot;æ•°å€¼çš„æ‰©å±•&quot;&gt;&lt;/a&gt;æ•°å€¼çš„æ‰©å±•&lt;/h1&gt;&lt;h2 id=&quot;äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•&quot;&gt;&lt;a href=&quot;#äºŒè¿›åˆ¶å’Œå…«è¿›åˆ¶è¡¨ç¤ºæ³•&quot; class=&quot;headerlink&quot; 
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Number" scheme="http://microzz.com/tags/Number/"/>
    
  </entry>
  
  <entry>
    <title>æ­£åˆ™çš„æ‰©å±•(RegExp)</title>
    <link href="http://microzz.com/2016/11/20/regex/"/>
    <id>http://microzz.com/2016/11/20/regex/</id>
    <published>2016-11-20T07:57:19.000Z</published>
    <updated>2017-01-12T07:58:47.546Z</updated>
    
    <content type="html"><![CDATA[<h1 id="æ­£åˆ™çš„æ‰©å±•"><a href="#æ­£åˆ™çš„æ‰©å±•" class="headerlink" title="æ­£åˆ™çš„æ‰©å±•"></a>æ­£åˆ™çš„æ‰©å±•</h1><h2 id="RegExpæ„é€ å‡½æ•°"><a href="#RegExpæ„é€ å‡½æ•°" class="headerlink" title="RegExpæ„é€ å‡½æ•°"></a>RegExpæ„é€ å‡½æ•°</h2><p>åœ¨ES5ä¸­ï¼ŒRegExpæ„é€ å‡½æ•°çš„å‚æ•°æœ‰ä¸¤ç§æƒ…å†µã€‚</p>
<p>ç¬¬ä¸€ç§æƒ…å†µæ˜¯ï¼Œå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œè¿™æ—¶ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼ˆflagï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'xyz'</span>, <span class="string">'i'</span>);</div><div class="line"><span class="comment">// ç­‰ä»·äº</span></div><div class="line"><span class="keyword">var</span> regex = <span class="regexp">/xyz/i</span>;</div></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æƒ…å†µæ˜¯ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™è¡¨ç¤ºå¼ï¼Œè¿™æ—¶ä¼šè¿”å›ä¸€ä¸ªåŸæœ‰æ­£åˆ™è¡¨è¾¾å¼çš„æ‹·è´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/xyz/i</span>);</div><div class="line"><span class="comment">// ç­‰ä»·äº</span></div><div class="line"><span class="keyword">var</span> regex = <span class="regexp">/xyz/i</span>;</div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼ŒES5ä¸å…è®¸æ­¤æ—¶ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ·»åŠ ä¿®é¥°ç¬¦ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/xyz/</span>, <span class="string">'i'</span>);</div><div class="line"><span class="comment">// Uncaught TypeError: Cannot supply flags when constructing one RegExp from another</span></div></pre></td></tr></table></figure>
<p>ES6æ”¹å˜äº†è¿™ç§è¡Œä¸ºã€‚å¦‚æœRegExpæ„é€ å‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ­£åˆ™å¯¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¿®é¥°ç¬¦ã€‚è€Œä¸”ï¼Œè¿”å›çš„æ­£åˆ™è¡¨è¾¾å¼ä¼šå¿½ç•¥åŸæœ‰çš„æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ï¼Œåªä½¿ç”¨æ–°æŒ‡å®šçš„ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="regexp">/abc/ig</span>, <span class="string">'i'</span>).flags</div><div class="line"><span class="comment">// "i"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼ŒåŸæœ‰æ­£åˆ™å¯¹è±¡çš„ä¿®é¥°ç¬¦æ˜¯<code>ig</code>ï¼Œå®ƒä¼šè¢«ç¬¬äºŒä¸ªå‚æ•°<code>i</code>è¦†ç›–ã€‚</p>
<h2 id="å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•"><a href="#å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•" class="headerlink" title="å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•"></a>å­—ç¬¦ä¸²çš„æ­£åˆ™æ–¹æ³•</h2><p>å­—ç¬¦ä¸²å¯¹è±¡å…±æœ‰4ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼š<code>match()</code>ã€<code>replace()</code>ã€<code>search()</code>å’Œ<code>split()</code>ã€‚</p>
<p>ES6å°†è¿™4ä¸ªæ–¹æ³•ï¼Œåœ¨è¯­è¨€å†…éƒ¨å…¨éƒ¨è°ƒç”¨RegExpçš„å®ä¾‹æ–¹æ³•ï¼Œä»è€Œåšåˆ°æ‰€æœ‰ä¸æ­£åˆ™ç›¸å…³çš„æ–¹æ³•ï¼Œå…¨éƒ½å®šä¹‰åœ¨RegExpå¯¹è±¡ä¸Šã€‚</p>
<ul>
<li><code>String.prototype.match</code> è°ƒç”¨ <code>RegExp.prototype[Symbol.match]</code></li>
<li><code>String.prototype.replace</code> è°ƒç”¨ <code>RegExp.prototype[Symbol.replace]</code></li>
<li><code>String.prototype.search</code> è°ƒç”¨ <code>RegExp.prototype[Symbol.search]</code></li>
<li><code>String.prototype.split</code> è°ƒç”¨ <code>RegExp.prototype[Symbol.split]</code></li>
</ul>
<h2 id="uä¿®é¥°ç¬¦"><a href="#uä¿®é¥°ç¬¦" class="headerlink" title="uä¿®é¥°ç¬¦"></a>uä¿®é¥°ç¬¦</h2><p>ES6å¯¹æ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†<code>u</code>ä¿®é¥°ç¬¦ï¼Œå«ä¹‰ä¸ºâ€œUnicodeæ¨¡å¼â€ï¼Œç”¨æ¥æ­£ç¡®å¤„ç†å¤§äº<code>\uFFFF</code>çš„Unicodeå­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¼šæ­£ç¡®å¤„ç†å››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/^\uD83D/u.test(<span class="string">'\uD83D\uDC2A'</span>)</div><div class="line"><span class="comment">// false</span></div><div class="line">/^\uD83D/.test(<span class="string">'\uD83D\uDC2A'</span>)</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>\uD83D\uDC2A</code>æ˜¯ä¸€ä¸ªå››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ï¼Œä»£è¡¨ä¸€ä¸ªå­—ç¬¦ã€‚ä½†æ˜¯ï¼ŒES5ä¸æ”¯æŒå››ä¸ªå­—èŠ‚çš„UTF-16ç¼–ç ï¼Œä¼šå°†å…¶è¯†åˆ«ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ç¬¬äºŒè¡Œä»£ç ç»“æœä¸º<code>true</code>ã€‚åŠ äº†<code>u</code>ä¿®é¥°ç¬¦ä»¥åï¼ŒES6å°±ä¼šè¯†åˆ«å…¶ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç¬¬ä¸€è¡Œä»£ç ç»“æœä¸º<code>false</code>ã€‚</p>
<p>ä¸€æ—¦åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦å·ï¼Œå°±ä¼šä¿®æ”¹ä¸‹é¢è¿™äº›æ­£åˆ™è¡¨è¾¾å¼çš„è¡Œä¸ºã€‚</p>
<p><strong>ï¼ˆ1ï¼‰ç‚¹å­—ç¬¦</strong></p>
<p>ç‚¹ï¼ˆ<code>.</code>ï¼‰å­—ç¬¦åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œå«ä¹‰æ˜¯é™¤äº†æ¢è¡Œç¬¦ä»¥å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚å¯¹äºç ç‚¹å¤§äº<code>0xFFFF</code>çš„Unicodeå­—ç¬¦ï¼Œç‚¹å­—ç¬¦ä¸èƒ½è¯†åˆ«ï¼Œå¿…é¡»åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·'</span>;</div><div class="line"></div><div class="line"><span class="regexp">/^.$/</span>.test(s) <span class="comment">// false</span></div><div class="line">/^.$/u.test(s) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸æ·»åŠ <code>u</code>ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°±ä¼šè®¤ä¸ºå­—ç¬¦ä¸²ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œä»è€ŒåŒ¹é…å¤±è´¥ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰Unicodeå­—ç¬¦è¡¨ç¤ºæ³•</strong></p>
<p>ES6æ–°å¢äº†ä½¿ç”¨å¤§æ‹¬å·è¡¨ç¤ºUnicodeå­—ç¬¦ï¼Œè¿™ç§è¡¨ç¤ºæ³•åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¿…é¡»åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦ï¼Œæ‰èƒ½è¯†åˆ«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">/\u&#123;<span class="number">61</span>&#125;/.test(<span class="string">'a'</span>) <span class="comment">// false</span></div><div class="line">/\u&#123;<span class="number">61</span>&#125;/u.test(<span class="string">'a'</span>) <span class="comment">// true</span></div><div class="line">/\u&#123;<span class="number">20</span>BB7&#125;/u.test(<span class="string">'ğ ®·'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœä¸åŠ <code>u</code>ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ— æ³•è¯†åˆ«<code>\u{61}</code>è¿™ç§è¡¨ç¤ºæ³•ï¼Œåªä¼šè®¤ä¸ºè¿™åŒ¹é…61ä¸ªè¿ç»­çš„<code>u</code>ã€‚</p>
<p><strong>ï¼ˆ3ï¼‰é‡è¯</strong></p>
<p>ä½¿ç”¨<code>u</code>ä¿®é¥°ç¬¦åï¼Œæ‰€æœ‰é‡è¯éƒ½ä¼šæ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº<code>0xFFFF</code>çš„Unicodeå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">/a&#123;<span class="number">2</span>&#125;/.test(<span class="string">'aa'</span>) <span class="comment">// true</span></div><div class="line">/a&#123;<span class="number">2</span>&#125;/u.test(<span class="string">'aa'</span>) <span class="comment">// true</span></div><div class="line">/ğ ®·&#123;<span class="number">2</span>&#125;/.test(<span class="string">'ğ ®·ğ ®·'</span>) <span class="comment">// false</span></div><div class="line">/ğ ®·&#123;<span class="number">2</span>&#125;/u.test(<span class="string">'ğ ®·ğ ®·'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œåªæœ‰åœ¨ä½¿ç”¨<code>u</code>ä¿®é¥°ç¬¦çš„æƒ…å†µä¸‹ï¼ŒUnicodeè¡¨è¾¾å¼å½“ä¸­çš„å¤§æ‹¬å·æ‰ä¼šè¢«æ­£ç¡®è§£è¯»ï¼Œå¦åˆ™ä¼šè¢«è§£è¯»ä¸ºé‡è¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/^\u&#123;<span class="number">3</span>&#125;$/.test(<span class="string">'uuu'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç”±äºæ­£åˆ™è¡¨è¾¾å¼æ²¡æœ‰<code>u</code>ä¿®é¥°ç¬¦ï¼Œæ‰€ä»¥å¤§æ‹¬å·è¢«è§£è¯»ä¸ºé‡è¯ã€‚åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦ï¼Œå°±ä¼šè¢«è§£è¯»ä¸ºUnicodeè¡¨è¾¾å¼ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰é¢„å®šä¹‰æ¨¡å¼</strong></p>
<p><code>u</code>ä¿®é¥°ç¬¦ä¹Ÿå½±å“åˆ°é¢„å®šä¹‰æ¨¡å¼ï¼Œèƒ½å¦æ­£ç¡®è¯†åˆ«ç ç‚¹å¤§äº<code>0xFFFF</code>çš„Unicodeå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/^\S$/.test(<span class="string">'ğ ®·'</span>) <span class="comment">// false</span></div><div class="line">/^\S$/u.test(<span class="string">'ğ ®·'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„<code>\S</code>æ˜¯é¢„å®šä¹‰æ¨¡å¼ï¼ŒåŒ¹é…æ‰€æœ‰ä¸æ˜¯ç©ºæ ¼çš„å­—ç¬¦ã€‚åªæœ‰åŠ äº†<code>u</code>ä¿®é¥°ç¬¦ï¼Œå®ƒæ‰èƒ½æ­£ç¡®åŒ¹é…ç ç‚¹å¤§äº<code>0xFFFF</code>çš„Unicodeå­—ç¬¦ã€‚</p>
<p>åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥å†™å‡ºä¸€ä¸ªæ­£ç¡®è¿”å›å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">codePointLength</span>(<span class="params">text</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> result = text.match(<span class="regexp">/[\s\S]/gu</span>);</div><div class="line">  <span class="keyword">return</span> result ? result.length : <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·ğ ®·'</span>;</div><div class="line"></div><div class="line">s.length <span class="comment">// 4</span></div><div class="line">codePointLength(s) <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ5ï¼‰iä¿®é¥°ç¬¦</strong></p>
<p>æœ‰äº›Unicodeå­—ç¬¦çš„ç¼–ç ä¸åŒï¼Œä½†æ˜¯å­—å‹å¾ˆç›¸è¿‘ï¼Œæ¯”å¦‚ï¼Œ<code>\u004B</code>ä¸<code>\u212A</code>éƒ½æ˜¯å¤§å†™çš„<code>K</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/[a-z]/i.test(<span class="string">'\u212A'</span>) <span class="comment">// false</span></div><div class="line">/[a-z]/iu.test(<span class="string">'\u212A'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œä¸åŠ <code>u</code>ä¿®é¥°ç¬¦ï¼Œå°±æ— æ³•è¯†åˆ«éè§„èŒƒçš„Kå­—ç¬¦ã€‚</p>
<h2 id="y-ä¿®é¥°ç¬¦"><a href="#y-ä¿®é¥°ç¬¦" class="headerlink" title="y ä¿®é¥°ç¬¦"></a>y ä¿®é¥°ç¬¦</h2><p>é™¤äº†<code>u</code>ä¿®é¥°ç¬¦ï¼ŒES6è¿˜ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ·»åŠ äº†<code>y</code>ä¿®é¥°ç¬¦ï¼Œå«åšâ€œç²˜è¿â€ï¼ˆstickyï¼‰ä¿®é¥°ç¬¦ã€‚</p>
<p><code>y</code>ä¿®é¥°ç¬¦çš„ä½œç”¨ä¸<code>g</code>ä¿®é¥°ç¬¦ç±»ä¼¼ï¼Œä¹Ÿæ˜¯å…¨å±€åŒ¹é…ï¼Œåä¸€æ¬¡åŒ¹é…éƒ½ä»ä¸Šä¸€æ¬¡åŒ¹é…æˆåŠŸçš„ä¸‹ä¸€ä¸ªä½ç½®å¼€å§‹ã€‚ä¸åŒä¹‹å¤„åœ¨äºï¼Œ<code>g</code>ä¿®é¥°ç¬¦åªè¦å‰©ä½™ä½ç½®ä¸­å­˜åœ¨åŒ¹é…å°±å¯ï¼Œè€Œ<code>y</code>ä¿®é¥°ç¬¦ç¡®ä¿åŒ¹é…å¿…é¡»ä»å‰©ä½™çš„ç¬¬ä¸€ä¸ªä½ç½®å¼€å§‹ï¼Œè¿™ä¹Ÿå°±æ˜¯â€œç²˜è¿â€çš„æ¶µä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'aaa_aa_a'</span>;</div><div class="line"><span class="keyword">var</span> r1 = <span class="regexp">/a+/g</span>;</div><div class="line"><span class="keyword">var</span> r2 = <span class="regexp">/a+/y</span>;</div><div class="line"></div><div class="line">r1.exec(s) <span class="comment">// ["aaa"]</span></div><div class="line">r2.exec(s) <span class="comment">// ["aaa"]</span></div><div class="line"></div><div class="line">r1.exec(s) <span class="comment">// ["aa"]</span></div><div class="line">r2.exec(s) <span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æœ‰ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œä¸€ä¸ªä½¿ç”¨<code>g</code>ä¿®é¥°ç¬¦ï¼Œå¦ä¸€ä¸ªä½¿ç”¨<code>y</code>ä¿®é¥°ç¬¦ã€‚è¿™ä¸¤ä¸ªæ­£åˆ™è¡¨è¾¾å¼å„æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œä¸¤è€…è¡Œä¸ºç›¸åŒï¼Œå‰©ä½™å­—ç¬¦ä¸²éƒ½æ˜¯<code>_aa_a</code>ã€‚ç”±äº<code>g</code>ä¿®é¥°æ²¡æœ‰ä½ç½®è¦æ±‚ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡æ‰§è¡Œä¼šè¿”å›ç»“æœï¼Œè€Œ<code>y</code>ä¿®é¥°ç¬¦è¦æ±‚åŒ¹é…å¿…é¡»ä»å¤´éƒ¨å¼€å§‹ï¼Œæ‰€ä»¥è¿”å›<code>null</code>ã€‚</p>
<p>å¦‚æœæ”¹ä¸€ä¸‹æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¿è¯æ¯æ¬¡éƒ½èƒ½å¤´éƒ¨åŒ¹é…ï¼Œ<code>y</code>ä¿®é¥°ç¬¦å°±ä¼šè¿”å›ç»“æœäº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'aaa_aa_a'</span>;</div><div class="line"><span class="keyword">var</span> r = <span class="regexp">/a+_/y</span>;</div><div class="line"></div><div class="line">r.exec(s) <span class="comment">// ["aaa_"]</span></div><div class="line">r.exec(s) <span class="comment">// ["aa_"]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ¯æ¬¡åŒ¹é…ï¼Œéƒ½æ˜¯ä»å‰©ä½™å­—ç¬¦ä¸²çš„å¤´éƒ¨å¼€å§‹ã€‚</p>
<p>ä½¿ç”¨<code>lastIndex</code>å±æ€§ï¼Œå¯ä»¥æ›´å¥½åœ°è¯´æ˜<code>y</code>ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> REGEX = <span class="regexp">/a/g</span>;</div><div class="line"></div><div class="line"><span class="comment">// æŒ‡å®šä»2å·ä½ç½®ï¼ˆyï¼‰å¼€å§‹åŒ¹é…</span></div><div class="line">REGEX.lastIndex = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="comment">// åŒ¹é…æˆåŠŸ</span></div><div class="line"><span class="keyword">const</span> match = REGEX.exec(<span class="string">'xaya'</span>);</div><div class="line"></div><div class="line"><span class="comment">// åœ¨3å·ä½ç½®åŒ¹é…æˆåŠŸ</span></div><div class="line">match.index <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="comment">// ä¸‹ä¸€æ¬¡åŒ¹é…ä»4å·ä½å¼€å§‹</span></div><div class="line">REGEX.lastIndex <span class="comment">// 4</span></div><div class="line"></div><div class="line"><span class="comment">// 4å·ä½å¼€å§‹åŒ¹é…å¤±è´¥</span></div><div class="line">REGEX.exec(<span class="string">'xaxa'</span>) <span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>lastIndex</code>å±æ€§æŒ‡å®šæ¯æ¬¡æœç´¢çš„å¼€å§‹ä½ç½®ï¼Œ<code>g</code>ä¿®é¥°ç¬¦ä»è¿™ä¸ªä½ç½®å¼€å§‹å‘åæœç´¢ï¼Œç›´åˆ°å‘ç°åŒ¹é…ä¸ºæ­¢ã€‚</p>
<p><code>y</code>ä¿®é¥°ç¬¦åŒæ ·éµå®ˆ<code>lastIndex</code>å±æ€§ï¼Œä½†æ˜¯è¦æ±‚å¿…é¡»åœ¨<code>lastIndex</code>æŒ‡å®šçš„ä½ç½®å‘ç°åŒ¹é…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> REGEX = <span class="regexp">/a/y</span>;</div><div class="line"></div><div class="line"><span class="comment">// æŒ‡å®šä»2å·ä½ç½®å¼€å§‹åŒ¹é…</span></div><div class="line">REGEX.lastIndex = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="comment">// ä¸æ˜¯ç²˜è¿ï¼ŒåŒ¹é…å¤±è´¥</span></div><div class="line">REGEX.exec(<span class="string">'xaya'</span>) <span class="comment">// null</span></div><div class="line"></div><div class="line"><span class="comment">// æŒ‡å®šä»3å·ä½ç½®å¼€å§‹åŒ¹é…</span></div><div class="line">REGEX.lastIndex = <span class="number">3</span>;</div><div class="line"></div><div class="line"><span class="comment">// 3å·ä½ç½®æ˜¯ç²˜è¿ï¼ŒåŒ¹é…æˆåŠŸ</span></div><div class="line"><span class="keyword">const</span> match = REGEX.exec(<span class="string">'xaxa'</span>);</div><div class="line">match.index <span class="comment">// 3</span></div><div class="line">REGEX.lastIndex <span class="comment">// 4</span></div></pre></td></tr></table></figure>
<p>è¿›ä¸€æ­¥è¯´ï¼Œ<code>y</code>ä¿®é¥°ç¬¦å·éšå«äº†å¤´éƒ¨åŒ¹é…çš„æ ‡å¿—<code>^</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/b/y.exec(<span class="string">'aba'</span>)</div><div class="line"><span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ç”±äºä¸èƒ½ä¿è¯å¤´éƒ¨åŒ¹é…ï¼Œæ‰€ä»¥è¿”å›<code>null</code>ã€‚<code>y</code>ä¿®é¥°ç¬¦çš„è®¾è®¡æœ¬æ„ï¼Œå°±æ˜¯è®©å¤´éƒ¨åŒ¹é…çš„æ ‡å¿—<code>^</code>åœ¨å…¨å±€åŒ¹é…ä¸­éƒ½æœ‰æ•ˆã€‚</p>
<p>åœ¨<code>split</code>æ–¹æ³•ä¸­ä½¿ç”¨<code>y</code>ä¿®é¥°ç¬¦ï¼ŒåŸå­—ç¬¦ä¸²å¿…é¡»ä»¥åˆ†éš”ç¬¦å¼€å¤´ã€‚è¿™ä¹Ÿæ„å‘³ç€ï¼Œåªè¦åŒ¹é…æˆåŠŸï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜è‚¯å®šæ˜¯ç©ºå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ²¡æœ‰æ‰¾åˆ°åŒ¹é…</span></div><div class="line"><span class="string">'x##'</span>.split(<span class="regexp">/#/y</span>)</div><div class="line"><span class="comment">// [ 'x##' ]</span></div><div class="line"></div><div class="line"><span class="comment">// æ‰¾åˆ°ä¸¤ä¸ªåŒ¹é…</span></div><div class="line"><span class="string">'##x'</span>.split(<span class="regexp">/#/y</span>)</div><div class="line"><span class="comment">// [ '', '', 'x' ]</span></div></pre></td></tr></table></figure>
<p>åç»­çš„åˆ†éš”ç¬¦åªæœ‰ç´§è·Ÿå‰é¢çš„åˆ†éš”ç¬¦ï¼Œæ‰ä¼šè¢«è¯†åˆ«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">'#x#'</span>.split(<span class="regexp">/#/y</span>)</div><div class="line"><span class="comment">// [ '', 'x#' ]</span></div><div class="line"></div><div class="line"><span class="string">'##'</span>.split(<span class="regexp">/#/y</span>)</div><div class="line"><span class="comment">// [ '', '', '' ]</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å­—ç¬¦ä¸²å¯¹è±¡çš„<code>replace</code>æ–¹æ³•çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> REGEX = <span class="regexp">/a/gy</span>;</div><div class="line"><span class="string">'aaxa'</span>.replace(REGEX, <span class="string">'-'</span>) <span class="comment">// '--xa'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæœ€åä¸€ä¸ª<code>a</code>å› ä¸ºä¸æ˜¯å‡ºç°ä¸‹ä¸€æ¬¡åŒ¹é…çš„å¤´éƒ¨ï¼Œæ‰€ä»¥ä¸ä¼šè¢«æ›¿æ¢ã€‚</p>
<p>å•å•ä¸€ä¸ª<code>y</code>ä¿®é¥°ç¬¦å¯¹<code>match</code>æ–¹æ³•ï¼Œåªèƒ½è¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…ï¼Œå¿…é¡»ä¸<code>g</code>ä¿®é¥°ç¬¦è”ç”¨ï¼Œæ‰èƒ½è¿”å›æ‰€æœ‰åŒ¹é…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'a1a2a3'</span>.match(<span class="regexp">/a\d/y</span>) <span class="comment">// ["a1"]</span></div><div class="line"><span class="string">'a1a2a3'</span>.match(<span class="regexp">/a\d/gy</span>) <span class="comment">// ["a1", "a2", "a3"]</span></div></pre></td></tr></table></figure>
<p><code>y</code>ä¿®é¥°ç¬¦çš„ä¸€ä¸ªåº”ç”¨ï¼Œæ˜¯ä»å­—ç¬¦ä¸²æå–tokenï¼ˆè¯å…ƒï¼‰ï¼Œ<code>y</code>ä¿®é¥°ç¬¦ç¡®ä¿äº†åŒ¹é…ä¹‹é—´ä¸ä¼šæœ‰æ¼æ‰çš„å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> TOKEN_Y = <span class="regexp">/\s*(\+|[0-9]+)\s*/y</span>;</div><div class="line"><span class="keyword">const</span> TOKEN_G  = <span class="regexp">/\s*(\+|[0-9]+)\s*/g</span>;</div><div class="line"></div><div class="line">tokenize(TOKEN_Y, <span class="string">'3 + 4'</span>)</div><div class="line"><span class="comment">// [ '3', '+', '4' ]</span></div><div class="line">tokenize(TOKEN_G, <span class="string">'3 + 4'</span>)</div><div class="line"><span class="comment">// [ '3', '+', '4' ]</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tokenize</span>(<span class="params">TOKEN_REGEX, str</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> result = [];</div><div class="line">  <span class="keyword">let</span> match;</div><div class="line">  <span class="keyword">while</span> (match = TOKEN_REGEX.exec(str)) &#123;</div><div class="line">    result.push(match[<span class="number">1</span>]);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœå­—ç¬¦ä¸²é‡Œé¢æ²¡æœ‰éæ³•å­—ç¬¦ï¼Œ<code>y</code>ä¿®é¥°ç¬¦ä¸<code>g</code>ä¿®é¥°ç¬¦çš„æå–ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼Œä¸€æ—¦å‡ºç°éæ³•å­—ç¬¦ï¼Œä¸¤è€…çš„è¡Œä¸ºå°±ä¸ä¸€æ ·äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">tokenize(TOKEN_Y, <span class="string">'3x + 4'</span>)</div><div class="line"><span class="comment">// [ '3' ]</span></div><div class="line">tokenize(TOKEN_G, <span class="string">'3x + 4'</span>)</div><div class="line"><span class="comment">// [ '3', '+', '4' ]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>g</code>ä¿®é¥°ç¬¦ä¼šå¿½ç•¥éæ³•å­—ç¬¦ï¼Œè€Œ<code>y</code>ä¿®é¥°ç¬¦ä¸ä¼šï¼Œè¿™æ ·å°±å¾ˆå®¹æ˜“å‘ç°é”™è¯¯ã€‚</p>
<h2 id="stickyå±æ€§"><a href="#stickyå±æ€§" class="headerlink" title="stickyå±æ€§"></a>stickyå±æ€§</h2><p>ä¸<code>y</code>ä¿®é¥°ç¬¦ç›¸åŒ¹é…ï¼ŒES6çš„æ­£åˆ™å¯¹è±¡å¤šäº†<code>sticky</code>å±æ€§ï¼Œè¡¨ç¤ºæ˜¯å¦è®¾ç½®äº†<code>y</code>ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> r = <span class="regexp">/hello\d/y</span>;</div><div class="line">r.sticky <span class="comment">// true</span></div></pre></td></tr></table></figure>
<h2 id="flagså±æ€§"><a href="#flagså±æ€§" class="headerlink" title="flagså±æ€§"></a>flagså±æ€§</h2><p>ES6ä¸ºæ­£åˆ™è¡¨è¾¾å¼æ–°å¢äº†<code>flags</code>å±æ€§ï¼Œä¼šè¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5çš„sourceå±æ€§</span></div><div class="line"><span class="comment">// è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„æ­£æ–‡</span></div><div class="line">/abc/ig.source</div><div class="line"><span class="comment">// "abc"</span></div><div class="line"></div><div class="line"><span class="comment">// ES6çš„flagså±æ€§</span></div><div class="line"><span class="comment">// è¿”å›æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦</span></div><div class="line">/abc/ig.flags</div><div class="line"><span class="comment">// 'gi'</span></div></pre></td></tr></table></figure>
<h2 id="RegExp-escape"><a href="#RegExp-escape" class="headerlink" title="RegExp.escape()"></a>RegExp.escape()</h2><p>å­—ç¬¦ä¸²å¿…é¡»è½¬ä¹‰ï¼Œæ‰èƒ½ä½œä¸ºæ­£åˆ™æ¨¡å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escapeRegExp</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> str.replace(<span class="regexp">/[\-\[\]\/\&#123;\&#125;\(\)\*\+\?\.\\\^\$\|]/g</span>, <span class="string">'\\$&amp;'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> str = <span class="string">'/path/to/resource.html?search=query'</span>;</div><div class="line">escapeRegExp(str)</div><div class="line"><span class="comment">// "\/path\/to\/resource\.html\?search=query"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>str</code>æ˜¯ä¸€ä¸ªæ­£å¸¸å­—ç¬¦ä¸²ï¼Œå¿…é¡»ä½¿ç”¨åæ–œæ å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œæ‰èƒ½ç”¨æ¥ä½œä¸ºä¸€ä¸ªæ­£åˆ™åŒ¹é…çš„æ¨¡å¼ã€‚</p>
<p>å·²ç»æœ‰<a href="https://esdiscuss.org/topic/regexp-escape" target="_blank" rel="external">æè®®</a>å°†è¿™ä¸ªéœ€æ±‚æ ‡å‡†åŒ–ï¼Œä½œä¸ºRegExpå¯¹è±¡çš„é™æ€æ–¹æ³•<a href="https://github.com/benjamingr/RexExp.escape" target="_blank" rel="external">RegExp.escape()</a>ï¼Œæ”¾å…¥ES7ã€‚2015å¹´7æœˆ31æ—¥ï¼ŒTC39è®¤ä¸ºï¼Œè¿™ä¸ªæ–¹æ³•æœ‰å®‰å…¨é£é™©ï¼Œåˆä¸æ„¿è¿™ä¸ªæ–¹æ³•å˜å¾—è¿‡äºå¤æ‚ï¼Œæ²¡æœ‰åŒæ„å°†å…¶åˆ—å…¥ES7ï¼Œä½†è¿™ä¸å¤±ä¸ºä¸€ä¸ªçœŸå®çš„éœ€æ±‚ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">RegExp</span>.escape(<span class="string">'The Quick Brown Fox'</span>);</div><div class="line"><span class="comment">// "The Quick Brown Fox"</span></div><div class="line"></div><div class="line"><span class="built_in">RegExp</span>.escape(<span class="string">'Buy it. use it. break it. fix it.'</span>);</div><div class="line"><span class="comment">// "Buy it\. use it\. break it\. fix it\."</span></div><div class="line"></div><div class="line"><span class="built_in">RegExp</span>.escape(<span class="string">'(*.*)'</span>);</div><div class="line"><span class="comment">// "\(\*\.\*\)"</span></div></pre></td></tr></table></figure>
<p>å­—ç¬¦ä¸²è½¬ä¹‰ä»¥åï¼Œå¯ä»¥ä½¿ç”¨RegExpæ„é€ å‡½æ•°ç”Ÿæˆæ­£åˆ™æ¨¡å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'hello. how are you?'</span>;</div><div class="line"><span class="keyword">var</span> regex = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="built_in">RegExp</span>.escape(str), <span class="string">'g'</span>);</div><div class="line">assert.equal(<span class="built_in">String</span>(regex), <span class="string">'/hello\. how are you\?/g'</span>);</div></pre></td></tr></table></figure>
<p>ç›®å‰ï¼Œè¯¥æ–¹æ³•å¯ä»¥ç”¨ä¸Šæ–‡çš„<code>escapeRegExp</code>å‡½æ•°æˆ–è€…å«ç‰‡æ¨¡å—<a href="https://github.com/ljharb/regexp.escape" target="_blank" rel="external">regexp.escape</a>å®ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="built_in">escape</span> = <span class="built_in">require</span>(<span class="string">'regexp.escape'</span>);</div><div class="line"><span class="built_in">escape</span>(<span class="string">'hi. how are you?'</span>);</div><div class="line"><span class="comment">// "hi\\. how are you\\?"</span></div></pre></td></tr></table></figure>
<h2 id="s-ä¿®é¥°ç¬¦ï¼šdotAll-æ¨¡å¼"><a href="#s-ä¿®é¥°ç¬¦ï¼šdotAll-æ¨¡å¼" class="headerlink" title="s ä¿®é¥°ç¬¦ï¼šdotAll æ¨¡å¼"></a>s ä¿®é¥°ç¬¦ï¼šdotAll æ¨¡å¼</h2><p>æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç‚¹ï¼ˆ<code>.</code>ï¼‰æ˜¯ä¸€ä¸ªç‰¹æ®Šå­—ç¬¦ï¼Œä»£è¡¨ä»»æ„çš„å•ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯è¡Œç»ˆæ­¢ç¬¦ï¼ˆline terminator characterï¼‰é™¤å¤–ã€‚</p>
<p>ä»¥ä¸‹å››ä¸ªå­—ç¬¦å±äºâ€è¡Œç»ˆæ­¢ç¬¦â€œã€‚</p>
<ul>
<li>U+000A æ¢è¡Œç¬¦ï¼ˆ<code>\n</code>ï¼‰</li>
<li>U+000D å›è½¦ç¬¦ï¼ˆ<code>\r</code>ï¼‰</li>
<li>U+2028 è¡Œåˆ†éš”ç¬¦ï¼ˆline separatorï¼‰</li>
<li>U+2029 æ®µåˆ†éš”ç¬¦ï¼ˆparagraph separatorï¼‰</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/foo.bar/.test(<span class="string">'foo\nbar'</span>)</div><div class="line"><span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå› ä¸º<code>.</code>ä¸åŒ¹é…<code>\n</code>ï¼Œæ‰€ä»¥æ­£åˆ™è¡¨è¾¾å¼è¿”å›<code>false</code>ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›åŒ¹é…çš„æ˜¯ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œè¿™æ—¶æœ‰ä¸€ç§å˜é€šçš„å†™æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/foo[^]bar/.test(<span class="string">'foo\nbar'</span>)</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™ç§è§£å†³æ–¹æ¡ˆæ¯•ç«Ÿä¸å¤ªç¬¦åˆç›´è§‰ï¼Œæ‰€ä»¥ç°åœ¨æœ‰ä¸€ä¸ª<a href="https://github.com/mathiasbynens/es-regexp-dotall-flag" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œå¼•å…¥<code>/s</code>ä¿®é¥°ç¬¦ï¼Œä½¿å¾—<code>.</code>å¯ä»¥åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">/foo.bar/s.test(<span class="string">'foo\nbar'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™è¢«ç§°ä¸º<code>dotAll</code>æ¨¡å¼ï¼Œå³ç‚¹ï¼ˆdotï¼‰ä»£è¡¨ä¸€åˆ‡å­—ç¬¦ã€‚æ‰€ä»¥ï¼Œæ­£åˆ™è¡¨è¾¾å¼è¿˜å¼•å…¥äº†ä¸€ä¸ª<code>dotAll</code>å±æ€§ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºè¯¥æ­£åˆ™è¡¨è¾¾å¼æ˜¯å¦å¤„åœ¨<code>dotAll</code>æ¨¡å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> re = <span class="regexp">/foo.bar/</span>s;</div><div class="line"><span class="comment">// å¦ä¸€ç§å†™æ³•</span></div><div class="line"><span class="comment">// const re = new RegExp('foo.bar', 's');</span></div><div class="line"></div><div class="line">re.test(<span class="string">'foo\nbar'</span>) <span class="comment">// true</span></div><div class="line">re.dotAll <span class="comment">// true</span></div><div class="line">re.flags <span class="comment">// 's'</span></div></pre></td></tr></table></figure>
<p><code>/s</code>ä¿®é¥°ç¬¦å’Œå¤šè¡Œä¿®é¥°ç¬¦<code>/m</code>ä¸å†²çªï¼Œä¸¤è€…ä¸€èµ·ä½¿ç”¨çš„æƒ…å†µä¸‹ï¼Œ<code>.</code>åŒ¹é…æ‰€æœ‰å­—ç¬¦ï¼Œè€Œ<code>^</code>å’Œ<code>$</code>åŒ¹é…æ¯ä¸€è¡Œçš„è¡Œé¦–å’Œè¡Œå°¾ã€‚</p>
<h2 id="åè¡Œæ–­è¨€"><a href="#åè¡Œæ–­è¨€" class="headerlink" title="åè¡Œæ–­è¨€"></a>åè¡Œæ–­è¨€</h2><p>JavaScriptè¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªæ”¯æŒå…ˆè¡Œæ–­è¨€ï¼ˆlookaheadï¼‰å’Œå…ˆè¡Œå¦å®šæ–­è¨€ï¼ˆnegative lookaheadï¼‰ï¼Œä¸æ”¯æŒåè¡Œæ–­è¨€ï¼ˆlookbehindï¼‰å’Œåè¡Œå¦å®šæ–­è¨€ï¼ˆnegative lookbehindï¼‰ã€‚</p>
<p>ç›®å‰ï¼Œæœ‰ä¸€ä¸ª<a href="https://github.com/goyakin/es-regexp-lookbehind" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œåœ¨ES7åŠ å…¥åè¡Œæ–­è¨€ã€‚V8å¼•æ“4.9ç‰ˆå·²ç»æ”¯æŒï¼ŒChromeæµè§ˆå™¨49ç‰ˆæ‰“å¼€â€experimental JavaScript featuresâ€œå¼€å…³ï¼ˆåœ°å€æ é”®å…¥<code>about:flags</code>ï¼‰ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿™é¡¹åŠŸèƒ½ã€‚</p>
<p>â€å…ˆè¡Œæ–­è¨€â€œæŒ‡çš„æ˜¯ï¼Œ<code>x</code>åªæœ‰åœ¨<code>y</code>å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ<code>/x(?=y)/</code>ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç™¾åˆ†å·ä¹‹å‰çš„æ•°å­—ï¼Œè¦å†™æˆ<code>/\d+(?=%)/</code>ã€‚â€å…ˆè¡Œå¦å®šæ–­è¨€â€œæŒ‡çš„æ˜¯ï¼Œ<code>x</code>åªæœ‰ä¸åœ¨<code>y</code>å‰é¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ<code>/x(?!y)/</code>ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç™¾åˆ†å·ä¹‹å‰çš„æ•°å­—ï¼Œè¦å†™æˆ<code>/\d+(?!%)/</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/\d+(?=%)/.exec(<span class="string">'100% of US presidents have been male'</span>)  <span class="comment">// ["100"]</span></div><div class="line">/\d+(?!%)/.exec(<span class="string">'thatâ€™s all 44 of them'</span>)                 <span class="comment">// ["44"]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœäº’æ¢æ­£åˆ™è¡¨è¾¾å¼ï¼Œå°±ä¼šåŒ¹é…å¤±è´¥ã€‚å¦å¤–ï¼Œè¿˜å¯ä»¥çœ‹åˆ°ï¼Œâ€å…ˆè¡Œæ–­è¨€â€œæ‹¬å·ä¹‹ä¸­çš„éƒ¨åˆ†ï¼ˆ<code>(?=%)</code>ï¼‰ï¼Œæ˜¯ä¸è®¡å…¥è¿”å›ç»“æœçš„ã€‚</p>
<p>â€œåè¡Œæ–­è¨€â€æ­£å¥½ä¸â€å…ˆè¡Œæ–­è¨€â€ç›¸åï¼Œ<code>x</code>åªæœ‰åœ¨<code>y</code>åé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ<code>/(?&lt;=y)x/</code>ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ç¾å…ƒç¬¦å·ä¹‹åçš„æ•°å­—ï¼Œè¦å†™æˆ<code>/(?&lt;=\$)\d+/</code>ã€‚â€åè¡Œå¦å®šæ–­è¨€â€œåˆ™ä¸â€å…ˆè¡Œå¦å®šæ–­è¨€â€œç›¸åï¼Œ<code>x</code>åªæœ‰ä¸åœ¨<code>y</code>åé¢æ‰åŒ¹é…ï¼Œå¿…é¡»å†™æˆ<code>/(?&lt;!y)x/</code>ã€‚æ¯”å¦‚ï¼ŒåªåŒ¹é…ä¸åœ¨ç¾å…ƒç¬¦å·åé¢çš„æ•°å­—ï¼Œè¦å†™æˆ<code>/(?&lt;!\$)\d+/</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/(?<span class="xml"><span class="tag">&lt;<span class="name">=\$)\d+</span>/<span class="attr">.exec</span>('<span class="attr">Benjamin</span> <span class="attr">Franklin</span> <span class="attr">is</span> <span class="attr">on</span> <span class="attr">the</span> $<span class="attr">100</span> <span class="attr">bill</span>')  // ["<span class="attr">100</span>"]</span></span></div><div class="line">/(?&lt;!\$)\<span class="attr">d</span>+/<span class="attr">.exec</span>('<span class="attr">it</span>â€™<span class="attr">s</span> <span class="attr">is</span> <span class="attr">worth</span> <span class="attr">about</span> â‚¬<span class="attr">90</span>')                // ["<span class="attr">90</span>"]</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œâ€åè¡Œæ–­è¨€â€çš„æ‹¬å·ä¹‹ä¸­çš„éƒ¨åˆ†ï¼ˆ<code>(?&lt;=\$)</code>ï¼‰ï¼Œä¹Ÿæ˜¯ä¸è®¡å…¥è¿”å›ç»“æœã€‚</p>
<p>â€œåè¡Œæ–­è¨€â€çš„å®ç°ï¼Œéœ€è¦å…ˆåŒ¹é…<code>/(?&lt;=y)x/</code>çš„<code>x</code>ï¼Œç„¶åå†å›åˆ°å·¦è¾¹ï¼ŒåŒ¹é…<code>y</code>çš„éƒ¨åˆ†ã€‚è¿™ç§â€å…ˆå³åå·¦â€çš„æ‰§è¡Œé¡ºåºï¼Œä¸æ‰€æœ‰å…¶ä»–æ­£åˆ™æ“ä½œç›¸åï¼Œå¯¼è‡´äº†ä¸€äº›ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚</p>
<p>é¦–å…ˆï¼Œâ€åè¡Œæ–­è¨€â€œçš„ç»„åŒ¹é…ï¼Œä¸æ­£å¸¸æƒ…å†µä¸‹ç»“æœæ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/(?<span class="xml"><span class="tag">&lt;<span class="name">=(\d+)(\d+))$</span>/<span class="attr">.exec</span>('<span class="attr">1053</span>') // ["", "<span class="attr">1</span>", "<span class="attr">053</span>"]</span></span></div><div class="line">/^(\<span class="attr">d</span>+)(\<span class="attr">d</span>+)$/<span class="attr">.exec</span>('<span class="attr">1053</span>') // ["<span class="attr">1053</span>", "<span class="attr">105</span>", "<span class="attr">3</span>"]</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œéœ€è¦æ•æ‰ä¸¤ä¸ªç»„åŒ¹é…ã€‚æ²¡æœ‰â€åè¡Œæ–­è¨€â€æ—¶ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·æ˜¯è´ªå©ªæ¨¡å¼ï¼Œç¬¬äºŒä¸ªæ‹¬å·åªèƒ½æ•è·ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœæ˜¯<code>105</code>å’Œ<code>3</code>ã€‚è€Œâ€åè¡Œæ–­è¨€â€æ—¶ï¼Œç”±äºæ‰§è¡Œé¡ºåºæ˜¯ä»å³åˆ°å·¦ï¼Œç¬¬äºŒä¸ªæ‹¬å·æ˜¯è´ªå©ªæ¨¡å¼ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·åªèƒ½æ•è·ä¸€ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥ç»“æœæ˜¯<code>1</code>å’Œ<code>053</code>ã€‚</p>
<p>å…¶æ¬¡ï¼Œâ€åè¡Œæ–­è¨€â€çš„åæ–œæ å¼•ç”¨ï¼Œä¹Ÿä¸é€šå¸¸çš„é¡ºåºç›¸åï¼Œå¿…é¡»æ”¾åœ¨å¯¹åº”çš„é‚£ä¸ªæ‹¬å·ä¹‹å‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">/(?<span class="xml"><span class="tag">&lt;<span class="name">=(o)d\1)r</span>/<span class="attr">.exec</span>('<span class="attr">hodor</span>')  // <span class="attr">null</span></span></span></div><div class="line">/(?&lt;=<span class="string">\1d(o))r/.exec(</span>'<span class="attr">hodor</span>')  // ["<span class="attr">r</span>", "<span class="attr">o</span>"]</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœåè¡Œæ–­è¨€çš„åæ–œæ å¼•ç”¨ï¼ˆ<code>\1</code>ï¼‰æ”¾åœ¨æ‹¬å·çš„åé¢ï¼Œå°±ä¸ä¼šå¾—åˆ°åŒ¹é…ç»“æœï¼Œå¿…é¡»æ”¾åœ¨å‰é¢æ‰å¯ä»¥ã€‚</p>
<h2 id="Unicodeå±æ€§ç±»"><a href="#Unicodeå±æ€§ç±»" class="headerlink" title="Unicodeå±æ€§ç±»"></a>Unicodeå±æ€§ç±»</h2><p>ç›®å‰ï¼Œæœ‰ä¸€ä¸ª<a href="https://github.com/mathiasbynens/es-regexp-unicode-property-escapes" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œå¼•å…¥äº†ä¸€ç§æ–°çš„ç±»çš„å†™æ³•<code>\p{...}</code>å’Œ<code>\P{...}</code>ï¼Œå…è®¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ç¬¦åˆUnicodeæŸç§å±æ€§çš„æ‰€æœ‰å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> regexGreekSymbol = <span class="regexp">/\p&#123;Script=Greek&#125;/u</span>;</div><div class="line">regexGreekSymbol.test(<span class="string">'Ï€'</span>) <span class="comment">// u</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>\p{Script=Greek}</code>æŒ‡å®šåŒ¹é…ä¸€ä¸ªå¸Œè…Šæ–‡å­—æ¯ï¼Œæ‰€ä»¥åŒ¹é…<code>Ï€</code>æˆåŠŸã€‚</p>
<p>Unicodeå±æ€§ç±»è¦æŒ‡å®šå±æ€§åå’Œå±æ€§å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\p&#123;UnicodePropertyName=UnicodePropertyValue&#125;</div></pre></td></tr></table></figure>
<p>å¯¹äºæŸäº›å±æ€§ï¼Œå¯ä»¥åªå†™å±æ€§åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">\p&#123;UnicodePropertyName&#125;</div></pre></td></tr></table></figure>
<p><code>\P{â€¦}</code>æ˜¯<code>\p{â€¦}</code>çš„åå‘åŒ¹é…ï¼Œå³åŒ¹é…ä¸æ»¡è¶³æ¡ä»¶çš„å­—ç¬¦ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™ä¸¤ç§ç±»åªå¯¹Unicodeæœ‰æ•ˆï¼Œæ‰€ä»¥ä½¿ç”¨çš„æ—¶å€™ä¸€å®šè¦åŠ ä¸Š<code>u</code>ä¿®é¥°ç¬¦ã€‚å¦‚æœä¸åŠ <code>u</code>ä¿®é¥°ç¬¦ï¼Œæ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨<code>\p</code>å’Œ<code>\P</code>ä¼šæŠ¥é”™ï¼ŒECMAScripté¢„ç•™äº†è¿™ä¸¤ä¸ªç±»ã€‚</p>
<p>ç”±äºUnicodeçš„å„ç§å±æ€§éå¸¸å¤šï¼Œæ‰€ä»¥è¿™ç§æ–°çš„ç±»çš„è¡¨è¾¾èƒ½åŠ›éå¸¸å¼ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> regex = <span class="regexp">/^\p&#123;Decimal_Number&#125;+$/u</span>;</div><div class="line">regex.test(<span class="string">'ğŸğŸğŸ‘ğŸœğŸğŸğŸ©ğŸªğŸ«ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸºğŸ»ğŸ¼'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå±æ€§ç±»æŒ‡å®šåŒ¹é…æ‰€æœ‰åè¿›åˆ¶å­—ç¬¦ï¼Œå¯ä»¥çœ‹åˆ°å„ç§å­—å‹çš„åè¿›åˆ¶å­—ç¬¦éƒ½ä¼šåŒ¹é…æˆåŠŸã€‚</p>
<p><code>\p{Number}</code>ç”šè‡³èƒ½åŒ¹é…ç½—é©¬æ•°å­—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åŒ¹é…æ‰€æœ‰æ•°å­—</span></div><div class="line"><span class="keyword">const</span> regex = <span class="regexp">/^\p&#123;Number&#125;+$/u</span>;</div><div class="line">regex.test(<span class="string">'Â²Â³Â¹Â¼Â½Â¾'</span>) <span class="comment">// true</span></div><div class="line">regex.test(<span class="string">'ã‰›ã‰œã‰'</span>) <span class="comment">// true</span></div><div class="line">regex.test(<span class="string">'â… â…¡â…¢â…£â…¤â…¥â…¦â…§â…¨â…©â…ªâ…«'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯å…¶ä»–ä¸€äº›ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰å­—æ¯ï¼Œç­‰åŒäºUnicodeç‰ˆçš„\w</span></div><div class="line">[\p&#123;Alphabetic&#125;\p&#123;Mark&#125;\p&#123;Decimal_Number&#125;\p&#123;Connector_Punctuation&#125;\p&#123;Join_Control&#125;]</div><div class="line"></div><div class="line"><span class="comment">// åŒ¹é…å„ç§æ–‡å­—çš„æ‰€æœ‰éå­—æ¯çš„å­—ç¬¦ï¼Œç­‰åŒäºUnicodeç‰ˆçš„\W</span></div><div class="line">[^\p&#123;Alphabetic&#125;\p&#123;Mark&#125;\p&#123;Decimal_Number&#125;\p&#123;Connector_Punctuation&#125;\p&#123;Join_Control&#125;]</div><div class="line"></div><div class="line"><span class="comment">// åŒ¹é…æ‰€æœ‰çš„ç®­å¤´å­—ç¬¦</span></div><div class="line"><span class="keyword">const</span> regexArrows = <span class="regexp">/^\p&#123;Block=Arrows&#125;+$/u</span>;</div><div class="line">regexArrows.test(<span class="string">'â†â†‘â†’â†“â†”â†•â†–â†—â†˜â†™â‡â‡â‡‘â‡’â‡“â‡”â‡•â‡–â‡—â‡˜â‡™â‡§â‡©'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;æ­£åˆ™çš„æ‰©å±•&quot;&gt;&lt;a href=&quot;#æ­£åˆ™çš„æ‰©å±•&quot; class=&quot;headerlink&quot; title=&quot;æ­£åˆ™çš„æ‰©å±•&quot;&gt;&lt;/a&gt;æ­£åˆ™çš„æ‰©å±•&lt;/h1&gt;&lt;h2 id=&quot;RegExpæ„é€ å‡½æ•°&quot;&gt;&lt;a href=&quot;#RegExpæ„é€ å‡½æ•°&quot; class=&quot;headerlink&quot; 
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="RegExp" scheme="http://microzz.com/tags/RegExp/"/>
    
      <category term="æ­£åˆ™è¡¨è¾¾å¼" scheme="http://microzz.com/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>å­—ç¬¦ä¸²çš„æ‰©å±•</title>
    <link href="http://microzz.com/2016/11/15/string/"/>
    <id>http://microzz.com/2016/11/15/string/</id>
    <published>2016-11-15T07:45:19.000Z</published>
    <updated>2017-01-12T07:49:44.276Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å­—ç¬¦ä¸²çš„æ‰©å±•"><a href="#å­—ç¬¦ä¸²çš„æ‰©å±•" class="headerlink" title="å­—ç¬¦ä¸²çš„æ‰©å±•"></a>å­—ç¬¦ä¸²çš„æ‰©å±•</h1><p>ES6åŠ å¼ºäº†å¯¹Unicodeçš„æ”¯æŒï¼Œå¹¶ä¸”æ‰©å±•äº†å­—ç¬¦ä¸²å¯¹è±¡ã€‚</p>
<h2 id="å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•"><a href="#å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•" class="headerlink" title="å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•"></a>å­—ç¬¦çš„Unicodeè¡¨ç¤ºæ³•</h2><p>JavaScriptå…è®¸é‡‡ç”¨<code>\uxxxx</code>å½¢å¼è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œå…¶ä¸­â€œxxxxâ€è¡¨ç¤ºå­—ç¬¦çš„ç ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">"\u0061"</span></div><div class="line"><span class="comment">// "a"</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œè¿™ç§è¡¨ç¤ºæ³•åªé™äº<code>\u0000</code>â€”â€”<code>\uFFFF</code>ä¹‹é—´çš„å­—ç¬¦ã€‚è¶…å‡ºè¿™ä¸ªèŒƒå›´çš„å­—ç¬¦ï¼Œå¿…é¡»ç”¨ä¸¤ä¸ªåŒå­—èŠ‚çš„å½¢å¼è¡¨è¾¾ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">"\uD842\uDFB7"</span></div><div class="line"><span class="comment">// "ğ ®·"</span></div><div class="line"></div><div class="line"><span class="string">"\u20BB7"</span></div><div class="line"><span class="comment">// " 7"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¦‚æœç›´æ¥åœ¨<code>\u</code>åé¢è·Ÿä¸Šè¶…è¿‡<code>0xFFFF</code>çš„æ•°å€¼ï¼ˆæ¯”å¦‚<code>\u20BB7</code>ï¼‰ï¼ŒJavaScriptä¼šç†è§£æˆ<code>\u20BB+7</code>ã€‚ç”±äº<code>\u20BB</code>æ˜¯ä¸€ä¸ªä¸å¯æ‰“å°å­—ç¬¦ï¼Œæ‰€ä»¥åªä¼šæ˜¾ç¤ºä¸€ä¸ªç©ºæ ¼ï¼Œåé¢è·Ÿç€ä¸€ä¸ª<code>7</code>ã€‚</p>
<p>ES6 å¯¹è¿™ä¸€ç‚¹åšå‡ºäº†æ”¹è¿›ï¼Œåªè¦å°†ç ç‚¹æ”¾å…¥å¤§æ‹¬å·ï¼Œå°±èƒ½æ­£ç¡®è§£è¯»è¯¥å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="string">"\u&#123;20BB7&#125;"</span></div><div class="line"><span class="comment">// "ğ ®·"</span></div><div class="line"></div><div class="line"><span class="string">"\u&#123;41&#125;\u&#123;42&#125;\u&#123;43&#125;"</span></div><div class="line"><span class="comment">// "ABC"</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> hello = <span class="number">123</span>;</div><div class="line">hell\u&#123;<span class="number">6</span>F&#125; <span class="comment">// 123</span></div><div class="line"></div><div class="line"><span class="string">'\u&#123;1F680&#125;'</span> === <span class="string">'\uD83D\uDE80'</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæœ€åä¸€ä¸ªä¾‹å­è¡¨æ˜ï¼Œå¤§æ‹¬å·è¡¨ç¤ºæ³•ä¸å››å­—èŠ‚çš„UTF-16ç¼–ç æ˜¯ç­‰ä»·çš„ã€‚</p>
<p>æœ‰äº†è¿™ç§è¡¨ç¤ºæ³•ä¹‹åï¼ŒJavaScriptå…±æœ‰6ç§æ–¹æ³•å¯ä»¥è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">'\z'</span> === <span class="string">'z'</span>  <span class="comment">// true</span></div><div class="line"><span class="string">'\172'</span> === <span class="string">'z'</span> <span class="comment">// true</span></div><div class="line"><span class="string">'\x7A'</span> === <span class="string">'z'</span> <span class="comment">// true</span></div><div class="line"><span class="string">'\u007A'</span> === <span class="string">'z'</span> <span class="comment">// true</span></div><div class="line"><span class="string">'\u&#123;7A&#125;'</span> === <span class="string">'z'</span> <span class="comment">// true</span></div></pre></td></tr></table></figure>
<h2 id="codePointAt"><a href="#codePointAt" class="headerlink" title="codePointAt()"></a>codePointAt()</h2><p>JavaScriptå†…éƒ¨ï¼Œå­—ç¬¦ä»¥UTF-16çš„æ ¼å¼å‚¨å­˜ï¼Œæ¯ä¸ªå­—ç¬¦å›ºå®šä¸º<code>2</code>ä¸ªå­—èŠ‚ã€‚å¯¹äºé‚£äº›éœ€è¦<code>4</code>ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼ˆUnicodeç ç‚¹å¤§äº<code>0xFFFF</code>çš„å­—ç¬¦ï¼‰ï¼ŒJavaScriptä¼šè®¤ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªå­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">"ğ ®·"</span>;</div><div class="line"></div><div class="line">s.length <span class="comment">// 2</span></div><div class="line">s.charAt(<span class="number">0</span>) <span class="comment">// ''</span></div><div class="line">s.charAt(<span class="number">1</span>) <span class="comment">// ''</span></div><div class="line">s.charCodeAt(<span class="number">0</span>) <span class="comment">// 55362</span></div><div class="line">s.charCodeAt(<span class="number">1</span>) <span class="comment">// 57271</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ±‰å­—â€œğ ®·â€ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ªå­—ä¸æ˜¯â€å‰ç¥¥â€œçš„â€å‰â€œï¼‰çš„ç ç‚¹æ˜¯<code>0x20BB7</code>ï¼ŒUTF-16ç¼–ç ä¸º<code>0xD842 0xDFB7</code>ï¼ˆåè¿›åˆ¶ä¸º<code>55362 57271</code>ï¼‰ï¼Œéœ€è¦<code>4</code>ä¸ªå­—èŠ‚å‚¨å­˜ã€‚å¯¹äºè¿™ç§<code>4</code>ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼ŒJavaScriptä¸èƒ½æ­£ç¡®å¤„ç†ï¼Œå­—ç¬¦ä¸²é•¿åº¦ä¼šè¯¯åˆ¤ä¸º<code>2</code>ï¼Œè€Œä¸”<code>charAt</code>æ–¹æ³•æ— æ³•è¯»å–æ•´ä¸ªå­—ç¬¦ï¼Œ<code>charCodeAt</code>æ–¹æ³•åªèƒ½åˆ†åˆ«è¿”å›å‰ä¸¤ä¸ªå­—èŠ‚å’Œåä¸¤ä¸ªå­—èŠ‚çš„å€¼ã€‚</p>
<p>ES6æä¾›äº†<code>codePointAt</code>æ–¹æ³•ï¼Œèƒ½å¤Ÿæ­£ç¡®å¤„ç†4ä¸ªå­—èŠ‚å‚¨å­˜çš„å­—ç¬¦ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦çš„ç ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·a'</span>;</div><div class="line"></div><div class="line">s.codePointAt(<span class="number">0</span>) <span class="comment">// 134071</span></div><div class="line">s.codePointAt(<span class="number">1</span>) <span class="comment">// 57271</span></div><div class="line"></div><div class="line">s.codePointAt(<span class="number">2</span>) <span class="comment">// 97</span></div></pre></td></tr></table></figure>
<p><code>codePointAt</code>æ–¹æ³•çš„å‚æ•°ï¼Œæ˜¯å­—ç¬¦åœ¨å­—ç¬¦ä¸²ä¸­çš„ä½ç½®ï¼ˆä»0å¼€å§‹ï¼‰ã€‚ä¸Šé¢ä»£ç ä¸­ï¼ŒJavaScriptå°†â€œğ ®·aâ€è§†ä¸ºä¸‰ä¸ªå­—ç¬¦ï¼ŒcodePointAtæ–¹æ³•åœ¨ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸Šï¼Œæ­£ç¡®åœ°è¯†åˆ«äº†â€œğ ®·â€ï¼Œè¿”å›äº†å®ƒçš„åè¿›åˆ¶ç ç‚¹134071ï¼ˆå³åå…­è¿›åˆ¶çš„<code>20BB7</code>ï¼‰ã€‚åœ¨ç¬¬äºŒä¸ªå­—ç¬¦ï¼ˆå³â€œğ ®·â€çš„åä¸¤ä¸ªå­—èŠ‚ï¼‰å’Œç¬¬ä¸‰ä¸ªå­—ç¬¦â€œaâ€ä¸Šï¼Œ<code>codePointAt</code>æ–¹æ³•çš„ç»“æœä¸<code>charCodeAt</code>æ–¹æ³•ç›¸åŒã€‚</p>
<p>æ€»ä¹‹ï¼Œ<code>codePointAt</code>æ–¹æ³•ä¼šæ­£ç¡®è¿”å›32ä½çš„UTF-16å­—ç¬¦çš„ç ç‚¹ã€‚å¯¹äºé‚£äº›ä¸¤ä¸ªå­—èŠ‚å‚¨å­˜çš„å¸¸è§„å­—ç¬¦ï¼Œå®ƒçš„è¿”å›ç»“æœä¸<code>charCodeAt</code>æ–¹æ³•ç›¸åŒã€‚</p>
<p><code>codePointAt</code>æ–¹æ³•è¿”å›çš„æ˜¯ç ç‚¹çš„åè¿›åˆ¶å€¼ï¼Œå¦‚æœæƒ³è¦åå…­è¿›åˆ¶çš„å€¼ï¼Œå¯ä»¥ä½¿ç”¨<code>toString</code>æ–¹æ³•è½¬æ¢ä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·a'</span>;</div><div class="line"></div><div class="line">s.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>) <span class="comment">// "20bb7"</span></div><div class="line">s.codePointAt(<span class="number">2</span>).toString(<span class="number">16</span>) <span class="comment">// "61"</span></div></pre></td></tr></table></figure>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°äº†ï¼Œ<code>codePointAt</code>æ–¹æ³•çš„å‚æ•°ï¼Œä»ç„¶æ˜¯ä¸æ­£ç¡®çš„ã€‚æ¯”å¦‚ï¼Œä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦<code>a</code>åœ¨å­—ç¬¦ä¸²<code>s</code>çš„æ­£ç¡®ä½ç½®åºå·åº”è¯¥æ˜¯1ï¼Œä½†æ˜¯å¿…é¡»å‘<code>codePointAt</code>æ–¹æ³•ä¼ å…¥2ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ä¸ªåŠæ³•æ˜¯ä½¿ç”¨<code>for...of</code>å¾ªç¯ï¼Œå› ä¸ºå®ƒä¼šæ­£ç¡®è¯†åˆ«32ä½çš„UTF-16å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'ğ ®·a'</span>;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> ch <span class="keyword">of</span> s) &#123;</div><div class="line">  <span class="built_in">console</span>.log(ch.codePointAt(<span class="number">0</span>).toString(<span class="number">16</span>));</div><div class="line">&#125;</div><div class="line"><span class="comment">// 20bb7</span></div><div class="line"><span class="comment">// 61</span></div></pre></td></tr></table></figure>
<p><code>codePointAt</code>æ–¹æ³•æ˜¯æµ‹è¯•ä¸€ä¸ªå­—ç¬¦ç”±ä¸¤ä¸ªå­—èŠ‚è¿˜æ˜¯ç”±å››ä¸ªå­—èŠ‚ç»„æˆçš„æœ€ç®€å•æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">is32Bit</span>(<span class="params">c</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> c.codePointAt(<span class="number">0</span>) &gt; <span class="number">0xFFFF</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">is32Bit(<span class="string">"ğ ®·"</span>) <span class="comment">// true</span></div><div class="line">is32Bit(<span class="string">"a"</span>) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<h2 id="String-fromCodePoint"><a href="#String-fromCodePoint" class="headerlink" title="String.fromCodePoint()"></a>String.fromCodePoint()</h2><p>ES5æä¾›<code>String.fromCharCode</code>æ–¹æ³•ï¼Œç”¨äºä»ç ç‚¹è¿”å›å¯¹åº”å­—ç¬¦ï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¸èƒ½è¯†åˆ«32ä½çš„UTF-16å­—ç¬¦ï¼ˆUnicodeç¼–å·å¤§äº<code>0xFFFF</code>ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.fromCharCode(<span class="number">0x20BB7</span>)</div><div class="line"><span class="comment">// "à®·"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>String.fromCharCode</code>ä¸èƒ½è¯†åˆ«å¤§äº<code>0xFFFF</code>çš„ç ç‚¹ï¼Œæ‰€ä»¥<code>0x20BB7</code>å°±å‘ç”Ÿäº†æº¢å‡ºï¼Œæœ€é«˜ä½<code>2</code>è¢«èˆå¼ƒäº†ï¼Œæœ€åè¿”å›ç ç‚¹<code>U+0BB7</code>å¯¹åº”çš„å­—ç¬¦ï¼Œè€Œä¸æ˜¯ç ç‚¹<code>U+20BB7</code>å¯¹åº”çš„å­—ç¬¦ã€‚</p>
<p>ES6æä¾›äº†<code>String.fromCodePoint</code>æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«<code>0xFFFF</code>çš„å­—ç¬¦ï¼Œå¼¥è¡¥äº†<code>String.fromCharCode</code>æ–¹æ³•çš„ä¸è¶³ã€‚åœ¨ä½œç”¨ä¸Šï¼Œæ­£å¥½ä¸<code>codePointAt</code>æ–¹æ³•ç›¸åã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>)</div><div class="line"><span class="comment">// "ğ ®·"</span></div><div class="line"><span class="built_in">String</span>.fromCodePoint(<span class="number">0x78</span>, <span class="number">0x1f680</span>, <span class="number">0x79</span>) === <span class="string">'x\uD83D\uDE80y'</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ<code>String.fromCodePoint</code>æ–¹æ³•æœ‰å¤šä¸ªå‚æ•°ï¼Œåˆ™å®ƒä»¬ä¼šè¢«åˆå¹¶æˆä¸€ä¸ªå­—ç¬¦ä¸²è¿”å›ã€‚</p>
<p>æ³¨æ„ï¼Œ<code>fromCodePoint</code>æ–¹æ³•å®šä¹‰åœ¨<code>String</code>å¯¹è±¡ä¸Šï¼Œè€Œ<code>codePointAt</code>æ–¹æ³•å®šä¹‰åœ¨å­—ç¬¦ä¸²çš„å®ä¾‹å¯¹è±¡ä¸Šã€‚</p>
<h2 id="å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£"><a href="#å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£" class="headerlink" title="å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£"></a>å­—ç¬¦ä¸²çš„éå†å™¨æ¥å£</h2><p>ES6ä¸ºå­—ç¬¦ä¸²æ·»åŠ äº†éå†å™¨æ¥å£ï¼ˆè¯¦è§ã€ŠIteratorã€‹ä¸€ç« ï¼‰ï¼Œä½¿å¾—å­—ç¬¦ä¸²å¯ä»¥è¢«<code>for...of</code>å¾ªç¯éå†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> codePoint <span class="keyword">of</span> <span class="string">'foo'</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(codePoint)</div><div class="line">&#125;</div><div class="line"><span class="comment">// "f"</span></div><div class="line"><span class="comment">// "o"</span></div><div class="line"><span class="comment">// "o"</span></div></pre></td></tr></table></figure>
<p>é™¤äº†éå†å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªéå†å™¨æœ€å¤§çš„ä¼˜ç‚¹æ˜¯å¯ä»¥è¯†åˆ«å¤§äº<code>0xFFFF</code>çš„ç ç‚¹ï¼Œä¼ ç»Ÿçš„<code>for</code>å¾ªç¯æ— æ³•è¯†åˆ«è¿™æ ·çš„ç ç‚¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> text = <span class="built_in">String</span>.fromCodePoint(<span class="number">0x20BB7</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; text.length; i++) &#123;</div><div class="line">  <span class="built_in">console</span>.log(text[i]);</div><div class="line">&#125;</div><div class="line"><span class="comment">// " "</span></div><div class="line"><span class="comment">// " "</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> text) &#123;</div><div class="line">  <span class="built_in">console</span>.log(i);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "ğ ®·"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­—ç¬¦ä¸²<code>text</code>åªæœ‰ä¸€ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯<code>for</code>å¾ªç¯ä¼šè®¤ä¸ºå®ƒåŒ…å«ä¸¤ä¸ªå­—ç¬¦ï¼ˆéƒ½ä¸å¯æ‰“å°ï¼‰ï¼Œè€Œ<code>for...of</code>å¾ªç¯ä¼šæ­£ç¡®è¯†åˆ«å‡ºè¿™ä¸€ä¸ªå­—ç¬¦ã€‚</p>
<h2 id="at"><a href="#at" class="headerlink" title="at()"></a>at()</h2><p>ES5å¯¹å­—ç¬¦ä¸²å¯¹è±¡æä¾›<code>charAt</code>æ–¹æ³•ï¼Œè¿”å›å­—ç¬¦ä¸²ç»™å®šä½ç½®çš„å­—ç¬¦ã€‚è¯¥æ–¹æ³•ä¸èƒ½è¯†åˆ«ç ç‚¹å¤§äº<code>0xFFFF</code>çš„å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'abc'</span>.charAt(<span class="number">0</span>) <span class="comment">// "a"</span></div><div class="line"><span class="string">'ğ ®·'</span>.charAt(<span class="number">0</span>) <span class="comment">// "\uD842"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>charAt</code>æ–¹æ³•è¿”å›çš„æ˜¯UTF-16ç¼–ç çš„ç¬¬ä¸€ä¸ªå­—èŠ‚ï¼Œå®é™…ä¸Šæ˜¯æ— æ³•æ˜¾ç¤ºçš„ã€‚</p>
<p>ç›®å‰ï¼Œæœ‰ä¸€ä¸ªææ¡ˆï¼Œæå‡ºå­—ç¬¦ä¸²å®ä¾‹çš„<code>at</code>æ–¹æ³•ï¼Œå¯ä»¥è¯†åˆ«Unicodeç¼–å·å¤§äº<code>0xFFFF</code>çš„å­—ç¬¦ï¼Œè¿”å›æ­£ç¡®çš„å­—ç¬¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'abc'</span>.at(<span class="number">0</span>) <span class="comment">// "a"</span></div><div class="line"><span class="string">'ğ ®·'</span>.at(<span class="number">0</span>) <span class="comment">// "ğ ®·"</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ–¹æ³•å¯ä»¥é€šè¿‡<a href="https://github.com/es-shims/String.prototype.at" target="_blank" rel="external">å«ç‰‡åº“</a>å®ç°ã€‚</p>
<h2 id="normalize"><a href="#normalize" class="headerlink" title="normalize()"></a>normalize()</h2><p>è®¸å¤šæ¬§æ´²è¯­è¨€æœ‰è¯­è°ƒç¬¦å·å’Œé‡éŸ³ç¬¦å·ã€‚ä¸ºäº†è¡¨ç¤ºå®ƒä»¬ï¼ŒUnicodeæä¾›äº†ä¸¤ç§æ–¹æ³•ã€‚ä¸€ç§æ˜¯ç›´æ¥æä¾›å¸¦é‡éŸ³ç¬¦å·çš„å­—ç¬¦ï¼Œæ¯”å¦‚<code>Ç‘</code>ï¼ˆ\u01D1ï¼‰ã€‚å¦ä¸€ç§æ˜¯æä¾›åˆæˆç¬¦å·ï¼ˆcombining characterï¼‰ï¼Œå³åŸå­—ç¬¦ä¸é‡éŸ³ç¬¦å·çš„åˆæˆï¼Œä¸¤ä¸ªå­—ç¬¦åˆæˆä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚<code>O</code>ï¼ˆ\u004Fï¼‰å’Œ<code>Ë‡</code>ï¼ˆ\u030Cï¼‰åˆæˆ<code>Ç‘</code>ï¼ˆ\u004F\u030Cï¼‰ã€‚</p>
<p>è¿™ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œåœ¨è§†è§‰å’Œè¯­ä¹‰ä¸Šéƒ½ç­‰ä»·ï¼Œä½†æ˜¯JavaScriptä¸èƒ½è¯†åˆ«ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">'\u01D1'</span>===<span class="string">'\u004F\u030C'</span> <span class="comment">//false</span></div><div class="line"></div><div class="line"><span class="string">'\u01D1'</span>.length <span class="comment">// 1</span></div><div class="line"><span class="string">'\u004F\u030C'</span>.length <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼ŒJavaScriptå°†åˆæˆå­—ç¬¦è§†ä¸ºä¸¤ä¸ªå­—ç¬¦ï¼Œå¯¼è‡´ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ä¸ç›¸ç­‰ã€‚</p>
<p>ES6æä¾›å­—ç¬¦ä¸²å®ä¾‹çš„<code>normalize()</code>æ–¹æ³•ï¼Œç”¨æ¥å°†å­—ç¬¦çš„ä¸åŒè¡¨ç¤ºæ–¹æ³•ç»Ÿä¸€ä¸ºåŒæ ·çš„å½¢å¼ï¼Œè¿™ç§°ä¸ºUnicodeæ­£è§„åŒ–ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'\u01D1'</span>.normalize() === <span class="string">'\u004F\u030C'</span>.normalize()</div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p><code>normalize</code>æ–¹æ³•å¯ä»¥æ¥å—ä¸€ä¸ªå‚æ•°æ¥æŒ‡å®š<code>normalize</code>çš„æ–¹å¼ï¼Œå‚æ•°çš„å››ä¸ªå¯é€‰å€¼å¦‚ä¸‹ã€‚</p>
<ul>
<li><code>NFC</code>ï¼Œé»˜è®¤å‚æ•°ï¼Œè¡¨ç¤ºâ€œæ ‡å‡†ç­‰ä»·åˆæˆâ€ï¼ˆNormalization Form Canonical Compositionï¼‰ï¼Œè¿”å›å¤šä¸ªç®€å•å­—ç¬¦çš„åˆæˆå­—ç¬¦ã€‚æ‰€è°“â€œæ ‡å‡†ç­‰ä»·â€æŒ‡çš„æ˜¯è§†è§‰å’Œè¯­ä¹‰ä¸Šçš„ç­‰ä»·ã€‚</li>
<li><code>NFD</code>ï¼Œè¡¨ç¤ºâ€œæ ‡å‡†ç­‰ä»·åˆ†è§£â€ï¼ˆNormalization Form Canonical Decompositionï¼‰ï¼Œå³åœ¨æ ‡å‡†ç­‰ä»·çš„å‰æä¸‹ï¼Œè¿”å›åˆæˆå­—ç¬¦åˆ†è§£çš„å¤šä¸ªç®€å•å­—ç¬¦ã€‚</li>
<li><code>NFKC</code>ï¼Œè¡¨ç¤ºâ€œå…¼å®¹ç­‰ä»·åˆæˆâ€ï¼ˆNormalization Form Compatibility Compositionï¼‰ï¼Œè¿”å›åˆæˆå­—ç¬¦ã€‚æ‰€è°“â€œå…¼å®¹ç­‰ä»·â€æŒ‡çš„æ˜¯è¯­ä¹‰ä¸Šå­˜åœ¨ç­‰ä»·ï¼Œä½†è§†è§‰ä¸Šä¸ç­‰ä»·ï¼Œæ¯”å¦‚â€œå›â€å’Œâ€œå–œå–œâ€ã€‚ï¼ˆè¿™åªæ˜¯ç”¨æ¥ä¸¾ä¾‹ï¼Œ<code>normalize</code>æ–¹æ³•ä¸èƒ½è¯†åˆ«ä¸­æ–‡ã€‚ï¼‰</li>
<li><code>NFKD</code>ï¼Œè¡¨ç¤ºâ€œå…¼å®¹ç­‰ä»·åˆ†è§£â€ï¼ˆNormalization Form Compatibility Decompositionï¼‰ï¼Œå³åœ¨å…¼å®¹ç­‰ä»·çš„å‰æä¸‹ï¼Œè¿”å›åˆæˆå­—ç¬¦åˆ†è§£çš„å¤šä¸ªç®€å•å­—ç¬¦ã€‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'\u004F\u030C'</span>.normalize(<span class="string">'NFC'</span>).length <span class="comment">// 1</span></div><div class="line"><span class="string">'\u004F\u030C'</span>.normalize(<span class="string">'NFD'</span>).length <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œ<code>NFC</code>å‚æ•°è¿”å›å­—ç¬¦çš„åˆæˆå½¢å¼ï¼Œ<code>NFD</code>å‚æ•°è¿”å›å­—ç¬¦çš„åˆ†è§£å½¢å¼ã€‚</p>
<p>ä¸è¿‡ï¼Œ<code>normalize</code>æ–¹æ³•ç›®å‰ä¸èƒ½è¯†åˆ«ä¸‰ä¸ªæˆ–ä¸‰ä¸ªä»¥ä¸Šå­—ç¬¦çš„åˆæˆã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯åªèƒ½ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œé€šè¿‡Unicodeç¼–å·åŒºé—´åˆ¤æ–­ã€‚</p>
<h2 id="includes-startsWith-endsWith"><a href="#includes-startsWith-endsWith" class="headerlink" title="includes(), startsWith(), endsWith()"></a>includes(), startsWith(), endsWith()</h2><p>ä¼ ç»Ÿä¸Šï¼ŒJavaScriptåªæœ‰<code>indexOf</code>æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥ç¡®å®šä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¦åŒ…å«åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ES6åˆæä¾›äº†ä¸‰ç§æ–°æ–¹æ³•ã€‚</p>
<ul>
<li><strong>includes()</strong>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°äº†å‚æ•°å­—ç¬¦ä¸²ã€‚</li>
<li><strong>startsWith()</strong>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨æºå­—ç¬¦ä¸²çš„å¤´éƒ¨ã€‚</li>
<li><strong>endsWith()</strong>ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå‚æ•°å­—ç¬¦ä¸²æ˜¯å¦åœ¨æºå­—ç¬¦ä¸²çš„å°¾éƒ¨ã€‚</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</div><div class="line"></div><div class="line">s.startsWith(<span class="string">'Hello'</span>) <span class="comment">// true</span></div><div class="line">s.endsWith(<span class="string">'!'</span>) <span class="comment">// true</span></div><div class="line">s.includes(<span class="string">'o'</span>) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>è¿™ä¸‰ä¸ªæ–¹æ³•éƒ½æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œè¡¨ç¤ºå¼€å§‹æœç´¢çš„ä½ç½®ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'Hello world!'</span>;</div><div class="line"></div><div class="line">s.startsWith(<span class="string">'world'</span>, <span class="number">6</span>) <span class="comment">// true</span></div><div class="line">s.endsWith(<span class="string">'Hello'</span>, <span class="number">5</span>) <span class="comment">// true</span></div><div class="line">s.includes(<span class="string">'Hello'</span>, <span class="number">6</span>) <span class="comment">// false</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°<code>n</code>æ—¶ï¼Œ<code>endsWith</code>çš„è¡Œä¸ºä¸å…¶ä»–ä¸¤ä¸ªæ–¹æ³•æœ‰æ‰€ä¸åŒã€‚å®ƒé’ˆå¯¹å‰<code>n</code>ä¸ªå­—ç¬¦ï¼Œè€Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•é’ˆå¯¹ä»ç¬¬<code>n</code>ä¸ªä½ç½®ç›´åˆ°å­—ç¬¦ä¸²ç»“æŸã€‚</p>
<h2 id="repeat"><a href="#repeat" class="headerlink" title="repeat()"></a>repeat()</h2><p><code>repeat</code>æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºå°†åŸå­—ç¬¦ä¸²é‡å¤<code>n</code>æ¬¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">'x'</span>.repeat(<span class="number">3</span>) <span class="comment">// "xxx"</span></div><div class="line"><span class="string">'hello'</span>.repeat(<span class="number">2</span>) <span class="comment">// "hellohello"</span></div><div class="line"><span class="string">'na'</span>.repeat(<span class="number">0</span>) <span class="comment">// ""</span></div></pre></td></tr></table></figure>
<p>å‚æ•°å¦‚æœæ˜¯å°æ•°ï¼Œä¼šè¢«å–æ•´ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="number">2.9</span>) <span class="comment">// "nana"</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>repeat</code>çš„å‚æ•°æ˜¯è´Ÿæ•°æˆ–è€…<code>Infinity</code>ï¼Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="literal">Infinity</span>)</div><div class="line"><span class="comment">// RangeError</span></div><div class="line"><span class="string">'na'</span>.repeat(<span class="number">-1</span>)</div><div class="line"><span class="comment">// RangeError</span></div></pre></td></tr></table></figure>
<p>ä½†æ˜¯ï¼Œå¦‚æœå‚æ•°æ˜¯0åˆ°-1ä¹‹é—´çš„å°æ•°ï¼Œåˆ™ç­‰åŒäº0ï¼Œè¿™æ˜¯å› ä¸ºä¼šå…ˆè¿›è¡Œå–æ•´è¿ç®—ã€‚0åˆ°-1ä¹‹é—´çš„å°æ•°ï¼Œå–æ•´ä»¥åç­‰äº<code>-0</code>ï¼Œ<code>repeat</code>è§†åŒä¸º0ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="number">-0.9</span>) <span class="comment">// ""</span></div></pre></td></tr></table></figure>
<p>å‚æ•°<code>NaN</code>ç­‰åŒäº0ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="literal">NaN</span>) <span class="comment">// ""</span></div></pre></td></tr></table></figure>
<p>å¦‚æœ<code>repeat</code>çš„å‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šå…ˆè½¬æ¢æˆæ•°å­—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'na'</span>.repeat(<span class="string">'na'</span>) <span class="comment">// ""</span></div><div class="line"><span class="string">'na'</span>.repeat(<span class="string">'3'</span>) <span class="comment">// "nanana"</span></div></pre></td></tr></table></figure>
<h2 id="padStart-ï¼ŒpadEnd"><a href="#padStart-ï¼ŒpadEnd" class="headerlink" title="padStart()ï¼ŒpadEnd()"></a>padStart()ï¼ŒpadEnd()</h2><p>ES7æ¨å‡ºäº†å­—ç¬¦ä¸²è¡¥å…¨é•¿åº¦çš„åŠŸèƒ½ã€‚å¦‚æœæŸä¸ªå­—ç¬¦ä¸²ä¸å¤ŸæŒ‡å®šé•¿åº¦ï¼Œä¼šåœ¨å¤´éƒ¨æˆ–å°¾éƒ¨è¡¥å…¨ã€‚<code>padStart</code>ç”¨äºå¤´éƒ¨è¡¥å…¨ï¼Œ<code>padEnd</code>ç”¨äºå°¾éƒ¨è¡¥å…¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="string">'x'</span>.padStart(<span class="number">5</span>, <span class="string">'ab'</span>) <span class="comment">// 'ababx'</span></div><div class="line"><span class="string">'x'</span>.padStart(<span class="number">4</span>, <span class="string">'ab'</span>) <span class="comment">// 'abax'</span></div><div class="line"></div><div class="line"><span class="string">'x'</span>.padEnd(<span class="number">5</span>, <span class="string">'ab'</span>) <span class="comment">// 'xabab'</span></div><div class="line"><span class="string">'x'</span>.padEnd(<span class="number">4</span>, <span class="string">'ab'</span>) <span class="comment">// 'xaba'</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>padStart</code>å’Œ<code>padEnd</code>ä¸€å…±æ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ç”¨æ¥æŒ‡å®šå­—ç¬¦ä¸²çš„æœ€å°é•¿åº¦ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ã€‚</p>
<p>å¦‚æœåŸå­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œç­‰äºæˆ–å¤§äºæŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™è¿”å›åŸå­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'xxx'</span>.padStart(<span class="number">2</span>, <span class="string">'ab'</span>) <span class="comment">// 'xxx'</span></div><div class="line"><span class="string">'xxx'</span>.padEnd(<span class="number">2</span>, <span class="string">'ab'</span>) <span class="comment">// 'xxx'</span></div></pre></td></tr></table></figure>
<p>å¦‚æœç”¨æ¥è¡¥å…¨çš„å­—ç¬¦ä¸²ä¸åŸå­—ç¬¦ä¸²ï¼Œä¸¤è€…çš„é•¿åº¦ä¹‹å’Œè¶…è¿‡äº†æŒ‡å®šçš„æœ€å°é•¿åº¦ï¼Œåˆ™ä¼šæˆªå»è¶…å‡ºä½æ•°çš„è¡¥å…¨å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'abc'</span>.padStart(<span class="number">10</span>, <span class="string">'0123456789'</span>)</div><div class="line"><span class="comment">// '0123456abc'</span></div></pre></td></tr></table></figure>
<p>å¦‚æœçœç•¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œåˆ™ä¼šç”¨ç©ºæ ¼è¡¥å…¨é•¿åº¦ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'x'</span>.padStart(<span class="number">4</span>) <span class="comment">// '   x'</span></div><div class="line"><span class="string">'x'</span>.padEnd(<span class="number">4</span>) <span class="comment">// 'x   '</span></div></pre></td></tr></table></figure>
<p><code>padStart</code>çš„å¸¸è§ç”¨é€”æ˜¯ä¸ºæ•°å€¼è¡¥å…¨æŒ‡å®šä½æ•°ã€‚ä¸‹é¢ä»£ç ç”Ÿæˆ10ä½çš„æ•°å€¼å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="string">'1'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000001"</span></div><div class="line"><span class="string">'12'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000000012"</span></div><div class="line"><span class="string">'123456'</span>.padStart(<span class="number">10</span>, <span class="string">'0'</span>) <span class="comment">// "0000123456"</span></div></pre></td></tr></table></figure>
<p>å¦ä¸€ä¸ªç”¨é€”æ˜¯æç¤ºå­—ç¬¦ä¸²æ ¼å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">'12'</span>.padStart(<span class="number">10</span>, <span class="string">'YYYY-MM-DD'</span>) <span class="comment">// "YYYY-MM-12"</span></div><div class="line"><span class="string">'09-12'</span>.padStart(<span class="number">10</span>, <span class="string">'YYYY-MM-DD'</span>) <span class="comment">// "YYYY-09-12"</span></div></pre></td></tr></table></figure>
<h2 id="æ¨¡æ¿å­—ç¬¦ä¸²"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²"></a>æ¨¡æ¿å­—ç¬¦ä¸²</h2><p>ä¼ ç»Ÿçš„JavaScriptè¯­è¨€ï¼Œè¾“å‡ºæ¨¡æ¿é€šå¸¸æ˜¯è¿™æ ·å†™çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#result'</span>).append(</div><div class="line">  <span class="string">'There are &lt;b&gt;'</span> + basket.count + <span class="string">'&lt;/b&gt; '</span> +</div><div class="line">  <span class="string">'items in your basket, '</span> +</div><div class="line">  <span class="string">'&lt;em&gt;'</span> + basket.onSale +</div><div class="line">  <span class="string">'&lt;/em&gt; are on sale!'</span></div><div class="line">);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ç§å†™æ³•ç›¸å½“ç¹çä¸æ–¹ä¾¿ï¼ŒES6å¼•å…¥äº†æ¨¡æ¿å­—ç¬¦ä¸²è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#result'</span>).append(<span class="string">`</span></div><div class="line">  There are &lt;b&gt;<span class="subst">$&#123;basket.count&#125;</span>&lt;/b&gt; items</div><div class="line">   in your basket, &lt;em&gt;<span class="subst">$&#123;basket.onSale&#125;</span>&lt;/em&gt;</div><div class="line">  are on sale!</div><div class="line">`);</div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ï¼ˆtemplate stringï¼‰æ˜¯å¢å¼ºç‰ˆçš„å­—ç¬¦ä¸²ï¼Œç”¨åå¼•å·ï¼ˆ&#96;ï¼‰æ ‡è¯†ã€‚å®ƒå¯ä»¥å½“ä½œæ™®é€šå­—ç¬¦ä¸²ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼Œæˆ–è€…åœ¨å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ™®é€šå­—ç¬¦ä¸²</span></div><div class="line"><span class="string">`In JavaScript '\n' is a line-feed.`</span></div><div class="line"></div><div class="line"><span class="comment">// å¤šè¡Œå­—ç¬¦ä¸²</span></div><div class="line"><span class="string">`In JavaScript this is</span></div><div class="line"> not legal.`</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">`string text line 1</span></div><div class="line">string text line 2`);</div><div class="line"></div><div class="line"><span class="comment">// å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡</span></div><div class="line"><span class="keyword">var</span> name = <span class="string">"Bob"</span>, time = <span class="string">"today"</span>;</div><div class="line"><span class="string">`Hello <span class="subst">$&#123;name&#125;</span>, how are you <span class="subst">$&#123;time&#125;</span>?`</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­çš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œéƒ½æ˜¯ç”¨åå¼•å·è¡¨ç¤ºã€‚å¦‚æœåœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¸­éœ€è¦ä½¿ç”¨åå¼•å·ï¼Œåˆ™å‰é¢è¦ç”¨åæ–œæ è½¬ä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> greeting = <span class="string">`\`Yo\` World!`</span>;</div></pre></td></tr></table></figure>
<p>å¦‚æœä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²è¡¨ç¤ºå¤šè¡Œå­—ç¬¦ä¸²ï¼Œæ‰€æœ‰çš„ç©ºæ ¼å’Œç¼©è¿›éƒ½ä¼šè¢«ä¿ç•™åœ¨è¾“å‡ºä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#list'</span>).html(<span class="string">`</span></div><div class="line">&lt;ul&gt;</div><div class="line">  &lt;li&gt;first&lt;/li&gt;</div><div class="line">  &lt;li&gt;second&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">`);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ‰€æœ‰æ¨¡æ¿å­—ç¬¦ä¸²çš„ç©ºæ ¼å’Œæ¢è¡Œï¼Œéƒ½æ˜¯è¢«ä¿ç•™çš„ï¼Œæ¯”å¦‚<code>&lt;ul&gt;</code>æ ‡ç­¾å‰é¢ä¼šæœ‰ä¸€ä¸ªæ¢è¡Œã€‚å¦‚æœä½ ä¸æƒ³è¦è¿™ä¸ªæ¢è¡Œï¼Œå¯ä»¥ä½¿ç”¨<code>trim</code>æ–¹æ³•æ¶ˆé™¤å®ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">$(<span class="string">'#list'</span>).html(<span class="string">`</span></div><div class="line">&lt;ul&gt;</div><div class="line">  &lt;li&gt;first&lt;/li&gt;</div><div class="line">  &lt;li&gt;second&lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">`.trim());</div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ä¸­åµŒå…¥å˜é‡ï¼Œéœ€è¦å°†å˜é‡åå†™åœ¨<code>${}</code>ä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">authorize</span>(<span class="params">user, action</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (!user.hasPrivilege(action)) &#123;</div><div class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(</div><div class="line">      <span class="comment">// ä¼ ç»Ÿå†™æ³•ä¸º</span></div><div class="line">      <span class="comment">// 'User '</span></div><div class="line">      <span class="comment">// + user.name</span></div><div class="line">      <span class="comment">// + ' is not authorized to do '</span></div><div class="line">      <span class="comment">// + action</span></div><div class="line">      <span class="comment">// + '.'</span></div><div class="line">      <span class="string">`User <span class="subst">$&#123;user.name&#125;</span> is not authorized to do <span class="subst">$&#123;action&#125;</span>.`</span>);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¤§æ‹¬å·å†…éƒ¨å¯ä»¥æ”¾å…¥ä»»æ„çš„JavaScriptè¡¨è¾¾å¼ï¼Œå¯ä»¥è¿›è¡Œè¿ç®—ï¼Œä»¥åŠå¼•ç”¨å¯¹è±¡å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> y = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="string">`<span class="subst">$&#123;x&#125;</span> + <span class="subst">$&#123;y&#125;</span> = <span class="subst">$&#123;x + y&#125;</span>`</span></div><div class="line"><span class="comment">// "1 + 2 = 3"</span></div><div class="line"></div><div class="line"><span class="string">`<span class="subst">$&#123;x&#125;</span> + <span class="subst">$&#123;y * <span class="number">2</span>&#125;</span> = <span class="subst">$&#123;x + y * <span class="number">2</span>&#125;</span>`</span></div><div class="line"><span class="comment">// "1 + 4 = 5"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span>&#125;;</div><div class="line"><span class="string">`<span class="subst">$&#123;obj.x + obj.y&#125;</span>`</span></div><div class="line"><span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ä¹‹ä¸­è¿˜èƒ½è°ƒç”¨å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="string">"Hello World"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="string">`foo <span class="subst">$&#123;fn()&#125;</span> bar`</span></div><div class="line"><span class="comment">// foo Hello World bar</span></div></pre></td></tr></table></figure>
<p>å¦‚æœå¤§æ‹¬å·ä¸­çš„å€¼ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œå°†æŒ‰ç…§ä¸€èˆ¬çš„è§„åˆ™è½¬ä¸ºå­—ç¬¦ä¸²ã€‚æ¯”å¦‚ï¼Œå¤§æ‹¬å·ä¸­æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå°†é»˜è®¤è°ƒç”¨å¯¹è±¡çš„<code>toString</code>æ–¹æ³•ã€‚</p>
<p>å¦‚æœæ¨¡æ¿å­—ç¬¦ä¸²ä¸­çš„å˜é‡æ²¡æœ‰å£°æ˜ï¼Œå°†æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å˜é‡placeæ²¡æœ‰å£°æ˜</span></div><div class="line"><span class="keyword">var</span> msg = <span class="string">`Hello, <span class="subst">$&#123;place&#125;</span>`</span>;</div><div class="line"><span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ç”±äºæ¨¡æ¿å­—ç¬¦ä¸²çš„å¤§æ‹¬å·å†…éƒ¨ï¼Œå°±æ˜¯æ‰§è¡ŒJavaScriptä»£ç ï¼Œå› æ­¤å¦‚æœå¤§æ‹¬å·å†…éƒ¨æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå°†ä¼šåŸæ ·è¾“å‡ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">`Hello <span class="subst">$&#123;<span class="string">'World'</span>&#125;</span>`</span></div><div class="line"><span class="comment">// "Hello World"</span></div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ç”šè‡³è¿˜èƒ½åµŒå¥—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> tmpl = <span class="function"><span class="params">addrs</span> =&gt;</span> <span class="string">`</span></div><div class="line">  &lt;table&gt;</div><div class="line">  <span class="subst">$&#123;addrs.map(addr =&gt; <span class="string">`</span></span></div><div class="line">    &lt;tr&gt;&lt;td&gt;<span class="subst">$&#123;addr.first&#125;</span>&lt;/td&gt;&lt;/tr&gt;</div><div class="line">    &lt;tr&gt;&lt;td&gt;<span class="subst">$&#123;addr.last&#125;</span>&lt;/td&gt;&lt;/tr&gt;</div><div class="line">  `).join(<span class="string">''</span>)&#125;</div><div class="line">  &lt;/table&gt;</div><div class="line">`;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²çš„å˜é‡ä¹‹ä¸­ï¼ŒåˆåµŒå…¥äº†å¦ä¸€ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> data = [</div><div class="line">    &#123; <span class="attr">first</span>: <span class="string">'&lt;Jane&gt;'</span>, <span class="attr">last</span>: <span class="string">'Bond'</span> &#125;,</div><div class="line">    &#123; <span class="attr">first</span>: <span class="string">'Lars'</span>, <span class="attr">last</span>: <span class="string">'&lt;Croft&gt;'</span> &#125;,</div><div class="line">];</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(tmpl(data));</div><div class="line"><span class="comment">// &lt;table&gt;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   &lt;tr&gt;&lt;td&gt;&lt;Jane&gt;&lt;/td&gt;&lt;/tr&gt;</span></div><div class="line"><span class="comment">//   &lt;tr&gt;&lt;td&gt;Bond&lt;/td&gt;&lt;/tr&gt;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//   &lt;tr&gt;&lt;td&gt;Lars&lt;/td&gt;&lt;/tr&gt;</span></div><div class="line"><span class="comment">//   &lt;tr&gt;&lt;td&gt;&lt;Croft&gt;&lt;/td&gt;&lt;/tr&gt;</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">// &lt;/table&gt;</span></div></pre></td></tr></table></figure>
<p>å¦‚æœéœ€è¦å¼•ç”¨æ¨¡æ¿å­—ç¬¦ä¸²æœ¬èº«ï¼Œåœ¨éœ€è¦æ—¶æ‰§è¡Œï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·å†™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å†™æ³•ä¸€</span></div><div class="line"><span class="keyword">let</span> str = <span class="string">'return '</span> + <span class="string">'`Hello $&#123;name&#125;!`'</span>;</div><div class="line"><span class="keyword">let</span> func = <span class="keyword">new</span> <span class="built_in">Function</span>(<span class="string">'name'</span>, str);</div><div class="line">func(<span class="string">'Jack'</span>) <span class="comment">// "Hello Jack!"</span></div><div class="line"></div><div class="line"><span class="comment">// å†™æ³•äºŒ</span></div><div class="line"><span class="keyword">let</span> str = <span class="string">'(name) =&gt; `Hello $&#123;name&#125;!`'</span>;</div><div class="line"><span class="keyword">let</span> func = <span class="built_in">eval</span>.call(<span class="literal">null</span>, str);</div><div class="line">func(<span class="string">'Jack'</span>) <span class="comment">// "Hello Jack!"</span></div></pre></td></tr></table></figure>
<h2 id="å®ä¾‹ï¼šæ¨¡æ¿ç¼–è¯‘"><a href="#å®ä¾‹ï¼šæ¨¡æ¿ç¼–è¯‘" class="headerlink" title="å®ä¾‹ï¼šæ¨¡æ¿ç¼–è¯‘"></a>å®ä¾‹ï¼šæ¨¡æ¿ç¼–è¯‘</h2><p>ä¸‹é¢ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªé€šè¿‡æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œç”Ÿæˆæ­£å¼æ¨¡æ¿çš„å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> template = <span class="string">`</span></div><div class="line">&lt;ul&gt;</div><div class="line">  &lt;% for(var i=0; i &lt; data.supplies.length; i++) &#123; %&gt;</div><div class="line">    &lt;li&gt;&lt;%= data.supplies[i] %&gt;&lt;/li&gt;</div><div class="line">  &lt;% &#125; %&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">`;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨æ¨¡æ¿å­—ç¬¦ä¸²ä¹‹ä¸­ï¼Œæ”¾ç½®äº†ä¸€ä¸ªå¸¸è§„æ¨¡æ¿ã€‚è¯¥æ¨¡æ¿ä½¿ç”¨<code>&lt;%...%&gt;</code>æ”¾ç½®JavaScriptä»£ç ï¼Œä½¿ç”¨<code>&lt;%= ... %&gt;</code>è¾“å‡ºJavaScriptè¡¨è¾¾å¼ã€‚</p>
<p>æ€ä¹ˆç¼–è¯‘è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²å‘¢ï¼Ÿ</p>
<p>ä¸€ç§æ€è·¯æ˜¯å°†å…¶è½¬æ¢ä¸ºJavaScriptè¡¨è¾¾å¼å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">echo(<span class="string">'&lt;ul&gt;'</span>);</div><div class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; data.supplies.length; i++) &#123;</div><div class="line">  echo(<span class="string">'&lt;li&gt;'</span>);</div><div class="line">  echo(data.supplies[i]);</div><div class="line">  echo(<span class="string">'&lt;/li&gt;'</span>);</div><div class="line">&#125;;</div><div class="line">echo(<span class="string">'&lt;/ul&gt;'</span>);</div></pre></td></tr></table></figure>
<p>è¿™ä¸ªè½¬æ¢ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°±è¡Œäº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> evalExpr = <span class="regexp">/&lt;%=(.+?)%&gt;/g</span>;</div><div class="line"><span class="keyword">var</span> expr = <span class="regexp">/&lt;%([\s\S]+?)%&gt;/g</span>;</div><div class="line"></div><div class="line">template = template</div><div class="line">  .replace(evalExpr, <span class="string">'`); \n  echo( $1 ); \n  echo(`'</span>)</div><div class="line">  .replace(expr, <span class="string">'`); \n $1 \n  echo(`'</span>);</div><div class="line"></div><div class="line">template = <span class="string">'echo(`'</span> + template + <span class="string">'`);'</span>;</div></pre></td></tr></table></figure>
<p>ç„¶åï¼Œå°†<code>template</code>å°è£…åœ¨ä¸€ä¸ªå‡½æ•°é‡Œé¢è¿”å›ï¼Œå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> script =</div><div class="line"><span class="string">`(function parse(data)&#123;</span></div><div class="line">  var output = "";</div><div class="line"></div><div class="line">  function echo(html)&#123;</div><div class="line">    output += html;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="subst">$&#123; template &#125;</span></div><div class="line"></div><div class="line">  return output;</div><div class="line">&#125;)`;</div><div class="line"></div><div class="line"><span class="keyword">return</span> script;</div></pre></td></tr></table></figure>
<p>å°†ä¸Šé¢çš„å†…å®¹æ‹¼è£…æˆä¸€ä¸ªæ¨¡æ¿ç¼–è¯‘å‡½æ•°<code>compile</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">compile</span>(<span class="params">template</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> evalExpr = <span class="regexp">/&lt;%=(.+?)%&gt;/g</span>;</div><div class="line">  <span class="keyword">var</span> expr = <span class="regexp">/&lt;%([\s\S]+?)%&gt;/g</span>;</div><div class="line"></div><div class="line">  template = template</div><div class="line">    .replace(evalExpr, <span class="string">'`); \n  echo( $1 ); \n  echo(`'</span>)</div><div class="line">    .replace(expr, <span class="string">'`); \n $1 \n  echo(`'</span>);</div><div class="line"></div><div class="line">  template = <span class="string">'echo(`'</span> + template + <span class="string">'`);'</span>;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> script =</div><div class="line">  <span class="string">`(function parse(data)&#123;</span></div><div class="line">    var output = "";</div><div class="line"></div><div class="line">    function echo(html)&#123;</div><div class="line">      output += html;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="subst">$&#123; template &#125;</span></div><div class="line"></div><div class="line">    return output;</div><div class="line">  &#125;)`;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> script;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>compile</code>å‡½æ•°çš„ç”¨æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> parse = <span class="built_in">eval</span>(compile(template));</div><div class="line">div.innerHTML = parse(&#123; <span class="attr">supplies</span>: [ <span class="string">"broom"</span>, <span class="string">"mop"</span>, <span class="string">"cleaner"</span> ] &#125;);</div><div class="line"><span class="comment">//   &lt;ul&gt;</span></div><div class="line"><span class="comment">//     &lt;li&gt;broom&lt;/li&gt;</span></div><div class="line"><span class="comment">//     &lt;li&gt;mop&lt;/li&gt;</span></div><div class="line"><span class="comment">//     &lt;li&gt;cleaner&lt;/li&gt;</span></div><div class="line"><span class="comment">//   &lt;/ul&gt;</span></div></pre></td></tr></table></figure>
<h2 id="æ ‡ç­¾æ¨¡æ¿"><a href="#æ ‡ç­¾æ¨¡æ¿" class="headerlink" title="æ ‡ç­¾æ¨¡æ¿"></a>æ ‡ç­¾æ¨¡æ¿</h2><p>æ¨¡æ¿å­—ç¬¦ä¸²çš„åŠŸèƒ½ï¼Œä¸ä»…ä»…æ˜¯ä¸Šé¢è¿™äº›ã€‚å®ƒå¯ä»¥ç´§è·Ÿåœ¨ä¸€ä¸ªå‡½æ•°ååé¢ï¼Œè¯¥å‡½æ•°å°†è¢«è°ƒç”¨æ¥å¤„ç†è¿™ä¸ªæ¨¡æ¿å­—ç¬¦ä¸²ã€‚è¿™è¢«ç§°ä¸ºâ€œæ ‡ç­¾æ¨¡æ¿â€åŠŸèƒ½ï¼ˆtagged templateï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">alert<span class="string">`123`</span></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">alert(<span class="number">123</span>)</div></pre></td></tr></table></figure>
<p>æ ‡ç­¾æ¨¡æ¿å…¶å®ä¸æ˜¯æ¨¡æ¿ï¼Œè€Œæ˜¯å‡½æ•°è°ƒç”¨çš„ä¸€ç§ç‰¹æ®Šå½¢å¼ã€‚â€œæ ‡ç­¾â€æŒ‡çš„å°±æ˜¯å‡½æ•°ï¼Œç´§è·Ÿåœ¨åé¢çš„æ¨¡æ¿å­—ç¬¦ä¸²å°±æ˜¯å®ƒçš„å‚æ•°ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ¨¡æ¿å­—ç¬¦é‡Œé¢æœ‰å˜é‡ï¼Œå°±ä¸æ˜¯ç®€å•çš„è°ƒç”¨äº†ï¼Œè€Œæ˜¯ä¼šå°†æ¨¡æ¿å­—ç¬¦ä¸²å…ˆå¤„ç†æˆå¤šä¸ªå‚æ•°ï¼Œå†è°ƒç”¨å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</div><div class="line"><span class="keyword">var</span> b = <span class="number">10</span>;</div><div class="line"></div><div class="line">tag<span class="string">`Hello <span class="subst">$&#123; a + b &#125;</span> world <span class="subst">$&#123; a * b &#125;</span>`</span>;</div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line">tag([<span class="string">'Hello '</span>, <span class="string">' world '</span>, <span class="string">''</span>], <span class="number">15</span>, <span class="number">50</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å‰é¢æœ‰ä¸€ä¸ªæ ‡è¯†å<code>tag</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ã€‚æ•´ä¸ªè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œå°±æ˜¯<code>tag</code>å‡½æ•°å¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²åçš„è¿”å›å€¼ã€‚</p>
<p>å‡½æ•°<code>tag</code>ä¾æ¬¡ä¼šæ¥æ”¶åˆ°å¤šä¸ªå‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">stringArr, value1, value2</span>)</span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">stringArr, ...values</span>)</span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>tag</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„æˆå‘˜æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²ä¸­é‚£äº›æ²¡æœ‰å˜é‡æ›¿æ¢çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå˜é‡æ›¿æ¢åªå‘ç”Ÿåœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ä¸ç¬¬äºŒä¸ªæˆå‘˜ä¹‹é—´ã€ç¬¬äºŒä¸ªæˆå‘˜ä¸ç¬¬ä¸‰ä¸ªæˆå‘˜ä¹‹é—´ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p><code>tag</code>å‡½æ•°çš„å…¶ä»–å‚æ•°ï¼Œéƒ½æ˜¯æ¨¡æ¿å­—ç¬¦ä¸²å„ä¸ªå˜é‡è¢«æ›¿æ¢åçš„å€¼ã€‚ç”±äºæœ¬ä¾‹ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²å«æœ‰ä¸¤ä¸ªå˜é‡ï¼Œå› æ­¤<code>tag</code>ä¼šæ¥å—åˆ°<code>value1</code>å’Œ<code>value2</code>ä¸¤ä¸ªå‚æ•°ã€‚</p>
<p><code>tag</code>å‡½æ•°æ‰€æœ‰å‚æ•°çš„å®é™…å€¼å¦‚ä¸‹ã€‚</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼š<code>[&#39;Hello &#39;, &#39; world &#39;, &#39;&#39;]</code></li>
<li>ç¬¬äºŒä¸ªå‚æ•°: 15</li>
<li>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼š50</li>
</ul>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>tag</code>å‡½æ•°å®é™…ä¸Šä»¥ä¸‹é¢çš„å½¢å¼è°ƒç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tag([<span class="string">'Hello '</span>, <span class="string">' world '</span>, <span class="string">''</span>], <span class="number">15</span>, <span class="number">50</span>)</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥æŒ‰ç…§éœ€è¦ç¼–å†™<code>tag</code>å‡½æ•°çš„ä»£ç ã€‚ä¸‹é¢æ˜¯<code>tag</code>å‡½æ•°çš„ä¸€ç§å†™æ³•ï¼Œä»¥åŠè¿è¡Œç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</div><div class="line"><span class="keyword">var</span> b = <span class="number">10</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">s, v1, v2</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(s[<span class="number">0</span>]);</div><div class="line">  <span class="built_in">console</span>.log(s[<span class="number">1</span>]);</div><div class="line">  <span class="built_in">console</span>.log(s[<span class="number">2</span>]);</div><div class="line">  <span class="built_in">console</span>.log(v1);</div><div class="line">  <span class="built_in">console</span>.log(v2);</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="string">"OK"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">tag<span class="string">`Hello <span class="subst">$&#123; a + b &#125;</span> world <span class="subst">$&#123; a * b&#125;</span>`</span>;</div><div class="line"><span class="comment">// "Hello "</span></div><div class="line"><span class="comment">// " world "</span></div><div class="line"><span class="comment">// ""</span></div><div class="line"><span class="comment">// 15</span></div><div class="line"><span class="comment">// 50</span></div><div class="line"><span class="comment">// "OK"</span></div></pre></td></tr></table></figure>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ›´å¤æ‚çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> total = <span class="number">30</span>;</div><div class="line"><span class="keyword">var</span> msg = passthru<span class="string">`The total is <span class="subst">$&#123;total&#125;</span> (<span class="subst">$&#123;total*<span class="number">1.05</span>&#125;</span> with tax)`</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">passthru</span>(<span class="params">literals</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> result = <span class="string">''</span>;</div><div class="line">  <span class="keyword">var</span> i = <span class="number">0</span>;</div><div class="line"></div><div class="line">  <span class="keyword">while</span> (i &lt; literals.length) &#123;</div><div class="line">    result += literals[i++];</div><div class="line">    <span class="keyword">if</span> (i &lt; <span class="built_in">arguments</span>.length) &#123;</div><div class="line">      result += <span class="built_in">arguments</span>[i];</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"></div><div class="line">msg <span class="comment">// "The total is 30 (31.5 with tax)"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ï¼Œå¦‚ä½•å°†å„ä¸ªå‚æ•°æŒ‰ç…§åŸæ¥çš„ä½ç½®æ‹¼åˆå›å»ã€‚</p>
<p><code>passthru</code>å‡½æ•°é‡‡ç”¨restå‚æ•°çš„å†™æ³•å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">passthru</span>(<span class="params">literals, ...values</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> output = <span class="string">""</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; values.length; index++) &#123;</div><div class="line">    output += literals[index] + values[index];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  output += literals[index]</div><div class="line">  <span class="keyword">return</span> output;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>â€œæ ‡ç­¾æ¨¡æ¿â€çš„ä¸€ä¸ªé‡è¦åº”ç”¨ï¼Œå°±æ˜¯è¿‡æ»¤HTMLå­—ç¬¦ä¸²ï¼Œé˜²æ­¢ç”¨æˆ·è¾“å…¥æ¶æ„å†…å®¹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> message =</div><div class="line">  SaferHTML<span class="string">`&lt;p&gt;<span class="subst">$&#123;sender&#125;</span> has sent you a message.&lt;/p&gt;`</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">SaferHTML</span>(<span class="params">templateData</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> s = templateData[<span class="number">0</span>];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="built_in">arguments</span>.length; i++) &#123;</div><div class="line">    <span class="keyword">var</span> arg = <span class="built_in">String</span>(<span class="built_in">arguments</span>[i]);</div><div class="line"></div><div class="line">    <span class="comment">// Escape special characters in the substitution.</span></div><div class="line">    s += arg.replace(<span class="regexp">/&amp;/g</span>, <span class="string">"&amp;amp;"</span>)</div><div class="line">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">"&amp;lt;"</span>)</div><div class="line">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">"&amp;gt;"</span>);</div><div class="line"></div><div class="line">    <span class="comment">// Don't escape special characters in the template.</span></div><div class="line">    s += templateData[i];</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> s;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>sender</code>å˜é‡å¾€å¾€æ˜¯ç”¨æˆ·æä¾›çš„ï¼Œç»è¿‡<code>SaferHTML</code>å‡½æ•°å¤„ç†ï¼Œé‡Œé¢çš„ç‰¹æ®Šå­—ç¬¦éƒ½ä¼šè¢«è½¬ä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sender = <span class="string">'&lt;script&gt;alert("abc")&lt;/script&gt;'</span>; <span class="comment">// æ¶æ„ä»£ç </span></div><div class="line"><span class="keyword">var</span> message = SaferHTML<span class="string">`&lt;p&gt;<span class="subst">$&#123;sender&#125;</span> has sent you a message.&lt;/p&gt;`</span>;</div><div class="line"></div><div class="line">message</div><div class="line"><span class="comment">// &lt;p&gt;&amp;lt;script&amp;gt;alert("abc")&amp;lt;/script&amp;gt; has sent you a message.&lt;/p&gt;</span></div></pre></td></tr></table></figure>
<p>æ ‡ç­¾æ¨¡æ¿çš„å¦ä¸€ä¸ªåº”ç”¨ï¼Œå°±æ˜¯å¤šè¯­è¨€è½¬æ¢ï¼ˆå›½é™…åŒ–å¤„ç†ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">i18n<span class="string">`Welcome to <span class="subst">$&#123;siteName&#125;</span>, you are visitor number <span class="subst">$&#123;visitorNumber&#125;</span>!`</span></div><div class="line"><span class="comment">// "æ¬¢è¿è®¿é—®xxxï¼Œæ‚¨æ˜¯ç¬¬xxxxä½è®¿é—®è€…ï¼"</span></div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å­—ç¬¦ä¸²æœ¬èº«å¹¶ä¸èƒ½å–ä»£Mustacheä¹‹ç±»çš„æ¨¡æ¿åº“ï¼Œå› ä¸ºæ²¡æœ‰æ¡ä»¶åˆ¤æ–­å’Œå¾ªç¯å¤„ç†åŠŸèƒ½ï¼Œä½†æ˜¯é€šè¿‡æ ‡ç­¾å‡½æ•°ï¼Œä½ å¯ä»¥è‡ªå·±æ·»åŠ è¿™äº›åŠŸèƒ½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¸‹é¢çš„hashTemplateå‡½æ•°</span></div><div class="line"><span class="comment">// æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„æ¨¡æ¿å¤„ç†å‡½æ•°</span></div><div class="line"><span class="keyword">var</span> libraryHtml = hashTemplate<span class="string">`</span></div><div class="line">  &lt;ul&gt;</div><div class="line">    #for book in <span class="subst">$&#123;myBooks&#125;</span></div><div class="line">      &lt;li&gt;&lt;i&gt;#&#123;book.title&#125;&lt;/i&gt; by #&#123;book.author&#125;&lt;/li&gt;</div><div class="line">    #end</div><div class="line">  &lt;/ul&gt;</div><div class="line">`;</div></pre></td></tr></table></figure>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨æ ‡ç­¾æ¨¡æ¿ï¼Œåœ¨JavaScriptè¯­è¨€ä¹‹ä¸­åµŒå…¥å…¶ä»–è¯­è¨€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">jsx<span class="string">`</span></div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;input</div><div class="line">      ref='input'</div><div class="line">      onChange='<span class="subst">$&#123;<span class="keyword">this</span>.handleChange&#125;</span>'</div><div class="line">      defaultValue='<span class="subst">$&#123;<span class="keyword">this</span>.state.value&#125;</span>' /&gt;</div><div class="line">      <span class="subst">$&#123;<span class="keyword">this</span>.state.value&#125;</span></div><div class="line">   &lt;/div&gt;</div><div class="line">`</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç é€šè¿‡<code>jsx</code>å‡½æ•°ï¼Œå°†ä¸€ä¸ªDOMå­—ç¬¦ä¸²è½¬ä¸ºReactå¯¹è±¡ã€‚ä½ å¯ä»¥åœ¨Githubæ‰¾åˆ°<code>jsx</code>å‡½æ•°çš„<a href="https://gist.github.com/lygaret/a68220defa69174bdec5" target="_blank" rel="external">å…·ä½“å®ç°</a>ã€‚</p>
<p>ä¸‹é¢åˆ™æ˜¯ä¸€ä¸ªå‡æƒ³çš„ä¾‹å­ï¼Œé€šè¿‡<code>java</code>å‡½æ•°ï¼Œåœ¨JavaScriptä»£ç ä¹‹ä¸­è¿è¡ŒJavaä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">java<span class="string">`</span></div><div class="line">class HelloWorldApp &#123;</div><div class="line">  public static void main(String[] args) &#123;</div><div class="line">    System.out.println(â€œHello World!â€); // Display the string.</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">`</div><div class="line">HelloWorldApp.main();</div></pre></td></tr></table></figure>
<p>æ¨¡æ¿å¤„ç†å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆæ¨¡æ¿å­—ç¬¦ä¸²æ•°ç»„ï¼‰ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>raw</code>å±æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">console</span>.log<span class="string">`123`</span></div><div class="line"><span class="comment">// ["123", raw: Array[1]]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>console.log</code>æ¥å—çš„å‚æ•°ï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ•°ç»„æœ‰ä¸€ä¸ª<code>raw</code>å±æ€§ï¼Œä¿å­˜çš„æ˜¯è½¬ä¹‰åçš„åŸå­—ç¬¦ä¸²ã€‚</p>
<p>è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">tag<span class="string">`First line\nSecond line`</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">strings</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(strings.raw[<span class="number">0</span>]);</div><div class="line">  <span class="comment">// "First line\\nSecond line"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>tag</code>å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°<code>strings</code>ï¼Œæœ‰ä¸€ä¸ª<code>raw</code>å±æ€§ï¼Œä¹ŸæŒ‡å‘ä¸€ä¸ªæ•°ç»„ã€‚è¯¥æ•°ç»„çš„æˆå‘˜ä¸<code>strings</code>æ•°ç»„å®Œå…¨ä¸€è‡´ã€‚æ¯”å¦‚ï¼Œ<code>strings</code>æ•°ç»„æ˜¯<code>[&quot;First line\nSecond line&quot;]</code>ï¼Œé‚£ä¹ˆ<code>strings.raw</code>æ•°ç»„å°±æ˜¯<code>[&quot;First line\\nSecond line&quot;]</code>ã€‚ä¸¤è€…å”¯ä¸€çš„åŒºåˆ«ï¼Œå°±æ˜¯å­—ç¬¦ä¸²é‡Œé¢çš„æ–œæ éƒ½è¢«è½¬ä¹‰äº†ã€‚æ¯”å¦‚ï¼Œstrings.rawæ•°ç»„ä¼šå°†<code>\n</code>è§†ä¸º<code>\\</code>å’Œ<code>n</code>ä¸¤ä¸ªå­—ç¬¦ï¼Œè€Œä¸æ˜¯æ¢è¡Œç¬¦ã€‚è¿™æ˜¯ä¸ºäº†æ–¹ä¾¿å–å¾—è½¬ä¹‰ä¹‹å‰çš„åŸå§‹æ¨¡æ¿è€Œè®¾è®¡çš„ã€‚</p>
<h2 id="String-raw"><a href="#String-raw" class="headerlink" title="String.raw()"></a>String.raw()</h2><p>ES6è¿˜ä¸ºåŸç”Ÿçš„Stringå¯¹è±¡ï¼Œæä¾›äº†ä¸€ä¸ª<code>raw</code>æ–¹æ³•ã€‚</p>
<p><code>String.raw</code>æ–¹æ³•ï¼Œå¾€å¾€ç”¨æ¥å……å½“æ¨¡æ¿å­—ç¬¦ä¸²çš„å¤„ç†å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªæ–œæ éƒ½è¢«è½¬ä¹‰ï¼ˆå³æ–œæ å‰é¢å†åŠ ä¸€ä¸ªæ–œæ ï¼‰çš„å­—ç¬¦ä¸²ï¼Œå¯¹åº”äºæ›¿æ¢å˜é‡åçš„æ¨¡æ¿å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.raw<span class="string">`Hi\n<span class="subst">$&#123;<span class="number">2</span>+<span class="number">3</span>&#125;</span>!`</span>;</div><div class="line"><span class="comment">// "Hi\\n5!"</span></div><div class="line"></div><div class="line"><span class="built_in">String</span>.raw<span class="string">`Hi\u000A!`</span>;</div><div class="line"><span class="comment">// 'Hi\\u000A!'</span></div></pre></td></tr></table></figure>
<p>å¦‚æœåŸå­—ç¬¦ä¸²çš„æ–œæ å·²ç»è½¬ä¹‰ï¼Œé‚£ä¹ˆ<code>String.raw</code>ä¸ä¼šåšä»»ä½•å¤„ç†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.raw<span class="string">`Hi\\n`</span></div><div class="line"><span class="comment">// "Hi\\n"</span></div></pre></td></tr></table></figure>
<p><code>String.raw</code>çš„ä»£ç åŸºæœ¬å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.raw = <span class="function"><span class="keyword">function</span> (<span class="params">strings, ...values</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> output = <span class="string">""</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> index = <span class="number">0</span>; index &lt; values.length; index++) &#123;</div><div class="line">    output += strings.raw[index] + values[index];</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  output += strings.raw[index]</div><div class="line">  <span class="keyword">return</span> output;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>String.raw</code>æ–¹æ³•å¯ä»¥ä½œä¸ºå¤„ç†æ¨¡æ¿å­—ç¬¦ä¸²çš„åŸºæœ¬æ–¹æ³•ï¼Œå®ƒä¼šå°†æ‰€æœ‰å˜é‡æ›¿æ¢ï¼Œè€Œä¸”å¯¹æ–œæ è¿›è¡Œè½¬ä¹‰ï¼Œæ–¹ä¾¿ä¸‹ä¸€æ­¥ä½œä¸ºå­—ç¬¦ä¸²æ¥ä½¿ç”¨ã€‚</p>
<p><code>String.raw</code>æ–¹æ³•ä¹Ÿå¯ä»¥ä½œä¸ºæ­£å¸¸çš„å‡½æ•°ä½¿ç”¨ã€‚è¿™æ—¶ï¼Œå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªå…·æœ‰<code>raw</code>å±æ€§çš„å¯¹è±¡ï¼Œä¸”<code>raw</code>å±æ€§çš„å€¼åº”è¯¥æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.raw(&#123; <span class="attr">raw</span>: <span class="string">'test'</span> &#125;, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</div><div class="line"><span class="comment">// 't0e1s2t'</span></div><div class="line"></div><div class="line"><span class="comment">// ç­‰åŒäº</span></div><div class="line"><span class="built_in">String</span>.raw(&#123; <span class="attr">raw</span>: [<span class="string">'t'</span>,<span class="string">'e'</span>,<span class="string">'s'</span>,<span class="string">'t'</span>] &#125;, <span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>);</div></pre></td></tr></table></figure>
<h2 id="æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶"><a href="#æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶" class="headerlink" title="æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶"></a>æ¨¡æ¿å­—ç¬¦ä¸²çš„é™åˆ¶</h2><p>å‰é¢æåˆ°æ ‡ç­¾æ¨¡æ¿é‡Œé¢ï¼Œå¯ä»¥å†…åµŒå…¶ä»–è¯­è¨€ã€‚ä½†æ˜¯ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²é»˜è®¤ä¼šå°†å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå› æ­¤å¯¼è‡´äº†æ— æ³•åµŒå…¥å…¶ä»–è¯­è¨€ã€‚</p>
<p>ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨æ ‡ç­¾æ¨¡æ¿é‡Œé¢å¯ä»¥åµŒå…¥Latexè¯­è¨€ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">latex</span>(<span class="params">strings</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> <span class="built_in">document</span> = latex<span class="string">`</span></div><div class="line">\newcommand&#123;\fun&#125;&#123;\textbf&#123;Fun!&#125;&#125;  // æ­£å¸¸å·¥ä½œ</div><div class="line">\newcommand&#123;\unicode&#125;&#123;\textbf&#123;Unicode!&#125;&#125; // æŠ¥é”™</div><div class="line">\newcommand&#123;\xerxes&#125;&#123;\textbf&#123;King!&#125;&#125; // æŠ¥é”™</div><div class="line"></div><div class="line">Breve over the h goes \u&#123;h&#125;ere // æŠ¥é”™</div><div class="line">`</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>document</code>å†…åµŒçš„æ¨¡æ¿å­—ç¬¦ä¸²ï¼Œå¯¹äºLatexè¯­è¨€æ¥è¯´å®Œå…¨æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯JavaScriptå¼•æ“ä¼šæŠ¥é”™ã€‚åŸå› å°±åœ¨äºå­—ç¬¦ä¸²çš„è½¬ä¹‰ã€‚</p>
<p>æ¨¡æ¿å­—ç¬¦ä¸²ä¼šå°†<code>\u00FF</code>å’Œ<code>\u{42}</code>å½“ä½œUnicodeå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œæ‰€ä»¥<code>\unicode</code>è§£ææ—¶æŠ¥é”™ï¼›è€Œ<code>\x56</code>ä¼šè¢«å½“ä½œåå…­è¿›åˆ¶å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œæ‰€ä»¥<code>\xerxes</code>ä¼šæŠ¥é”™ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œç°åœ¨æœ‰ä¸€ä¸ª<a href="https://tc39.github.io/proposal-template-literal-revision/" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œæ”¾æ¾å¯¹æ ‡ç­¾æ¨¡æ¿é‡Œé¢çš„å­—ç¬¦ä¸²è½¬ä¹‰çš„é™åˆ¶ã€‚å¦‚æœé‡åˆ°ä¸åˆæ³•çš„å­—ç¬¦ä¸²è½¬ä¹‰ï¼Œå°±è¿”å›<code>undefined</code>ï¼Œè€Œä¸æ˜¯æŠ¥é”™ï¼Œå¹¶ä¸”ä»<code>raw</code>å±æ€§ä¸Šé¢å¯ä»¥å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">strs</span>) </span>&#123;</div><div class="line">  strs[<span class="number">0</span>] === <span class="literal">undefined</span></div><div class="line">  strs.raw[<span class="number">0</span>] === <span class="string">"\\unicode and \\u&#123;55&#125;"</span>;</div><div class="line">&#125;</div><div class="line">tag<span class="string">`\unicode and \u&#123;55&#125;`</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²åŸæœ¬æ˜¯åº”è¯¥æŠ¥é”™çš„ï¼Œä½†æ˜¯ç”±äºæ”¾æ¾äº†å¯¹å­—ç¬¦ä¸²è½¬ä¹‰çš„é™åˆ¶ï¼Œæ‰€ä»¥ä¸æŠ¥é”™äº†ï¼ŒJavaScriptå¼•æ“å°†ç¬¬ä¸€ä¸ªå­—ç¬¦è®¾ç½®ä¸º<code>undefined</code>ï¼Œä½†æ˜¯<code>raw</code>å±æ€§ä¾ç„¶å¯ä»¥å¾—åˆ°åŸå§‹å­—ç¬¦ä¸²ï¼Œå› æ­¤<code>tag</code>å‡½æ•°è¿˜æ˜¯å¯ä»¥å¯¹åŸå­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ã€‚</p>
<p>æ³¨æ„ï¼Œè¿™ç§å¯¹å­—ç¬¦ä¸²è½¬ä¹‰çš„æ”¾æ¾ï¼Œåªåœ¨æ ‡ç­¾æ¨¡æ¿è§£æå­—ç¬¦ä¸²æ—¶ç”Ÿæ•ˆï¼Œä¸æ˜¯æ ‡ç­¾æ¨¡æ¿çš„åœºåˆï¼Œä¾ç„¶ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> bad = <span class="string">`bad escape sequence: \unicode`</span>; <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å­—ç¬¦ä¸²çš„æ‰©å±•&quot;&gt;&lt;a href=&quot;#å­—ç¬¦ä¸²çš„æ‰©å±•&quot; class=&quot;headerlink&quot; title=&quot;å­—ç¬¦ä¸²çš„æ‰©å±•&quot;&gt;&lt;/a&gt;å­—ç¬¦ä¸²çš„æ‰©å±•&lt;/h1&gt;&lt;p&gt;ES6åŠ å¼ºäº†å¯¹Unicodeçš„æ”¯æŒï¼Œå¹¶ä¸”æ‰©å±•äº†å­—ç¬¦ä¸²å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h2 id=&quot;å­—ç¬¦çš„Unicodeè¡¨ç¤º
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Unicode" scheme="http://microzz.com/tags/Unicode/"/>
    
  </entry>
  
  <entry>
    <title>å˜é‡çš„è§£æ„èµ‹å€¼(Destructuring)</title>
    <link href="http://microzz.com/2016/11/13/destructuring/"/>
    <id>http://microzz.com/2016/11/13/destructuring/</id>
    <published>2016-11-13T07:16:19.000Z</published>
    <updated>2017-01-12T07:47:46.995Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å˜é‡çš„è§£æ„èµ‹å€¼"><a href="#å˜é‡çš„è§£æ„èµ‹å€¼" class="headerlink" title="å˜é‡çš„è§£æ„èµ‹å€¼"></a>å˜é‡çš„è§£æ„èµ‹å€¼</h1><h2 id="æ•°ç»„çš„è§£æ„èµ‹å€¼"><a href="#æ•°ç»„çš„è§£æ„èµ‹å€¼" class="headerlink" title="æ•°ç»„çš„è§£æ„èµ‹å€¼"></a>æ•°ç»„çš„è§£æ„èµ‹å€¼</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>ES6å…è®¸æŒ‰ç…§ä¸€å®šæ¨¡å¼ï¼Œä»æ•°ç»„å’Œå¯¹è±¡ä¸­æå–å€¼ï¼Œå¯¹å˜é‡è¿›è¡Œèµ‹å€¼ï¼Œè¿™è¢«ç§°ä¸ºè§£æ„ï¼ˆDestructuringï¼‰ã€‚</p>
<p>ä»¥å‰ï¼Œä¸ºå˜é‡èµ‹å€¼ï¼Œåªèƒ½ç›´æ¥æŒ‡å®šå€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> b = <span class="number">2</span>;</div><div class="line"><span class="keyword">var</span> c = <span class="number">3</span>;</div></pre></td></tr></table></figure>
<p>ES6å…è®¸å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯ä»¥ä»æ•°ç»„ä¸­æå–å€¼ï¼ŒæŒ‰ç…§å¯¹åº”ä½ç½®ï¼Œå¯¹å˜é‡èµ‹å€¼ã€‚</p>
<p>æœ¬è´¨ä¸Šï¼Œè¿™ç§å†™æ³•å±äºâ€œæ¨¡å¼åŒ¹é…â€ï¼Œåªè¦ç­‰å·ä¸¤è¾¹çš„æ¨¡å¼ç›¸åŒï¼Œå·¦è¾¹çš„å˜é‡å°±ä¼šè¢«èµ‹äºˆå¯¹åº”çš„å€¼ã€‚ä¸‹é¢æ˜¯ä¸€äº›ä½¿ç”¨åµŒå¥—æ•°ç»„è¿›è¡Œè§£æ„çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [foo, [[bar], baz]] = [<span class="number">1</span>, [[<span class="number">2</span>], <span class="number">3</span>]];</div><div class="line">foo <span class="comment">// 1</span></div><div class="line">bar <span class="comment">// 2</span></div><div class="line">baz <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [ , , third] = [<span class="string">"foo"</span>, <span class="string">"bar"</span>, <span class="string">"baz"</span>];</div><div class="line">third <span class="comment">// "baz"</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [x, , y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [head, ...tail] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</div><div class="line">head <span class="comment">// 1</span></div><div class="line">tail <span class="comment">// [2, 3, 4]</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [x, y, ...z] = [<span class="string">'a'</span>];</div><div class="line">x <span class="comment">// "a"</span></div><div class="line">y <span class="comment">// undefined</span></div><div class="line">z <span class="comment">// []</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè§£æ„ä¸æˆåŠŸï¼Œå˜é‡çš„å€¼å°±ç­‰äº<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [foo] = [];</div><div class="line"><span class="keyword">var</span> [bar, foo] = [<span class="number">1</span>];</div></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä¸¤ç§æƒ…å†µéƒ½å±äºè§£æ„ä¸æˆåŠŸï¼Œ<code>foo</code>çš„å€¼éƒ½ä¼šç­‰äº<code>undefined</code>ã€‚</p>
<p>å¦ä¸€ç§æƒ…å†µæ˜¯ä¸å®Œå…¨è§£æ„ï¼Œå³ç­‰å·å·¦è¾¹çš„æ¨¡å¼ï¼ŒåªåŒ¹é…ä¸€éƒ¨åˆ†çš„ç­‰å·å³è¾¹çš„æ•°ç»„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè§£æ„ä¾ç„¶å¯ä»¥æˆåŠŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [x, y] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// 2</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [a, [b], d] = [<span class="number">1</span>, [<span class="number">2</span>, <span class="number">3</span>], <span class="number">4</span>];</div><div class="line">a <span class="comment">// 1</span></div><div class="line">b <span class="comment">// 2</span></div><div class="line">d <span class="comment">// 4</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸¤ä¸ªä¾‹å­ï¼Œéƒ½å±äºä¸å®Œå…¨è§£æ„ï¼Œä½†æ˜¯å¯ä»¥æˆåŠŸã€‚</p>
<p>å¦‚æœç­‰å·çš„å³è¾¹ä¸æ˜¯æ•°ç»„ï¼ˆæˆ–è€…ä¸¥æ ¼åœ°è¯´ï¼Œä¸æ˜¯å¯éå†çš„ç»“æ„ï¼Œå‚è§ã€ŠIteratorã€‹ä¸€ç« ï¼‰ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">let</span> [foo] = <span class="number">1</span>;</div><div class="line"><span class="keyword">let</span> [foo] = <span class="literal">false</span>;</div><div class="line"><span class="keyword">let</span> [foo] = <span class="literal">NaN</span>;</div><div class="line"><span class="keyword">let</span> [foo] = <span class="literal">undefined</span>;</div><div class="line"><span class="keyword">let</span> [foo] = <span class="literal">null</span>;</div><div class="line"><span class="keyword">let</span> [foo] = &#123;&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è¡¨è¾¾å¼éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºç­‰å·å³è¾¹çš„å€¼ï¼Œè¦ä¹ˆè½¬ä¸ºå¯¹è±¡ä»¥åä¸å…·å¤‡Iteratoræ¥å£ï¼ˆå‰äº”ä¸ªè¡¨è¾¾å¼ï¼‰ï¼Œè¦ä¹ˆæœ¬èº«å°±ä¸å…·å¤‡Iteratoræ¥å£ï¼ˆæœ€åä¸€ä¸ªè¡¨è¾¾å¼ï¼‰ã€‚</p>
<p>è§£æ„èµ‹å€¼ä¸ä»…é€‚ç”¨äºvarå‘½ä»¤ï¼Œä¹Ÿé€‚ç”¨äºletå’Œconstå‘½ä»¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [v1, v2, ..., vN ] = array;</div><div class="line"><span class="keyword">let</span> [v1, v2, ..., vN ] = array;</div><div class="line"><span class="keyword">const</span> [v1, v2, ..., vN ] = array;</div></pre></td></tr></table></figure>
<p>å¯¹äºSetç»“æ„ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„çš„è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [x, y, z] = <span class="keyword">new</span> <span class="built_in">Set</span>([<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>]);</div><div class="line">x <span class="comment">// "a"</span></div></pre></td></tr></table></figure>
<p>äº‹å®ä¸Šï¼Œåªè¦æŸç§æ•°æ®ç»“æ„å…·æœ‰Iteratoræ¥å£ï¼Œéƒ½å¯ä»¥é‡‡ç”¨æ•°ç»„å½¢å¼çš„è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">fibs</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> a = <span class="number">0</span>;</div><div class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</div><div class="line">  <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="keyword">yield</span> a;</div><div class="line">    [a, b] = [b, a + b];</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> [first, second, third, fourth, fifth, sixth] = fibs();</div><div class="line">sixth <span class="comment">// 5</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>fibs</code>æ˜¯ä¸€ä¸ªGeneratorå‡½æ•°ï¼ŒåŸç”Ÿå…·æœ‰Iteratoræ¥å£ã€‚è§£æ„èµ‹å€¼ä¼šä¾æ¬¡ä»è¿™ä¸ªæ¥å£è·å–å€¼ã€‚</p>
<h3 id="é»˜è®¤å€¼"><a href="#é»˜è®¤å€¼" class="headerlink" title="é»˜è®¤å€¼"></a>é»˜è®¤å€¼</h3><p>è§£æ„èµ‹å€¼å…è®¸æŒ‡å®šé»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [foo = <span class="literal">true</span>] = [];</div><div class="line">foo <span class="comment">// true</span></div><div class="line"></div><div class="line">[x, y = <span class="string">'b'</span>] = [<span class="string">'a'</span>]; <span class="comment">// x='a', y='b'</span></div><div class="line">[x, y = <span class="string">'b'</span>] = [<span class="string">'a'</span>, <span class="literal">undefined</span>]; <span class="comment">// x='a', y='b'</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼ŒES6å†…éƒ¨ä½¿ç”¨ä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼ˆ<code>===</code>ï¼‰ï¼Œåˆ¤æ–­ä¸€ä¸ªä½ç½®æ˜¯å¦æœ‰å€¼ã€‚æ‰€ä»¥ï¼Œå¦‚æœä¸€ä¸ªæ•°ç»„æˆå‘˜ä¸ä¸¥æ ¼ç­‰äº<code>undefined</code>ï¼Œé»˜è®¤å€¼æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> [x = <span class="number">1</span>] = [<span class="literal">undefined</span>];</div><div class="line">x <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> [x = <span class="number">1</span>] = [<span class="literal">null</span>];</div><div class="line">x <span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœä¸€ä¸ªæ•°ç»„æˆå‘˜æ˜¯<code>null</code>ï¼Œé»˜è®¤å€¼å°±ä¸ä¼šç”Ÿæ•ˆï¼Œå› ä¸º<code>null</code>ä¸ä¸¥æ ¼ç­‰äº<code>undefined</code>ã€‚</p>
<p>å¦‚æœé»˜è®¤å€¼æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆè¿™ä¸ªè¡¨è¾¾å¼æ˜¯æƒ°æ€§æ±‚å€¼çš„ï¼Œå³åªæœ‰åœ¨ç”¨åˆ°çš„æ—¶å€™ï¼Œæ‰ä¼šæ±‚å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'aaa'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> [x = f()] = [<span class="number">1</span>];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå› ä¸º<code>x</code>èƒ½å–åˆ°å€¼ï¼Œæ‰€ä»¥å‡½æ•°<code>f</code>æ ¹æœ¬ä¸ä¼šæ‰§è¡Œã€‚ä¸Šé¢çš„ä»£ç å…¶å®ç­‰ä»·äºä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> x;</div><div class="line"><span class="keyword">if</span> ([<span class="number">1</span>][<span class="number">0</span>] === <span class="literal">undefined</span>) &#123;</div><div class="line">  x = f();</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">  x = [<span class="number">1</span>][<span class="number">0</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é»˜è®¤å€¼å¯ä»¥å¼•ç”¨è§£æ„èµ‹å€¼çš„å…¶ä»–å˜é‡ï¼Œä½†è¯¥å˜é‡å¿…é¡»å·²ç»å£°æ˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [];     <span class="comment">// x=1; y=1</span></div><div class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [<span class="number">2</span>];    <span class="comment">// x=2; y=2</span></div><div class="line"><span class="keyword">let</span> [x = <span class="number">1</span>, y = x] = [<span class="number">1</span>, <span class="number">2</span>]; <span class="comment">// x=1; y=2</span></div><div class="line"><span class="keyword">let</span> [x = y, y = <span class="number">1</span>] = [];     <span class="comment">// ReferenceError</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢æœ€åä¸€ä¸ªè¡¨è¾¾å¼ä¹‹æ‰€ä»¥ä¼šæŠ¥é”™ï¼Œæ˜¯å› ä¸º<code>x</code>ç”¨åˆ°é»˜è®¤å€¼<code>y</code>æ—¶ï¼Œ<code>y</code>è¿˜æ²¡æœ‰å£°æ˜ã€‚</p>
<h2 id="å¯¹è±¡çš„è§£æ„èµ‹å€¼"><a href="#å¯¹è±¡çš„è§£æ„èµ‹å€¼" class="headerlink" title="å¯¹è±¡çš„è§£æ„èµ‹å€¼"></a>å¯¹è±¡çš„è§£æ„èµ‹å€¼</h2><p>è§£æ„ä¸ä»…å¯ä»¥ç”¨äºæ•°ç»„ï¼Œè¿˜å¯ä»¥ç”¨äºå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; foo, bar &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div><div class="line">foo <span class="comment">// "aaa"</span></div><div class="line">bar <span class="comment">// "bbb"</span></div></pre></td></tr></table></figure>
<p>å¯¹è±¡çš„è§£æ„ä¸æ•°ç»„æœ‰ä¸€ä¸ªé‡è¦çš„ä¸åŒã€‚æ•°ç»„çš„å…ƒç´ æ˜¯æŒ‰æ¬¡åºæ’åˆ—çš„ï¼Œå˜é‡çš„å–å€¼ç”±å®ƒçš„ä½ç½®å†³å®šï¼›è€Œå¯¹è±¡çš„å±æ€§æ²¡æœ‰æ¬¡åºï¼Œå˜é‡å¿…é¡»ä¸å±æ€§åŒåï¼Œæ‰èƒ½å–åˆ°æ­£ç¡®çš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; bar, foo &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div><div class="line">foo <span class="comment">// "aaa"</span></div><div class="line">bar <span class="comment">// "bbb"</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div><div class="line">baz <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œç­‰å·å·¦è¾¹çš„ä¸¤ä¸ªå˜é‡çš„æ¬¡åºï¼Œä¸ç­‰å·å³è¾¹ä¸¤ä¸ªåŒåå±æ€§çš„æ¬¡åºä¸ä¸€è‡´ï¼Œä½†æ˜¯å¯¹å–å€¼å®Œå…¨æ²¡æœ‰å½±å“ã€‚ç¬¬äºŒä¸ªä¾‹å­çš„å˜é‡æ²¡æœ‰å¯¹åº”çš„åŒåå±æ€§ï¼Œå¯¼è‡´å–ä¸åˆ°å€¼ï¼Œæœ€åç­‰äº<code>undefined</code>ã€‚</p>
<p>å¦‚æœå˜é‡åä¸å±æ€§åä¸ä¸€è‡´ï¼Œå¿…é¡»å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; <span class="attr">foo</span>: baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">'aaa'</span>, <span class="attr">bar</span>: <span class="string">'bbb'</span> &#125;;</div><div class="line">baz <span class="comment">// "aaa"</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> obj = &#123; <span class="attr">first</span>: <span class="string">'hello'</span>, <span class="attr">last</span>: <span class="string">'world'</span> &#125;;</div><div class="line"><span class="keyword">let</span> &#123; <span class="attr">first</span>: f, <span class="attr">last</span>: l &#125; = obj;</div><div class="line">f <span class="comment">// 'hello'</span></div><div class="line">l <span class="comment">// 'world'</span></div></pre></td></tr></table></figure>
<p>è¿™å®é™…ä¸Šè¯´æ˜ï¼Œå¯¹è±¡çš„è§£æ„èµ‹å€¼æ˜¯ä¸‹é¢å½¢å¼çš„ç®€å†™ï¼ˆå‚è§ã€Šå¯¹è±¡çš„æ‰©å±•ã€‹ä¸€ç« ï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; <span class="attr">foo</span>: foo, <span class="attr">bar</span>: bar &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div></pre></td></tr></table></figure>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹è±¡çš„è§£æ„èµ‹å€¼çš„å†…éƒ¨æœºåˆ¶ï¼Œæ˜¯å…ˆæ‰¾åˆ°åŒåå±æ€§ï¼Œç„¶åå†èµ‹ç»™å¯¹åº”çš„å˜é‡ã€‚çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯åè€…ï¼Œè€Œä¸æ˜¯å‰è€…ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123; <span class="attr">foo</span>: baz &#125; = &#123; <span class="attr">foo</span>: <span class="string">"aaa"</span>, <span class="attr">bar</span>: <span class="string">"bbb"</span> &#125;;</div><div class="line">baz <span class="comment">// "aaa"</span></div><div class="line">foo <span class="comment">// error: foo is not defined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>foo</code>æ˜¯åŒ¹é…çš„æ¨¡å¼ï¼Œ<code>baz</code>æ‰æ˜¯å˜é‡ã€‚çœŸæ­£è¢«èµ‹å€¼çš„æ˜¯å˜é‡<code>baz</code>ï¼Œè€Œä¸æ˜¯æ¨¡å¼<code>foo</code>ã€‚</p>
<p>æ³¨æ„ï¼Œé‡‡ç”¨è¿™ç§å†™æ³•æ—¶ï¼Œå˜é‡çš„å£°æ˜å’Œèµ‹å€¼æ˜¯ä¸€ä½“çš„ã€‚å¯¹äº<code>let</code>å’Œ<code>const</code>æ¥è¯´ï¼Œå˜é‡ä¸èƒ½é‡æ–°å£°æ˜ï¼Œæ‰€ä»¥ä¸€æ—¦èµ‹å€¼çš„å˜é‡ä»¥å‰å£°æ˜è¿‡ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> foo;</div><div class="line"><span class="keyword">let</span> &#123;foo&#125; = &#123;<span class="attr">foo</span>: <span class="number">1</span>&#125;; <span class="comment">// SyntaxError: Duplicate declaration "foo"</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> baz;</div><div class="line"><span class="keyword">let</span> &#123;<span class="attr">bar</span>: baz&#125; = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;; <span class="comment">// SyntaxError: Duplicate declaration "baz"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè§£æ„èµ‹å€¼çš„å˜é‡éƒ½ä¼šé‡æ–°å£°æ˜ï¼Œæ‰€ä»¥æŠ¥é”™äº†ã€‚ä¸è¿‡ï¼Œå› ä¸º<code>var</code>å‘½ä»¤å…è®¸é‡æ–°å£°æ˜ï¼Œæ‰€ä»¥è¿™ä¸ªé”™è¯¯åªä¼šåœ¨ä½¿ç”¨<code>let</code>å’Œ<code>const</code>å‘½ä»¤æ—¶å‡ºç°ã€‚å¦‚æœæ²¡æœ‰ç¬¬äºŒä¸ª<code>let</code>å‘½ä»¤ï¼Œä¸Šé¢çš„ä»£ç å°±ä¸ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> foo;</div><div class="line">(&#123;foo&#125; = &#123;<span class="attr">foo</span>: <span class="number">1</span>&#125;); <span class="comment">// æˆåŠŸ</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> baz;</div><div class="line">(&#123;<span class="attr">bar</span>: baz&#125; = &#123;<span class="attr">bar</span>: <span class="number">1</span>&#125;); <span class="comment">// æˆåŠŸ</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>let</code>å‘½ä»¤ä¸‹é¢ä¸€è¡Œçš„åœ†æ‹¬å·æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚å› ä¸ºè§£æå™¨ä¼šå°†èµ·é¦–çš„å¤§æ‹¬å·ï¼Œç†è§£æˆä¸€ä¸ªä»£ç å—ï¼Œè€Œä¸æ˜¯èµ‹å€¼è¯­å¥ã€‚</p>
<p>å’Œæ•°ç»„ä¸€æ ·ï¼Œè§£æ„ä¹Ÿå¯ä»¥ç”¨äºåµŒå¥—ç»“æ„çš„å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;</div><div class="line">  <span class="attr">p</span>: [</div><div class="line">    <span class="string">'Hello'</span>,</div><div class="line">    &#123; <span class="attr">y</span>: <span class="string">'World'</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; <span class="attr">p</span>: [x, &#123; y &#125;] &#125; = obj;</div><div class="line">x <span class="comment">// "Hello"</span></div><div class="line">y <span class="comment">// "World"</span></div></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œè¿™æ—¶<code>p</code>æ˜¯æ¨¡å¼ï¼Œä¸æ˜¯å˜é‡ï¼Œå› æ­¤ä¸ä¼šè¢«èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> node = &#123;</div><div class="line">  <span class="attr">loc</span>: &#123;</div><div class="line">    <span class="attr">start</span>: &#123;</div><div class="line">      <span class="attr">line</span>: <span class="number">1</span>,</div><div class="line">      <span class="attr">column</span>: <span class="number">5</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; <span class="attr">loc</span>: &#123; <span class="attr">start</span>: &#123; line &#125;&#125; &#125; = node;</div><div class="line">line <span class="comment">// 1</span></div><div class="line">loc  <span class="comment">// error: loc is undefined</span></div><div class="line">start <span class="comment">// error: start is undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåªæœ‰<code>line</code>æ˜¯å˜é‡ï¼Œ<code>loc</code>å’Œ<code>start</code>éƒ½æ˜¯æ¨¡å¼ï¼Œä¸ä¼šè¢«èµ‹å€¼ã€‚</p>
<p>ä¸‹é¢æ˜¯åµŒå¥—èµ‹å€¼çš„ä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> obj = &#123;&#125;;</div><div class="line"><span class="keyword">let</span> arr = [];</div><div class="line"></div><div class="line">(&#123; <span class="attr">foo</span>: obj.prop, <span class="attr">bar</span>: arr[<span class="number">0</span>] &#125; = &#123; <span class="attr">foo</span>: <span class="number">123</span>, <span class="attr">bar</span>: <span class="literal">true</span> &#125;);</div><div class="line"></div><div class="line">obj <span class="comment">// &#123;prop:123&#125;</span></div><div class="line">arr <span class="comment">// [true]</span></div></pre></td></tr></table></figure>
<p>å¯¹è±¡çš„è§£æ„ä¹Ÿå¯ä»¥æŒ‡å®šé»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123;x = <span class="number">3</span>&#125; = &#123;&#125;;</div><div class="line">x <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;x, y = <span class="number">5</span>&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</div><div class="line">x <span class="comment">// 1</span></div><div class="line">y <span class="comment">// 5</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;<span class="attr">x</span>:y = <span class="number">3</span>&#125; = &#123;&#125;;</div><div class="line">y <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;<span class="attr">x</span>:y = <span class="number">3</span>&#125; = &#123;<span class="attr">x</span>: <span class="number">5</span>&#125;;</div><div class="line">y <span class="comment">// 5</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; <span class="attr">message</span>: msg = <span class="string">'Something went wrong'</span> &#125; = &#123;&#125;;</div><div class="line">msg <span class="comment">// "Something went wrong"</span></div></pre></td></tr></table></figure>
<p>é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯ï¼Œå¯¹è±¡çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äº<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123;x = <span class="number">3</span>&#125; = &#123;<span class="attr">x</span>: <span class="literal">undefined</span>&#125;;</div><div class="line">x <span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;x = <span class="number">3</span>&#125; = &#123;<span class="attr">x</span>: <span class="literal">null</span>&#125;;</div><div class="line">x <span class="comment">// null</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¦‚æœ<code>x</code>å±æ€§ç­‰äº<code>null</code>ï¼Œå°±ä¸ä¸¥æ ¼ç›¸ç­‰äº<code>undefined</code>ï¼Œå¯¼è‡´é»˜è®¤å€¼ä¸ä¼šç”Ÿæ•ˆã€‚</p>
<p>å¦‚æœè§£æ„å¤±è´¥ï¼Œå˜é‡çš„å€¼ç­‰äº<code>undefined</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> &#123;foo&#125; = &#123;<span class="attr">bar</span>: <span class="string">'baz'</span>&#125;;</div><div class="line">foo <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè§£æ„æ¨¡å¼æ˜¯åµŒå¥—çš„å¯¹è±¡ï¼Œè€Œä¸”å­å¯¹è±¡æ‰€åœ¨çš„çˆ¶å±æ€§ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå°†ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="keyword">var</span> &#123;<span class="attr">foo</span>: &#123;bar&#125;&#125; = &#123;<span class="attr">baz</span>: <span class="string">'baz'</span>&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œç­‰å·å·¦è¾¹å¯¹è±¡çš„<code>foo</code>å±æ€§ï¼Œå¯¹åº”ä¸€ä¸ªå­å¯¹è±¡ã€‚è¯¥å­å¯¹è±¡çš„<code>bar</code>å±æ€§ï¼Œè§£æ„æ—¶ä¼šæŠ¥é”™ã€‚åŸå› å¾ˆç®€å•ï¼Œå› ä¸º<code>foo</code>è¿™æ—¶ç­‰äº<code>undefined</code>ï¼Œå†å–å­å±æ€§å°±ä¼šæŠ¥é”™ï¼Œè¯·çœ‹ä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _tmp = &#123;<span class="attr">baz</span>: <span class="string">'baz'</span>&#125;;</div><div class="line">_tmp.foo.bar <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>å¦‚æœè¦å°†ä¸€ä¸ªå·²ç»å£°æ˜çš„å˜é‡ç”¨äºè§£æ„èµ‹å€¼ï¼Œå¿…é¡»éå¸¸å°å¿ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// é”™è¯¯çš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> x;</div><div class="line">&#123;x&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;;</div><div class="line"><span class="comment">// SyntaxError: syntax error</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„å†™æ³•ä¼šæŠ¥é”™ï¼Œå› ä¸ºJavaScriptå¼•æ“ä¼šå°†<code>{x}</code>ç†è§£æˆä¸€ä¸ªä»£ç å—ï¼Œä»è€Œå‘ç”Ÿè¯­æ³•é”™è¯¯ã€‚åªæœ‰ä¸å°†å¤§æ‹¬å·å†™åœ¨è¡Œé¦–ï¼Œé¿å…JavaScriptå°†å…¶è§£é‡Šä¸ºä»£ç å—ï¼Œæ‰èƒ½è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ­£ç¡®çš„å†™æ³•</span></div><div class="line">(&#123;x&#125; = &#123;<span class="attr">x</span>: <span class="number">1</span>&#125;);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†æ•´ä¸ªè§£æ„èµ‹å€¼è¯­å¥ï¼Œæ”¾åœ¨ä¸€ä¸ªåœ†æ‹¬å·é‡Œé¢ï¼Œå°±å¯ä»¥æ­£ç¡®æ‰§è¡Œã€‚å…³äºåœ†æ‹¬å·ä¸è§£æ„èµ‹å€¼çš„å…³ç³»ï¼Œå‚è§ä¸‹æ–‡ã€‚</p>
<p>è§£æ„èµ‹å€¼å…è®¸ï¼Œç­‰å·å·¦è¾¹çš„æ¨¡å¼ä¹‹ä¸­ï¼Œä¸æ”¾ç½®ä»»ä½•å˜é‡åã€‚å› æ­¤ï¼Œå¯ä»¥å†™å‡ºéå¸¸å¤æ€ªçš„èµ‹å€¼è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">(&#123;&#125; = [<span class="literal">true</span>, <span class="literal">false</span>]);</div><div class="line">(&#123;&#125; = <span class="string">'abc'</span>);</div><div class="line">(&#123;&#125; = []);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„è¡¨è¾¾å¼è™½ç„¶æ¯«æ— æ„ä¹‰ï¼Œä½†æ˜¯è¯­æ³•æ˜¯åˆæ³•çš„ï¼Œå¯ä»¥æ‰§è¡Œã€‚</p>
<p>å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å°†ç°æœ‰å¯¹è±¡çš„æ–¹æ³•ï¼Œèµ‹å€¼åˆ°æŸä¸ªå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; log, sin, cos &#125; = <span class="built_in">Math</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†<code>Math</code>å¯¹è±¡çš„å¯¹æ•°ã€æ­£å¼¦ã€ä½™å¼¦ä¸‰ä¸ªæ–¹æ³•ï¼Œèµ‹å€¼åˆ°å¯¹åº”çš„å˜é‡ä¸Šï¼Œä½¿ç”¨èµ·æ¥å°±ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚</p>
<p>ç”±äºæ•°ç»„æœ¬è´¨æ˜¯ç‰¹æ®Šçš„å¯¹è±¡ï¼Œå› æ­¤å¯ä»¥å¯¹æ•°ç»„è¿›è¡Œå¯¹è±¡å±æ€§çš„è§£æ„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> &#123;<span class="number">0</span> : first, [arr.length - <span class="number">1</span>] : last&#125; = arr;</div><div class="line">first <span class="comment">// 1</span></div><div class="line">last <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯¹æ•°ç»„è¿›è¡Œå¯¹è±¡è§£æ„ã€‚æ•°ç»„<code>arr</code>çš„<code>0</code>é”®å¯¹åº”çš„å€¼æ˜¯<code>1</code>ï¼Œ<code>[arr.length - 1]</code>å°±æ˜¯<code>2</code>é”®ï¼Œå¯¹åº”çš„å€¼æ˜¯<code>3</code>ã€‚æ–¹æ‹¬å·è¿™ç§å†™æ³•ï¼Œå±äºâ€œå±æ€§åè¡¨è¾¾å¼â€ï¼Œå‚è§ã€Šå¯¹è±¡çš„æ‰©å±•ã€‹ä¸€ç« ã€‚</p>
<h2 id="å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼"><a href="#å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼" class="headerlink" title="å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼"></a>å­—ç¬¦ä¸²çš„è§£æ„èµ‹å€¼</h2><p>å­—ç¬¦ä¸²ä¹Ÿå¯ä»¥è§£æ„èµ‹å€¼ã€‚è¿™æ˜¯å› ä¸ºæ­¤æ—¶ï¼Œå­—ç¬¦ä¸²è¢«è½¬æ¢æˆäº†ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> [a, b, c, d, e] = <span class="string">'hello'</span>;</div><div class="line">a <span class="comment">// "h"</span></div><div class="line">b <span class="comment">// "e"</span></div><div class="line">c <span class="comment">// "l"</span></div><div class="line">d <span class="comment">// "l"</span></div><div class="line">e <span class="comment">// "o"</span></div></pre></td></tr></table></figure>
<p>ç±»ä¼¼æ•°ç»„çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ª<code>length</code>å±æ€§ï¼Œå› æ­¤è¿˜å¯ä»¥å¯¹è¿™ä¸ªå±æ€§è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123;<span class="attr">length</span> : len&#125; = <span class="string">'hello'</span>;</div><div class="line">len <span class="comment">// 5</span></div></pre></td></tr></table></figure>
<h2 id="æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼"><a href="#æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼" class="headerlink" title="æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼"></a>æ•°å€¼å’Œå¸ƒå°”å€¼çš„è§£æ„èµ‹å€¼</h2><p>è§£æ„èµ‹å€¼æ—¶ï¼Œå¦‚æœç­‰å·å³è¾¹æ˜¯æ•°å€¼å’Œå¸ƒå°”å€¼ï¼Œåˆ™ä¼šå…ˆè½¬ä¸ºå¯¹è±¡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123;<span class="attr">toString</span>: s&#125; = <span class="number">123</span>;</div><div class="line">s === <span class="built_in">Number</span>.prototype.toString <span class="comment">// true</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> &#123;<span class="attr">toString</span>: s&#125; = <span class="literal">true</span>;</div><div class="line">s === <span class="built_in">Boolean</span>.prototype.toString <span class="comment">// true</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œæ•°å€¼å’Œå¸ƒå°”å€¼çš„åŒ…è£…å¯¹è±¡éƒ½æœ‰<code>toString</code>å±æ€§ï¼Œå› æ­¤å˜é‡<code>s</code>éƒ½èƒ½å–åˆ°å€¼ã€‚</p>
<p>è§£æ„èµ‹å€¼çš„è§„åˆ™æ˜¯ï¼Œåªè¦ç­‰å·å³è¾¹çš„å€¼ä¸æ˜¯å¯¹è±¡ï¼Œå°±å…ˆå°†å…¶è½¬ä¸ºå¯¹è±¡ã€‚ç”±äº<code>undefined</code>å’Œ<code>null</code>æ— æ³•è½¬ä¸ºå¯¹è±¡ï¼Œæ‰€ä»¥å¯¹å®ƒä»¬è¿›è¡Œè§£æ„èµ‹å€¼ï¼Œéƒ½ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> &#123; <span class="attr">prop</span>: x &#125; = <span class="literal">undefined</span>; <span class="comment">// TypeError</span></div><div class="line"><span class="keyword">let</span> &#123; <span class="attr">prop</span>: y &#125; = <span class="literal">null</span>; <span class="comment">// TypeError</span></div></pre></td></tr></table></figure>
<h2 id="å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼"><a href="#å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼" class="headerlink" title="å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼"></a>å‡½æ•°å‚æ•°çš„è§£æ„èµ‹å€¼</h2><p>å‡½æ•°çš„å‚æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params">[x, y]</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> x + y;</div><div class="line">&#125;</div><div class="line"></div><div class="line">add([<span class="number">1</span>, <span class="number">2</span>]); <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>add</code>çš„å‚æ•°è¡¨é¢ä¸Šæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä½†åœ¨ä¼ å…¥å‚æ•°çš„é‚£ä¸€åˆ»ï¼Œæ•°ç»„å‚æ•°å°±è¢«è§£æ„æˆå˜é‡<code>x</code>å’Œ<code>y</code>ã€‚å¯¹äºå‡½æ•°å†…éƒ¨çš„ä»£ç æ¥è¯´ï¼Œå®ƒä»¬èƒ½æ„Ÿå—åˆ°çš„å‚æ•°å°±æ˜¯<code>x</code>å’Œ<code>y</code>ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]].map(<span class="function">(<span class="params">[a, b]</span>) =&gt;</span> a + b);</div><div class="line"><span class="comment">// [ 3, 7 ]</span></div></pre></td></tr></table></figure>
<p>å‡½æ•°å‚æ•°çš„è§£æ„ä¹Ÿå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">&#123;x = <span class="number">0</span>, y = <span class="number">0</span>&#125; = &#123;&#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">move(&#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></div><div class="line">move(&#123;<span class="attr">x</span>: <span class="number">3</span>&#125;); <span class="comment">// [3, 0]</span></div><div class="line">move(&#123;&#125;); <span class="comment">// [0, 0]</span></div><div class="line">move(); <span class="comment">// [0, 0]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°<code>move</code>çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡å¯¹è¿™ä¸ªå¯¹è±¡è¿›è¡Œè§£æ„ï¼Œå¾—åˆ°å˜é‡<code>x</code>å’Œ<code>y</code>çš„å€¼ã€‚å¦‚æœè§£æ„å¤±è´¥ï¼Œ<code>x</code>å’Œ<code>y</code>ç­‰äºé»˜è®¤å€¼ã€‚</p>
<p>æ³¨æ„ï¼Œä¸‹é¢çš„å†™æ³•ä¼šå¾—åˆ°ä¸ä¸€æ ·çš„ç»“æœã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">move</span>(<span class="params">&#123;x, y&#125; = &#123; x: <span class="number">0</span>, y: <span class="number">0</span> &#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">move(&#123;<span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span>&#125;); <span class="comment">// [3, 8]</span></div><div class="line">move(&#123;<span class="attr">x</span>: <span class="number">3</span>&#125;); <span class="comment">// [3, undefined]</span></div><div class="line">move(&#123;&#125;); <span class="comment">// [undefined, undefined]</span></div><div class="line">move(); <span class="comment">// [0, 0]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç æ˜¯ä¸ºå‡½æ•°<code>move</code>çš„å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯ä¸ºå˜é‡<code>x</code>å’Œ<code>y</code>æŒ‡å®šé»˜è®¤å€¼ï¼Œæ‰€ä»¥ä¼šå¾—åˆ°ä¸å‰ä¸€ç§å†™æ³•ä¸åŒçš„ç»“æœã€‚</p>
<p><code>undefined</code>å°±ä¼šè§¦å‘å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="literal">undefined</span>, <span class="number">3</span>].map(<span class="function">(<span class="params">x = <span class="string">'yes'</span></span>) =&gt;</span> x);</div><div class="line"><span class="comment">// [ 1, 'yes', 3 ]</span></div></pre></td></tr></table></figure>
<h2 id="åœ†æ‹¬å·é—®é¢˜"><a href="#åœ†æ‹¬å·é—®é¢˜" class="headerlink" title="åœ†æ‹¬å·é—®é¢˜"></a>åœ†æ‹¬å·é—®é¢˜</h2><p>è§£æ„èµ‹å€¼è™½ç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯è§£æèµ·æ¥å¹¶ä¸å®¹æ˜“ã€‚å¯¹äºç¼–è¯‘å™¨æ¥è¯´ï¼Œä¸€ä¸ªå¼å­åˆ°åº•æ˜¯æ¨¡å¼ï¼Œè¿˜æ˜¯è¡¨è¾¾å¼ï¼Œæ²¡æœ‰åŠæ³•ä»ä¸€å¼€å§‹å°±çŸ¥é“ï¼Œå¿…é¡»è§£æåˆ°ï¼ˆæˆ–è§£æä¸åˆ°ï¼‰ç­‰å·æ‰èƒ½çŸ¥é“ã€‚</p>
<p>ç”±æ­¤å¸¦æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæ¨¡å¼ä¸­å‡ºç°åœ†æ‹¬å·æ€ä¹ˆå¤„ç†ã€‚ES6çš„è§„åˆ™æ˜¯ï¼Œåªè¦æœ‰å¯èƒ½å¯¼è‡´è§£æ„çš„æ­§ä¹‰ï¼Œå°±ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™æ¡è§„åˆ™å®é™…ä¸Šä¸é‚£ä¹ˆå®¹æ˜“è¾¨åˆ«ï¼Œå¤„ç†èµ·æ¥ç›¸å½“éº»çƒ¦ã€‚å› æ­¤ï¼Œå»ºè®®åªè¦æœ‰å¯èƒ½ï¼Œå°±ä¸è¦åœ¨æ¨¡å¼ä¸­æ”¾ç½®åœ†æ‹¬å·ã€‚</p>
<h3 id="ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ"><a href="#ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ" class="headerlink" title="ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ"></a>ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ</h3><p>ä»¥ä¸‹ä¸‰ç§è§£æ„èµ‹å€¼ä¸å¾—ä½¿ç”¨åœ†æ‹¬å·ã€‚</p>
<p>ï¼ˆ1ï¼‰å˜é‡å£°æ˜è¯­å¥ä¸­ï¼Œä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å…¨éƒ¨æŠ¥é”™</span></div><div class="line"><span class="keyword">var</span> [(a)] = [<span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123;<span class="attr">x</span>: (c)&#125; = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> (&#123;<span class="attr">x</span>: c&#125;) = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> &#123;(x: c)&#125; = &#123;&#125;;</div><div class="line"><span class="keyword">var</span> &#123;(x): c&#125; = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> &#123; <span class="attr">o</span>: (&#123; <span class="attr">p</span>: p &#125;) &#125; = &#123; <span class="attr">o</span>: &#123; <span class="attr">p</span>: <span class="number">2</span> &#125; &#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸‰ä¸ªè¯­å¥éƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯å˜é‡å£°æ˜è¯­å¥ï¼Œæ¨¡å¼ä¸èƒ½ä½¿ç”¨åœ†æ‹¬å·ã€‚</p>
<p>ï¼ˆ2ï¼‰å‡½æ•°å‚æ•°ä¸­ï¼Œæ¨¡å¼ä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·ã€‚</p>
<p>å‡½æ•°å‚æ•°ä¹Ÿå±äºå˜é‡å£°æ˜ï¼Œå› æ­¤ä¸èƒ½å¸¦æœ‰åœ†æ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">[(z</span>)]) </span>&#123; <span class="keyword">return</span> z; &#125;</div></pre></td></tr></table></figure>
<p>ï¼ˆ3ï¼‰èµ‹å€¼è¯­å¥ä¸­ï¼Œä¸èƒ½å°†æ•´ä¸ªæ¨¡å¼ï¼Œæˆ–åµŒå¥—æ¨¡å¼ä¸­çš„ä¸€å±‚ï¼Œæ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å…¨éƒ¨æŠ¥é”™</span></div><div class="line">(&#123; <span class="attr">p</span>: a &#125;) = &#123; <span class="attr">p</span>: <span class="number">42</span> &#125;;</div><div class="line">([a]) = [<span class="number">5</span>];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†æ•´ä¸ªæ¨¡å¼æ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ï¼Œå¯¼è‡´æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line">[(&#123; <span class="attr">p</span>: a &#125;), &#123; <span class="attr">x</span>: c &#125;] = [&#123;&#125;, &#123;&#125;];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†åµŒå¥—æ¨¡å¼çš„ä¸€å±‚ï¼Œæ”¾åœ¨åœ†æ‹¬å·ä¹‹ä¸­ï¼Œå¯¼è‡´æŠ¥é”™ã€‚</p>
<h3 id="å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ"><a href="#å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ" class="headerlink" title="å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ"></a>å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µ</h3><p>å¯ä»¥ä½¿ç”¨åœ†æ‹¬å·çš„æƒ…å†µåªæœ‰ä¸€ç§ï¼šèµ‹å€¼è¯­å¥çš„éæ¨¡å¼éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨åœ†æ‹¬å·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[(b)] = [<span class="number">3</span>]; <span class="comment">// æ­£ç¡®</span></div><div class="line">(&#123; <span class="attr">p</span>: (d) &#125; = &#123;&#125;); <span class="comment">// æ­£ç¡®</span></div><div class="line">[(<span class="built_in">parseInt</span>.prop)] = [<span class="number">3</span>]; <span class="comment">// æ­£ç¡®</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä¸‰è¡Œè¯­å¥éƒ½å¯ä»¥æ­£ç¡®æ‰§è¡Œï¼Œå› ä¸ºé¦–å…ˆå®ƒä»¬éƒ½æ˜¯èµ‹å€¼è¯­å¥ï¼Œè€Œä¸æ˜¯å£°æ˜è¯­å¥ï¼›å…¶æ¬¡å®ƒä»¬çš„åœ†æ‹¬å·éƒ½ä¸å±äºæ¨¡å¼çš„ä¸€éƒ¨åˆ†ã€‚ç¬¬ä¸€è¡Œè¯­å¥ä¸­ï¼Œæ¨¡å¼æ˜¯å–æ•°ç»„çš„ç¬¬ä¸€ä¸ªæˆå‘˜ï¼Œè·Ÿåœ†æ‹¬å·æ— å…³ï¼›ç¬¬äºŒè¡Œè¯­å¥ä¸­ï¼Œæ¨¡å¼æ˜¯pï¼Œè€Œä¸æ˜¯dï¼›ç¬¬ä¸‰è¡Œè¯­å¥ä¸ç¬¬ä¸€è¡Œè¯­å¥çš„æ€§è´¨ä¸€è‡´ã€‚</p>
<h2 id="ç”¨é€”"><a href="#ç”¨é€”" class="headerlink" title="ç”¨é€”"></a>ç”¨é€”</h2><p>å˜é‡çš„è§£æ„èµ‹å€¼ç”¨é€”å¾ˆå¤šã€‚</p>
<p><strong>ï¼ˆ1ï¼‰äº¤æ¢å˜é‡çš„å€¼</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[x, y] = [y, x];</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç äº¤æ¢å˜é‡<code>x</code>å’Œ<code>y</code>çš„å€¼ï¼Œè¿™æ ·çš„å†™æ³•ä¸ä»…ç®€æ´ï¼Œè€Œä¸”æ˜“è¯»ï¼Œè¯­ä¹‰éå¸¸æ¸…æ™°ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰ä»å‡½æ•°è¿”å›å¤šä¸ªå€¼</strong></p>
<p>å‡½æ•°åªèƒ½è¿”å›ä¸€ä¸ªå€¼ï¼Œå¦‚æœè¦è¿”å›å¤šä¸ªå€¼ï¼Œåªèƒ½å°†å®ƒä»¬æ”¾åœ¨æ•°ç»„æˆ–å¯¹è±¡é‡Œè¿”å›ã€‚æœ‰äº†è§£æ„èµ‹å€¼ï¼Œå–å‡ºè¿™äº›å€¼å°±éå¸¸æ–¹ä¾¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è¿”å›ä¸€ä¸ªæ•°ç»„</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> [a, b, c] = example();</div><div class="line"></div><div class="line"><span class="comment">// è¿”å›ä¸€ä¸ªå¯¹è±¡</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">example</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">    <span class="attr">foo</span>: <span class="number">1</span>,</div><div class="line">    <span class="attr">bar</span>: <span class="number">2</span></div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> &#123; foo, bar &#125; = example();</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ3ï¼‰å‡½æ•°å‚æ•°çš„å®šä¹‰</strong></p>
<p>è§£æ„èµ‹å€¼å¯ä»¥æ–¹ä¾¿åœ°å°†ä¸€ç»„å‚æ•°ä¸å˜é‡åå¯¹åº”èµ·æ¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‚æ•°æ˜¯ä¸€ç»„æœ‰æ¬¡åºçš„å€¼</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">[x, y, z]</span>) </span>&#123; ... &#125;</div><div class="line">f([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]);</div><div class="line"></div><div class="line"><span class="comment">// å‚æ•°æ˜¯ä¸€ç»„æ— æ¬¡åºçš„å€¼</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params">&#123;x, y, z&#125;</span>) </span>&#123; ... &#125;</div><div class="line">f(&#123;<span class="attr">z</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">2</span>, <span class="attr">x</span>: <span class="number">1</span>&#125;);</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ4ï¼‰æå–JSONæ•°æ®</strong></p>
<p>è§£æ„èµ‹å€¼å¯¹æå–JSONå¯¹è±¡ä¸­çš„æ•°æ®ï¼Œå°¤å…¶æœ‰ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> jsonData = &#123;</div><div class="line">  <span class="attr">id</span>: <span class="number">42</span>,</div><div class="line">  <span class="attr">status</span>: <span class="string">"OK"</span>,</div><div class="line">  <span class="attr">data</span>: [<span class="number">867</span>, <span class="number">5309</span>]</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> &#123; id, status, <span class="attr">data</span>: number &#125; = jsonData;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(id, status, number);</div><div class="line"><span class="comment">// 42, "OK", [867, 5309]</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯ä»¥å¿«é€Ÿæå–JSONæ•°æ®çš„å€¼ã€‚</p>
<p><strong>ï¼ˆ5ï¼‰å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">jQuery.ajax = <span class="function"><span class="keyword">function</span> (<span class="params">url, &#123;</span></span></div><div class="line">  async = true,</div><div class="line">  beforeSend = function () &#123;&#125;,</div><div class="line">  cache = <span class="literal">true</span>,</div><div class="line">  complete = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;,</div><div class="line">  crossDomain = <span class="literal">false</span>,</div><div class="line">  global = <span class="literal">true</span>,</div><div class="line">  <span class="comment">// ... more config</span></div><div class="line">&#125;) &#123;</div><div class="line">  <span class="comment">// ... do stuff</span></div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>æŒ‡å®šå‚æ•°çš„é»˜è®¤å€¼ï¼Œå°±é¿å…äº†åœ¨å‡½æ•°ä½“å†…éƒ¨å†å†™<code>var foo = config.foo || &#39;default foo&#39;;</code>è¿™æ ·çš„è¯­å¥ã€‚</p>
<p><strong>ï¼ˆ6ï¼‰éå†Mapç»“æ„</strong></p>
<p>ä»»ä½•éƒ¨ç½²äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œéƒ½å¯ä»¥ç”¨<code>for...of</code>å¾ªç¯éå†ã€‚Mapç»“æ„åŸç”Ÿæ”¯æŒIteratoræ¥å£ï¼Œé…åˆå˜é‡çš„è§£æ„èµ‹å€¼ï¼Œè·å–é”®åå’Œé”®å€¼å°±éå¸¸æ–¹ä¾¿ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</div><div class="line">map.set(<span class="string">'first'</span>, <span class="string">'hello'</span>);</div><div class="line">map.set(<span class="string">'second'</span>, <span class="string">'world'</span>);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key, value] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="built_in">console</span>.log(key + <span class="string">" is "</span> + value);</div><div class="line">&#125;</div><div class="line"><span class="comment">// first is hello</span></div><div class="line"><span class="comment">// second is world</span></div></pre></td></tr></table></figure>
<p>å¦‚æœåªæƒ³è·å–é”®åï¼Œæˆ–è€…åªæƒ³è·å–é”®å€¼ï¼Œå¯ä»¥å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// è·å–é”®å</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [key] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// è·å–é”®å€¼</span></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> [,value] <span class="keyword">of</span> map) &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>ï¼ˆ7ï¼‰è¾“å…¥æ¨¡å—çš„æŒ‡å®šæ–¹æ³•</strong></p>
<p>åŠ è½½æ¨¡å—æ—¶ï¼Œå¾€å¾€éœ€è¦æŒ‡å®šè¾“å…¥é‚£äº›æ–¹æ³•ã€‚è§£æ„èµ‹å€¼ä½¿å¾—è¾“å…¥è¯­å¥éå¸¸æ¸…æ™°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; SourceMapConsumer, SourceNode &#125; = <span class="built_in">require</span>(<span class="string">"source-map"</span>);</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å˜é‡çš„è§£æ„èµ‹å€¼&quot;&gt;&lt;a href=&quot;#å˜é‡çš„è§£æ„èµ‹å€¼&quot; class=&quot;headerlink&quot; title=&quot;å˜é‡çš„è§£æ„èµ‹å€¼&quot;&gt;&lt;/a&gt;å˜é‡çš„è§£æ„èµ‹å€¼&lt;/h1&gt;&lt;h2 id=&quot;æ•°ç»„çš„è§£æ„èµ‹å€¼&quot;&gt;&lt;a href=&quot;#æ•°ç»„çš„è§£æ„èµ‹å€¼&quot; class=&quot;headerlink
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="Destructuring" scheme="http://microzz.com/tags/Destructuring/"/>
    
  </entry>
  
  <entry>
    <title>letå’Œconstå‘½ä»¤</title>
    <link href="http://microzz.com/2016/11/12/let/"/>
    <id>http://microzz.com/2016/11/12/let/</id>
    <published>2016-11-12T07:16:19.000Z</published>
    <updated>2017-01-12T07:47:17.355Z</updated>
    
    <content type="html"><![CDATA[<h1 id="letå’Œconstå‘½ä»¤"><a href="#letå’Œconstå‘½ä»¤" class="headerlink" title="letå’Œconstå‘½ä»¤"></a>letå’Œconstå‘½ä»¤</h1><h2 id="letå‘½ä»¤"><a href="#letå‘½ä»¤" class="headerlink" title="letå‘½ä»¤"></a>letå‘½ä»¤</h2><h3 id="åŸºæœ¬ç”¨æ³•"><a href="#åŸºæœ¬ç”¨æ³•" class="headerlink" title="åŸºæœ¬ç”¨æ³•"></a>åŸºæœ¬ç”¨æ³•</h3><p>ES6æ–°å¢äº†<code>let</code>å‘½ä»¤ï¼Œç”¨æ¥å£°æ˜å˜é‡ã€‚å®ƒçš„ç”¨æ³•ç±»ä¼¼äº<code>var</code>ï¼Œä½†æ˜¯æ‰€å£°æ˜çš„å˜é‡ï¼Œåªåœ¨<code>let</code>å‘½ä»¤æ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</div><div class="line">  <span class="keyword">var</span> b = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">a <span class="comment">// ReferenceError: a is not defined.</span></div><div class="line">b <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨ä»£ç å—ä¹‹ä¸­ï¼Œåˆ†åˆ«ç”¨<code>let</code>å’Œ<code>var</code>å£°æ˜äº†ä¸¤ä¸ªå˜é‡ã€‚ç„¶ååœ¨ä»£ç å—ä¹‹å¤–è°ƒç”¨è¿™ä¸¤ä¸ªå˜é‡ï¼Œç»“æœ<code>let</code>å£°æ˜çš„å˜é‡æŠ¥é”™ï¼Œ<code>var</code>å£°æ˜çš„å˜é‡è¿”å›äº†æ­£ç¡®çš„å€¼ã€‚è¿™è¡¨æ˜ï¼Œ<code>let</code>å£°æ˜çš„å˜é‡åªåœ¨å®ƒæ‰€åœ¨çš„ä»£ç å—æœ‰æ•ˆã€‚</p>
<p><code>for</code>å¾ªç¯çš„è®¡æ•°å™¨ï¼Œå°±å¾ˆåˆé€‚ä½¿ç”¨<code>let</code>å‘½ä»¤ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(i);</div><div class="line"><span class="comment">//ReferenceError: i is not defined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè®¡æ•°å™¨<code>i</code>åªåœ¨<code>for</code>å¾ªç¯ä½“å†…æœ‰æ•ˆï¼Œåœ¨å¾ªç¯ä½“å¤–å¼•ç”¨å°±ä¼šæŠ¥é”™ã€‚</p>
<p>ä¸‹é¢çš„ä»£ç å¦‚æœä½¿ç”¨<code>var</code>ï¼Œæœ€åè¾“å‡ºçš„æ˜¯<code>10</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">  a[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(i);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line">a[<span class="number">6</span>](); <span class="comment">// 10</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>i</code>æ˜¯<code>var</code>å£°æ˜çš„ï¼Œåœ¨å…¨å±€èŒƒå›´å†…éƒ½æœ‰æ•ˆã€‚æ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯ï¼Œæ–°çš„<code>i</code>å€¼éƒ½ä¼šè¦†ç›–æ—§å€¼ï¼Œå¯¼è‡´æœ€åè¾“å‡ºçš„æ˜¯æœ€åä¸€è½®çš„<code>i</code>çš„å€¼ã€‚</p>
<p>å¦‚æœä½¿ç”¨<code>let</code>ï¼Œå£°æ˜çš„å˜é‡ä»…åœ¨å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œæœ€åè¾“å‡ºçš„æ˜¯6ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = [];</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</div><div class="line">  a[i] = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(i);</div><div class="line">  &#125;;</div><div class="line">&#125;</div><div class="line">a[<span class="number">6</span>](); <span class="comment">// 6</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>i</code>æ˜¯<code>let</code>å£°æ˜çš„ï¼Œå½“å‰çš„<code>i</code>åªåœ¨æœ¬è½®å¾ªç¯æœ‰æ•ˆï¼Œæ‰€ä»¥æ¯ä¸€æ¬¡å¾ªç¯çš„<code>i</code>å…¶å®éƒ½æ˜¯ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œæ‰€ä»¥æœ€åè¾“å‡ºçš„æ˜¯<code>6</code>ã€‚ä½ å¯èƒ½ä¼šé—®ï¼Œå¦‚æœæ¯ä¸€è½®å¾ªç¯çš„å˜é‡<code>i</code>éƒ½æ˜¯é‡æ–°å£°æ˜çš„ï¼Œé‚£å®ƒæ€ä¹ˆçŸ¥é“ä¸Šä¸€è½®å¾ªç¯çš„å€¼ï¼Œä»è€Œè®¡ç®—å‡ºæœ¬è½®å¾ªç¯çš„å€¼ï¼Ÿè¿™æ˜¯å› ä¸º JavaScript å¼•æ“å†…éƒ¨ä¼šè®°ä½ä¸Šä¸€è½®å¾ªç¯çš„å€¼ï¼Œåˆå§‹åŒ–æœ¬è½®çš„å˜é‡<code>i</code>æ—¶ï¼Œå°±åœ¨ä¸Šä¸€è½®å¾ªç¯çš„åŸºç¡€ä¸Šè¿›è¡Œè®¡ç®—ã€‚</p>
<h3 id="ä¸å­˜åœ¨å˜é‡æå‡"><a href="#ä¸å­˜åœ¨å˜é‡æå‡" class="headerlink" title="ä¸å­˜åœ¨å˜é‡æå‡"></a>ä¸å­˜åœ¨å˜é‡æå‡</h3><p><code>let</code>ä¸åƒ<code>var</code>é‚£æ ·ä¼šå‘ç”Ÿâ€œå˜é‡æå‡â€ç°è±¡ã€‚æ‰€ä»¥ï¼Œå˜é‡ä¸€å®šè¦åœ¨å£°æ˜åä½¿ç”¨ï¼Œå¦åˆ™æŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// var çš„æƒ…å†µ</span></div><div class="line"><span class="built_in">console</span>.log(foo); <span class="comment">// è¾“å‡ºundefined</span></div><div class="line"><span class="keyword">var</span> foo = <span class="number">2</span>;</div><div class="line"></div><div class="line"><span class="comment">// let çš„æƒ…å†µ</span></div><div class="line"><span class="built_in">console</span>.log(bar); <span class="comment">// æŠ¥é”™ReferenceError</span></div><div class="line"><span class="keyword">let</span> bar = <span class="number">2</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>foo</code>ç”¨<code>var</code>å‘½ä»¤å£°æ˜ï¼Œä¼šå‘ç”Ÿå˜é‡æå‡ï¼Œå³è„šæœ¬å¼€å§‹è¿è¡Œæ—¶ï¼Œå˜é‡<code>foo</code>å·²ç»å­˜åœ¨äº†ï¼Œä½†æ˜¯æ²¡æœ‰å€¼ï¼Œæ‰€ä»¥ä¼šè¾“å‡º<code>undefined</code>ã€‚å˜é‡<code>bar</code>ç”¨<code>let</code>å‘½ä»¤å£°æ˜ï¼Œä¸ä¼šå‘ç”Ÿå˜é‡æå‡ã€‚è¿™è¡¨ç¤ºåœ¨å£°æ˜å®ƒä¹‹å‰ï¼Œå˜é‡<code>bar</code>æ˜¯ä¸å­˜åœ¨çš„ï¼Œè¿™æ—¶å¦‚æœç”¨åˆ°å®ƒï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p>
<h3 id="æš‚æ—¶æ€§æ­»åŒº"><a href="#æš‚æ—¶æ€§æ­»åŒº" class="headerlink" title="æš‚æ—¶æ€§æ­»åŒº"></a>æš‚æ—¶æ€§æ­»åŒº</h3><p>åªè¦å—çº§ä½œç”¨åŸŸå†…å­˜åœ¨<code>let</code>å‘½ä»¤ï¼Œå®ƒæ‰€å£°æ˜çš„å˜é‡å°±â€œç»‘å®šâ€ï¼ˆbindingï¼‰è¿™ä¸ªåŒºåŸŸï¼Œä¸å†å—å¤–éƒ¨çš„å½±å“ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> tmp = <span class="number">123</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  tmp = <span class="string">'abc'</span>; <span class="comment">// ReferenceError</span></div><div class="line">  <span class="keyword">let</span> tmp;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå­˜åœ¨å…¨å±€å˜é‡<code>tmp</code>ï¼Œä½†æ˜¯å—çº§ä½œç”¨åŸŸå†…<code>let</code>åˆå£°æ˜äº†ä¸€ä¸ªå±€éƒ¨å˜é‡<code>tmp</code>ï¼Œå¯¼è‡´åè€…ç»‘å®šè¿™ä¸ªå—çº§ä½œç”¨åŸŸï¼Œæ‰€ä»¥åœ¨<code>let</code>å£°æ˜å˜é‡å‰ï¼Œå¯¹<code>tmp</code>èµ‹å€¼ä¼šæŠ¥é”™ã€‚</p>
<p>ES6æ˜ç¡®è§„å®šï¼Œå¦‚æœåŒºå—ä¸­å­˜åœ¨<code>let</code>å’Œ<code>const</code>å‘½ä»¤ï¼Œè¿™ä¸ªåŒºå—å¯¹è¿™äº›å‘½ä»¤å£°æ˜çš„å˜é‡ï¼Œä»ä¸€å¼€å§‹å°±å½¢æˆäº†å°é—­ä½œç”¨åŸŸã€‚å‡¡æ˜¯åœ¨å£°æ˜ä¹‹å‰å°±ä½¿ç”¨è¿™äº›å˜é‡ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p>æ€»ä¹‹ï¼Œåœ¨ä»£ç å—å†…ï¼Œä½¿ç”¨<code>let</code>å‘½ä»¤å£°æ˜å˜é‡ä¹‹å‰ï¼Œè¯¥å˜é‡éƒ½æ˜¯ä¸å¯ç”¨çš„ã€‚è¿™åœ¨è¯­æ³•ä¸Šï¼Œç§°ä¸ºâ€œæš‚æ—¶æ€§æ­»åŒºâ€ï¼ˆtemporal dead zoneï¼Œç®€ç§° TDZï¼‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="comment">// TDZå¼€å§‹</span></div><div class="line">  tmp = <span class="string">'abc'</span>; <span class="comment">// ReferenceError</span></div><div class="line">  <span class="built_in">console</span>.log(tmp); <span class="comment">// ReferenceError</span></div><div class="line"></div><div class="line">  <span class="keyword">let</span> tmp; <span class="comment">// TDZç»“æŸ</span></div><div class="line">  <span class="built_in">console</span>.log(tmp); <span class="comment">// undefined</span></div><div class="line"></div><div class="line">  tmp = <span class="number">123</span>;</div><div class="line">  <span class="built_in">console</span>.log(tmp); <span class="comment">// 123</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œåœ¨<code>let</code>å‘½ä»¤å£°æ˜å˜é‡<code>tmp</code>ä¹‹å‰ï¼Œéƒ½å±äºå˜é‡<code>tmp</code>çš„â€œæ­»åŒºâ€ã€‚</p>
<p>â€œæš‚æ—¶æ€§æ­»åŒºâ€ä¹Ÿæ„å‘³ç€<code>typeof</code>ä¸å†æ˜¯ä¸€ä¸ªç™¾åˆ†ä¹‹ç™¾å®‰å…¨çš„æ“ä½œã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> x; <span class="comment">// ReferenceError</span></div><div class="line"><span class="keyword">let</span> x;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>x</code>ä½¿ç”¨<code>let</code>å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥åœ¨å£°æ˜ä¹‹å‰ï¼Œéƒ½å±äº<code>x</code>çš„â€œæ­»åŒºâ€ï¼Œåªè¦ç”¨åˆ°è¯¥å˜é‡å°±ä¼šæŠ¥é”™ã€‚å› æ­¤ï¼Œ<code>typeof</code>è¿è¡Œæ—¶å°±ä¼šæŠ›å‡ºä¸€ä¸ª<code>ReferenceError</code>ã€‚</p>
<p>ä½œä¸ºæ¯”è¾ƒï¼Œå¦‚æœä¸€ä¸ªå˜é‡æ ¹æœ¬æ²¡æœ‰è¢«å£°æ˜ï¼Œä½¿ç”¨<code>typeof</code>åè€Œä¸ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> undeclared_variable <span class="comment">// "undefined"</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>undeclared_variable</code>æ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„å˜é‡åï¼Œç»“æœè¿”å›â€œundefinedâ€ã€‚æ‰€ä»¥ï¼Œåœ¨æ²¡æœ‰<code>let</code>ä¹‹å‰ï¼Œ<code>typeof</code>è¿ç®—ç¬¦æ˜¯ç™¾åˆ†ä¹‹ç™¾å®‰å…¨çš„ï¼Œæ°¸è¿œä¸ä¼šæŠ¥é”™ã€‚ç°åœ¨è¿™ä¸€ç‚¹ä¸æˆç«‹äº†ã€‚è¿™æ ·çš„è®¾è®¡æ˜¯ä¸ºäº†è®©å¤§å®¶å…»æˆè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ï¼Œå˜é‡ä¸€å®šè¦åœ¨å£°æ˜ä¹‹åä½¿ç”¨ï¼Œå¦åˆ™å°±æŠ¥é”™ã€‚</p>
<p>æœ‰äº›â€œæ­»åŒºâ€æ¯”è¾ƒéšè”½ï¼Œä¸å¤ªå®¹æ˜“å‘ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">x = y, y = <span class="number">2</span></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line"></div><div class="line">bar(); <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œè°ƒç”¨<code>bar</code>å‡½æ•°ä¹‹æ‰€ä»¥æŠ¥é”™ï¼ˆæŸäº›å®ç°å¯èƒ½ä¸æŠ¥é”™ï¼‰ï¼Œæ˜¯å› ä¸ºå‚æ•°<code>x</code>é»˜è®¤å€¼ç­‰äºå¦ä¸€ä¸ªå‚æ•°<code>y</code>ï¼Œè€Œæ­¤æ—¶<code>y</code>è¿˜æ²¡æœ‰å£°æ˜ï¼Œå±äºâ€æ­»åŒºâ€œã€‚å¦‚æœ<code>y</code>çš„é»˜è®¤å€¼æ˜¯<code>x</code>ï¼Œå°±ä¸ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ­¤æ—¶<code>x</code>å·²ç»å£°æ˜äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">x = <span class="number">2</span>, y = x</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> [x, y];</div><div class="line">&#125;</div><div class="line">bar(); <span class="comment">// [2, 2]</span></div></pre></td></tr></table></figure>
<p>ES6è§„å®šæš‚æ—¶æ€§æ­»åŒºå’Œ<code>let</code>ã€<code>const</code>è¯­å¥ä¸å‡ºç°å˜é‡æå‡ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‡å°‘è¿è¡Œæ—¶é”™è¯¯ï¼Œé˜²æ­¢åœ¨å˜é‡å£°æ˜å‰å°±ä½¿ç”¨è¿™ä¸ªå˜é‡ï¼Œä»è€Œå¯¼è‡´æ„æ–™ä¹‹å¤–çš„è¡Œä¸ºã€‚è¿™æ ·çš„é”™è¯¯åœ¨ES5æ˜¯å¾ˆå¸¸è§çš„ï¼Œç°åœ¨æœ‰äº†è¿™ç§è§„å®šï¼Œé¿å…æ­¤ç±»é”™è¯¯å°±å¾ˆå®¹æ˜“äº†ã€‚</p>
<p>æ€»ä¹‹ï¼Œæš‚æ—¶æ€§æ­»åŒºçš„æœ¬è´¨å°±æ˜¯ï¼Œåªè¦ä¸€è¿›å…¥å½“å‰ä½œç”¨åŸŸï¼Œæ‰€è¦ä½¿ç”¨çš„å˜é‡å°±å·²ç»å­˜åœ¨äº†ï¼Œä½†æ˜¯ä¸å¯è·å–ï¼Œåªæœ‰ç­‰åˆ°å£°æ˜å˜é‡çš„é‚£ä¸€è¡Œä»£ç å‡ºç°ï¼Œæ‰å¯ä»¥è·å–å’Œä½¿ç”¨è¯¥å˜é‡ã€‚</p>
<h3 id="ä¸å…è®¸é‡å¤å£°æ˜"><a href="#ä¸å…è®¸é‡å¤å£°æ˜" class="headerlink" title="ä¸å…è®¸é‡å¤å£°æ˜"></a>ä¸å…è®¸é‡å¤å£°æ˜</h3><p>letä¸å…è®¸åœ¨ç›¸åŒä½œç”¨åŸŸå†…ï¼Œé‡å¤å£°æ˜åŒä¸€ä¸ªå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</div><div class="line">  <span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">10</span>;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å› æ­¤ï¼Œä¸èƒ½åœ¨å‡½æ•°å†…éƒ¨é‡æ–°å£°æ˜å‚æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> arg; <span class="comment">// æŠ¥é”™</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">func</span>(<span class="params">arg</span>) </span>&#123;</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">let</span> arg; <span class="comment">// ä¸æŠ¥é”™</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å—çº§ä½œç”¨åŸŸ"><a href="#å—çº§ä½œç”¨åŸŸ" class="headerlink" title="å—çº§ä½œç”¨åŸŸ"></a>å—çº§ä½œç”¨åŸŸ</h2><h3 id="ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸï¼Ÿ"></a>ä¸ºä»€ä¹ˆéœ€è¦å—çº§ä½œç”¨åŸŸï¼Ÿ</h3><p>ES5åªæœ‰å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œæ²¡æœ‰å—çº§ä½œç”¨åŸŸï¼Œè¿™å¸¦æ¥å¾ˆå¤šä¸åˆç†çš„åœºæ™¯ã€‚</p>
<p>ç¬¬ä¸€ç§åœºæ™¯ï¼Œå†…å±‚å˜é‡å¯èƒ½ä¼šè¦†ç›–å¤–å±‚å˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> tmp = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(tmp);</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">    <span class="keyword">var</span> tmp = <span class="string">"hello world"</span>;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">f(); <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå‡½æ•°fæ‰§è¡Œåï¼Œè¾“å‡ºç»“æœä¸º<code>undefined</code>ï¼ŒåŸå› åœ¨äºå˜é‡æå‡ï¼Œå¯¼è‡´å†…å±‚çš„tmpå˜é‡è¦†ç›–äº†å¤–å±‚çš„tmpå˜é‡ã€‚</p>
<p>ç¬¬äºŒç§åœºæ™¯ï¼Œç”¨æ¥è®¡æ•°çš„å¾ªç¯å˜é‡æ³„éœ²ä¸ºå…¨å±€å˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> s = <span class="string">'hello'</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; s.length; i++) &#123;</div><div class="line">  <span class="built_in">console</span>.log(s[i]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(i); <span class="comment">// 5</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡iåªç”¨æ¥æ§åˆ¶å¾ªç¯ï¼Œä½†æ˜¯å¾ªç¯ç»“æŸåï¼Œå®ƒå¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œæ³„éœ²æˆäº†å…¨å±€å˜é‡ã€‚</p>
<h3 id="ES6çš„å—çº§ä½œç”¨åŸŸ"><a href="#ES6çš„å—çº§ä½œç”¨åŸŸ" class="headerlink" title="ES6çš„å—çº§ä½œç”¨åŸŸ"></a>ES6çš„å—çº§ä½œç”¨åŸŸ</h3><p><code>let</code>å®é™…ä¸Šä¸ºJavaScriptæ–°å¢äº†å—çº§ä½œç”¨åŸŸã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> n = <span class="number">5</span>;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">    <span class="keyword">let</span> n = <span class="number">10</span>;</div><div class="line">  &#125;</div><div class="line">  <span class="built_in">console</span>.log(n); <span class="comment">// 5</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„å‡½æ•°æœ‰ä¸¤ä¸ªä»£ç å—ï¼Œéƒ½å£°æ˜äº†å˜é‡<code>n</code>ï¼Œè¿è¡Œåè¾“å‡º5ã€‚è¿™è¡¨ç¤ºå¤–å±‚ä»£ç å—ä¸å—å†…å±‚ä»£ç å—çš„å½±å“ã€‚å¦‚æœä½¿ç”¨<code>var</code>å®šä¹‰å˜é‡<code>n</code>ï¼Œæœ€åè¾“å‡ºçš„å€¼å°±æ˜¯10ã€‚</p>
<p>ES6å…è®¸å—çº§ä½œç”¨åŸŸçš„ä»»æ„åµŒå¥—ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;&#123;&#123;&#123;<span class="keyword">let</span> insane = <span class="string">'Hello World'</span>&#125;&#125;&#125;&#125;&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä½¿ç”¨äº†ä¸€ä¸ªäº”å±‚çš„å—çº§ä½œç”¨åŸŸã€‚å¤–å±‚ä½œç”¨åŸŸæ— æ³•è¯»å–å†…å±‚ä½œç”¨åŸŸçš„å˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;&#123;&#123;</div><div class="line">  &#123;<span class="keyword">let</span> insane = <span class="string">'Hello World'</span>&#125;</div><div class="line">  <span class="built_in">console</span>.log(insane); <span class="comment">// æŠ¥é”™</span></div><div class="line">&#125;&#125;&#125;&#125;;</div></pre></td></tr></table></figure>
<p>å†…å±‚ä½œç”¨åŸŸå¯ä»¥å®šä¹‰å¤–å±‚ä½œç”¨åŸŸçš„åŒåå˜é‡ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;&#123;&#123;&#123;</div><div class="line">  <span class="keyword">let</span> insane = <span class="string">'Hello World'</span>;</div><div class="line">  &#123;<span class="keyword">let</span> insane = <span class="string">'Hello World'</span>&#125;</div><div class="line">&#125;&#125;&#125;&#125;;</div></pre></td></tr></table></figure>
<p>å—çº§ä½œç”¨åŸŸçš„å‡ºç°ï¼Œå®é™…ä¸Šä½¿å¾—è·å¾—å¹¿æ³›åº”ç”¨çš„ç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼ï¼ˆIIFEï¼‰ä¸å†å¿…è¦äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// IIFE å†™æ³•</span></div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> tmp = ...;</div><div class="line">  ...</div><div class="line">&#125;());</div><div class="line"></div><div class="line"><span class="comment">// å—çº§ä½œç”¨åŸŸå†™æ³•</span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> tmp = ...;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜"><a href="#å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜" class="headerlink" title="å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜"></a>å—çº§ä½œç”¨åŸŸä¸å‡½æ•°å£°æ˜</h3><p>å‡½æ•°èƒ½ä¸èƒ½åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜ï¼Œæ˜¯ä¸€ä¸ªç›¸å½“ä»¤äººæ··æ·†çš„é—®é¢˜ã€‚</p>
<p>ES5è§„å®šï¼Œå‡½æ•°åªèƒ½åœ¨é¡¶å±‚ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜ï¼Œä¸èƒ½åœ¨å—çº§ä½œç”¨åŸŸå£°æ˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æƒ…å†µä¸€</span></div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æƒ…å†µäºŒ</span></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125; <span class="keyword">catch</span>(e) &#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç çš„ä¸¤ç§å‡½æ•°å£°æ˜ï¼Œæ ¹æ®ES5çš„è§„å®šéƒ½æ˜¯éæ³•çš„ã€‚</p>
<p>ä½†æ˜¯ï¼Œæµè§ˆå™¨æ²¡æœ‰éµå®ˆè¿™ä¸ªè§„å®šï¼Œä¸ºäº†å…¼å®¹ä»¥å‰çš„æ—§ä»£ç ï¼Œè¿˜æ˜¯æ”¯æŒåœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ï¼Œå› æ­¤ä¸Šé¢ä¸¤ç§æƒ…å†µå®é™…éƒ½èƒ½è¿è¡Œï¼Œä¸ä¼šæŠ¥é”™ã€‚ä¸è¿‡ï¼Œâ€œä¸¥æ ¼æ¨¡å¼â€ä¸‹è¿˜æ˜¯ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5ä¸¥æ ¼æ¨¡å¼</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ES6 å¼•å…¥äº†å—çº§ä½œç”¨åŸŸï¼Œæ˜ç¡®å…è®¸åœ¨å—çº§ä½œç”¨åŸŸä¹‹ä¸­å£°æ˜å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6ä¸¥æ ¼æ¨¡å¼</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// ä¸æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ES6 è§„å®šï¼Œå—çº§ä½œç”¨åŸŸä¹‹ä¸­ï¼Œå‡½æ•°å£°æ˜è¯­å¥çš„è¡Œä¸ºç±»ä¼¼äº<code>let</code>ï¼Œåœ¨å—çº§ä½œç”¨åŸŸä¹‹å¤–ä¸å¯å¼•ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">    <span class="comment">// é‡å¤å£°æ˜ä¸€æ¬¡å‡½æ•°f</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  f();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨ ES5 ä¸­è¿è¡Œï¼Œä¼šå¾—åˆ°â€œI am inside!â€ï¼Œå› ä¸ºåœ¨<code>if</code>å†…å£°æ˜çš„å‡½æ•°<code>f</code>ä¼šè¢«æå‡åˆ°å‡½æ•°å¤´éƒ¨ï¼Œå®é™…è¿è¡Œçš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES5ç‰ˆæœ¬</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">  &#125;</div><div class="line">  f();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<p>ES6 çš„è¿è¡Œç»“æœå°±å®Œå…¨ä¸ä¸€æ ·äº†ï¼Œä¼šå¾—åˆ°â€œI am outside!â€ã€‚å› ä¸ºå—çº§ä½œç”¨åŸŸå†…å£°æ˜çš„å‡½æ•°ç±»ä¼¼äº<code>let</code>ï¼Œå¯¹ä½œç”¨åŸŸä¹‹å¤–æ²¡æœ‰å½±å“ï¼Œå®é™…è¿è¡Œçš„ä»£ç å¦‚ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6ç‰ˆæœ¬</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  f();</div><div class="line">&#125;());</div></pre></td></tr></table></figure>
<p>å¾ˆæ˜¾ç„¶ï¼Œè¿™ç§è¡Œä¸ºå·®å¼‚ä¼šå¯¹è€ä»£ç äº§ç”Ÿå¾ˆå¤§å½±å“ã€‚ä¸ºäº†å‡è½»å› æ­¤äº§ç”Ÿçš„ä¸å…¼å®¹é—®é¢˜ï¼ŒES6åœ¨<a href="http://www.ecma-international.org/ecma-262/6.0/index.html#sec-block-level-function-declarations-web-legacy-compatibility-semantics" target="_blank" rel="external">é™„å½•B</a>é‡Œé¢è§„å®šï¼Œæµè§ˆå™¨çš„å®ç°å¯ä»¥ä¸éµå®ˆä¸Šé¢çš„è§„å®šï¼Œæœ‰è‡ªå·±çš„<a href="http://stackoverflow.com/questions/31419897/what-are-the-precise-semantics-of-block-level-functions-in-es6" target="_blank" rel="external">è¡Œä¸ºæ–¹å¼</a>ã€‚</p>
<ul>
<li>å…è®¸åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚</li>
<li>å‡½æ•°å£°æ˜ç±»ä¼¼äº<code>var</code>ï¼Œå³ä¼šæå‡åˆ°å…¨å±€ä½œç”¨åŸŸæˆ–å‡½æ•°ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚</li>
<li>åŒæ—¶ï¼Œå‡½æ•°å£°æ˜è¿˜ä¼šæå‡åˆ°æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸçš„å¤´éƒ¨ã€‚</li>
</ul>
<p>æ³¨æ„ï¼Œä¸Šé¢ä¸‰æ¡è§„åˆ™åªå¯¹ES6çš„æµè§ˆå™¨å®ç°æœ‰æ•ˆï¼Œå…¶ä»–ç¯å¢ƒçš„å®ç°ä¸ç”¨éµå®ˆï¼Œè¿˜æ˜¯å°†å—çº§ä½œç”¨åŸŸçš„å‡½æ•°å£°æ˜å½“ä½œ<code>let</code>å¤„ç†ã€‚</p>
<p>å‰é¢é‚£æ®µä»£ç ï¼Œåœ¨ Chrome ç¯å¢ƒä¸‹è¿è¡Œä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6çš„æµè§ˆå™¨ç¯å¢ƒ</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">    <span class="comment">// é‡å¤å£°æ˜ä¸€æ¬¡å‡½æ•°f</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  f();</div><div class="line">&#125;());</div><div class="line"><span class="comment">// Uncaught TypeError: f is not a function</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ä»£ç æŠ¥é”™ï¼Œæ˜¯å› ä¸ºå®é™…è¿è¡Œçš„æ˜¯ä¸‹é¢çš„ä»£ç ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ES6çš„æµè§ˆå™¨ç¯å¢ƒ</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am outside!'</span>); &#125;</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> f = <span class="literal">undefined</span>;</div><div class="line">  <span class="keyword">if</span> (<span class="literal">false</span>) &#123;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123; <span class="built_in">console</span>.log(<span class="string">'I am inside!'</span>); &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  f();</div><div class="line">&#125;());</div><div class="line"><span class="comment">// Uncaught TypeError: f is not a function</span></div></pre></td></tr></table></figure>
<p>è€ƒè™‘åˆ°ç¯å¢ƒå¯¼è‡´çš„è¡Œä¸ºå·®å¼‚å¤ªå¤§ï¼Œåº”è¯¥é¿å…åœ¨å—çº§ä½œç”¨åŸŸå†…å£°æ˜å‡½æ•°ã€‚å¦‚æœç¡®å®éœ€è¦ï¼Œä¹Ÿåº”è¯¥å†™æˆå‡½æ•°è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯å‡½æ•°å£°æ˜è¯­å¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‡½æ•°å£°æ˜è¯­å¥</span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="string">'secret'</span>;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// å‡½æ•°è¡¨è¾¾å¼</span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="string">'secret'</span>;</div><div class="line">  <span class="keyword">let</span> f = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å¦å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚ES6çš„å—çº§ä½œç”¨åŸŸå…è®¸å£°æ˜å‡½æ•°çš„è§„åˆ™ï¼Œåªåœ¨ä½¿ç”¨å¤§æ‹¬å·çš„æƒ…å†µä¸‹æˆç«‹ï¼Œå¦‚æœæ²¡æœ‰ä½¿ç”¨å¤§æ‹¬å·ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ä¸æŠ¥é”™</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æŠ¥é”™</span></div><div class="line"><span class="meta">'use strict'</span>;</div><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>)</div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>) </span>&#123;&#125;</div></pre></td></tr></table></figure>
<h3 id="do-è¡¨è¾¾å¼"><a href="#do-è¡¨è¾¾å¼" class="headerlink" title="do è¡¨è¾¾å¼"></a>do è¡¨è¾¾å¼</h3><p>æœ¬è´¨ä¸Šï¼Œå—çº§ä½œç”¨åŸŸæ˜¯ä¸€ä¸ªè¯­å¥ï¼Œå°†å¤šä¸ªæ“ä½œå°è£…åœ¨ä¸€èµ·ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="keyword">let</span> t = f();</div><div class="line">  t = t * t + <span class="number">1</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå—çº§ä½œç”¨åŸŸå°†ä¸¤ä¸ªè¯­å¥å°è£…åœ¨ä¸€èµ·ã€‚ä½†æ˜¯ï¼Œåœ¨å—çº§ä½œç”¨åŸŸä»¥å¤–ï¼Œæ²¡æœ‰åŠæ³•å¾—åˆ°<code>t</code>çš„å€¼ï¼Œå› ä¸ºå—çº§ä½œç”¨åŸŸä¸è¿”å›å€¼ï¼Œé™¤é<code>t</code>æ˜¯å…¨å±€å˜é‡ã€‚</p>
<p>ç°åœ¨æœ‰ä¸€ä¸ª<a href="http://wiki.ecmascript.org/doku.php?id=strawman:do_expressions" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œä½¿å¾—å—çº§ä½œç”¨åŸŸå¯ä»¥å˜ä¸ºè¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥è¿”å›å€¼ï¼ŒåŠæ³•å°±æ˜¯åœ¨å—çº§ä½œç”¨åŸŸä¹‹å‰åŠ ä¸Š<code>do</code>ï¼Œä½¿å®ƒå˜ä¸º<code>do</code>è¡¨è¾¾å¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> x = <span class="keyword">do</span> &#123;</div><div class="line">  <span class="keyword">let</span> t = f();</div><div class="line">  t * t + <span class="number">1</span>;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå˜é‡<code>x</code>ä¼šå¾—åˆ°æ•´ä¸ªå—çº§ä½œç”¨åŸŸçš„è¿”å›å€¼ã€‚</p>
<h2 id="constå‘½ä»¤"><a href="#constå‘½ä»¤" class="headerlink" title="constå‘½ä»¤"></a>constå‘½ä»¤</h2><p><code>const</code>å£°æ˜ä¸€ä¸ªåªè¯»çš„å¸¸é‡ã€‚ä¸€æ—¦å£°æ˜ï¼Œå¸¸é‡çš„å€¼å°±ä¸èƒ½æ”¹å˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> PI = <span class="number">3.1415</span>;</div><div class="line">PI <span class="comment">// 3.1415</span></div><div class="line"></div><div class="line">PI = <span class="number">3</span>;</div><div class="line"><span class="comment">// TypeError: Assignment to constant variable.</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨æ˜æ”¹å˜å¸¸é‡çš„å€¼ä¼šæŠ¥é”™ã€‚</p>
<p><code>const</code>å£°æ˜çš„å˜é‡ä¸å¾—æ”¹å˜å€¼ï¼Œè¿™æ„å‘³ç€ï¼Œconstä¸€æ—¦å£°æ˜å˜é‡ï¼Œå°±å¿…é¡»ç«‹å³åˆå§‹åŒ–ï¼Œä¸èƒ½ç•™åˆ°ä»¥åèµ‹å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foo;</div><div class="line"><span class="comment">// SyntaxError: Missing initializer in const declaration</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç è¡¨ç¤ºï¼Œå¯¹äº<code>const</code>æ¥è¯´ï¼Œåªå£°æ˜ä¸èµ‹å€¼ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p><code>const</code>çš„ä½œç”¨åŸŸä¸<code>let</code>å‘½ä»¤ç›¸åŒï¼šåªåœ¨å£°æ˜æ‰€åœ¨çš„å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="keyword">const</span> MAX = <span class="number">5</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">MAX <span class="comment">// Uncaught ReferenceError: MAX is not defined</span></div></pre></td></tr></table></figure>
<p><code>const</code>å‘½ä»¤å£°æ˜çš„å¸¸é‡ä¹Ÿæ˜¯ä¸æå‡ï¼ŒåŒæ ·å­˜åœ¨æš‚æ—¶æ€§æ­»åŒºï¼Œåªèƒ½åœ¨å£°æ˜çš„ä½ç½®åé¢ä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</div><div class="line">  <span class="built_in">console</span>.log(MAX); <span class="comment">// ReferenceError</span></div><div class="line">  <span class="keyword">const</span> MAX = <span class="number">5</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç åœ¨å¸¸é‡<code>MAX</code>å£°æ˜ä¹‹å‰å°±è°ƒç”¨ï¼Œç»“æœæŠ¥é”™ã€‚</p>
<p><code>const</code>å£°æ˜çš„å¸¸é‡ï¼Œä¹Ÿä¸<code>let</code>ä¸€æ ·ä¸å¯é‡å¤å£°æ˜ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> message = <span class="string">"Hello!"</span>;</div><div class="line"><span class="keyword">let</span> age = <span class="number">25</span>;</div><div class="line"></div><div class="line"><span class="comment">// ä»¥ä¸‹ä¸¤è¡Œéƒ½ä¼šæŠ¥é”™</span></div><div class="line"><span class="keyword">const</span> message = <span class="string">"Goodbye!"</span>;</div><div class="line"><span class="keyword">const</span> age = <span class="number">30</span>;</div></pre></td></tr></table></figure>
<p>å¯¹äºå¤åˆç±»å‹çš„å˜é‡ï¼Œå˜é‡åä¸æŒ‡å‘æ•°æ®ï¼Œè€Œæ˜¯æŒ‡å‘æ•°æ®æ‰€åœ¨çš„åœ°å€ã€‚<code>const</code>å‘½ä»¤åªæ˜¯ä¿è¯å˜é‡åæŒ‡å‘çš„åœ°å€ä¸å˜ï¼Œå¹¶ä¸ä¿è¯è¯¥åœ°å€çš„æ•°æ®ä¸å˜ï¼Œæ‰€ä»¥å°†ä¸€ä¸ªå¯¹è±¡å£°æ˜ä¸ºå¸¸é‡å¿…é¡»éå¸¸å°å¿ƒã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foo = &#123;&#125;;</div><div class="line">foo.prop = <span class="number">123</span>;</div><div class="line"></div><div class="line">foo.prop</div><div class="line"><span class="comment">// 123</span></div><div class="line"></div><div class="line">foo = &#123;&#125;; <span class="comment">// TypeError: "foo" is read-only</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡<code>foo</code>å‚¨å­˜çš„æ˜¯ä¸€ä¸ªåœ°å€ï¼Œè¿™ä¸ªåœ°å€æŒ‡å‘ä¸€ä¸ªå¯¹è±¡ã€‚ä¸å¯å˜çš„åªæ˜¯è¿™ä¸ªåœ°å€ï¼Œå³ä¸èƒ½æŠŠ<code>foo</code>æŒ‡å‘å¦ä¸€ä¸ªåœ°å€ï¼Œä½†å¯¹è±¡æœ¬èº«æ˜¯å¯å˜çš„ï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥ä¸ºå…¶æ·»åŠ æ–°å±æ€§ã€‚</p>
<p>ä¸‹é¢æ˜¯å¦ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> a = [];</div><div class="line">a.push(<span class="string">'Hello'</span>); <span class="comment">// å¯æ‰§è¡Œ</span></div><div class="line">a.length = <span class="number">0</span>;    <span class="comment">// å¯æ‰§è¡Œ</span></div><div class="line">a = [<span class="string">'Dave'</span>];    <span class="comment">// æŠ¥é”™</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡<code>a</code>æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„æœ¬èº«æ˜¯å¯å†™çš„ï¼Œä½†æ˜¯å¦‚æœå°†å¦ä¸€ä¸ªæ•°ç»„èµ‹å€¼ç»™<code>a</code>ï¼Œå°±ä¼šæŠ¥é”™ã€‚</p>
<p>å¦‚æœçœŸçš„æƒ³å°†å¯¹è±¡å†»ç»“ï¼Œåº”è¯¥ä½¿ç”¨<code>Object.freeze</code>æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> foo = <span class="built_in">Object</span>.freeze(&#123;&#125;);</div><div class="line"></div><div class="line"><span class="comment">// å¸¸è§„æ¨¡å¼æ—¶ï¼Œä¸‹é¢ä¸€è¡Œä¸èµ·ä½œç”¨ï¼›</span></div><div class="line"><span class="comment">// ä¸¥æ ¼æ¨¡å¼æ—¶ï¼Œè¯¥è¡Œä¼šæŠ¥é”™</span></div><div class="line">foo.prop = <span class="number">123</span>;</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå¸¸é‡<code>foo</code>æŒ‡å‘ä¸€ä¸ªå†»ç»“çš„å¯¹è±¡ï¼Œæ‰€ä»¥æ·»åŠ æ–°å±æ€§ä¸èµ·ä½œç”¨ï¼Œä¸¥æ ¼æ¨¡å¼æ—¶è¿˜ä¼šæŠ¥é”™ã€‚</p>
<p>é™¤äº†å°†å¯¹è±¡æœ¬èº«å†»ç»“ï¼Œå¯¹è±¡çš„å±æ€§ä¹Ÿåº”è¯¥å†»ç»“ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå°†å¯¹è±¡å½»åº•å†»ç»“çš„å‡½æ•°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> constantize = <span class="function">(<span class="params">obj</span>) =&gt;</span> &#123;</div><div class="line">  <span class="built_in">Object</span>.freeze(obj);</div><div class="line">  <span class="built_in">Object</span>.keys(obj).forEach( <span class="function">(<span class="params">key, value</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">if</span> ( <span class="keyword">typeof</span> obj[key] === <span class="string">'object'</span> ) &#123;</div><div class="line">      constantize( obj[key] );</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ES5åªæœ‰ä¸¤ç§å£°æ˜å˜é‡çš„æ–¹æ³•ï¼š<code>var</code>å‘½ä»¤å’Œ<code>function</code>å‘½ä»¤ã€‚ES6é™¤äº†æ·»åŠ <code>let</code>å’Œ<code>const</code>å‘½ä»¤ï¼Œåé¢ç« èŠ‚è¿˜ä¼šæåˆ°ï¼Œå¦å¤–ä¸¤ç§å£°æ˜å˜é‡çš„æ–¹æ³•ï¼š<code>import</code>å‘½ä»¤å’Œ<code>class</code>å‘½ä»¤ã€‚æ‰€ä»¥ï¼ŒES6ä¸€å…±æœ‰6ç§å£°æ˜å˜é‡çš„æ–¹æ³•ã€‚</p>
<h2 id="é¡¶å±‚å¯¹è±¡çš„å±æ€§"><a href="#é¡¶å±‚å¯¹è±¡çš„å±æ€§" class="headerlink" title="é¡¶å±‚å¯¹è±¡çš„å±æ€§"></a>é¡¶å±‚å¯¹è±¡çš„å±æ€§</h2><p>é¡¶å±‚å¯¹è±¡ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒæŒ‡çš„æ˜¯<code>window</code>å¯¹è±¡ï¼Œåœ¨NodeæŒ‡çš„æ˜¯<code>global</code>å¯¹è±¡ã€‚ES5ä¹‹ä¸­ï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§ä¸å…¨å±€å˜é‡æ˜¯ç­‰ä»·çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">window</span>.a = <span class="number">1</span>;</div><div class="line">a <span class="comment">// 1</span></div><div class="line"></div><div class="line">a = <span class="number">2</span>;</div><div class="line"><span class="built_in">window</span>.a <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§èµ‹å€¼ä¸å…¨å±€å˜é‡çš„èµ‹å€¼ï¼Œæ˜¯åŒä¸€ä»¶äº‹ã€‚</p>
<p>é¡¶å±‚å¯¹è±¡çš„å±æ€§ä¸å…¨å±€å˜é‡æŒ‚é’©ï¼Œè¢«è®¤ä¸ºæ˜¯JavaScriptè¯­è¨€æœ€å¤§çš„è®¾è®¡è´¥ç¬”ä¹‹ä¸€ã€‚è¿™æ ·çš„è®¾è®¡å¸¦æ¥äº†å‡ ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼Œé¦–å…ˆæ˜¯æ²¡æ³•åœ¨ç¼–è¯‘æ—¶å°±æŠ¥å‡ºå˜é‡æœªå£°æ˜çš„é”™è¯¯ï¼Œåªæœ‰è¿è¡Œæ—¶æ‰èƒ½çŸ¥é“ï¼ˆå› ä¸ºå…¨å±€å˜é‡å¯èƒ½æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§åˆ›é€ çš„ï¼Œè€Œå±æ€§çš„åˆ›é€ æ˜¯åŠ¨æ€çš„ï¼‰ï¼›å…¶æ¬¡ï¼Œç¨‹åºå‘˜å¾ˆå®¹æ˜“ä¸çŸ¥ä¸è§‰åœ°å°±åˆ›å»ºäº†å…¨å±€å˜é‡ï¼ˆæ¯”å¦‚æ‰“å­—å‡ºé”™ï¼‰ï¼›æœ€åï¼Œé¡¶å±‚å¯¹è±¡çš„å±æ€§æ˜¯åˆ°å¤„å¯ä»¥è¯»å†™çš„ï¼Œè¿™éå¸¸ä¸åˆ©äºæ¨¡å—åŒ–ç¼–ç¨‹ã€‚å¦ä¸€æ–¹é¢ï¼Œ<code>window</code>å¯¹è±¡æœ‰å®ä½“å«ä¹‰ï¼ŒæŒ‡çš„æ˜¯æµè§ˆå™¨çš„çª—å£å¯¹è±¡ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯ä¸€ä¸ªæœ‰å®ä½“å«ä¹‰çš„å¯¹è±¡ï¼Œä¹Ÿæ˜¯ä¸åˆé€‚çš„ã€‚</p>
<p>ES6ä¸ºäº†æ”¹å˜è¿™ä¸€ç‚¹ï¼Œä¸€æ–¹é¢è§„å®šï¼Œä¸ºäº†ä¿æŒå…¼å®¹æ€§ï¼Œ<code>var</code>å‘½ä»¤å’Œ<code>function</code>å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¾æ—§æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼›å¦ä¸€æ–¹é¢è§„å®šï¼Œ<code>let</code>å‘½ä»¤ã€<code>const</code>å‘½ä»¤ã€<code>class</code>å‘½ä»¤å£°æ˜çš„å…¨å±€å˜é‡ï¼Œä¸å±äºé¡¶å±‚å¯¹è±¡çš„å±æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»ES6å¼€å§‹ï¼Œå…¨å±€å˜é‡å°†é€æ­¥ä¸é¡¶å±‚å¯¹è±¡çš„å±æ€§è„±é’©ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line"><span class="comment">// å¦‚æœåœ¨Nodeçš„REPLç¯å¢ƒï¼Œå¯ä»¥å†™æˆglobal.a</span></div><div class="line"><span class="comment">// æˆ–è€…é‡‡ç”¨é€šç”¨æ–¹æ³•ï¼Œå†™æˆthis.a</span></div><div class="line"><span class="built_in">window</span>.a <span class="comment">// 1</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> b = <span class="number">1</span>;</div><div class="line"><span class="built_in">window</span>.b <span class="comment">// undefined</span></div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œå…¨å±€å˜é‡<code>a</code>ç”±<code>var</code>å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥å®ƒæ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼›å…¨å±€å˜é‡<code>b</code>ç”±<code>let</code>å‘½ä»¤å£°æ˜ï¼Œæ‰€ä»¥å®ƒä¸æ˜¯é¡¶å±‚å¯¹è±¡çš„å±æ€§ï¼Œè¿”å›<code>undefined</code>ã€‚</p>
<h2 id="global-å¯¹è±¡"><a href="#global-å¯¹è±¡" class="headerlink" title="global å¯¹è±¡"></a>global å¯¹è±¡</h2><p>ES5çš„é¡¶å±‚å¯¹è±¡ï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºå®ƒåœ¨å„ç§å®ç°é‡Œé¢æ˜¯ä¸ç»Ÿä¸€çš„ã€‚</p>
<ul>
<li>æµè§ˆå™¨é‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯<code>window</code>ï¼Œä½† Node å’Œ Web Worker æ²¡æœ‰<code>window</code>ã€‚</li>
<li>æµè§ˆå™¨å’Œ Web Worker é‡Œé¢ï¼Œ<code>self</code>ä¹ŸæŒ‡å‘é¡¶å±‚å¯¹è±¡ï¼Œä½†æ˜¯Nodeæ²¡æœ‰<code>self</code>ã€‚</li>
<li>Node é‡Œé¢ï¼Œé¡¶å±‚å¯¹è±¡æ˜¯<code>global</code>ï¼Œä½†å…¶ä»–ç¯å¢ƒéƒ½ä¸æ”¯æŒã€‚</li>
</ul>
<p>åŒä¸€æ®µä»£ç ä¸ºäº†èƒ½å¤Ÿåœ¨å„ç§ç¯å¢ƒï¼Œéƒ½èƒ½å–åˆ°é¡¶å±‚å¯¹è±¡ï¼Œç°åœ¨ä¸€èˆ¬æ˜¯ä½¿ç”¨<code>this</code>å˜é‡ï¼Œä½†æ˜¯æœ‰å±€é™æ€§ã€‚</p>
<ul>
<li>å…¨å±€ç¯å¢ƒä¸­ï¼Œ<code>this</code>ä¼šè¿”å›é¡¶å±‚å¯¹è±¡ã€‚ä½†æ˜¯ï¼ŒNodeæ¨¡å—å’ŒES6æ¨¡å—ä¸­ï¼Œ<code>this</code>è¿”å›çš„æ˜¯å½“å‰æ¨¡å—ã€‚</li>
<li>å‡½æ•°é‡Œé¢çš„<code>this</code>ï¼Œå¦‚æœå‡½æ•°ä¸æ˜¯ä½œä¸ºå¯¹è±¡çš„æ–¹æ³•è¿è¡Œï¼Œè€Œæ˜¯å•çº¯ä½œä¸ºå‡½æ•°è¿è¡Œï¼Œ<code>this</code>ä¼šæŒ‡å‘é¡¶å±‚å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œè¿™æ—¶<code>this</code>ä¼šè¿”å›<code>undefined</code>ã€‚</li>
<li>ä¸ç®¡æ˜¯ä¸¥æ ¼æ¨¡å¼ï¼Œè¿˜æ˜¯æ™®é€šæ¨¡å¼ï¼Œ<code>new Function(&#39;return this&#39;)()</code>ï¼Œæ€»æ˜¯ä¼šè¿”å›å…¨å±€å¯¹è±¡ã€‚ä½†æ˜¯ï¼Œå¦‚æœæµè§ˆå™¨ç”¨äº†CSPï¼ˆContent Security Policyï¼Œå†…å®¹å®‰å…¨æ”¿ç­–ï¼‰ï¼Œé‚£ä¹ˆ<code>eval</code>ã€<code>new Function</code>è¿™äº›æ–¹æ³•éƒ½å¯èƒ½æ— æ³•ä½¿ç”¨ã€‚</li>
</ul>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¾ˆéš¾æ‰¾åˆ°ä¸€ç§æ–¹æ³•ï¼Œå¯ä»¥åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œéƒ½å–åˆ°é¡¶å±‚å¯¹è±¡ã€‚ä¸‹é¢æ˜¯ä¸¤ç§å‹‰å¼ºå¯ä»¥ä½¿ç”¨çš„æ–¹æ³•ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ–¹æ³•ä¸€</span></div><div class="line">(<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span></div><div class="line">   ? <span class="built_in">window</span></div><div class="line">   : (<span class="keyword">typeof</span> process === <span class="string">'object'</span> &amp;&amp;</div><div class="line">      <span class="keyword">typeof</span> <span class="built_in">require</span> === <span class="string">'function'</span> &amp;&amp;</div><div class="line">      <span class="keyword">typeof</span> global === <span class="string">'object'</span>)</div><div class="line">     ? global</div><div class="line">     : <span class="keyword">this</span>);</div><div class="line"></div><div class="line"><span class="comment">// æ–¹æ³•äºŒ</span></div><div class="line"><span class="keyword">var</span> getGlobal = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> self !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> self; &#125;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">window</span> !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> <span class="built_in">window</span>; &#125;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> global !== <span class="string">'undefined'</span>) &#123; <span class="keyword">return</span> global; &#125;</div><div class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'unable to locate global object'</span>);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>ç°åœ¨æœ‰ä¸€ä¸ª<a href="https://github.com/tc39/proposal-global" target="_blank" rel="external">ææ¡ˆ</a>ï¼Œåœ¨è¯­è¨€æ ‡å‡†çš„å±‚é¢ï¼Œå¼•å…¥<code>global</code>ä½œä¸ºé¡¶å±‚å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ‰€æœ‰ç¯å¢ƒä¸‹ï¼Œ<code>global</code>éƒ½æ˜¯å­˜åœ¨çš„ï¼Œéƒ½å¯ä»¥ä»å®ƒæ‹¿åˆ°é¡¶å±‚å¯¹è±¡ã€‚</p>
<p>å«ç‰‡åº“<a href="https://github.com/ljharb/System.global" target="_blank" rel="external"><code>system.global</code></a>æ¨¡æ‹Ÿäº†è¿™ä¸ªææ¡ˆï¼Œå¯ä»¥åœ¨æ‰€æœ‰ç¯å¢ƒæ‹¿åˆ°<code>global</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// CommonJSçš„å†™æ³•</span></div><div class="line"><span class="built_in">require</span>(<span class="string">'system.global/shim'</span>)();</div><div class="line"></div><div class="line"><span class="comment">// ES6æ¨¡å—çš„å†™æ³•</span></div><div class="line"><span class="keyword">import</span> shim <span class="keyword">from</span> <span class="string">'system.global/shim'</span>; shim();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å¯ä»¥ä¿è¯å„ç§ç¯å¢ƒé‡Œé¢ï¼Œ<code>global</code>å¯¹è±¡éƒ½æ˜¯å­˜åœ¨çš„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// CommonJSçš„å†™æ³•</span></div><div class="line"><span class="keyword">var</span> global = <span class="built_in">require</span>(<span class="string">'system.global'</span>)();</div><div class="line"></div><div class="line"><span class="comment">// ES6æ¨¡å—çš„å†™æ³•</span></div><div class="line"><span class="keyword">import</span> getGlobal <span class="keyword">from</span> <span class="string">'system.global'</span>;</div><div class="line"><span class="keyword">const</span> global = getGlobal();</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç å°†é¡¶å±‚å¯¹è±¡æ”¾å…¥å˜é‡<code>global</code>ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;letå’Œconstå‘½ä»¤&quot;&gt;&lt;a href=&quot;#letå’Œconstå‘½ä»¤&quot; class=&quot;headerlink&quot; title=&quot;letå’Œconstå‘½ä»¤&quot;&gt;&lt;/a&gt;letå’Œconstå‘½ä»¤&lt;/h1&gt;&lt;h2 id=&quot;letå‘½ä»¤&quot;&gt;&lt;a href=&quot;#letå‘½ä»¤&quot; class
    
    </summary>
    
    
      <category term="JavaScript" scheme="http://microzz.com/tags/JavaScript/"/>
    
      <category term="ECMAScript6" scheme="http://microzz.com/tags/ECMAScript6/"/>
    
      <category term="JS" scheme="http://microzz.com/tags/JS/"/>
    
      <category term="ES6" scheme="http://microzz.com/tags/ES6/"/>
    
      <category term="const" scheme="http://microzz.com/tags/const/"/>
    
      <category term="let" scheme="http://microzz.com/tags/let/"/>
    
  </entry>
  
</feed>
